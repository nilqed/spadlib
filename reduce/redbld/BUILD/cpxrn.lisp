(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'CPXRN)) 
(FLUID '(|:PREC:|)) 
(GLOBAL '(BFONE* EPSQRT*)) 
(FLUID '(DMODE* *BFSPACE *NUMVAL)) 
(SWITCH (LIST 'BFSPACE 'NUMVAL)) 
(SETQ *BFSPACE (SETQ *NUMVAL T)) 
(GLOBAL '(DOMAINLIST*)) 
(SETQ DOMAINLIST* (UNION '(|:CRN:|) DOMAINLIST*)) 
(FLUID '(*COMPLEX-RATIONAL)) 
(PUT 'COMPLEX-RATIONAL 'TAG '|:CRN:|) 
(PUT '|:CRN:| 'DNAME 'COMPLEX-RATIONAL) 
(FLAG '(|:CRN:|) 'FIELD) 
(PUT '|:CRN:| 'I2D 'I2CRN*) 
(PUT '|:CRN:| 'PLUS '|CRN:PLUS|) 
(PUT '|:CRN:| 'TIMES '|CRN:TIMES|) 
(PUT '|:CRN:| 'DIFFERENCE '|CRN:DIFFER|) 
(PUT '|:CRN:| 'QUOTIENT '|CRN:QUOTIENT|) 
(PUT '|:CRN:| 'ZEROP '|CRN:ZEROP|) 
(PUT '|:CRN:| 'ONEP '|CRN:ONEP|) 
(PUT '|:CRN:| 'PREPFN '|CRN:PREP|) 
(PUT '|:CRN:| 'PRIFN '|CRN:PRIN|) 
(PUT '|:CRN:| 'MINUS '|CRN:MINUS|) 
(PUT '|:CRN:| 'FACTORFN '|CRN:FACTOR|) 
(PUT '|:CRN:| 'RATIONALIZEFN '|GIRATIONALIZE:|) 
(PUT '|:CRN:| '|:RN:| '*CRN2RN) 
(PUT '|:RN:| '|:CRN:| '*RN2CRN) 
(PUT '|:RD:| '|:CRN:| '*RD2CRN) 
(PUT '|:CRN:| '|:RD:| '*CRN2RD) 
(PUT '|:GI:| '|:CRN:| '*GI2CRN) 
(PUT '|:CRN:| 'CMPXFN 'MKCRN) 
(PUT '|:CRN:| 'IVALUE 'MKDCRN) 
(PUT '|:CRN:| 'INTEQUIVFN 'CRNEQUIV) 
(PUT '|:CRN:| 'REALTYPE '|:RN:|) 
(PUT '|:RN:| 'CMPXTYPE '|:CRN:|) 
(PUT '|:CRN:| 'MINUSP '|CRN:MINUSP|) 
(PUT 'MKCRN 'NUMBER-OF-ARGS 2) 
(PUT 'MKCRN 'DEFINED-ON-LINE '81) 
(PUT 'MKCRN 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT 'MKCRN 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MKCRN (U V) (CONS '|:CRN:| (CONS U V))) 
(DE CRNTAG (X) (CONS '|:CRN:| X)) 
(PUT 'CRNTAG 'NUMBER-OF-ARGS 1) 
(PUT 'CRNTAG 'DEFINED-ON-LINE '83) 
(PUT 'CRNTAG 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT 'CRNTAG 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CRNTAG 'INLINE '(LAMBDA (X) (CONS '|:CRN:| X))) 
(DE RNTAG (X) (CONS '|:RN:| X)) 
(PUT 'RNTAG 'NUMBER-OF-ARGS 1) 
(PUT 'RNTAG 'DEFINED-ON-LINE '85) 
(PUT 'RNTAG 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT 'RNTAG 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'RNTAG 'INLINE '(LAMBDA (X) (CONS '|:RN:| X))) 
(DE CRNRL (X) (CADR X)) 
(PUT 'CRNRL 'NUMBER-OF-ARGS 1) 
(PUT 'CRNRL 'DEFINED-ON-LINE '87) 
(PUT 'CRNRL 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT 'CRNRL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CRNRL 'INLINE '(LAMBDA (X) (CADR X))) 
(DE CRNIM (X) (CDDR X)) 
(PUT 'CRNIM 'NUMBER-OF-ARGS 1) 
(PUT 'CRNIM 'DEFINED-ON-LINE '89) 
(PUT 'CRNIM 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT 'CRNIM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CRNIM 'INLINE '(LAMBDA (X) (CDDR X))) 
(PUT '|CRN:MINUSP| 'NUMBER-OF-ARGS 1) 
(PUT '|CRN:MINUSP| 'DEFINED-ON-LINE '91) 
(PUT '|CRN:MINUSP| 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT '|CRN:MINUSP| 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE |CRN:MINUSP| (U) (AND (EQUAL (CAR (CDDR U)) 0) (MINUSP (CAR (CADR U))))) 
(PUT '|CRN:SIMP| 'NUMBER-OF-ARGS 1) 
(PUT '|CRN:SIMP| 'DEFINED-ON-LINE '93) 
(PUT '|CRN:SIMP| 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT '|CRN:SIMP| 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE |CRN:SIMP| (U) (CONS (CONS '|:CRN:| U) 1)) 
(PUT '|:CRN:| 'SIMPFN '|CRN:SIMP|) 
(PUT 'MKDCRN 'NUMBER-OF-ARGS 1) 
(PUT 'MKDCRN 'DEFINED-ON-LINE '97) 
(PUT 'MKDCRN 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT 'MKDCRN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MKDCRN (U) (CONS (CONS '|:CRN:| (CONS (CONS 0 1) (CONS 1 1))) 1)) 
(PUT 'I2CRN* 'NUMBER-OF-ARGS 1) 
(PUT 'I2CRN* 'DEFINED-ON-LINE '100) 
(PUT 'I2CRN* 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT 'I2CRN* 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE I2CRN* (U) (MKCRN (CONS U 1) (CONS 0 1))) 
(PUT '*CRN2RN 'NUMBER-OF-ARGS 1) 
(PUT '*CRN2RN 'DEFINED-ON-LINE '103) 
(PUT '*CRN2RN 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT '*CRN2RN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE *CRN2RN (N)
    (COND ((NOT (EQUAL (CAR (CDDR N)) 0)) (CR2RDERR))
          (T (CONS '|:RN:| (CADR N))))) 
(PUT '*RN2CRN 'NUMBER-OF-ARGS 1) 
(PUT '*RN2CRN 'DEFINED-ON-LINE '107) 
(PUT '*RN2CRN 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT '*RN2CRN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE *RN2CRN (U) (MKCRN (CDR U) (CONS 0 1))) 
(PUT '*CRN2RD 'NUMBER-OF-ARGS 1) 
(PUT '*CRN2RD 'DEFINED-ON-LINE '110) 
(PUT '*CRN2RD 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT '*CRN2RD 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE *CRN2RD (N)
    (COND ((NOT (EQUAL (CAR (CDDR N)) 0)) (CR2RDERR))
          (T (MKROUND (CHKRN* (R2BF (CADR N))))))) 
(PUT '*RD2CRN 'NUMBER-OF-ARGS 1) 
(PUT '*RD2CRN 'DEFINED-ON-LINE '114) 
(PUT '*RD2CRN 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT '*RD2CRN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE *RD2CRN (U) ((LAMBDA (X) (MKCRN (REALRAT X) (CONS 0 1))) (ROUND* U))) 
(PUT '*GI2CRN 'NUMBER-OF-ARGS 1) 
(PUT '*GI2CRN 'DEFINED-ON-LINE '116) 
(PUT '*GI2CRN 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT '*GI2CRN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE *GI2CRN (U) (MKCRN (CONS (CADR U) 1) (CONS (CDDR U) 1))) 
(PUT '|CRN:PLUS| 'NUMBER-OF-ARGS 2) 
(PUT '|CRN:PLUS| 'DEFINED-ON-LINE '118) 
(PUT '|CRN:PLUS| 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT '|CRN:PLUS| 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE |CRN:PLUS| (U V)
    (MKCRN (CDR (|RNPLUS:| (CONS '|:RN:| (CADR U)) (CONS '|:RN:| (CADR V))))
           (CDR (|RNPLUS:| (CONS '|:RN:| (CDDR U)) (CONS '|:RN:| (CDDR V)))))) 
(PUT '|CRN:DIFFER| 'NUMBER-OF-ARGS 2) 
(PUT '|CRN:DIFFER| 'DEFINED-ON-LINE '122) 
(PUT '|CRN:DIFFER| 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT '|CRN:DIFFER| 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE |CRN:DIFFER| (U V)
    (MKCRN
     (CDR (|RNDIFFERENCE:| (CONS '|:RN:| (CADR U)) (CONS '|:RN:| (CADR V))))
     (CDR (|RNDIFFERENCE:| (CONS '|:RN:| (CDDR U)) (CONS '|:RN:| (CDDR V)))))) 
(PUT '|CRN:TIMES| 'NUMBER-OF-ARGS 2) 
(PUT '|CRN:TIMES| 'DEFINED-ON-LINE '126) 
(PUT '|CRN:TIMES| 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT '|CRN:TIMES| 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE |CRN:TIMES| (U V)
    ((LAMBDA (RU IU RV IV)
       (MKCRN (CDR (|RNDIFFERENCE:| (|RNTIMES:| RU RV) (|RNTIMES:| IU IV)))
              (CDR (|RNPLUS:| (|RNTIMES:| RU IV) (|RNTIMES:| RV IU)))))
     (CONS '|:RN:| (CADR U)) (CONS '|:RN:| (CDDR U)) (CONS '|:RN:| (CADR V))
     (CONS '|:RN:| (CDDR V)))) 
(PUT '|CRN:QUOTIENT| 'NUMBER-OF-ARGS 2) 
(PUT '|CRN:QUOTIENT| 'DEFINED-ON-LINE '132) 
(PUT '|CRN:QUOTIENT| 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT '|CRN:QUOTIENT| 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE |CRN:QUOTIENT| (U V)
    ((LAMBDA (RU IU RV IV)
       (PROGN
        (SETQ V (|RNPLUS:| (|RNTIMES:| RV RV) (|RNTIMES:| IV IV)))
        (MKCRN
         (CDR
          (|RNQUOTIENT:| (|RNPLUS:| (|RNTIMES:| RU RV) (|RNTIMES:| IU IV)) V))
         (CDR
          (|RNQUOTIENT:|
           (|RNDIFFERENCE:| (|RNTIMES:| IU RV) (|RNTIMES:| RU IV)) V)))))
     (CONS '|:RN:| (CADR U)) (CONS '|:RN:| (CDDR U)) (CONS '|:RN:| (CADR V))
     (CONS '|:RN:| (CDDR V)))) 
(PUT '|CRN:MINUS| 'NUMBER-OF-ARGS 1) 
(PUT '|CRN:MINUS| 'DEFINED-ON-LINE '139) 
(PUT '|CRN:MINUS| 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT '|CRN:MINUS| 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE |CRN:MINUS| (U)
    ((LAMBDA (RU IU)
       (MKCRN (CONS (MINUS (CAR RU)) (CDR RU))
              (CONS (MINUS (CAR IU)) (CDR IU))))
     (CADR U) (CDDR U))) 
(PUT '|CRN:ZEROP| 'NUMBER-OF-ARGS 1) 
(PUT '|CRN:ZEROP| 'DEFINED-ON-LINE '143) 
(PUT '|CRN:ZEROP| 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT '|CRN:ZEROP| 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE |CRN:ZEROP| (U) (AND (EQUAL (CAR (CADR U)) 0) (EQUAL (CAR (CDDR U)) 0))) 
(PUT '|CRN:ONEP| 'NUMBER-OF-ARGS 1) 
(PUT '|CRN:ONEP| 'DEFINED-ON-LINE '145) 
(PUT '|CRN:ONEP| 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT '|CRN:ONEP| 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE |CRN:ONEP| (U) (AND (EQUAL (CAR (CDDR U)) 0) (EQUAL (CADR U) '(1 . 1)))) 
(PUT '|CRN:PREP| 'NUMBER-OF-ARGS 1) 
(PUT '|CRN:PREP| 'DEFINED-ON-LINE '147) 
(PUT '|CRN:PREP| 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT '|CRN:PREP| 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE |CRN:PREP| (U)
    (CRNPREP1 (CONS (CONS '|:RN:| (CADR U)) (CONS '|:RN:| (CDDR U))))) 
(PUT '|CRN:FACTOR| 'NUMBER-OF-ARGS 1) 
(PUT '|CRN:FACTOR| 'DEFINED-ON-LINE '150) 
(PUT '|CRN:FACTOR| 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT '|CRN:FACTOR| 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE |CRN:FACTOR| (U)
    ((LAMBDA (DMODE*)
       (PROG (M N P X Y)
         ((LAMBDA (*MSG) (SETDMODE 'RATIONAL NIL)) NIL)
         (SETQ X (SUBF U NIL))
         (SETQ Y (FCTRF (CAR X)))
         (SETQ N (CAR Y))
         ((LAMBDA (*MSG) (SETDMODE 'RATIONAL T)) NIL)
         (SETQ Y
                 (PROG (J FORALL-RESULT FORALL-ENDPTR)
                   (SETQ J (CDR Y))
                   (COND ((NULL J) (RETURN NIL)))
                   (SETQ FORALL-RESULT
                           (SETQ FORALL-ENDPTR
                                   (CONS
                                    ((LAMBDA (J)
                                       (PROGN
                                        (SETQ P (CAR (SUBF (CAR J) NIL)))
                                        (SETQ N
                                                (MULTD N
                                                       (SETQ M
                                                               (EXPTF
                                                                (LNC (CKRN P))
                                                                (CDR J)))))
                                        (CONS (QUOTFD P M) (CDR J))))
                                     (CAR J))
                                    NIL)))
                  LOOPLABEL
                   (SETQ J (CDR J))
                   (COND ((NULL J) (RETURN FORALL-RESULT)))
                   (RPLACD FORALL-ENDPTR
                           (CONS
                            ((LAMBDA (J)
                               (PROGN
                                (SETQ P (CAR (SUBF (CAR J) NIL)))
                                (SETQ N
                                        (MULTD N
                                               (SETQ M
                                                       (EXPTF (LNC (CKRN P))
                                                              (CDR J)))))
                                (CONS (QUOTFD P M) (CDR J))))
                             (CAR J))
                            NIL))
                   (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                   (GO LOOPLABEL)))
         (RETURN (CONS (INT-EQUIV-CHK (QUOTFD N (CDR X))) Y))))
     DMODE*)) 
(PUT 'CRNPRIMP 'NUMBER-OF-ARGS 1) 
(PUT 'CRNPRIMP 'DEFINED-ON-LINE '164) 
(PUT 'CRNPRIMP 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT 'CRNPRIMP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CRNPRIMP (U)
    (COND ((|RNONEP:| U) 'I) ((|RNONEP:| (|RNMINUS:| U)) (LIST 'MINUS 'I))
          (T (LIST 'TIMES (|RNPREP:| U) 'I)))) 
(PUT 'CRNPREP1 'NUMBER-OF-ARGS 1) 
(PUT 'CRNPREP1 'DEFINED-ON-LINE '169) 
(PUT 'CRNPREP1 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT 'CRNPREP1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CRNPREP1 (U)
    (COND ((|RNZEROP:| (CDR U)) (|RNPREP:| (CAR U)))
          ((|RNZEROP:| (CAR U)) (CRNPRIMP (CDR U)))
          (T
           ((LAMBDA (V)
              (COND
               ((|RNMINUSP:| (CDR U))
                (LIST 'DIFFERENCE V (CRNPRIMP (|RNMINUS:| (CDR U)))))
               (T (LIST 'PLUS V (CRNPRIMP (CDR U))))))
            (COND
             ((|RNMINUSP:| (CAR U))
              (LIST 'MINUS (|RNPREP:| (|RNMINUS:| (CAR U)))))
             (T (|RNPREP:| (CAR U)))))))) 
(PUT '|CRN:PRIN| 'NUMBER-OF-ARGS 1) 
(PUT '|CRN:PRIN| 'DEFINED-ON-LINE '183) 
(PUT '|CRN:PRIN| 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT '|CRN:PRIN| 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE |CRN:PRIN| (U)
    ((LAMBDA (V)
       (COND
        ((OR (ATOM V) (EQ (CAR V) 'TIMES) (MEMQ (CAR V) DOMAINLIST*))
         (MAPRIN V))
        (T (PROGN (PRIN2* "(") (MAPRIN V) (PRIN2* ")")))))
     (|CRN:PREP| U))) 
(PUT 'CRNEQUIV 'NUMBER-OF-ARGS 1) 
(PUT 'CRNEQUIV 'DEFINED-ON-LINE '188) 
(PUT 'CRNEQUIV 'DEFINED-IN-FILE 'POLY/CPXRN.RED) 
(PUT 'CRNEQUIV 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CRNEQUIV (U)
    (COND ((AND (EQUAL (CADR (SETQ U (CDR U))) 0) (EQUAL (CDAR U) 1)) (CAAR U))
          (T NIL))) 
(INITDMODE 'COMPLEX-RATIONAL) 
(ENDMODULE) 