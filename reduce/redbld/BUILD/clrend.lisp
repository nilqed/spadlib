(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'REND)) 
(CREATE-PACKAGE '(CLREND) NIL) 
(FLUID '(*ECHO *INT *MODE IFL* LISPSYSTEM* PROMPTSTRING* OUTPUTHANDLER*)) 
(GLOBAL
 '(TAB* $EOL$ FF* CR* *EXTRAECHO *LOADVERSION DATE* IPL* LARGEST-SMALL-MODULUS
   OFL* SPARE* STATCOUNTER VERSION* SYMCHAR*)) 
(SWITCH (LIST 'BREAK 'GC 'PRINTLOWER 'REDEFMSG 'DEBUG 'VERBOSELOAD)) 
(PUT 'CARCHECK 'NUMBER-OF-ARGS 1) 
(PUT 'CARCHECK 'DEFINED-ON-LINE '56) 
(PUT 'CARCHECK 'DEFINED-IN-FILE 'CLREND.RED) 
(PUT 'CARCHECK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CARCHECK (FFF) NIL) 
(REMPROP 'BYE 'STAT) 
(FLUID '(BYE-ACTIONS*)) 
(SETQ BYE-ACTIONS* '((CLOSE-OUTPUT-FILES) (QUIT))) 
(PUT 'BYE 'NUMBER-OF-ARGS 0) 
(PUT 'BYE 'DEFINED-ON-LINE '82) 
(PUT 'BYE 'DEFINED-IN-FILE 'CLREND.RED) 
(PUT 'BYE 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE BYE NIL (EVAL (CONS 'PROGN BYE-ACTIONS*))) 
(DEFLIST '((BYE ENDSTAT)) 'STAT) 
(PUT 'QUIT 'NEWNAM 'BYE) 
(PUT 'MKFIL 'NUMBER-OF-ARGS 1) 
(PUT 'MKFIL 'DEFINED-ON-LINE '92) 
(PUT 'MKFIL 'DEFINED-IN-FILE 'CLREND.RED) 
(PUT 'MKFIL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MKFIL (U)
    (COND ((STRINGP U) U) ((NOT (IDP U)) (TYPERR U "file name"))
          (T (STRING-DOWNCASE U)))) 
(SETQ CR* (INTERN (INT2ID 13))) 
(SETQ FF* (INTERN (INT2ID 12))) 
(SETQ TAB* (INTERN (INT2ID 9))) 
(PUT 'SEPRP 'NUMBER-OF-ARGS 1) 
(PUT 'SEPRP 'DEFINED-ON-LINE '111) 
(PUT 'SEPRP 'DEFINED-IN-FILE 'CLREND.RED) 
(PUT 'SEPRP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SEPRP (U) (OR (EQ U '| |) (EQ U TAB*) (EQ U $EOL$) (EQ U FF*) (EQ U CR*))) 
(PUT 'SETPCHAR 'NUMBER-OF-ARGS 1) 
(PUT 'SETPCHAR 'DEFINED-ON-LINE '117) 
(PUT 'SETPCHAR 'DEFINED-IN-FILE 'CLREND.RED) 
(PUT 'SETPCHAR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SETPCHAR (C)
    (PROG (OLDPROMPT)
      (SETQ OLDPROMPT PROMPTSTRING*)
      (SETQ PROMPTSTRING*
              (COND ((STRINGP C) C) ((IDP C) (ID2STRING C))
                    (T (ERROR 0 "Unexpected prompt in setpchar"))))
      (RETURN OLDPROMPT))) 
(PUT 'PRINTPROMPT 'NUMBER-OF-ARGS 1) 
(PUT 'PRINTPROMPT 'DEFINED-ON-LINE '135) 
(PUT 'PRINTPROMPT 'DEFINED-IN-FILE 'CLREND.RED) 
(PUT 'PRINTPROMPT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PRINTPROMPT (U)
    (PROGN
     (AND OFL* (WRS NIL))
     (PRIN2 U)
     (FORCE-OUTPUT)
     (AND OFL* (WRS (CDR OFL*))))) 
(FLAG '(SYSTEM PWD CD GETENV) 'OPFN) 
(FLAG '(SYSTEM) 'NOVAL) 
(SETQ LARGEST-SMALL-MODULUS (EXPT 2 23)) 
(REMFLAG '(BEGIN) 'GO) 
(PUT 'BEGIN 'NUMBER-OF-ARGS 0) 
(PUT 'BEGIN 'DEFINED-ON-LINE '192) 
(PUT 'BEGIN 'DEFINED-IN-FILE 'CLREND.RED) 
(PUT 'BEGIN 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE BEGIN NIL
    (PROG ()
      (SETQ *ECHO (NOT *INT))
      (SETQ *EXTRAECHO T)
      (SETQ IFL* (SETQ IPL* (SETQ OFL* NIL)))
      (COND ((NULL DATE*) (GO A)))
      (COND (*LOADVERSION (ERRORSET '(LOAD ENTRY) NIL NIL)))
      (LINELENGTH 80)
      (PRIN2 VERSION*)
      (PRIN2 ", ")
      (PRIN2 DATE*)
      (PRIN2T " ...")
      (SETQ *MODE
              (PROGN
               (SETQ ALGLIST* (CONS NIL NIL))
               (COND ((GETD 'ADDSQ) 'ALGEBRAIC) (T 'SYMBOLIC))))
      (COND ((EQ *MODE 'ALGEBRAIC) (SETQ *BREAK NIL)))
      (SETQ DATE* NIL)
     A
      (COND ((ERRORP (ERRORSET '(BEGIN1) NIL NIL)) (GO A)))
      (PRIN2T "Entering LISP ... "))) 
(FLAG '(BEGIN) 'GO) 
(SETQ SPARE* 0) 
(SETQ SYMCHAR* T) 
(PUT 'INITREDUCE 'NUMBER-OF-ARGS 0) 
(PUT 'INITREDUCE 'DEFINED-ON-LINE '221) 
(PUT 'INITREDUCE 'DEFINED-IN-FILE 'CLREND.RED) 
(PUT 'INITREDUCE 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE INITREDUCE NIL
    (PROGN
     (SETQ STATCOUNTER 0)
     (SETQ SPARE* 0)
     (SETQ *INT T)
     (SETQ CRBUFLIS* NIL)
     NIL)) 
(FLAG '(TR UNTR TRST UNTRST) 'NOFORM) 
(DEFLIST '((TR RLIS) (UNTR RLIS) (TRST RLIS) (UNTRST RLIS)) 'STAT) 
(DE PRIN (X) (PRIN1 X)) 
(PUT 'PRIN 'NUMBER-OF-ARGS 1) 
(PUT 'PRIN 'DEFINED-ON-LINE '258) 
(PUT 'PRIN 'DEFINED-IN-FILE 'CLREND.RED) 
(PUT 'PRIN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'PRIN 'INLINE '(LAMBDA (X) (PRIN1 X))) 
(REMFLAG '(PRINTC) 'LOSE) 
(DE PRINTC (X) (PROGN (PRIN2 X) (TERPRI) X)) 
(PUT 'PRINTC 'NUMBER-OF-ARGS 1) 
(PUT 'PRINTC 'DEFINED-ON-LINE '264) 
(PUT 'PRINTC 'DEFINED-IN-FILE 'CLREND.RED) 
(PUT 'PRINTC 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'PRINTC 'INLINE '(LAMBDA (X) (PROGN (PRIN2 X) (TERPRI) X))) 
(FLAG '(PRINTC) 'LOSE) 
(PUT 'TTAB 'NUMBER-OF-ARGS 1) 
(PUT 'TTAB 'DEFINED-ON-LINE '268) 
(PUT 'TTAB 'DEFINED-IN-FILE 'CLREND.RED) 
(PUT 'TTAB 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE TTAB (N)
    (PROG ()
     WHILELABEL
      (COND ((NOT (LESSP (POSN) N)) (RETURN NIL)))
      (PRIN2 " ")
      (GO WHILELABEL))) 
(DE EXPLODEC (X) (EXPLODE2 X)) 
(PUT 'EXPLODEC 'NUMBER-OF-ARGS 1) 
(PUT 'EXPLODEC 'DEFINED-ON-LINE '270) 
(PUT 'EXPLODEC 'DEFINED-IN-FILE 'CLREND.RED) 
(PUT 'EXPLODEC 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'EXPLODEC 'INLINE '(LAMBDA (X) (EXPLODE2 X))) 
(PUT 'COMP 'SIMPFG '((T (COMPILATION T)) (NIL (COMPILATION NIL)))) 
(REMFLAG '(SYSTO_GET-RESOURCE-DIRECTORY) 'LOSE) 
(PUT 'SYSTO_GET-RESOURCE-DIRECTORY 'NUMBER-OF-ARGS 0) 
(PUT 'SYSTO_GET-RESOURCE-DIRECTORY 'DEFINED-ON-LINE '292) 
(PUT 'SYSTO_GET-RESOURCE-DIRECTORY 'DEFINED-IN-FILE 'CLREND.RED) 
(PUT 'SYSTO_GET-RESOURCE-DIRECTORY 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE SYSTO_GET-RESOURCE-DIRECTORY NIL "") 
(FLAG '(SYSTO_GET-RESOURCE-DIRECTORY) 'LOSE) 
(PUT 'COMPUTE-PROMPT-STRING 'NUMBER-OF-ARGS 2) 
(PUT 'COMPUTE-PROMPT-STRING 'DEFINED-ON-LINE '301) 
(PUT 'COMPUTE-PROMPT-STRING 'DEFINED-IN-FILE 'CLREND.RED) 
(PUT 'COMPUTE-PROMPT-STRING 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE COMPUTE-PROMPT-STRING (COUNT LEVEL) "") 
(FLAG '(SUBLA) 'LOSE) 
(PUT 'RANDOM_INIT 'NUMBER-OF-ARGS 0) 
(PUT 'RANDOM_INIT 'DEFINED-ON-LINE '320) 
(PUT 'RANDOM_INIT 'DEFINED-IN-FILE 'CLREND.RED) 
(PUT 'RANDOM_INIT 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE RANDOM_INIT NIL (RANDOM_NEW_SEED (DATESTAMP))) 
(PUT 'RENAME-FILE 'NUMBER-OF-ARGS 2) 
(PUT 'RENAME-FILE 'DEFINED-ON-LINE '326) 
(PUT 'RENAME-FILE 'DEFINED-IN-FILE 'CLREND.RED) 
(PUT 'RENAME-FILE 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE RENAME-FILE (FROMNAME TONAME)
    (EQUAL (SYSTEM (BLDMSG_INTERNAL "mv %w %w" (LIST FROMNAME TONAME))) 0)) 
(FLUID '(NONTERMINALS)) 
(REMFLAG '(LALR_COLLECT_TERMINALS) 'LOSE) 
(PUT 'LALR_COLLECT_TERMINALS 'NUMBER-OF-ARGS 1) 
(PUT 'LALR_COLLECT_TERMINALS 'DEFINED-ON-LINE '362) 
(PUT 'LALR_COLLECT_TERMINALS 'DEFINED-IN-FILE 'CLREND.RED) 
(PUT 'LALR_COLLECT_TERMINALS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE LALR_COLLECT_TERMINALS (GRAMMAR)
    (PROG (RHS_SYMBOLS)
      (PROG (PRODUCTIONS)
        (SETQ PRODUCTIONS GRAMMAR)
       LAB
        (COND ((NULL PRODUCTIONS) (RETURN NIL)))
        ((LAMBDA (PRODUCTIONS)
           (PROG (PRODUCTION)
             (SETQ PRODUCTION (CDR PRODUCTIONS))
            LAB
             (COND ((NULL PRODUCTION) (RETURN NIL)))
             ((LAMBDA (PRODUCTION)
                (PROG (SYMBOL)
                  (SETQ SYMBOL (CAR PRODUCTION))
                 LAB
                  (COND ((NULL SYMBOL) (RETURN NIL)))
                  ((LAMBDA (SYMBOL)
                     (PROGN
                      (COND ((IDP SYMBOL) (SETQ SYMBOL (INTERN SYMBOL))))
                      (COND
                       ((NOT (MEMBER SYMBOL RHS_SYMBOLS))
                        (SETQ RHS_SYMBOLS (CONS SYMBOL RHS_SYMBOLS))))))
                   (CAR SYMBOL))
                  (SETQ SYMBOL (CDR SYMBOL))
                  (GO LAB)))
              (CAR PRODUCTION))
             (SETQ PRODUCTION (CDR PRODUCTION))
             (GO LAB)))
         (CAR PRODUCTIONS))
        (SETQ PRODUCTIONS (CDR PRODUCTIONS))
        (GO LAB))
      (RETURN (SETDIFF RHS_SYMBOLS NONTERMINALS)))) 
(FLAG '(LALR_COLLECT_TERMINALS) 'LOSE) 
(ENDMODULE) 