(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'COEFF2)) 
(CREATE-PACKAGE '(COEFF2) '(CONTRIB MISC)) 
(PUT 'SIMP-COEFF2 'NUMBER-OF-ARGS 1) 
(PUT 'SIMP-COEFF2 'DEFINED-ON-LINE '63) 
(PUT 'SIMP-COEFF2 'DEFINED-IN-FILE 'MISC/COEFF2.RED) 
(PUT 'SIMP-COEFF2 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SIMP-COEFF2 (U)
    (PROG (X V KLST)
      (COND
       (*FACTOR (REDERR "Use COEFF2 after turning off the FACTOR switch")))
      (COND ((NULL U) (RETURN (CONS NIL 1))))
      (SETQ V (SIMP* (CAR U)))
      (COND ((NULL (CDR U)) (RETURN V)))
      (SETQ KLST
              (PROG (Y FORALL-RESULT FORALL-ENDPTR)
                (SETQ Y (CDR U))
                (COND ((NULL Y) (RETURN NIL)))
                (SETQ FORALL-RESULT
                        (SETQ FORALL-ENDPTR
                                (CONS ((LAMBDA (Y) (*A2K Y)) (CAR Y)) NIL)))
               LOOPLABEL
                (SETQ Y (CDR Y))
                (COND ((NULL Y) (RETURN FORALL-RESULT)))
                (RPLACD FORALL-ENDPTR
                        (CONS ((LAMBDA (Y) (*A2K Y)) (CAR Y)) NIL))
                (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                (GO LOOPLABEL)))
      (SETQ X (SETKORDER KLST))
      (SETQ V
              (CONS (COEFF2-F (REORDER (CAR V)) KLST)
                    (COEFF2-F (REORDER (CDR V)) KLST)))
      (SETKORDER X)
      (RETURN (CONS (REORDER (CAR V)) (REORDER (CDR V)))))) 
(PUT 'COEFF2-F 'NUMBER-OF-ARGS 2) 
(PUT 'COEFF2-F 'DEFINED-ON-LINE '78) 
(PUT 'COEFF2-F 'DEFINED-IN-FILE 'MISC/COEFF2.RED) 
(PUT 'COEFF2-F 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE COEFF2-F (U KLST)
    (COND ((OR (ATOM U) (ATOM (CAR U))) U)
          ((NOT (MEMQ (CAAAR U) KLST))
           (PROG (X)
             (SETQ X (COEFF-MKID2))
             (PUT X 'MYVALUE U)
             (RETURN (LIST (CONS (CONS X 1) 1)))))
          (T
           (ADDF
            ((LAMBDA (G122 G123)
               (COND (*PHYSOP-LOADED (PHYSOP-MULTF G122 G123))
                     (T (POLY-MULTF G122 G123))))
             (COEFF2-F (CDAR U) KLST) (LIST (CONS (CAAR U) 1)))
            (COEFF2-F (CDR U) KLST))))) 
(PUT 'COEFF2 'SIMPFN 'SIMP-COEFF2) 
(PUT 'EVAL2 'NUMBER-OF-ARGS 1) 
(PUT 'EVAL2 'DEFINED-ON-LINE '91) 
(PUT 'EVAL2 'DEFINED-IN-FILE 'MISC/COEFF2.RED) 
(PUT 'EVAL2 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE EVAL2 (U) (MK*SQ (EVAL2-SQ (SIMP* U)))) 
(PUT 'NM 'NUMBER-OF-ARGS 1) 
(PUT 'NM 'DEFINED-ON-LINE '94) 
(PUT 'NM 'DEFINED-IN-FILE 'MISC/COEFF2.RED) 
(PUT 'NM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE NM (N) (MK*SQ (SUBF1 (REORDER (GET (COEFF-MKID0 N) 'MYVALUE)) NIL))) 
(FLAG '(NM |,| EVAL2) 'OPFN) 
(FLAG '(NM |,| EVAL2) 'NOVAL) 
(GLOBAL '(SYMCOUNT)) 
(SETQ SYMCOUNT 0) 
(PUT 'COEFF-MKID2 'NUMBER-OF-ARGS 0) 
(PUT 'COEFF-MKID2 'DEFINED-ON-LINE '102) 
(PUT 'COEFF-MKID2 'DEFINED-IN-FILE 'MISC/COEFF2.RED) 
(PUT 'COEFF-MKID2 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE COEFF-MKID2 NIL
    (PROGN
     (SETQ SYMCOUNT (PLUS SYMCOUNT 1))
     (INTERN (COMPRESS (NCONC (EXPLODE '|#|) (EXPLODE SYMCOUNT)))))) 
(PUT 'EVAL2-SQ 'NUMBER-OF-ARGS 1) 
(PUT 'EVAL2-SQ 'DEFINED-ON-LINE '106) 
(PUT 'EVAL2-SQ 'DEFINED-IN-FILE 'MISC/COEFF2.RED) 
(PUT 'EVAL2-SQ 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE EVAL2-SQ (U) (CANCEL (RESIMP (CONS (EVAL2-F (CAR U)) (EVAL2-F (CDR U)))))) 
(PUT 'EVAL2-F 'NUMBER-OF-ARGS 1) 
(PUT 'EVAL2-F 'DEFINED-ON-LINE '109) 
(PUT 'EVAL2-F 'DEFINED-IN-FILE 'MISC/COEFF2.RED) 
(PUT 'EVAL2-F 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE EVAL2-F (U)
    (COND ((OR (ATOM U) (ATOM (CAR U))) U)
          (T
           (ADDF
            ((LAMBDA (G125 G126)
               (COND (*PHYSOP-LOADED (PHYSOP-MULTF G125 G126))
                     (T (POLY-MULTF G125 G126))))
             (EVAL2-P (CAAR U)) (EVAL2-F (CDAR U)))
            (EVAL2-F (CDR U)))))) 
(PUT 'EVAL2-P 'NUMBER-OF-ARGS 1) 
(PUT 'EVAL2-P 'DEFINED-ON-LINE '114) 
(PUT 'EVAL2-P 'DEFINED-IN-FILE 'MISC/COEFF2.RED) 
(PUT 'EVAL2-P 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE EVAL2-P (U)
    (PROG (N V W)
      (SETQ N (CDR U))
      (SETQ V (CAR U))
      (COND
       ((ATOM V)
        (COND ((SETQ W (GET V 'MYVALUE)) (RETURN (EXPTF (REORDER W) N))))))
      (RETURN (LIST (CONS U 1))))) 
(PUT 'RESET 'NUMBER-OF-ARGS 0) 
(PUT 'RESET 'DEFINED-ON-LINE '124) 
(PUT 'RESET 'DEFINED-IN-FILE 'MISC/COEFF2.RED) 
(PUT 'RESET 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE RESET NIL
    (PROG ()
     WHILELABEL
      (COND ((NOT (GREATERP SYMCOUNT 0)) (RETURN NIL)))
      (PROGN
       (REMPROP (COEFF-MKID0 SYMCOUNT) 'MYVALUE)
       (SETQ SYMCOUNT (DIFFERENCE SYMCOUNT 1)))
      (GO WHILELABEL))) 
(PUT 'COEFF-MKID0 'NUMBER-OF-ARGS 1) 
(PUT 'COEFF-MKID0 'DEFINED-ON-LINE '129) 
(PUT 'COEFF-MKID0 'DEFINED-IN-FILE 'MISC/COEFF2.RED) 
(PUT 'COEFF-MKID0 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE COEFF-MKID0 (N) (INTERN (COMPRESS (NCONC (EXPLODE '|#|) (EXPLODE N))))) 
(FLAG '(RESET) 'OPFN) 
(ENDMODULE) 