(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'REDIO)) 
(FLUID '(ORIG*)) 
(GLOBAL '(*FORMFEED LNNUM* MAXLN* PGNUM*)) 
(FLUID '(TITLE*)) 
(PUT 'INITIO 'NUMBER-OF-ARGS 0) 
(PUT 'INITIO 'DEFINED-ON-LINE '41) 
(PUT 'INITIO 'DEFINED-IN-FILE 'MISC/REDIO.RED) 
(PUT 'INITIO 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE INITIO NIL
    (PROG ()
      (SETQ *FORMFEED T)
      (SETQ ORIG* 0)
      (SETQ LNNUM* 0)
      (LINELENGTH 75)
      (SETQ MAXLN* 55)
      (SETQ TITLE* NIL)
      (SETQ PGNUM* 1))) 
(INITIO) 
(PUT 'SETPGLN 'NUMBER-OF-ARGS 2) 
(PUT 'SETPGLN 'DEFINED-ON-LINE '57) 
(PUT 'SETPGLN 'DEFINED-IN-FILE 'MISC/REDIO.RED) 
(PUT 'SETPGLN 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SETPGLN (P L)
    (PROG () (COND (P (SETQ MAXLN* P))) (COND (L (LINELENGTH L))))) 
(PUT 'GETES 'NUMBER-OF-ARGS 1) 
(PUT 'GETES 'DEFINED-ON-LINE '69) 
(PUT 'GETES 'DEFINED-IN-FILE 'MISC/REDIO.RED) 
(PUT 'GETES 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE GETES (U)
    (PROG (EEE)
      (COND
       ((NOT (IDP U))
        (RETURN (PROGN (SETQ EEE (EXPLODE U)) (CONS (LENGTH EEE) EEE)))))
      (COND
       ((NOT (SETQ EEE (GET U 'RCCNAM)))
        (PROGN
         (SETQ EEE (EXPLODE U))
         (SETQ EEE (CONS (LENGTH EEE) EEE))
         (PUT U 'RCCNAM EEE))))
      (RETURN EEE))) 
(PUT 'PRTATM 'NUMBER-OF-ARGS 1) 
(PUT 'PRTATM 'DEFINED-ON-LINE '83) 
(PUT 'PRTATM 'DEFINED-IN-FILE 'MISC/REDIO.RED) 
(PUT 'PRTATM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PRTATM (U) (PRIN2 U)) 
(PUT 'PRTLST 'NUMBER-OF-ARGS 1) 
(PUT 'PRTLST 'DEFINED-ON-LINE '86) 
(PUT 'PRTLST 'DEFINED-IN-FILE 'MISC/REDIO.RED) 
(PUT 'PRTLST 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PRTLST (U)
    (COND ((ATOM U) (PRIN2 U))
          (T
           (PROG (X)
             (SETQ X U)
            LAB
             (COND ((NULL X) (RETURN NIL)))
             ((LAMBDA (X) (PRIN2 X)) (CAR X))
             (SETQ X (CDR X))
             (GO LAB))))) 
(PUT 'PRTNUM 'NUMBER-OF-ARGS 1) 
(PUT 'PRTNUM 'DEFINED-ON-LINE '89) 
(PUT 'PRTNUM 'DEFINED-IN-FILE 'MISC/REDIO.RED) 
(PUT 'PRTNUM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PRTNUM (N)
    (PROG (X)
      (SETQ X (EXPLODE2 N))
     LAB
      (COND ((NULL X) (RETURN NIL)))
      ((LAMBDA (X) (PRIN2 X)) (CAR X))
      (SETQ X (CDR X))
      (GO LAB))) 
(PUT 'PRINCN 'NUMBER-OF-ARGS 1) 
(PUT 'PRINCN 'DEFINED-ON-LINE '95) 
(PUT 'PRINCN 'DEFINED-IN-FILE 'MISC/REDIO.RED) 
(PUT 'PRINCN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PRINCN (EEE)
    (PROG ()
     WHILELABEL
      (COND ((NOT (SETQ EEE (CDR EEE))) (RETURN NIL)))
      (PRIN2 (CAR EEE))
      (GO WHILELABEL))) 
(PUT 'SPACES 'NUMBER-OF-ARGS 1) 
(PUT 'SPACES 'DEFINED-ON-LINE '99) 
(PUT 'SPACES 'DEFINED-IN-FILE 'MISC/REDIO.RED) 
(PUT 'SPACES 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SPACES (N)
    (PROG (I)
      (SETQ I 1)
     LAB
      (COND ((MINUSP (DIFFERENCE N I)) (RETURN NIL)))
      (PRIN2 BLANK)
      (SETQ I (PLUS2 I 1))
      (GO LAB))) 
(PUT 'SPACES-TO 'NUMBER-OF-ARGS 1) 
(PUT 'SPACES-TO 'DEFINED-ON-LINE '101) 
(PUT 'SPACES-TO 'DEFINED-IN-FILE 'MISC/REDIO.RED) 
(PUT 'SPACES-TO 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SPACES-TO (N)
    (PROG (X)
      (SETQ X (DIFFERENCE N (POSN)))
      (COND ((LESSP X 1) (NEWLINE N)) (T (SPACES X))))) 
(PUT 'SETPAGE 'NUMBER-OF-ARGS 2) 
(PUT 'SETPAGE 'DEFINED-ON-LINE '108) 
(PUT 'SETPAGE 'DEFINED-IN-FILE 'MISC/REDIO.RED) 
(PUT 'SETPAGE 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SETPAGE (TITLE PAGE) (PROG () (SETQ TITLE* TITLE) (SETQ PGNUM* PAGE))) 
(PUT 'NEWLINE 'NUMBER-OF-ARGS 1) 
(PUT 'NEWLINE 'DEFINED-ON-LINE '115) 
(PUT 'NEWLINE 'DEFINED-IN-FILE 'MISC/REDIO.RED) 
(PUT 'NEWLINE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE NEWLINE (N)
    (PROG ()
      (SETQ LNNUM* (PLUS LNNUM* 1))
      (COND ((GEQ LNNUM* MAXLN*) (NEWPAGE)) (T (TERPRI)))
      (SPACES (PLUS ORIG* N)))) 
(PUT 'NEWPAGE 'NUMBER-OF-ARGS 0) 
(PUT 'NEWPAGE 'DEFINED-ON-LINE '124) 
(PUT 'NEWPAGE 'DEFINED-IN-FILE 'MISC/REDIO.RED) 
(PUT 'NEWPAGE 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE NEWPAGE NIL
    (PROG (A)
      (SETQ A LNNUM*)
      (SETQ LNNUM* 0)
      (COND ((NEQ (POSN) 0) (NEWLINE 0)))
      (COND ((NEQ A 0) (FORMFEED)))
      (COND (TITLE* (PROGN (SPACES-TO 5) (PRTLST TITLE*))))
      (SPACES-TO (DIFFERENCE (LINELENGTH NIL) 4))
      (COND (PGNUM* (PROGN (PRTNUM PGNUM*) (SETQ PGNUM* (PLUS PGNUM* 1))))
            (T (SETQ PGNUM* 2)))
      (NEWLINE 10)
      (NEWLINE 0))) 
(PUT 'UNDERLINE2 'NUMBER-OF-ARGS 1) 
(PUT 'UNDERLINE2 'DEFINED-ON-LINE '141) 
(PUT 'UNDERLINE2 'DEFINED-IN-FILE 'MISC/REDIO.RED) 
(PUT 'UNDERLINE2 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE UNDERLINE2 (N)
    (COND
     ((GEQ N (LINELENGTH NIL))
      (PROGN
       (SETQ N (DIFFERENCE (LINELENGTH NIL) (POSN)))
       (PROG (I)
         (SETQ I 0)
        LAB
         (COND ((MINUSP (DIFFERENCE N I)) (RETURN NIL)))
         (PRIN2 '-)
         (SETQ I (PLUS2 I 1))
         (GO LAB))
       (NEWLINE 0)))
     (T
      (PROG (J)
        (SETQ J (DIFFERENCE N (POSN)))
        (PROG (I)
          (SETQ I 0)
         LAB
          (COND ((MINUSP (DIFFERENCE J I)) (RETURN NIL)))
          (PRIN2 '-)
          (SETQ I (PLUS2 I 1))
          (GO LAB)))))) 
(PUT 'LPRINT 'NUMBER-OF-ARGS 2) 
(PUT 'LPRINT 'DEFINED-ON-LINE '151) 
(PUT 'LPRINT 'DEFINED-IN-FILE 'MISC/REDIO.RED) 
(PUT 'LPRINT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE LPRINT (U N)
    (PROG (EEE L M)
      (SETQ L 0)
      (SETQ M 0)
      (SPACES-TO N)
      (SETQ L (DIFFERENCE (LINELENGTH NIL) (POSN)))
      (COND ((LEQ L 0) (ERROR 13 "WINDOW TOO SMALL FOR LPRINT")))
      (PROG ()
       WHILELABEL
        (COND ((NOT U) (RETURN NIL)))
        (PROGN
         (SETQ EEE (GETES (CAR U)))
         (SETQ U (CDR U))
         (COND ((LESSP (LINELENGTH NIL) (POSN)) (NEWLINE N)))
         (COND
          ((LESSP (CAR EEE) (SETQ M (DIFFERENCE (LINELENGTH NIL) (POSN))))
           (PRINCN EEE))
          ((LESSP (CAR EEE) L) (PROGN (NEWLINE N) (PRINCN EEE)))
          (T
           (PROG ()
             (SETQ EEE (CDR EEE))
            A
             (PROG (I)
               (SETQ I 1)
              LAB
               (COND ((MINUSP (DIFFERENCE M I)) (RETURN NIL)))
               (PROGN (PRIN2 (CAR EEE)) (SETQ EEE (CDR EEE)))
               (SETQ I (PLUS2 I 1))
               (GO LAB))
             (NEWLINE N)
             (COND ((NULL EEE) NIL)
                   ((LESSP (LENGTH EEE) (SETQ M L)) (PRINCN (CONS NIL EEE)))
                   (T (GO A))))))
         (COND ((LESSP (POSN) (LINELENGTH NIL)) (PRIN2 BLANK))))
        (GO WHILELABEL)))) 
(PUT 'REMPROPSS 'NUMBER-OF-ARGS 2) 
(PUT 'REMPROPSS 'DEFINED-ON-LINE '173) 
(PUT 'REMPROPSS 'DEFINED-IN-FILE 'MISC/REDIO.RED) 
(PUT 'REMPROPSS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE REMPROPSS (ATMLST LST)
    (PROG (X)
      (SETQ X ATMLST)
     LAB
      (COND ((NULL X) (RETURN NIL)))
      ((LAMBDA (X)
         (PROG (Y)
           (SETQ Y LST)
          LAB
           (COND ((NULL Y) (RETURN NIL)))
           ((LAMBDA (Y) (REMPROP X Y)) (CAR Y))
           (SETQ Y (CDR Y))
           (GO LAB)))
       (CAR X))
      (SETQ X (CDR X))
      (GO LAB))) 
(PUT 'REMFLAGSS 'NUMBER-OF-ARGS 2) 
(PUT 'REMFLAGSS 'DEFINED-ON-LINE '178) 
(PUT 'REMFLAGSS 'DEFINED-IN-FILE 'MISC/REDIO.RED) 
(PUT 'REMFLAGSS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE REMFLAGSS (ATMLST LST)
    (PROG (X)
      (SETQ X LST)
     LAB
      (COND ((NULL X) (RETURN NIL)))
      ((LAMBDA (X) (REMFLAG ATMLST X)) (CAR X))
      (SETQ X (CDR X))
      (GO LAB))) 
(PUT 'FORMFEED 'NUMBER-OF-ARGS 0) 
(PUT 'FORMFEED 'DEFINED-ON-LINE '181) 
(PUT 'FORMFEED 'DEFINED-IN-FILE 'MISC/REDIO.RED) 
(PUT 'FORMFEED 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE FORMFEED NIL
    (COND (*FORMFEED (EJECT))
          (T
           (PROGN
            (TERPRI)
            (PRIN2 " ========================================= ")
            (TERPRI))))) 
(ENDMODULE) 