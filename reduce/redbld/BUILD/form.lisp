(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'FORM)) 
(FLUID
 '(**A2SFN *COMP *CREF *DEFN *MODE *REDUCE4 *RLISP88 CURRENT-MODULUS FNAME*
   FTYPE* *STRICT_ARGCOUNT *ARGNOCHK)) 
(GLOBAL '(*COMPOSITES *FORCE *MICRO-VERSION *VARS* CURSYM*)) 
(SETQ **A2SFN 'AEVAL) 
(FLAG '(ALGEBRAIC SYMBOLIC) 'MODEFN) 
(PUT 'FORMCOND 'NUMBER-OF-ARGS 3) 
(PUT 'FORMCOND 'DEFINED-ON-LINE '43) 
(PUT 'FORMCOND 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORMCOND 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMCOND (U VARS MODE) (CONS 'COND (FORMCOND1 (CDR U) VARS MODE))) 
(PUT 'FORMCOND1 'NUMBER-OF-ARGS 3) 
(PUT 'FORMCOND1 'DEFINED-ON-LINE '46) 
(PUT 'FORMCOND1 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORMCOND1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMCOND1 (U VARS MODE)
    (COND ((NULL U) NIL)
          (T
           (CONS
            (LIST (FORMBOOL (CAAR U) VARS MODE) (FORMC (CADAR U) VARS MODE))
            (FORMCOND1 (CDR U) VARS MODE))))) 
(PUT 'COND 'FORMFN 'FORMCOND) 
(PUT 'FORMLAMB 'NUMBER-OF-ARGS 3) 
(PUT 'FORMLAMB 'DEFINED-ON-LINE '62) 
(PUT 'FORMLAMB 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORMLAMB 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMLAMB (U VARS MODE)
    (PROG (V B FL)
      (SETQ V (CADR U))
      (PROG ()
       WHILELABEL
        (COND ((NOT V) (RETURN NIL)))
        (PROGN
         (COND ((OR (NULL (CAR V)) (EQUAL (CAR V) 'T)) (RSVERR (CAR V))))
         (SETQ V (CDR V)))
        (GO WHILELABEL))
      (SETQ V (CADR U))
      (SETQ B (FORM1 (CADDR U) (PAIRVARS V VARS MODE) MODE))
      (COND ((AND (EQUAL MODE 'SYMBOLIC) *CSL) (SETQ B (PSLMACROS B))))
      (SETQ B (LIST B))
      (RETURN (CONS 'LAMBDA (CONS V B))))) 
(PUT 'LAMBDA 'FORMFN 'FORMLAMB) 
(PUT 'PSLMACROS 'NUMBER-OF-ARGS 1) 
(PUT 'PSLMACROS 'DEFINED-ON-LINE '88) 
(PUT 'PSLMACROS 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'PSLMACROS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PSLMACROS (U)
    (PROG ()
      (SETQ U (SUBLIS '((PLUS . |PSL:PLUS|) (TIMES . |PSL:TIMES|)) U))
      (SETQ U (FULLY-MACROEXPAND U))
      (RETURN (SUBLIS '((|PSL:PLUS| . PLUS) (|PSL:TIMES| . TIMES)) U)))) 
(PUTD '|PSL:PLUS| 'MACRO
      '(LAMBDA (U) (COND ((NULL (CDR U)) 0) (T (EXPAND (CDR U) 'PLUS2))))) 
(PUTD '|PSL:TIMES| 'MACRO
      '(LAMBDA (U) (COND ((NULL (CDR U)) 1) (T (EXPAND (CDR U) 'TIMES2))))) 
(PUT 'FORMPROGN 'NUMBER-OF-ARGS 3) 
(PUT 'FORMPROGN 'DEFINED-ON-LINE '110) 
(PUT 'FORMPROGN 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORMPROGN 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMPROGN (U VARS MODE) (CONS 'PROGN (FORMCLIS (CDR U) VARS MODE))) 
(PUT 'PROGN 'FORMFN 'FORMPROGN) 
(PUT 'EXPDRMACRO 'NUMBER-OF-ARGS 1) 
(PUT 'EXPDRMACRO 'DEFINED-ON-LINE '115) 
(PUT 'EXPDRMACRO 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'EXPDRMACRO 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE EXPDRMACRO (U)
    (PROG (X)
      (COND
       ((OR (NULL (SETQ X (GETRMACRO U))) (FLAGP U 'NOEXPAND)) (RETURN NIL))
       ((AND *CREF (NULL (FLAGP U 'EXPAND)) (NULL *FORCE)) (RETURN NIL))
       (T (RETURN X))))) 
(PUT 'GETRMACRO 'NUMBER-OF-ARGS 1) 
(PUT 'GETRMACRO 'DEFINED-ON-LINE '124) 
(PUT 'GETRMACRO 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'GETRMACRO 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE GETRMACRO (U)
    (PROG (X)
      (RETURN
       (COND ((NOT (IDP U)) NIL)
             ((AND (SETQ X (GETD U)) (EQUAL (CAR X) 'MACRO)) X)
             ((SETQ X (GET U 'INLINE)) (CONS 'INLINE X))
             ((SETQ X (GET U 'SMACRO)) (CONS 'SMACRO X)) (T NIL))))) 
(PUT 'APPLMACRO 'NUMBER-OF-ARGS 3) 
(PUT 'APPLMACRO 'DEFINED-ON-LINE '135) 
(PUT 'APPLMACRO 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'APPLMACRO 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE APPLMACRO (U V W) (APPLY1 U (CONS W V))) 
(PUT 'MACRO 'MACROFN 'APPLMACRO) 
(FLAG '(ED GO QUOTE) 'NOFORM) 
(PUT 'ALL-VARS-IN 'NUMBER-OF-ARGS 2) 
(PUT 'ALL-VARS-IN 'DEFINED-ON-LINE '141) 
(PUT 'ALL-VARS-IN 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'ALL-VARS-IN 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE ALL-VARS-IN (X L)
    (COND ((ATOM X) (COND ((ATSOC X L) L) (T (CONS (CONS X T) L))))
          (T (ALL-VARS-IN (CDR X) (ALL-VARS-IN (CAR X) L))))) 
(PUT 'FORMQUOTECODE 'NUMBER-OF-ARGS 3) 
(PUT 'FORMQUOTECODE 'DEFINED-ON-LINE '156) 
(PUT 'FORMQUOTECODE 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORMQUOTECODE 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMQUOTECODE (U VARS MODE)
    (MKQUOTE (FORM1 (CADR U) (ALL-VARS-IN (CADR U) NIL) MODE))) 
(PUT 'QUOTECODE 'FORMFN 'FORMQUOTECODE) 
(PUT 'SET-GLOBAL-MODE 'NUMBER-OF-ARGS 1) 
(PUT 'SET-GLOBAL-MODE 'DEFINED-ON-LINE '161) 
(PUT 'SET-GLOBAL-MODE 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'SET-GLOBAL-MODE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SET-GLOBAL-MODE (U)
    (PROG ()
      (SETQ *MODE (PROGN (SETQ ALGLIST* (CONS NIL NIL)) U))
      (RETURN (LIST 'NULL (LIST 'SETQ '*MODE (MKQUOTE U)))))) 
(PUT 'FORM1 'NUMBER-OF-ARGS 3) 
(PUT 'FORM1 'DEFINED-ON-LINE '167) 
(PUT 'FORM1 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORM1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORM1 (U VARS MODE)
    (PROG (X Y)
      (COND
       ((ATOM U)
        (RETURN
         (COND ((NOT (IDP U)) U) ((EQUAL U 'ED) (LIST U))
               ((FLAGP U 'MODEFN) (SET-GLOBAL-MODE U))
               ((SETQ X (GET MODE 'IDFN)) (APPLY2 X U VARS)) (T U))))
       ((NOT (ATOM (CAR U))) (RETURN (FORM2 U VARS MODE)))
       ((NOT (IDP (CAR U))) (TYPERR (CAR U) "operator"))
       ((EQUAL (CAR U) 'COMMENT) (RETURN (FORM1 (CAR (LASTPAIR U)) VARS MODE)))
       ((FLAGP (CAR U) 'NOFORM) (RETURN U))
       ((AND (ARRAYP (CAR U)) (EQUAL MODE 'SYMBOLIC))
        (RETURN (LIST 'GETEL (INTARGFN U VARS MODE))))
       ((AND (PAIRP (CDR U))
             (OR (EQUAL (GET (CAR U) 'RTYPE) 'VECTOR) (VECTORP (CADR U))
                 (FLAGPCAR (CADR U) 'VECFN)))
        (RETURN (GETVECT U VARS MODE)))
       ((FLAGP (CAR U) 'MODEFN)
        (RETURN (CONVERTMODE (CADR U) VARS MODE (CAR U))))
       ((SETQ X (GET (CAR U) 'FORMFN))
        (RETURN (MACROCHK (APPLY3 X U VARS MODE) MODE)))
       ((EQUAL (GET (CAR U) 'STAT) 'RLIS)
        (RETURN (MACROCHK (FORMRLIS U VARS MODE) MODE)))
       ((EQUAL (CAR U) '*COMMA*)
        (COND
         ((AND (NOT (ATOM (CADR U))) (ATOM (CADDR U)) (FLAGP (CAADR U) 'TYPE))
          (BLOCKTYPERR (CAADR U)))
         (T
          (RERROR 'RLISP 10
                  (LIST "Syntax error: , invalid after" (CADR U)))))))
      (COND ((OR (EQUAL MODE 'SYMBOLIC) (FLAGP (CAR U) 'OPFN)) (ARGNOCHK U)))
      (SETQ X (FORMLIS (CDR U) VARS MODE))
      (SETQ Y (COND ((EQUAL X (CDR U)) U) (T (CONS (CAR U) X))))
      (RETURN
       (COND
        ((OR (EQUAL MODE 'SYMBOLIC) (GET (CAR U) 'STAT)
             (AND (CDR U) (EQCAR (CADR U) 'QUOTE)
                  (NULL (AND *MICRO-VERSION (NULL *DEFN))))
             (AND (INTEXPRNP Y VARS) (NULL *COMPOSITES)
                  (EQUAL CURRENT-MODULUS 1)))
         (MACROCHK Y MODE))
        ((NOT (EQUAL MODE 'ALGEBRAIC)) (CONVERTMODE Y VARS MODE 'ALGEBRAIC))
        (T (CONS 'LIST (CONS (ALGID (CAR U) VARS) X))))))) 
(PUT 'FORM2 'NUMBER-OF-ARGS 3) 
(PUT 'FORM2 'DEFINED-ON-LINE '221) 
(PUT 'FORM2 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORM2 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORM2 (U VARS MODE)
    (PROG (X)
      (COND ((SETQ X (GET (CAAR U) 'FORM2FN)) (RETURN (APPLY3 X U VARS MODE)))
            ((AND (EQCAR (CAAR U) 'VECT) (CHECK_ALL_SYMBOLS (CDAAR U)))
             (PROGN
              (SETQ X (CDAAR U))
              (COND ((EQUAL X '(NIL)) (SETQ X NIL)))
              (RETURN
               (FORM1 (CONS (LIST 'LAMBDA X (CADAR U)) (CDR U)) VARS MODE))))
            (T (TYPERR (CAR U) "operator"))))) 
(PUT 'LAMBDA 'FORM2FN 'FORMLIS) 
(PUT 'CHECK_ALL_SYMBOLS 'NUMBER-OF-ARGS 1) 
(PUT 'CHECK_ALL_SYMBOLS 'DEFINED-ON-LINE '251) 
(PUT 'CHECK_ALL_SYMBOLS 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'CHECK_ALL_SYMBOLS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CHECK_ALL_SYMBOLS (L)
    (COND ((NULL L) T) ((NOT (IDP (CAR L))) (TYPERR 'PROGN "operator"))
          (T (CHECK_ALL_SYMBOLS (CDR L))))) 
(PUT 'FORMABSTRACT 'NUMBER-OF-ARGS 3) 
(PUT 'FORMABSTRACT 'DEFINED-ON-LINE '256) 
(PUT 'FORMABSTRACT 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORMABSTRACT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMABSTRACT (U VARS MODE)
    (PROG (BVL BODY)
      (SETQ BVL (CDAR U))
      (SETQ BODY (CADR U))
      (COND ((EQUAL BVL '(NIL)) (SETQ BVL NIL)))
      (CHECK_ALL_SYMBOLS BVL)
      (SETQ U (LIST 'LAMBDA BVL BODY))
      (RETURN (FORMLAMB U VARS MODE)))) 
(PUT 'VECT 'FORM2FN 'FORMABSTRACT) 
(PUT 'ARGNOCHK 'NUMBER-OF-ARGS 1) 
(PUT 'ARGNOCHK 'DEFINED-ON-LINE '275) 
(PUT 'ARGNOCHK 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'ARGNOCHK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ARGNOCHK (U)
    (PROG (X)
      (COND ((NULL *ARGNOCHK) (RETURN U))
            ((SETQ X (GET (CAR U) 'NUMBER-OF-ARGS))
             (PROGN
              (COND
               ((AND (NEQ X (LENGTH (CDR U)))
                     (NULL
                      (OR (GET (CAR U) 'SIMPFN) (GET (CAR U) 'PSOPFN)
                          (FLAGP (CAR U) 'VARIADIC))))
                (PROGN
                 (COND
                  (*STRICT_ARGCOUNT
                   (PROGN
                    (PRIN2 "+++++ ")
                    (PRINT U)
                    (RERROR 'RLISP 11
                            (LIST (CAR U) "called with" (LENGTH (CDR U))
                                  (COND ((EQUAL (LENGTH (CDR U)) 1) "argument")
                                        (T "arguments"))
                                  "instead of" X))))
                  (T
                   (PROGN
                    (LPRIM
                     (LIST (CAR U) "called with" (LENGTH (CDR U)) "instead of"
                           X "arguments"))
                    (RETURN U))))))
               (T (RETURN U)))))
            (T
             (PROGN
              (PUT (CAR U) 'NUMBER-OF-ARGS (LENGTH (CDR U)))
              (RETURN U)))))) 
(FLAG
 '(COND AND OR LIST LIST* PLUS TIMES LOGAND LOGOR IPLUS ITIMES ILOGAND ILOGOR
        DEFAUTOLOAD GETHASH RESTART-CSL PRESERVE CHECKPOINT FILESTATUS BLDMSG
        PLOTDRIVER FDECLARE & |\|| LPDOTIMES)
 'VARIADIC) 
(PUT 'ARGSOFOPR 'NUMBER-OF-ARGS 1) 
(PUT 'ARGSOFOPR 'DEFINED-ON-LINE '308) 
(PUT 'ARGSOFOPR 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'ARGSOFOPR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ARGSOFOPR (U) (GET U 'NUMBER-OF-ARGS)) 
(PUT 'ARGSOFOPR 'INLINE '(LAMBDA (U) (GET U 'NUMBER-OF-ARGS))) 
(FLUID '(*REVALP)) 
(SETQ *REVALP T) 
(PUT 'INTEXPRNP 'NUMBER-OF-ARGS 2) 
(PUT 'INTEXPRNP 'DEFINED-ON-LINE '316) 
(PUT 'INTEXPRNP 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'INTEXPRNP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE INTEXPRNP (U VARS)
    (COND ((NOT *REVALP) NIL)
          ((ATOM U)
           (COND ((NUMBERP U) (FIXP U))
                 ((SETQ U (ATSOC U VARS)) (EQUAL (CDR U) 'INTEGER)) (T NIL)))
          (T
           (AND (IDP (CAR U)) (FLAGP (CAR U) 'INTFN)
                (INTEXPRLISP (CDR U) VARS))))) 
(PUT 'INTEXPRLISP 'NUMBER-OF-ARGS 2) 
(PUT 'INTEXPRLISP 'DEFINED-ON-LINE '325) 
(PUT 'INTEXPRLISP 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'INTEXPRLISP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE INTEXPRLISP (U VARS)
    (OR (NULL U) (AND (INTEXPRNP (CAR U) VARS) (INTEXPRLISP (CDR U) VARS)))) 
(FLAG '(DIFFERENCE MINUS PLUS TIMES LAMBDA) 'INTFN) 
(PUT 'FORMLIS 'NUMBER-OF-ARGS 3) 
(PUT 'FORMLIS 'DEFINED-ON-LINE '332) 
(PUT 'FORMLIS 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORMLIS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMLIS (U VARS MODE)
    (PROG (X)
      (PROG ()
       WHILELABEL
        (COND ((NOT U) (RETURN NIL)))
        (PROGN (SETQ X (CONS (FORM1 (CAR U) VARS MODE) X)) (SETQ U (CDR U)))
        (GO WHILELABEL))
      (RETURN (REVERSIP* X)))) 
(PUT 'FORMCLIS 'NUMBER-OF-ARGS 3) 
(PUT 'FORMCLIS 'DEFINED-ON-LINE '342) 
(PUT 'FORMCLIS 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORMCLIS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMCLIS (U VARS MODE)
    (PROG (X)
      (PROG ()
       WHILELABEL
        (COND ((NOT U) (RETURN NIL)))
        (PROGN (SETQ X (CONS (FORMC (CAR U) VARS MODE) X)) (SETQ U (CDR U)))
        (GO WHILELABEL))
      (RETURN (REVERSIP* X)))) 
(PUT 'FORM 'NUMBER-OF-ARGS 1) 
(PUT 'FORM 'DEFINED-ON-LINE '351) 
(PUT 'FORM 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE FORM (U)
    (COND ((AND (NULL (ATOM U)) (FLAGP (CAR U) 'ALWAYS_NFORM)) (N_FORM U))
          ((NULL *RLISP88) (FORM1 U *VARS* *MODE))
          ((OR (NULL (EQUAL *MODE 'SYMBOLIC))
               (AND (FLAGP U 'MODEFN) (NULL (EQUAL U 'SYMBOLIC)))
               (AND (FLAGPCAR U 'MODEFN) (NULL (EQUAL (CAR U) 'SYMBOLIC))))
           (TYPERR "algebraic expression" "Rlisp88 form"))
          (T (FORM1 U *VARS* *MODE)))) 
(PUT 'MACROCHK 'NUMBER-OF-ARGS 2) 
(PUT 'MACROCHK 'DEFINED-ON-LINE '361) 
(PUT 'MACROCHK 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'MACROCHK 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MACROCHK (U MODE)
    (PROG (Y)
      (COND ((ATOM U) (RETURN U))
            ((AND (SETQ Y (EXPDRMACRO (CAR U)))
                  (OR (EQUAL MODE 'SYMBOLIC)
                      (AND (IDP (CAR U)) (FLAGP (CAR U) 'OPFN))))
             (RETURN (APPLY3 (GET (CAR Y) 'MACROFN) (CDR Y) (CDR U) (CAR U))))
            (T (RETURN U))))) 
(PUT 'SYMBOLIC 'IDFN 'SYMBID) 
(PUT 'SYMBID 'NUMBER-OF-ARGS 2) 
(PUT 'SYMBID 'DEFINED-ON-LINE '375) 
(PUT 'SYMBID 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'SYMBID 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SYMBID (U VARS)
    (PROGN
     (COND
      ((AND FNAME* (NULL (MEMQ FTYPE* '(MACRO SMACRO INLINE)))
            (NOT
             (OR (ATSOC U VARS) (FLUIDP U) (GLOBALP U) (NULL U) (EQ U T)
                 (FLAGP U 'SHARE) *COMP *CREF (GET U 'CONSTANT?))))
       (LPRIM
        (LIST "nonlocal use of undeclared variable" U "in procedure" FNAME*))))
     U)) 
(PUT 'ALGEBRAIC 'IDFN 'ALGID) 
(PUT 'ALGID 'NUMBER-OF-ARGS 2) 
(PUT 'ALGID 'DEFINED-ON-LINE '386) 
(PUT 'ALGID 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'ALGID 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE ALGID (U VARS)
    (COND ((OR (ATSOC U VARS) (FLAGP U 'SHARE)) U) (T (MKQUOTE U)))) 
(PUT 'INTEGER 'IDFN 'INTID) 
(PUT 'INTID 'NUMBER-OF-ARGS 2) 
(PUT 'INTID 'DEFINED-ON-LINE '391) 
(PUT 'INTID 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'INTID 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE INTID (U VARS)
    (PROG (X Y)
      (RETURN
       (COND
        ((SETQ X (ATSOC U VARS))
         (COND ((EQUAL (CDR X) 'INTEGER) U)
               ((SETQ Y (GET (CDR X) 'INTEGER)) (APPLY2 Y U VARS))
               ((EQUAL (CDR X) 'SCALAR) (**A2I U VARS))
               (T
                (RERROR 'RLISP 12
                        (LIST (CDR X) "not convertable to INTEGER")))))
        (T (**A2I (MKQUOTE U) VARS)))))) 
(PUT 'CONVERTMODE 'NUMBER-OF-ARGS 4) 
(PUT 'CONVERTMODE 'DEFINED-ON-LINE '403) 
(PUT 'CONVERTMODE 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'CONVERTMODE 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE CONVERTMODE (EXPRN VARS TARGET SOURCE)
    (CONVERTMODE1 (FORM1 EXPRN VARS SOURCE) VARS TARGET SOURCE)) 
(PUT 'CONVERTMODE1 'NUMBER-OF-ARGS 4) 
(PUT 'CONVERTMODE1 'DEFINED-ON-LINE '406) 
(PUT 'CONVERTMODE1 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'CONVERTMODE1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE CONVERTMODE1 (EXPRN VARS TARGET SOURCE)
    (PROG (X)
      (COND ((EQUAL SOURCE 'REAL) (SETQ SOURCE 'ALGEBRAIC)))
      (COND ((EQUAL TARGET 'REAL) (SETQ TARGET 'ALGEBRAIC)))
      (COND ((EQ TARGET SOURCE) (RETURN EXPRN))
            ((AND (IDP EXPRN) (SETQ X (ATSOC EXPRN VARS))
                  (NOT (MEMQ (CDR X) '(INTEGER SCALAR REAL)))
                  (NOT (EQ (CDR X) SOURCE)))
             (RETURN (CONVERTMODE EXPRN VARS TARGET (CDR X))))
            ((NOT (SETQ X (GET SOURCE TARGET))) (TYPERR SOURCE TARGET))
            (T (RETURN (APPLY2 X EXPRN VARS)))))) 
(PUT 'ALGEBRAIC 'SYMBOLIC '**A2S) 
(PUT 'SYMBOLIC 'ALGEBRAIC '**S2A) 
(PUT 'SMEMBER 'NUMBER-OF-ARGS 2) 
(PUT 'SMEMBER 'DEFINED-ON-LINE '424) 
(PUT 'SMEMBER 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'SMEMBER 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SMEMBER (U V)
    (COND ((EQUAL U V) T) ((ATOM V) NIL)
          (T (OR (SMEMBER U (CAR V)) (SMEMBER U (CDR V)))))) 
(PUT 'SMEMQL 'NUMBER-OF-ARGS 2) 
(PUT 'SMEMQL 'DEFINED-ON-LINE '430) 
(PUT 'SMEMQL 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'SMEMQL 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SMEMQL (U V)
    (COND ((NULL U) NIL) ((SMEMQ (CAR U) V) (CONS (CAR U) (SMEMQL (CDR U) V)))
          (T (SMEMQL (CDR U) V)))) 
(PUT '**A2S 'NUMBER-OF-ARGS 2) 
(PUT '**A2S 'DEFINED-ON-LINE '437) 
(PUT '**A2S 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT '**A2S 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE **A2S (U VARS)
    (COND ((NULL U) (REDERR "tell Hearn!!"))
          ((AND (FLAGPCAR U 'NOCHANGE) (NOT (EQUAL (CAR U) 'GETEL))) U)
          ((SMEMBER 'RANDOM U)
           (LIST (LIST 'LAMBDA '(*UNCACHED) (LIST **A2SFN U)) T))
          (T (LIST **A2SFN U)))) 
(PUT '**S2A 'NUMBER-OF-ARGS 2) 
(PUT '**S2A 'DEFINED-ON-LINE '464) 
(PUT '**S2A 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT '**S2A 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE **S2A (U VARS) U) 
(PUT '**S2A 'INLINE '(LAMBDA (U VARS) U)) 
(PUT 'FORMC 'NUMBER-OF-ARGS 3) 
(PUT 'FORMC 'DEFINED-ON-LINE '467) 
(PUT 'FORMC 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORMC 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMC (U VARS MODE)
    (COND
     ((AND *RLISP88 (FLAGPCAR U 'MODEFN) (NULL (EQUAL (CAR U) 'SYMBOLIC)))
      (TYPERR "algebraic expression" "Rlisp88 form"))
     ((AND (EQUAL MODE 'ALGEBRAIC) (INTEXPRNP U VARS)) U)
     (T (CONVERTMODE U VARS 'SYMBOLIC MODE)))) 
(PUT 'INTARGFN 'NUMBER-OF-ARGS 3) 
(PUT 'INTARGFN 'DEFINED-ON-LINE '474) 
(PUT 'INTARGFN 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'INTARGFN 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE INTARGFN (U VARS MODE)
    (PROG (X Y)
      (SETQ Y (CDR U))
      (PROG ()
       WHILELABEL
        (COND ((NOT Y) (RETURN NIL)))
        (PROGN
         (SETQ X (CONS (CONVERTMODE (CAR Y) VARS 'INTEGER MODE) X))
         (SETQ Y (CDR Y)))
        (GO WHILELABEL))
      (RETURN
       (CONS 'LIST (CONS (FORM1 (CAR U) VARS 'ALGEBRAIC) (REVERSIP* X)))))) 
(PUT 'ALGEBRAIC 'INTEGER '**A2I) 
(PUT '**A2I 'NUMBER-OF-ARGS 2) 
(PUT '**A2I 'DEFINED-ON-LINE '487) 
(PUT '**A2I 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT '**A2I 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE **A2I (U VARS) (COND ((INTEXPRNP U VARS) U) (T (LIST 'IEVAL U)))) 
(PUT 'IEVAL 'NUMBER-OF-ARGS 1) 
(PUT 'IEVAL 'DEFINED-ON-LINE '490) 
(PUT 'IEVAL 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'IEVAL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE IEVAL (U) (*S2I (REVAL1 U T))) 
(FLAG '(IEVAL) 'OPFN) 
(FLAG '(IEVAL) 'NOCHANGE) 
(PUT 'SYMBOLIC 'INTEGER '**S2I) 
(PUT '**S2I 'NUMBER-OF-ARGS 2) 
(PUT '**S2I 'DEFINED-ON-LINE '498) 
(PUT '**S2I 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT '**S2I 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE **S2I (U VARS) (COND ((FIXP U) U) (T (LIST '*S2I U)))) 
(PUT '*S2I 'NUMBER-OF-ARGS 1) 
(PUT '*S2I 'DEFINED-ON-LINE '501) 
(PUT '*S2I 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT '*S2I 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE *S2I (U) (COND ((FIXP U) U) (T (TYPERR U "integer")))) 
(PUT 'INTEGER 'SYMBOLIC 'IDENTITY) 
(PUT 'IDENTITY 'NUMBER-OF-ARGS 2) 
(PUT 'IDENTITY 'DEFINED-ON-LINE '506) 
(PUT 'IDENTITY 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'IDENTITY 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE IDENTITY (U VARS) U) 
(PUT 'IDENTITY 'INLINE '(LAMBDA (U VARS) U)) 
(PUT 'FORMBOOL 'NUMBER-OF-ARGS 3) 
(PUT 'FORMBOOL 'DEFINED-ON-LINE '509) 
(PUT 'FORMBOOL 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORMBOOL 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMBOOL (U VARS MODE)
    (COND ((EQUAL MODE 'SYMBOLIC) (FORMC U VARS MODE))
          ((ATOM U)
           (COND ((EQUAL U 'T) U)
                 ((OR (NOT (IDP U)) (ATSOC U VARS)) (LIST 'BOOLVALUE* U))
                 (T (LIST 'BOOLVALUE* (FORMC* U VARS MODE)))))
          ((AND (INTEXPRLISP (CDR U) VARS) (GET (CAR U) 'BOOLFN)) U)
          ((AND (IDP (CAR U)) (GET (CAR U) 'BOOLFN))
           (CONS (GET (CAR U) 'BOOLFN) (FORMCLIS (CDR U) VARS MODE)))
          ((AND (IDP (CAR U)) (FLAGP (CAR U) 'BOOLEAN))
           (CONS (CAR U)
                 (FORMBOOLLIS (CDR U) VARS MODE (FLAGP (CAR U) 'BOOLARGS))))
          ((EQUAL (CAR U) 'BOOLVALUE*) (REDERR "Too many formbools"))
          ((EQUAL (CAR U) 'WHERE)
           (LIST 'BOOLVALUE*
                 (FORMC*
                  (LIST 'WHERE
                        (MKQUOTE
                         (LIST 'BOOL-EVAL (FORMBOOL (CADR U) VARS MODE)))
                        (CADDR U))
                  VARS MODE)))
          (T (LIST 'BOOLVALUE* (FORMC* U VARS MODE))))) 
(PUT 'FORMBOOLLIS 'NUMBER-OF-ARGS 4) 
(PUT 'FORMBOOLLIS 'DEFINED-ON-LINE '529) 
(PUT 'FORMBOOLLIS 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORMBOOLLIS 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMBOOLLIS (U VARS MODE BOOL)
    (PROG (X)
      (PROG ()
       WHILELABEL
        (COND ((NOT U) (RETURN NIL)))
        (PROGN
         (COND (BOOL (SETQ X (CONS (FORMBOOL (CAR U) VARS MODE) X)))
               (T (SETQ X (CONS (FORMC* (CAR U) VARS MODE) X))))
         (SETQ U (CDR U)))
        (GO WHILELABEL))
      (RETURN (REVERSIP* X)))) 
(PUT 'BOOL-EVAL 'NUMBER-OF-ARGS 1) 
(PUT 'BOOL-EVAL 'DEFINED-ON-LINE '538) 
(PUT 'BOOL-EVAL 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'BOOL-EVAL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BOOL-EVAL (U) (LISPEVAL U)) 
(FLAG '(BOOL-EVAL) 'NOFORM) 
(FLAG '(BOOL-EVAL) 'OPFN) 
(FLAG '(BOOL-EVAL) 'NOVAL) 
(PUT 'BOOLVALUE* 'NUMBER-OF-ARGS 1) 
(PUT 'BOOLVALUE* 'DEFINED-ON-LINE '546) 
(PUT 'BOOLVALUE* 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'BOOLVALUE* 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BOOLVALUE* (U) (AND U (NULL (EQUAL U 0)))) 
(PUT 'FORMC* 'NUMBER-OF-ARGS 3) 
(PUT 'FORMC* 'DEFINED-ON-LINE '548) 
(PUT 'FORMC* 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORMC* 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMC* (U VARS MODE)
    (PROG (**A2SFN) (SETQ **A2SFN 'REVALX) (RETURN (FORMC U VARS MODE)))) 
(PUT 'REVALX 'NUMBER-OF-ARGS 1) 
(PUT 'REVALX 'DEFINED-ON-LINE '554) 
(PUT 'REVALX 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'REVALX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE REVALX (U)
    (REVAL1 (COND ((AND (NOT (ATOM U)) (NOT (ATOM (CAR U)))) (PREPF U)) (T U))
            T)) 
(PUT 'FORMRERROR 'NUMBER-OF-ARGS 3) 
(PUT 'FORMRERROR 'DEFINED-ON-LINE '562) 
(PUT 'FORMRERROR 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORMRERROR 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMRERROR (U VARS MODE)
    (PROG (X)
      (ARGNOCHK U)
      (COND ((NOT (FIXP (CADDR U))) (TYPERR (CADDR U) "RERROR argument")))
      (SETQ X (FORMC* (CADDDR U) VARS MODE))
      (COND
       ((IDP (CADR U)) (RETURN (LIST 'RERROR (MKQUOTE (CADR U)) (CADDR U) X)))
       ((AND (EQCAR (CADR U) 'QUOTE) (IDP (CADADR U)))
        (RETURN (LIST 'RERROR (CADR U) (CADDR U) X)))
       (T (TYPERR (CADR U) "RERROR argument"))))) 
(DEFLIST '((RERROR FORMRERROR)) 'FORMFN) 
(PUT 'FORMREDERR 'NUMBER-OF-ARGS 3) 
(PUT 'FORMREDERR 'DEFINED-ON-LINE '575) 
(PUT 'FORMREDERR 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORMREDERR 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMREDERR (U VARS MODE) (LIST 'REDERR (FORMC* (CADR U) VARS MODE))) 
(PUT 'REDERR 'FORMFN 'FORMREDERR) 
(PUT 'FORMRETURN 'NUMBER-OF-ARGS 3) 
(PUT 'FORMRETURN 'DEFINED-ON-LINE '580) 
(PUT 'FORMRETURN 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORMRETURN 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMRETURN (U VARS MODE) (LIST 'RETURN (FORMC (CADR U) VARS MODE))) 
(PUT 'RETURN 'FORMFN 'FORMRETURN) 
(PUT 'RSVERR 'NUMBER-OF-ARGS 1) 
(PUT 'RSVERR 'DEFINED-ON-LINE '592) 
(PUT 'RSVERR 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'RSVERR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE RSVERR (X) (RERROR 'RLISP 13 (LIST X "is a reserved identifier"))) 
(PUT 'MKSETSHARE 'NUMBER-OF-ARGS 2) 
(PUT 'MKSETSHARE 'DEFINED-ON-LINE '595) 
(PUT 'MKSETSHARE 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'MKSETSHARE 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MKSETSHARE (U V) (MKSETQ U (LIST 'PROGN '(SETQ ALGLIST* (CONS NIL NIL)) V))) 
(PUT 'FORMSETQ 'NUMBER-OF-ARGS 3) 
(PUT 'FORMSETQ 'DEFINED-ON-LINE '598) 
(PUT 'FORMSETQ 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORMSETQ 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMSETQ (U VARS MODE)
    (COND ((NEQ MODE 'SYMBOLIC) (FORMSETQ0 U VARS MODE))
          ((EQCAR (CADR U) 'LIST) (FORMSETQ1 U VARS MODE))
          ((EQCAR (CADR U) 'CONS) (FORMSETQ2 U VARS MODE))
          (T (FORMSETQ0 U VARS MODE)))) 
(PUT 'FORMSETQ0 'NUMBER-OF-ARGS 3) 
(PUT 'FORMSETQ0 'DEFINED-ON-LINE '611) 
(PUT 'FORMSETQ0 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORMSETQ0 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMSETQ0 (U VARS MODE)
    (PROG (X Y Z)
      (COND ((IDP (SETQ Z (CAR (SETQ U (CDR U))))) (SETQ Y (ATSOC Z VARS))))
      (COND ((EQCAR (CADR U) 'QUOTE) (SETQ MODE 'SYMBOLIC)))
      (SETQ X (CONVERTMODE (CADR U) VARS 'SYMBOLIC MODE))
      (RETURN
       (COND
        ((AND (NOT (ATOM Z))
              (PROGN
               (COND
                ((AND *SAVEDEF
                      (OR (GET (CAR Z) 'INLINE) (GET (CAR Z) 'SMACRO)))
                 (PROGN
                  (COND ((NOT (ZEROP (POSN))) (TERPRI)))
                  (PRINC "+++ Assign via inline or smacro: ")
                  (PRINT Z))))
               T))
         (COND ((NOT (IDP (CAR Z))) (TYPERR Z "assignment"))
               ((AND (NULL (ATOM (SETQ Z (MACROCHK Z MODE)))) (ARRAYP (CAR Z)))
                (LIST 'SETEL (INTARGFN Z VARS MODE) X))
               ((AND (NULL (ATOM Z)) (CDR Z)
                     (OR (EQUAL (GET (CAR Z) 'RTYPE) 'VECTOR)
                         (VECTORP (CADR Z)) (FLAGPCAR (CADR Z) 'VECFN)))
                (PUTVECT U VARS MODE))
               ((EQCAR Z 'PART)
                (ACONC
                 (CONS 'LIST
                       (CONS (MKQUOTE 'SETPART*) (FORMLIS (CDR Z) VARS MODE)))
                 X))
               ((AND (NULL (ATOM Z)) (SETQ Y (GET (CAR Z) 'SETQFN)))
                (FORM1 (APPLSMACRO Y (APPEND (CDR Z) (CDR U)) NIL) VARS MODE))
               ((AND (EQUAL MODE 'SYMBOLIC)
                     (OR *RLISP88 (EQCAR Z 'STRUCTFETCH)))
                (LIST 'RSETF (FORM1 Z VARS MODE) X))
               (T (LIST 'SETK (FORM1 Z VARS 'ALGEBRAIC) X))))
        ((NOT (IDP Z)) (TYPERR Z "assignment"))
        ((AND (FLAGP Z 'RESERVED) (NULL (ATSOC Z VARS))) (RSVERR Z))
        ((FLAGP Z 'SHARE) (MKSETSHARE (SYMBID Z VARS) X))
        ((OR (EQUAL MODE 'SYMBOLIC) Y (EQCAR X 'QUOTE))
         (MKSETQ (SYMBID Z VARS) X))
        ((OR (VECTORP (CADR U)) (FLAGPCAR (CADR U) 'VECFN))
         (LIST 'SETV (MKQUOTE Z) (CADR U)))
        (T (LIST 'SETK (MKQUOTE Z) X)))))) 
(PUT 'FORMSETQ1 'NUMBER-OF-ARGS 3) 
(PUT 'FORMSETQ1 'DEFINED-ON-LINE '660) 
(PUT 'FORMSETQ1 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORMSETQ1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMSETQ1 (U VARS MODE)
    (PROG (GENS RESU LI COLL)
      (SETQ GENS (GENSYM))
      (SETQ RESU (GENSYM))
      (SETQ VARS (CONS (CONS GENS 'SCALAR) VARS))
      (SETQ LI (CDR (CADR U)))
      (PROG ()
       WHILELABEL
        (COND ((NOT LI) (RETURN NIL)))
        (PROGN
         (SETQ COLL
                 (CONS
                  (FORMSETQ0 (LIST 'SETQ (CAR LI) (LIST 'CAR GENS)) VARS MODE)
                  COLL))
         (SETQ COLL (CONS (LIST 'SETQ GENS (LIST 'CDR GENS)) COLL))
         (SETQ LI (CDR LI)))
        (GO WHILELABEL))
      (SETQ COLL (CONS (LIST 'RETURN RESU) COLL))
      (RETURN
       (CONS 'PROG
             (CONS (LIST GENS RESU)
                   (CONS (FORMSETQ0 (LIST 'SETQ GENS (CADDR U)) VARS MODE)
                         (CONS (LIST 'SETQ RESU GENS) (REVERSIP COLL)))))))) 
(PUT 'FORMSETQ2 'NUMBER-OF-ARGS 3) 
(PUT 'FORMSETQ2 'DEFINED-ON-LINE '678) 
(PUT 'FORMSETQ2 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORMSETQ2 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMSETQ2 (U VARS MODE)
    (PROG (GENS LI COLL)
      (SETQ GENS (GENSYM))
      (SETQ VARS (CONS (CONS GENS 'SCALAR) VARS))
      (SETQ LI (CDR (CADR U)))
      (SETQ COLL
              (CONS
               (FORMSETQ0 (LIST 'SETQ (CAR LI) (LIST 'CAR GENS)) VARS MODE)
               COLL))
      (SETQ COLL
              (CONS
               (FORMSETQ0 (LIST 'SETQ (CADR LI) (LIST 'CDR GENS)) VARS MODE)
               COLL))
      (SETQ COLL (CONS (LIST 'RETURN GENS) COLL))
      (RETURN
       (CONS 'PROG
             (CONS (LIST GENS)
                   (CONS (FORMSETQ0 (LIST 'SETQ GENS (CADDR U)) VARS MODE)
                         (REVERSIP COLL))))))) 
(PUT 'SETQ 'FORMFN 'FORMSETQ) 
(PUT 'SETCAR 'NUMBER-OF-ARGS 2) 
(PUT 'SETCAR 'DEFINED-ON-LINE '697) 
(PUT 'SETCAR 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'SETCAR 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SETCAR (A B) (PROGN (RPLACA A B) B)) 
(PUT 'SETCDR 'NUMBER-OF-ARGS 2) 
(PUT 'SETCDR 'DEFINED-ON-LINE '699) 
(PUT 'SETCDR 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'SETCDR 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SETCDR (A B) (PROGN (RPLACD A B) B)) 
(PUT 'CAR 'SETQFN '(LAMBDA (U V) (SETCAR U V))) 
(PUT 'CDR 'SETQFN '(LAMBDA (U V) (SETCDR U V))) 
(PUT 'CAAR 'SETQFN '(LAMBDA (U V) (SETCAR (CAR U) V))) 
(PUT 'CADR 'SETQFN '(LAMBDA (U V) (SETCAR (CDR U) V))) 
(PUT 'CDAR 'SETQFN '(LAMBDA (U V) (SETCDR (CAR U) V))) 
(PUT 'CDDR 'SETQFN '(LAMBDA (U V) (SETCDR (CDR U) V))) 
(PUT 'CAAAR 'SETQFN '(LAMBDA (U V) (SETCAR (CAAR U) V))) 
(PUT 'CAADR 'SETQFN '(LAMBDA (U V) (SETCAR (CADR U) V))) 
(PUT 'CADAR 'SETQFN '(LAMBDA (U V) (SETCAR (CDAR U) V))) 
(PUT 'CADDR 'SETQFN '(LAMBDA (U V) (SETCAR (CDDR U) V))) 
(PUT 'CDAAR 'SETQFN '(LAMBDA (U V) (SETCDR (CAAR U) V))) 
(PUT 'CDADR 'SETQFN '(LAMBDA (U V) (SETCDR (CADR U) V))) 
(PUT 'CDDAR 'SETQFN '(LAMBDA (U V) (SETCDR (CDAR U) V))) 
(PUT 'CDDDR 'SETQFN '(LAMBDA (U V) (SETCDR (CDDR U) V))) 
(PUT 'CAAAAR 'SETQFN '(LAMBDA (U V) (SETCAR (CAAAR U) V))) 
(PUT 'CAAADR 'SETQFN '(LAMBDA (U V) (SETCAR (CAADR U) V))) 
(PUT 'CAADAR 'SETQFN '(LAMBDA (U V) (SETCAR (CADAR U) V))) 
(PUT 'CAADDR 'SETQFN '(LAMBDA (U V) (SETCAR (CADDR U) V))) 
(PUT 'CADAAR 'SETQFN '(LAMBDA (U V) (SETCAR (CDAAR U) V))) 
(PUT 'CADADR 'SETQFN '(LAMBDA (U V) (SETCAR (CDADR U) V))) 
(PUT 'CADDAR 'SETQFN '(LAMBDA (U V) (SETCAR (CDDAR U) V))) 
(PUT 'CADDDR 'SETQFN '(LAMBDA (U V) (SETCAR (CDDDR U) V))) 
(PUT 'CDAAAR 'SETQFN '(LAMBDA (U V) (SETCDR (CAAAR U) V))) 
(PUT 'CDAADR 'SETQFN '(LAMBDA (U V) (SETCDR (CAADR U) V))) 
(PUT 'CDADAR 'SETQFN '(LAMBDA (U V) (SETCDR (CADAR U) V))) 
(PUT 'CDADDR 'SETQFN '(LAMBDA (U V) (SETCDR (CADDR U) V))) 
(PUT 'CDDAAR 'SETQFN '(LAMBDA (U V) (SETCDR (CDAAR U) V))) 
(PUT 'CDDADR 'SETQFN '(LAMBDA (U V) (SETCDR (CDADR U) V))) 
(PUT 'CDDDAR 'SETQFN '(LAMBDA (U V) (SETCDR (CDDAR U) V))) 
(PUT 'CDDDDR 'SETQFN '(LAMBDA (U V) (SETCDR (CDDDR U) V))) 
(PUT 'NTH 'SETQFN '(LAMBDA (L I X) (SETCAR (PNTH L I) X))) 
(PUT 'SET_NTH 'NUMBER-OF-ARGS 3) 
(PUT 'SET_NTH 'DEFINED-ON-LINE '763) 
(PUT 'SET_NTH 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'SET_NTH 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE SET_NTH (L I X) (SETCAR (PNTH L I) X)) 
(PUT 'GETV 'SETQFN '(LAMBDA (V I X) (PUTV V I X))) 
(PUT 'IGETV 'SETQFN '(LAMBDA (V I X) (IPUTV V I X))) 
(PUT 'FORMFUNC 'NUMBER-OF-ARGS 3) 
(PUT 'FORMFUNC 'DEFINED-ON-LINE '769) 
(PUT 'FORMFUNC 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORMFUNC 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMFUNC (U VARS MODE)
    (COND
     ((IDP (CADR U))
      (COND
       ((EQCAR (GETD (CADR U)) 'MACRO)
        (RERROR 'RLISP 14 (LIST "Macro" (CADR U) "Used as Function")))
       (T (LIST 'FUNCTION (CADR U)))))
     (T (LIST 'FUNCTION (FORM1 (CADR U) VARS MODE))))) 
(PUT 'FUNCTION 'FORMFN 'FORMFUNC) 
(PUT 'RLIS 'NUMBER-OF-ARGS 0) 
(PUT 'RLIS 'DEFINED-ON-LINE '788) 
(PUT 'RLIS 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'RLIS 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE RLIS NIL
    (PROG (X)
      (SETQ X CURSYM*)
      (RETURN
       (COND ((FLAGP (SCAN) 'DELIM) (LIST X NIL))
             (*REDUCE4 (LIST X (CONS 'LIST (REMCOMMA (XREAD1 'LAMBDA)))))
             (T (CONS X (REMCOMMA (XREAD1 'LAMBDA)))))))) 
(PUT 'FLAGOP 'NUMBER-OF-ARGS 1) 
(PUT 'FLAGOP 'DEFINED-ON-LINE '797) 
(PUT 'FLAGOP 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FLAGOP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE FLAGOP (U) (PROG () (FLAG U 'FLAGOP) (RLISTAT U))) 
(PUT 'RLISTAT 'NUMBER-OF-ARGS 1) 
(PUT 'RLISTAT 'DEFINED-ON-LINE '799) 
(PUT 'RLISTAT 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'RLISTAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE RLISTAT (U)
    (PROG ()
     WHILELABEL
      (COND ((NOT U) (RETURN NIL)))
      (PROGN (PUT (CAR U) 'STAT 'RLIS) (SETQ U (CDR U)))
      (GO WHILELABEL))) 
(RLISTAT '(FLAGOP)) 
(PUT 'FORMRLIS 'NUMBER-OF-ARGS 3) 
(PUT 'FORMRLIS 'DEFINED-ON-LINE '806) 
(PUT 'FORMRLIS 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'FORMRLIS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMRLIS (U VARS MODE)
    (COND
     ((NOT (FLAGP (CAR U) 'FLAGOP))
      (LIST (CAR U)
            (CONS 'LIST
                  (COND
                   ((EQUAL (CAR U) 'SHARE)
                    (PROG (X Y)
                      (SETQ Y (CDR U))
                      (PROG ()
                       WHILELABEL
                        (COND ((NOT Y) (RETURN NIL)))
                        (PROGN
                         (SETQ X (CONS (MKQUOTE (CAR Y)) X))
                         (SETQ Y (CDR Y)))
                        (GO WHILELABEL))
                      (RETURN (REVERSIP* X))))
                   (T (FORMLIS (CDR U) VARS 'ALGEBRAIC))))))
     ((NOT (IDLISTP (CDR U)))
      (TYPERR (CONS '*COMMA* (CDR U)) "identifier list"))
     (T
      (LIST 'FLAG (CONS 'LIST (FORMLIS (CDR U) VARS 'ALGEBRAIC))
            (MKQUOTE (CAR U)))))) 
(PUT 'MKARG 'NUMBER-OF-ARGS 2) 
(PUT 'MKARG 'DEFINED-ON-LINE '823) 
(PUT 'MKARG 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'MKARG 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MKARG (U VARS)
    (COND ((OR (NULL U) (CONSTANTP U)) U)
          ((ATOM U) (COND ((ATSOC U VARS) U) (T (MKQUOTE U))))
          ((MEMQ (CAR U) '(QUOTE |:DN:| |:INT:|)) (MKQUOTE U))
          ((MEMQ (CAR U) '(|:DN-S:| |:DN-F:| |:DN-L:|))
           (CONS (MKQUOTE '|:DN:|) (CDR U)))
          (T
           (PROG (X)
             (PROG ()
              WHILELABEL
               (COND ((NOT U) (RETURN NIL)))
               (PROGN (SETQ X (CONS (MKARG (CAR U) VARS) X)) (SETQ U (CDR U)))
               (GO WHILELABEL))
             (RETURN (CONS 'LIST (REVERSIP* X))))))) 
(PUT '|:RN:| 'FORMFN 'RNFORM) 
(PUT 'RNFORM 'NUMBER-OF-ARGS 3) 
(PUT 'RNFORM 'DEFINED-ON-LINE '841) 
(PUT 'RNFORM 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'RNFORM 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE RNFORM (U VARS MODE)
    (COND ((EQUAL MODE 'SYMBOLIC) (QUOTIENT (FLOAT (CADR U)) (FLOAT (CDDR U))))
          (T (MKQUOTE (LIST 'QUOTIENT (CADR U) (CDDR U)))))) 
(PUT '|:DN:| 'FORMFN 'DNFORM) 
(PUT '|:DN-S:| 'FORMFN 'DNFORM-S) 
(PUT '|:DN-F:| 'FORMFN 'DNFORM-F) 
(PUT '|:DN-L:| 'FORMFN 'DNFORM-L) 
(PUT 'DNFORM1 'NUMBER-OF-ARGS 4) 
(PUT 'DNFORM1 'DEFINED-ON-LINE '850) 
(PUT 'DNFORM1 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'DNFORM1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE DNFORM1 (U VARS MODE XMARK)
    (COND
     ((EQUAL MODE 'SYMBOLIC)
      (COMPRESS
       (NCONC* (EXPLODE (CADR U))
               (CONS '|.| (CONS XMARK (EXPLODE (CDDR U)))))))
     (T
      (PROGN
       (COND (*ADJPREC (PRECMSG (LENGTH (EXPLODE (ABS (CADR U)))))))
       (MKQUOTE
        (COND ((GEQ (CDDR U) 0) (DECIMAL2INTERNAL (CADR U) (CDDR U)))
              (T (CONS '|:DN:| (CDR U))))))))) 
(PUT 'DNFORM 'NUMBER-OF-ARGS 3) 
(PUT 'DNFORM 'DEFINED-ON-LINE '857) 
(PUT 'DNFORM 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'DNFORM 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DNFORM (U VARS MODE) (DNFORM1 U VARS MODE 'E)) 
(PUT 'DNFORM-S 'NUMBER-OF-ARGS 3) 
(PUT 'DNFORM-S 'DEFINED-ON-LINE '860) 
(PUT 'DNFORM-S 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'DNFORM-S 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DNFORM-S (U VARS MODE) (DNFORM1 U VARS MODE 'S)) 
(PUT 'DNFORM-F 'NUMBER-OF-ARGS 3) 
(PUT 'DNFORM-F 'DEFINED-ON-LINE '863) 
(PUT 'DNFORM-F 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'DNFORM-F 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DNFORM-F (U VARS MODE) (DNFORM1 U VARS MODE 'F)) 
(PUT 'DNFORM-L 'NUMBER-OF-ARGS 3) 
(PUT 'DNFORM-L 'DEFINED-ON-LINE '866) 
(PUT 'DNFORM-L 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'DNFORM-L 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DNFORM-L (U VARS MODE) (DNFORM1 U VARS MODE 'L)) 
(PUT '|:INT:| 'FORMFN 'INTFORM) 
(PUT 'INTFORM 'NUMBER-OF-ARGS 3) 
(PUT 'INTFORM 'DEFINED-ON-LINE '871) 
(PUT 'INTFORM 'DEFINED-IN-FILE 'RLISP/FORM.RED) 
(PUT 'INTFORM 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE INTFORM (U VARS MODE)
    (COND ((EQUAL MODE 'SYMBOLIC) (MKQUOTE (CADR U)))
          (T
           (PROGN
            (PRECMSG (LENGTH (EXPLODE (ABS (CADR U)))))
            (MKQUOTE (CADR U)))))) 
(ENDMODULE) 