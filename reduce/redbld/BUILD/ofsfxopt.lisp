(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'OFSFXOPT)) 
(REVISION 'OFSFXOPT
          "$Id: ofsfxopt.red 5986 2021-08-28 13:35:27Z thomas-sturm $") 
(COPYRIGHT 'OFSFXOPT "(c) 1998-2009 A. Dolzmann, 2016-2017 T. Sturm") 
(DE OFSF_XOPT-ANSL-MK (L) L) 
(PUT 'OFSF_XOPT-ANSL-MK 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-ANSL-MK 'DEFINED-ON-LINE '58) 
(PUT 'OFSF_XOPT-ANSL-MK 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-ANSL-MK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-ANSL-MK 'INLINE '(LAMBDA (L) L)) 
(DE OFSF_XOPT-ANSL-ANSL (ANSL) ANSL) 
(PUT 'OFSF_XOPT-ANSL-ANSL 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-ANSL-ANSL 'DEFINED-ON-LINE '62) 
(PUT 'OFSF_XOPT-ANSL-ANSL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-ANSL-ANSL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-ANSL-ANSL 'INLINE '(LAMBDA (ANSL) ANSL)) 
(DE OFSF_XOPT-ANS-MK (GD PT) (CONS GD PT)) 
(PUT 'OFSF_XOPT-ANS-MK 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_XOPT-ANS-MK 'DEFINED-ON-LINE '67) 
(PUT 'OFSF_XOPT-ANS-MK 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-ANS-MK 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(PUTC 'OFSF_XOPT-ANS-MK 'INLINE '(LAMBDA (GD PT) (CONS GD PT))) 
(DE OFSF_XOPT-ANS-GD (ANS) (CAR ANS)) 
(PUT 'OFSF_XOPT-ANS-GD 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-ANS-GD 'DEFINED-ON-LINE '71) 
(PUT 'OFSF_XOPT-ANS-GD 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-ANS-GD 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-ANS-GD 'INLINE '(LAMBDA (ANS) (CAR ANS))) 
(DE OFSF_XOPT-ANS-PT (ANS) (CDR ANS)) 
(PUT 'OFSF_XOPT-ANS-PT 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-ANS-PT 'DEFINED-ON-LINE '75) 
(PUT 'OFSF_XOPT-ANS-PT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-ANS-PT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-ANS-PT 'INLINE '(LAMBDA (ANS) (CDR ANS))) 
(DE OFSF_XOPT-PT-CTL (PT) PT) 
(PUT 'OFSF_XOPT-PT-CTL 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-PT-CTL 'DEFINED-ON-LINE '79) 
(PUT 'OFSF_XOPT-PT-CTL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-PT-CTL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-PT-CTL 'INLINE '(LAMBDA (PT) PT)) 
(DE OFSF_XOPT-PT-MK (CTL) CTL) 
(PUT 'OFSF_XOPT-PT-MK 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-PT-MK 'DEFINED-ON-LINE '83) 
(PUT 'OFSF_XOPT-PT-MK 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-PT-MK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-PT-MK 'INLINE '(LAMBDA (CTL) CTL)) 
(DE OFSF_XOPT-CT-MK (V VL) (CONS V VL)) 
(PUT 'OFSF_XOPT-CT-MK 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_XOPT-CT-MK 'DEFINED-ON-LINE '87) 
(PUT 'OFSF_XOPT-CT-MK 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CT-MK 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(PUTC 'OFSF_XOPT-CT-MK 'INLINE '(LAMBDA (V VL) (CONS V VL))) 
(DE OFSF_XOPT-CT-VAR (CT) (CAR CT)) 
(PUT 'OFSF_XOPT-CT-VAR 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-CT-VAR 'DEFINED-ON-LINE '91) 
(PUT 'OFSF_XOPT-CT-VAR 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CT-VAR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-CT-VAR 'INLINE '(LAMBDA (CT) (CAR CT))) 
(DE OFSF_XOPT-CT-VALUE (CT) (CDR CT)) 
(PUT 'OFSF_XOPT-CT-VALUE 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-CT-VALUE 'DEFINED-ON-LINE '95) 
(PUT 'OFSF_XOPT-CT-VALUE 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CT-VALUE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-CT-VALUE 'INLINE '(LAMBDA (CT) (CDR CT))) 
(DE OFSF_XOPT-CO-MK (CEL) CEL) 
(PUT 'OFSF_XOPT-CO-MK 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-CO-MK 'DEFINED-ON-LINE '106) 
(PUT 'OFSF_XOPT-CO-MK 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CO-MK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-CO-MK 'INLINE '(LAMBDA (CEL) CEL)) 
(DE OFSF_XOPT-CO-CEL (CO) CO) 
(PUT 'OFSF_XOPT-CO-CEL 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-CO-CEL 'DEFINED-ON-LINE '110) 
(PUT 'OFSF_XOPT-CO-CEL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CO-CEL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-CO-CEL 'INLINE '(LAMBDA (CO) CO)) 
(DE OFSF_XOPT-CE-MK (VL F PT PL) (LIST VL F PT PL)) 
(PUT 'OFSF_XOPT-CE-MK 'NUMBER-OF-ARGS 4) 
(PUT 'OFSF_XOPT-CE-MK 'DEFINED-ON-LINE '115) 
(PUT 'OFSF_XOPT-CE-MK 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CE-MK 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(PUTC 'OFSF_XOPT-CE-MK 'INLINE '(LAMBDA (VL F PT PL) (LIST VL F PT PL))) 
(DE OFSF_XOPT-CE-VL (CE) (CAR CE)) 
(PUT 'OFSF_XOPT-CE-VL 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-CE-VL 'DEFINED-ON-LINE '120) 
(PUT 'OFSF_XOPT-CE-VL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CE-VL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-CE-VL 'INLINE '(LAMBDA (CE) (CAR CE))) 
(DE OFSF_XOPT-CE-F (CE) (CADR CE)) 
(PUT 'OFSF_XOPT-CE-F 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-CE-F 'DEFINED-ON-LINE '125) 
(PUT 'OFSF_XOPT-CE-F 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CE-F 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-CE-F 'INLINE '(LAMBDA (CE) (CADR CE))) 
(DE OFSF_XOPT-CE-PT (CE) (CADDR CE)) 
(PUT 'OFSF_XOPT-CE-PT 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-CE-PT 'DEFINED-ON-LINE '129) 
(PUT 'OFSF_XOPT-CE-PT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CE-PT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-CE-PT 'INLINE '(LAMBDA (CE) (CADDR CE))) 
(DE OFSF_XOPT-CE-PL (CE) (CADDDR CE)) 
(PUT 'OFSF_XOPT-CE-PL 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-CE-PL 'DEFINED-ON-LINE '133) 
(PUT 'OFSF_XOPT-CE-PL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CE-PL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-CE-PL 'INLINE '(LAMBDA (CE) (CADDDR CE))) 
(DE OFSF_XOPT-CO-PUT (CO CE) (CONS CE CO)) 
(PUT 'OFSF_XOPT-CO-PUT 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_XOPT-CO-PUT 'DEFINED-ON-LINE '137) 
(PUT 'OFSF_XOPT-CO-PUT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CO-PUT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(PUTC 'OFSF_XOPT-CO-PUT 'INLINE '(LAMBDA (CO CE) (CONS CE CO))) 
(PUT 'OFSF_XOPT-CO-PUTL 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_XOPT-CO-PUTL 'DEFINED-ON-LINE '141) 
(PUT 'OFSF_XOPT-CO-PUTL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CO-PUTL 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-CO-PUTL (CO CEL)
    (PROG (CE FORALL-RESULT FORALL-ENDPTR)
      (SETQ CE CEL)
      (COND ((NULL CE) (RETURN NIL)))
      (SETQ FORALL-RESULT
              (SETQ FORALL-ENDPTR
                      (CONS ((LAMBDA (CE) (CONS CE CO)) (CAR CE)) NIL)))
     LOOPLABEL
      (SETQ CE (CDR CE))
      (COND ((NULL CE) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR (CONS ((LAMBDA (CE) (CONS CE CO)) (CAR CE)) NIL))
      (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
      (GO LOOPLABEL))) 
(DE OFSF_XOPT-CO-GET (CO) CO) 
(PUT 'OFSF_XOPT-CO-GET 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-CO-GET 'DEFINED-ON-LINE '146) 
(PUT 'OFSF_XOPT-CO-GET 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CO-GET 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-CO-GET 'INLINE '(LAMBDA (CO) CO)) 
(DE OFSF_XOPT-CO-LENGTH (CO) (LENGTH CO)) 
(PUT 'OFSF_XOPT-CO-LENGTH 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-CO-LENGTH 'DEFINED-ON-LINE '150) 
(PUT 'OFSF_XOPT-CO-LENGTH 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CO-LENGTH 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-CO-LENGTH 'INLINE '(LAMBDA (CO) (LENGTH CO))) 
(DE OFSF_XOPT-CS-MK (UBL LBL EQL) (LIST UBL LBL EQL)) 
(PUT 'OFSF_XOPT-CS-MK 'NUMBER-OF-ARGS 3) 
(PUT 'OFSF_XOPT-CS-MK 'DEFINED-ON-LINE '161) 
(PUT 'OFSF_XOPT-CS-MK 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CS-MK 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(PUTC 'OFSF_XOPT-CS-MK 'INLINE '(LAMBDA (UBL LBL EQL) (LIST UBL LBL EQL))) 
(DE OFSF_XOPT-CS-UBL (CS) (CAR CS)) 
(PUT 'OFSF_XOPT-CS-UBL 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-CS-UBL 'DEFINED-ON-LINE '166) 
(PUT 'OFSF_XOPT-CS-UBL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CS-UBL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-CS-UBL 'INLINE '(LAMBDA (CS) (CAR CS))) 
(DE OFSF_XOPT-CS-LBL (CS) (CADR CS)) 
(PUT 'OFSF_XOPT-CS-LBL 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-CS-LBL 'DEFINED-ON-LINE '170) 
(PUT 'OFSF_XOPT-CS-LBL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CS-LBL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-CS-LBL 'INLINE '(LAMBDA (CS) (CADR CS))) 
(DE OFSF_XOPT-CS-EQL (CS) (CADDR CS)) 
(PUT 'OFSF_XOPT-CS-EQL 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-CS-EQL 'DEFINED-ON-LINE '174) 
(PUT 'OFSF_XOPT-CS-EQL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CS-EQL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-CS-EQL 'INLINE '(LAMBDA (CS) (CADDR CS))) 
(DE OFSF_XOPT-CP-MK (P) P) 
(PUT 'OFSF_XOPT-CP-MK 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-CP-MK 'DEFINED-ON-LINE '178) 
(PUT 'OFSF_XOPT-CP-MK 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CP-MK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-CP-MK 'INLINE '(LAMBDA (P) P)) 
(DE OFSF_XOPT-CP-P (CP) CP) 
(PUT 'OFSF_XOPT-CP-P 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-CP-P 'DEFINED-ON-LINE '182) 
(PUT 'OFSF_XOPT-CP-P 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CP-P 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-CP-P 'INLINE '(LAMBDA (CP) CP)) 
(PUT 'OFSF_XOPT-CS-NULL 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-CS-NULL 'DEFINED-ON-LINE '186) 
(PUT 'OFSF_XOPT-CS-NULL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CS-NULL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_XOPT-CS-NULL (CS)
    (AND (NULL (CAR CS)) (NULL (CADR CS)) (NULL (CADDR CS)))) 
(DE OFSF_XOPT-ES-MK (CPL) CPL) 
(PUT 'OFSF_XOPT-ES-MK 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-ES-MK 'DEFINED-ON-LINE '193) 
(PUT 'OFSF_XOPT-ES-MK 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-ES-MK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-ES-MK 'INLINE '(LAMBDA (CPL) CPL)) 
(DE OFSF_XOPT-ES-CPL (ES) ES) 
(PUT 'OFSF_XOPT-ES-CPL 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-ES-CPL 'DEFINED-ON-LINE '197) 
(PUT 'OFSF_XOPT-ES-CPL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-ES-CPL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'OFSF_XOPT-ES-CPL 'INLINE '(LAMBDA (ES) ES)) 
(PUT 'OFSF_XOPT-CHECK 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-CHECK 'DEFINED-ON-LINE '202) 
(PUT 'OFSF_XOPT-CHECK 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CHECK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_XOPT-CHECK (F)
    (PROG (*RLSIATADV *RLSITSQSPL *RLSIFAC *RLDAVGCD *RLSIPD *RLSIPW)
      (SETQ *RLSIPW T)
      (RETURN (OFSF_XOPT-CHECK1 (CL_SIMPL (CL_PNF F) NIL (MINUS 1)) NIL T)))) 
(PUT 'OFSF_XOPT-CHECK1 'NUMBER-OF-ARGS 3) 
(PUT 'OFSF_XOPT-CHECK1 'DEFINED-ON-LINE '211) 
(PUT 'OFSF_XOPT-CHECK1 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CHECK1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-CHECK1 (F VL P)
    (PROG (OP ARGL R)
      (COND ((OR (EQ F 'TRUE) (EQ F 'FALSE)) (RETURN NIL)))
      (SETQ OP (COND ((ATOM F) F) (T (CAR F))))
      (COND
       ((EQ OP 'EX)
        (RETURN (AND P (OFSF_XOPT-CHECK1 (CADDR F) (CONS (CADR F) VL) T)))))
      (COND ((EQ OP 'ALL) (RETURN NIL)))
      (COND
       ((OR (OR (EQ OP 'TRUE) (EQ OP 'FALSE))
            (OR (OR (OR (EQ OP 'OR) (EQ OP 'AND)) (EQ OP 'NOT))
                (OR (EQ OP 'IMPL) (EQ OP 'REPL) (EQ OP 'EQUIV)))
            (OR (EQ OP 'EX) (EQ OP 'ALL)) (OR (EQ OP 'BEX) (EQ OP 'BALL)))
        (PROGN
         (SETQ ARGL (CDR F))
         (SETQ R T)
         (PROG ()
          WHILELABEL
           (COND ((NOT (AND ARGL R)) (RETURN NIL)))
           (PROGN
            (SETQ R (OFSF_XOPT-CHECK1 (CAR ARGL) VL NIL))
            (SETQ ARGL (CDR ARGL)))
           (GO WHILELABEL))
         (RETURN R))))
      (RETURN
       (AND (MEMQ (CAR F) '(LEQ |,| GEQ |,| EQUAL))
            (SFTO_LINWPP (CADR F) VL))))) 
(PUT 'OFSF_XOPT-QEA 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-QEA 'DEFINED-ON-LINE '237) 
(PUT 'OFSF_XOPT-QEA 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-QEA 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_XOPT-QEA (F)
    (PROG (*RLXOPTQE) (RETURN (OFSF_XOPT-TRANS-ANSL (OFSF_XOPT-XOPT F))))) 
(PUT 'OFSF_XOPT-TRANS-ANSL 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-TRANS-ANSL 'DEFINED-ON-LINE '247) 
(PUT 'OFSF_XOPT-TRANS-ANSL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-TRANS-ANSL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_XOPT-TRANS-ANSL (U)
    (PROG (ANS FORALL-RESULT FORALL-ENDPTR)
      (SETQ ANS U)
      (COND ((NULL ANS) (RETURN NIL)))
      (SETQ FORALL-RESULT
              (SETQ FORALL-ENDPTR
                      (CONS
                       ((LAMBDA (ANS)
                          (CONS (CAR ANS)
                                (PROG (CT FORALL-RESULT FORALL-ENDPTR)
                                  (SETQ CT (CDR ANS))
                                  (COND ((NULL CT) (RETURN NIL)))
                                  (SETQ FORALL-RESULT
                                          (SETQ FORALL-ENDPTR
                                                  (CONS
                                                   ((LAMBDA (CT)
                                                      (CONS (CAR CT) (CDR CT)))
                                                    (CAR CT))
                                                   NIL)))
                                 LOOPLABEL
                                  (SETQ CT (CDR CT))
                                  (COND ((NULL CT) (RETURN FORALL-RESULT)))
                                  (RPLACD FORALL-ENDPTR
                                          (CONS
                                           ((LAMBDA (CT)
                                              (CONS (CAR CT) (CDR CT)))
                                            (CAR CT))
                                           NIL))
                                  (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                                  (GO LOOPLABEL))))
                        (CAR ANS))
                       NIL)))
     LOOPLABEL
      (SETQ ANS (CDR ANS))
      (COND ((NULL ANS) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR
              (CONS
               ((LAMBDA (ANS)
                  (CONS (CAR ANS)
                        (PROG (CT FORALL-RESULT FORALL-ENDPTR)
                          (SETQ CT (CDR ANS))
                          (COND ((NULL CT) (RETURN NIL)))
                          (SETQ FORALL-RESULT
                                  (SETQ FORALL-ENDPTR
                                          (CONS
                                           ((LAMBDA (CT)
                                              (CONS (CAR CT) (CDR CT)))
                                            (CAR CT))
                                           NIL)))
                         LOOPLABEL
                          (SETQ CT (CDR CT))
                          (COND ((NULL CT) (RETURN FORALL-RESULT)))
                          (RPLACD FORALL-ENDPTR
                                  (CONS
                                   ((LAMBDA (CT) (CONS (CAR CT) (CDR CT)))
                                    (CAR CT))
                                   NIL))
                          (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                          (GO LOOPLABEL))))
                (CAR ANS))
               NIL))
      (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
      (GO LOOPLABEL))) 
(PUT 'OFSF_XOPT-QE 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-QE 'DEFINED-ON-LINE '255) 
(PUT 'OFSF_XOPT-QE 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-QE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_XOPT-QE (F)
    (PROG (*RLXOPTQE) (SETQ *RLXOPTQE T) (RETURN (OFSF_XOPT-XOPT F)))) 
(PUT 'OFSF_XOPT-XOPT 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-XOPT 'DEFINED-ON-LINE '265) 
(PUT 'OFSF_XOPT-XOPT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-XOPT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_XOPT-XOPT (F)
    (PROG (EXL MTR W CO *RLSIATADV *RLSITSQSPL *RLSIFAC *RLDAVGCD *RLSIPD
           *RLSIPW OFSF_XOPT-DELNODES* OFSF_XOPT-PLNODES* OFSF_XOPT-FNODES*
           OFSF_XOPT-THCOF* OFSF_XOPT-NODES*)
      (SETQ OFSF_XOPT-DELNODES* 0)
      (SETQ OFSF_XOPT-PLNODES* 0)
      (SETQ OFSF_XOPT-FNODES* 0)
      (SETQ OFSF_XOPT-THCOF* 0)
      (SETQ OFSF_XOPT-NODES* 0)
      (SETQ *RLSIPW T)
      (SETQ F (CL_SIMPL (CL_PNF F) NIL (MINUS 1)))
      (SETQ W (CL_SPLT F))
      (SETQ EXL (CAR W))
      (COND
       ((NULL EXL)
        (COND (*RLXOPTQE (RETURN F)) (T (RETURN (LIST (CONS F NIL)))))))
      (COND
       ((CDR EXL) (REDERR "ofsf_xopt!-xopt: more than one quantifier block")))
      (SETQ EXL (CAR EXL))
      (COND
       ((NEQ (CAR EXL) 'EX)
        (REDERR "ofsf_xopt!-xopt: not an existential formula")))
      (SETQ EXL (CDR EXL))
      (SETQ MTR (CADR W))
      (SETQ CO
              (COND
               ((NEQ (COND ((ATOM MTR) MTR) (T (CAR MTR))) 'OR)
                (LIST (LIST EXL MTR NIL NIL)))
               (T
                (PROG (X FORALL-RESULT FORALL-ENDPTR)
                  (SETQ X (CDR MTR))
                  (COND ((NULL X) (RETURN NIL)))
                  (SETQ FORALL-RESULT
                          (SETQ FORALL-ENDPTR
                                  (CONS
                                   ((LAMBDA (X) (LIST EXL X NIL NIL)) (CAR X))
                                   NIL)))
                 LOOPLABEL
                  (SETQ X (CDR X))
                  (COND ((NULL X) (RETURN FORALL-RESULT)))
                  (RPLACD FORALL-ENDPTR
                          (CONS ((LAMBDA (X) (LIST EXL X NIL NIL)) (CAR X))
                                NIL))
                  (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                  (GO LOOPLABEL)))))
      (COND ((NOT *RLXOPTQE) (RETURN (OFSF_XOPT-BACKSUB (OFSF_XOPT-ELIM CO)))))
      (SETQ W (OFSF_XOPT-BACKSUB (OFSF_XOPT-ELIM CO)))
      (COND (*RLVERBOSE (IOTO_PRIN2 "Constructing result formula ... ")))
      (SETQ W
              (PROG (ANS FORALL-RESULT FORALL-ENDPTR)
                (SETQ ANS W)
                (COND ((NULL ANS) (RETURN NIL)))
                (SETQ FORALL-RESULT
                        (SETQ FORALL-ENDPTR
                                (CONS ((LAMBDA (ANS) (CAR ANS)) (CAR ANS))
                                      NIL)))
               LOOPLABEL
                (SETQ ANS (CDR ANS))
                (COND ((NULL ANS) (RETURN FORALL-RESULT)))
                (RPLACD FORALL-ENDPTR
                        (CONS ((LAMBDA (ANS) (CAR ANS)) (CAR ANS)) NIL))
                (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                (GO LOOPLABEL)))
      (SETQ W
              (CL_SIMPL
               (COND ((AND W (CDR W)) (CONS 'OR W))
                     ((NULL W) (COND ((EQ 'OR 'AND) 'TRUE) (T 'FALSE)))
                     (T (CAR W)))
               NIL (MINUS 1)))
      (COND (*RLVERBOSE (IOTO_PRIN2T "done.")))
      (RETURN W))) 
(PUT 'OFSF_XOPT-ELIM 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-ELIM 'DEFINED-ON-LINE '308) 
(PUT 'OFSF_XOPT-ELIM 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-ELIM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_XOPT-ELIM (CO)
    (PROG (W CE CEL RESL THEO N)
      (SETQ N 0)
      (COND (*RLVERBOSE (SETQ OFSF_XOPT-NODES* (LENGTH CO))))
      (PROG ()
       WHILELABEL
        (COND ((NOT CO) (RETURN NIL)))
        (PROGN
         (COND (*RLVERBOSE (SETQ N (PLUS N 1))))
         (PROG (G332)
           (SETQ G332 CO)
           (SETQ CE (CAR G332))
           (SETQ CO (CDR G332))
           (RETURN G332))
         (COND (*RLVERBOSE (IOTO_PRIN2 (LIST "[" N "/" OFSF_XOPT-NODES*))))
         (SETQ CEL (OFSF_XOPT-QEVAR CE THEO))
         (PROG (G333 G334)
           (SETQ G333 (OFSF_XOPT-UPDCO CEL CO RESL THEO))
           (SETQ G334 G333)
           (SETQ CO (CAR G333))
           (SETQ G333 (CDR G333))
           (SETQ RESL (CAR G333))
           (SETQ G333 (CDR G333))
           (SETQ THEO (CAR G333))
           (SETQ G333 (CDR G333))
           (RETURN G334))
         (COND (*RLVERBOSE (IOTO_PRIN2 "] ")))
         NIL)
        (GO WHILELABEL))
      (COND
       (*RLVERBOSE
        (PROGN
         (IOTO_CTERPRI)
         (IOTO_PRIN2T (LIST "Number of computed nodes: " OFSF_XOPT-NODES*))
         (IOTO_PRIN2T (LIST "Number of PL hits: " OFSF_XOPT-PLNODES*))
         (IOTO_PRIN2T (LIST "Number of identical CE's: " OFSF_XOPT-DELNODES*))
         (IOTO_PRIN2T (LIST "Number of FALSE results: " OFSF_XOPT-FNODES*))
         (IOTO_PRIN2T
          (LIST "Number of CE's deleted by theo: " OFSF_XOPT-THCOF*))
         NIL)))
      (RETURN (OFSF_XOPT-CEL2ANSL RESL)))) 
(PUT 'OFSF_XOPT-QEVAR 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_XOPT-QEVAR 'DEFINED-ON-LINE '339) 
(PUT 'OFSF_XOPT-QEVAR 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-QEVAR 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-QEVAR (CE THEO)
    (PROG (V CS ES CEL)
      (SETQ V (OFSF_XOPT-VARSEL CE))
      (SETQ CS (OFSF_XOPT-CSET (CADR CE) V))
      (COND
       ((OFSF_XOPT-CS-NULL CS)
        (RETURN
         (LIST
          (LIST (LTO_DELQ V (CAR CE)) (CADR CE)
                (CONS (CONS V 'ARBITRARY) (CADDR CE)) (CADDDR CE))))))
      (COND
       (*RLXOPTPL
        (PROGN
         (SETQ CS (OFSF_XOPT-APPLYPL CS (CADDDR CE)))
         (COND
          ((OFSF_XOPT-CS-NULL CS)
           (RETURN (LIST (LIST NIL 'FALSE NIL NIL))))))))
      (SETQ ES (OFSF_XOPT-ESET CS))
      (SETQ CEL (OFSF_XOPT-SUCCS CE ES V THEO))
      (RETURN CEL))) 
(PUT 'OFSF_XOPT-VARSEL 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-VARSEL 'DEFINED-ON-LINE '361) 
(PUT 'OFSF_XOPT-VARSEL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-VARSEL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_XOPT-VARSEL (CE) (CAR (CAR CE))) 
(PUT 'OFSF_XOPT-CSET 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_XOPT-CSET 'DEFINED-ON-LINE '365) 
(PUT 'OFSF_XOPT-CSET 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CSET 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-CSET (F V)
    (COND (*RLXOPTSES (OFSF_XOPT-SCSET F V)) (T (OFSF_XOPT-CSETTRAD F V)))) 
(PUT 'OFSF_XOPT-SCSET 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_XOPT-SCSET 'DEFINED-ON-LINE '372) 
(PUT 'OFSF_XOPT-SCSET 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-SCSET 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-SCSET (F V)
    (PROG (W)
      (SETQ W (OFSF_XOPT-SCSET1 F V))
      (COND ((AND *RLVERBOSE (EQ (CDR W) 'FINITE)) (IOTO_PRIN2 "g")))
      (RETURN (CAR W)))) 
(PUT 'OFSF_XOPT-SCSET1 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_XOPT-SCSET1 'DEFINED-ON-LINE '382) 
(PUT 'OFSF_XOPT-SCSET1 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-SCSET1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-SCSET1 (F V)
    (COND
     (((LAMBDA (X) (OR (EQ X 'OR) (EQ X 'AND)))
       (COND ((ATOM F) F) (T (CAR F))))
      (OFSF_XOPT-SCSETJUNCT F V))
     ((CL_ATFP F) (OFSF_XOPT-SCSETAT F V))
     (T
      (REDERR
       (LIST "ofsf_xopt!-scset1: Unexpected operator"
             (COND ((ATOM F) F) (T (CAR F)))))))) 
(PUT 'OFSF_XOPT-SCSETJUNCT 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_XOPT-SCSETJUNCT 'DEFINED-ON-LINE '393) 
(PUT 'OFSF_XOPT-SCSETJUNCT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-SCSETJUNCT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-SCSETJUNCT (F V)
    (PROG (W FL NL R)
      (SETQ R (LIST NIL NIL NIL))
      (PROG (X)
        (SETQ X (CDR F))
       LAB
        (COND ((NULL X) (RETURN NIL)))
        ((LAMBDA (X)
           (PROGN
            (SETQ W (OFSF_XOPT-SCSET1 X V))
            (COND ((CDR W) (SETQ FL (CONS (CAR W) FL)))
                  (T (SETQ NL (CONS (CAR W) NL))))))
         (CAR X))
        (SETQ X (CDR X))
        (GO LAB))
      (COND
       (FL
        (COND
         ((EQ (COND ((ATOM F) F) (T (CAR F))) 'AND)
          (PROGN
           (COND ((AND *RLVERBOSE NL) (IOTO_PRIN2 "s")))
           (RETURN (CONS (OFSF_XOPT-SCSETSELECT FL) 'FINITE))))
         ((AND (EQ (COND ((ATOM F) F) (T (CAR F))) 'OR) (NULL NL))
          (PROGN
           (PROG (CS)
             (SETQ CS FL)
            LAB
             (COND ((NULL CS) (RETURN NIL)))
             ((LAMBDA (CS) (SETQ R (OFSF_XOPT-SCSETUNION CS R))) (CAR CS))
             (SETQ CS (CDR CS))
             (GO LAB))
           (RETURN (CONS R 'FINITE)))))))
      (PROG (CS)
        (SETQ CS FL)
       LAB
        (COND ((NULL CS) (RETURN NIL)))
        ((LAMBDA (CS) (SETQ R (OFSF_XOPT-SCSETUNION CS R))) (CAR CS))
        (SETQ CS (CDR CS))
        (GO LAB))
      (PROG (CS)
        (SETQ CS NL)
       LAB
        (COND ((NULL CS) (RETURN NIL)))
        ((LAMBDA (CS) (SETQ R (OFSF_XOPT-SCSETUNION CS R))) (CAR CS))
        (SETQ CS (CDR CS))
        (GO LAB))
      (RETURN (CONS R NIL)))) 
(PUT 'OFSF_XOPT-SCSETSELECT 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-SCSETSELECT 'DEFINED-ON-LINE '423) 
(PUT 'OFSF_XOPT-SCSETSELECT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-SCSETSELECT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_XOPT-SCSETSELECT (CSL) (CAR CSL)) 
(PUT 'OFSF_XOPT-SCSETUNION 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_XOPT-SCSETUNION 'DEFINED-ON-LINE '428) 
(PUT 'OFSF_XOPT-SCSETUNION 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-SCSETUNION 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-SCSETUNION (CS1 CS2)
    (LIST (UNION (CAR CS1) (CAR CS2)) (UNION (CADR CS1) (CADR CS2))
          (UNION (CADDR CS1) (CADDR CS2)))) 
(PUT 'OFSF_XOPT-SCSETAT 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_XOPT-SCSETAT 'DEFINED-ON-LINE '435) 
(PUT 'OFSF_XOPT-SCSETAT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-SCSETAT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-SCSETAT (AT V)
    (PROG (BT P)
      (SETQ BT (OFSF_XOPT-BOUNDARYTYPE AT V))
      (SETQ P (CADR AT))
      (RETURN
       (COND ((EQ BT 'UB) (CONS (LIST (LIST P) NIL NIL) NIL))
             ((EQ BT 'LB) (CONS (LIST NIL (LIST P) NIL) NIL))
             ((EQ BT 'EQU) (CONS (LIST NIL NIL (LIST P)) 'FINITE))
             (T (CONS (LIST NIL NIL NIL) NIL)))))) 
(PUT 'OFSF_XOPT-BOUNDARYTYPE 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_XOPT-BOUNDARYTYPE 'DEFINED-ON-LINE '452) 
(PUT 'OFSF_XOPT-BOUNDARYTYPE 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-BOUNDARYTYPE 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-BOUNDARYTYPE (AT V)
    (PROG (REL P RP W)
      (SETQ REL (CAR AT))
      (SETQ P (CADR AT))
      (COND ((OR (ATOM P) (ATOM (CAR P))) (RETURN NIL)))
      (SETQ RP (SFTO_REORDER P V))
      (COND ((NEQ (CAAAR RP) V) (RETURN NIL)))
      (COND ((EQ REL 'EQUAL) (RETURN 'EQU)))
      (SETQ W (CDAR RP))
      (COND
       ((NOT (OR (ATOM W) (ATOM (CAR W))))
        (REDERR "ofsf_xopt!-boundarytype: parametric coefficient")))
      (COND
       ((NOT (MEMQ REL '(GEQ LEQ)))
        (REDERR (LIST "ofsf_xopt!-boundarytype: unknown relation" REL))))
      (RETURN
       (COND ((MINUSF W) (COND ((EQ REL 'GEQ) 'UB) (T 'LB)))
             ((EQ REL 'GEQ) 'LB) (T 'UB))))) 
(PUT 'OFSF_XOPT-CSETTRAD 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_XOPT-CSETTRAD 'DEFINED-ON-LINE '482) 
(PUT 'OFSF_XOPT-CSETTRAD 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CSETTRAD 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-CSETTRAD (F V)
    (PROG (ATL BT UBL LBL EQL P)
      (SETQ ATL (CL_ATL1 F))
      (PROG (AT)
        (SETQ AT ATL)
       LAB
        (COND ((NULL AT) (RETURN NIL)))
        ((LAMBDA (AT)
           (PROGN
            (SETQ BT (OFSF_XOPT-BOUNDARYTYPE AT V))
            (SETQ P (CADR AT))
            (COND ((EQ BT 'UB) (SETQ UBL (CONS P UBL)))
                  ((EQ BT 'LB) (SETQ LBL (CONS P LBL)))
                  ((EQ BT 'EQU) (SETQ EQL (CONS P EQL))))))
         (CAR AT))
        (SETQ AT (CDR AT))
        (GO LAB))
      (RETURN (LIST UBL LBL EQL)))) 
(PUT 'OFSF_XOPT-APPLYPL 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_XOPT-APPLYPL 'DEFINED-ON-LINE '500) 
(PUT 'OFSF_XOPT-APPLYPL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-APPLYPL 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-APPLYPL (CS PL)
    (COND ((NOT *RLXOPTPL) CS) ((NULL PL) CS)
          (T
           (LIST (OFSF_XOPT-APPLYPL1 (CAR CS) PL)
                 (OFSF_XOPT-APPLYPL1 (CADR CS) PL)
                 (OFSF_XOPT-APPLYPL1 (CADDR CS) PL))))) 
(PUT 'OFSF_XOPT-APPLYPL1 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_XOPT-APPLYPL1 'DEFINED-ON-LINE '511) 
(PUT 'OFSF_XOPT-APPLYPL1 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-APPLYPL1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-APPLYPL1 (CPL PL)
    (PROG (CP FORALL-RESULT FORALL-ENDPTR)
      (SETQ CP CPL)
     STARTOVER
      (COND ((NULL CP) (RETURN NIL)))
      (SETQ FORALL-RESULT
              ((LAMBDA (CP)
                 (COND
                  ((EQ (CL_SIMPL (LIST 'EQUAL CP NIL) PL (MINUS 1)) 'FALSE)
                   (PROGN
                    (SETQ OFSF_XOPT-PLNODES* (PLUS OFSF_XOPT-PLNODES* 1))
                    NIL))
                  (T (LIST CP))))
               (CAR CP)))
      (SETQ FORALL-ENDPTR (LASTPAIR FORALL-RESULT))
      (SETQ CP (CDR CP))
      (COND ((ATOM FORALL-ENDPTR) (GO STARTOVER)))
     LOOPLABEL
      (COND ((NULL CP) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR
              ((LAMBDA (CP)
                 (COND
                  ((EQ (CL_SIMPL (LIST 'EQUAL CP NIL) PL (MINUS 1)) 'FALSE)
                   (PROGN
                    (SETQ OFSF_XOPT-PLNODES* (PLUS OFSF_XOPT-PLNODES* 1))
                    NIL))
                  (T (LIST CP))))
               (CAR CP)))
      (SETQ FORALL-ENDPTR (LASTPAIR FORALL-ENDPTR))
      (SETQ CP (CDR CP))
      (GO LOOPLABEL))) 
(PUT 'OFSF_XOPT-ESET 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-ESET 'DEFINED-ON-LINE '520) 
(PUT 'OFSF_XOPT-ESET 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-ESET 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_XOPT-ESET (CS)
    (COND (*RLXOPTSB (OFSF_XOPT-ESETOS CS)) (T (OFSF_XOPT-ESETBS CS)))) 
(PUT 'OFSF_XOPT-ESETOS 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-ESETOS 'DEFINED-ON-LINE '527) 
(PUT 'OFSF_XOPT-ESETOS 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-ESETOS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_XOPT-ESETOS (CS)
    (PROG (UBL LBL EQL)
      (SETQ UBL (CAR CS))
      (SETQ LBL (CADR CS))
      (SETQ EQL (CADDR CS))
      (RETURN
       (COND ((AND (NULL UBL) (NULL LBL)) EQL) ((NULL UBL) (CONS 'PINF EQL))
             ((NULL LBL) (CONS 'MINF EQL))
             ((LEQ (LENGTH UBL) (LENGTH LBL)) (CONS 'PINF (UNION UBL EQL)))
             (T (CONS 'MINF (UNION LBL EQL))))))) 
(PUT 'OFSF_XOPT-ESETBS 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-ESETBS 'DEFINED-ON-LINE '545) 
(PUT 'OFSF_XOPT-ESETBS 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-ESETBS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_XOPT-ESETBS (CS) (UNION (UNION (CAR CS) (CADR CS)) (CADDR CS))) 
(PUT 'OFSF_XOPT-SUCCS 'NUMBER-OF-ARGS 4) 
(PUT 'OFSF_XOPT-SUCCS 'DEFINED-ON-LINE '550) 
(PUT 'OFSF_XOPT-SUCCS 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-SUCCS 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-SUCCS (CE ES V THEO)
    (PROG (CEL NPL)
      (SETQ NPL (CADDDR CE))
      (PROG (CP)
        (SETQ CP ES)
       LAB
        (COND ((NULL CP) (RETURN NIL)))
        ((LAMBDA (CP)
           (PROGN
            (SETQ CEL (CONS (OFSF_XOPT-SUCCS1 CE CP V NPL THEO) CEL))
            (SETQ NPL (OFSF_XOPT-UPDPL CP NPL))
            NIL))
         (CAR CP))
        (SETQ CP (CDR CP))
        (GO LAB))
      (RETURN (REVERSIP CEL)))) 
(PUT 'OFSF_XOPT-SUCCS1 'NUMBER-OF-ARGS 5) 
(PUT 'OFSF_XOPT-SUCCS1 'DEFINED-ON-LINE '562) 
(PUT 'OFSF_XOPT-SUCCS1 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-SUCCS1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-SUCCS1 (CE CP V NPL THEO)
    (PROG (P F W)
      (SETQ P CP)
      (SETQ F (OFSF_XOPT-SUB (CADR CE) V P THEO))
      (RETURN
       (COND (W (LIST NIL 'FALSE NIL NIL))
             (T
              (LIST (LTO_DELQ V (CAR CE)) F
                    (CONS (CONS V (OFSF_XOPT-SOLV P V)) (CADDR CE))
                    (OFSF_XOPT-PLSUB NPL V P))))))) 
(PUT 'OFSF_XOPT-SUB 'NUMBER-OF-ARGS 4) 
(PUT 'OFSF_XOPT-SUB 'DEFINED-ON-LINE '579) 
(PUT 'OFSF_XOPT-SUB 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-SUB 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-SUB (F V SOL THEO)
    (PROG (W)
      (SETQ W (OFSF_XOPT-SUB1 F V SOL))
      (COND
       ((OR (NOT *RLXOPTRIR) (NOT *RLXOPTRI))
        (RETURN (CL_SIMPL W THEO (MINUS 1)))))
      (SETQ W (CL_SIMPL W NIL (MINUS 1)))
      (RETURN (COND ((EQ (CL_SIMPL W THEO (MINUS 1)) 'FALSE) 'FALSE) (T W))))) 
(PUT 'OFSF_XOPT-SUB1 'NUMBER-OF-ARGS 3) 
(PUT 'OFSF_XOPT-SUB1 'DEFINED-ON-LINE '593) 
(PUT 'OFSF_XOPT-SUB1 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-SUB1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-SUB1 (F V SOL)
    (COND
     ((MEMQ SOL '(MINF PINF)) (CL_APPLY2ATS1 F 'OFSF_XOPT-SUBIAT (LIST V SOL)))
     (T (CL_APPLY2ATS1 F 'OFSF_XOPT-SUBAT (LIST V SOL))))) 
(PUT 'OFSF_XOPT-SUBIAT 'NUMBER-OF-ARGS 3) 
(PUT 'OFSF_XOPT-SUBIAT 'DEFINED-ON-LINE '602) 
(PUT 'OFSF_XOPT-SUBIAT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-SUBIAT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-SUBIAT (ATF V IT)
    (PROG (REL P RP POS)
      (SETQ REL (CAR ATF))
      (COND
       ((EQ REL 'EQUAL)
        (RETURN (COND ((MEMQ V (OFSF_VARLAT ATF)) 'FALSE) (T ATF)))))
      (COND
       ((EQ REL 'NEQ)
        (RETURN (COND ((MEMQ V (OFSF_VARLAT ATF)) 'TRUE) (T ATF)))))
      (SETQ P (CADR ATF))
      (COND ((OR (ATOM P) (ATOM (CAR P))) (RETURN ATF)))
      (SETQ RP (SFTO_REORDER P V))
      (COND ((NEQ (CAAAR RP) V) (RETURN ATF)))
      (SETQ POS
              (COND ((EQ IT 'PINF) (NOT (MINUSF (CDAR RP))))
                    (T (MINUSF (CDAR RP)))))
      (RETURN
       (COND
        ((OR (AND POS (MEMQ REL '(GEQ GREATERP)))
             (AND (NOT POS) (MEMQ REL '(LEQ LESSP))))
         'TRUE)
        (T 'FALSE))))) 
(PUT 'OFSF_XOPT-SUBAT 'NUMBER-OF-ARGS 3) 
(PUT 'OFSF_XOPT-SUBAT 'DEFINED-ON-LINE '633) 
(PUT 'OFSF_XOPT-SUBAT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-SUBAT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-SUBAT (ATF V SOL)
    (LIST (CAR ATF) (OFSF_XOPT-SUBLF (CADR ATF) V SOL) NIL)) 
(PUT 'OFSF_XOPT-SUBLF 'NUMBER-OF-ARGS 3) 
(PUT 'OFSF_XOPT-SUBLF 'DEFINED-ON-LINE '638) 
(PUT 'OFSF_XOPT-SUBLF 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-SUBLF 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-SUBLF (P V MP)
    (PROG (OLDORDER RMP RP R)
      (COND ((NOT (MEMQ V (KERNELS P))) (RETURN P)))
      (SETQ OLDORDER (SETKORDER (LIST V)))
      (SETQ RMP (REORDER MP))
      (SETQ RP (REORDER P))
      (SETQ R
              (COND
               ((MINUSF (CDAR RMP))
                (ADDF
                 (COND (*PHYSOP-LOADED (PHYSOP-MULTF (CDAR RP) (CDR RMP)))
                       (T (POLY-MULTF (CDAR RP) (CDR RMP))))
                 (NEGF
                  (COND (*PHYSOP-LOADED (PHYSOP-MULTF (CDAR RMP) (CDR RP)))
                        (T (POLY-MULTF (CDAR RMP) (CDR RP)))))))
               (T
                (ADDF
                 (NEGF
                  (COND (*PHYSOP-LOADED (PHYSOP-MULTF (CDAR RP) (CDR RMP)))
                        (T (POLY-MULTF (CDAR RP) (CDR RMP)))))
                 (COND (*PHYSOP-LOADED (PHYSOP-MULTF (CDAR RMP) (CDR RP)))
                       (T (POLY-MULTF (CDAR RMP) (CDR RP))))))))
      (SETKORDER OLDORDER)
      (RETURN (REORDER R)))) 
(PUT 'OFSF_XOPT-SOLV 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_XOPT-SOLV 'DEFINED-ON-LINE '656) 
(PUT 'OFSF_XOPT-SOLV 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-SOLV 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-SOLV (P V)
    (PROG (RP)
      (COND ((MEMQ P '(MINF PINF)) (RETURN P)))
      (SETQ RP (SFTO_REORDER P V))
      (RETURN
       (PREPSQ
        (MULTSQ (CONS (REORDER (NEGF (CDR RP))) 1)
                (INVSQ (CONS (REORDER (CDAR RP)) 1))))))) 
(PUT 'OFSF_XOPT-PLSUB 'NUMBER-OF-ARGS 3) 
(PUT 'OFSF_XOPT-PLSUB 'DEFINED-ON-LINE '665) 
(PUT 'OFSF_XOPT-PLSUB 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-PLSUB 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-PLSUB (PL V SOL)
    (PROG (W)
      (COND ((NOT *RLXOPTPL) (RETURN NIL)))
      (COND ((NULL PL) (RETURN NIL)))
      (SETQ W
              (COND ((AND PL (CDR PL)) (CONS 'AND PL))
                    ((NULL PL) (COND ((EQ 'AND 'AND) 'TRUE) (T 'FALSE)))
                    (T (CAR PL))))
      (SETQ W (CL_SIMPL (OFSF_XOPT-SUB W V SOL NIL) NIL (MINUS 1)))
      (COND ((EQ W 'TRUE) (RETURN NIL)))
      (COND ((EQ W 'FALSE) (REDERR (LIST "ofsf_xopt!-plsub: Result" W))))
      (COND ((CL_ATFP W) (SETQ W (LIST W)))
            ((NEQ (COND ((ATOM W) W) (T (CAR W))) 'AND)
             (REDERR
              (LIST "ofsf_xopt!-plsub: unexpected operator"
                    (COND ((ATOM W) W) (T (CAR W))))))
            (T (SETQ W (CDR W))))
      (RETURN
       (PROG (F FORALL-RESULT FORALL-ENDPTR)
         (SETQ F W)
        STARTOVER
         (COND ((NULL F) (RETURN NIL)))
         (SETQ FORALL-RESULT
                 ((LAMBDA (F)
                    (COND ((CL_ATFP F) (LIST F))
                          (T
                           (PROGN (COND (*RLVERBOSE (IOTO_PRIN2 "C"))) NIL))))
                  (CAR F)))
         (SETQ FORALL-ENDPTR (LASTPAIR FORALL-RESULT))
         (SETQ F (CDR F))
         (COND ((ATOM FORALL-ENDPTR) (GO STARTOVER)))
        LOOPLABEL
         (COND ((NULL F) (RETURN FORALL-RESULT)))
         (RPLACD FORALL-ENDPTR
                 ((LAMBDA (F)
                    (COND ((CL_ATFP F) (LIST F))
                          (T
                           (PROGN (COND (*RLVERBOSE (IOTO_PRIN2 "C"))) NIL))))
                  (CAR F)))
         (SETQ FORALL-ENDPTR (LASTPAIR FORALL-ENDPTR))
         (SETQ F (CDR F))
         (GO LOOPLABEL))))) 
(PUT 'OFSF_XOPT-UPDPL 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_XOPT-UPDPL 'DEFINED-ON-LINE '692) 
(PUT 'OFSF_XOPT-UPDPL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-UPDPL 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-UPDPL (CP PL)
    (PROG (W)
      (COND ((NOT *RLXOPTPL) (RETURN NIL)))
      (SETQ W CP)
      (COND ((MEMQ W '(PINF MINF)) (RETURN PL)))
      (RETURN (CONS (LIST 'NEQ W NIL) PL)))) 
(PUT 'OFSF_XOPT-UPDCO 'NUMBER-OF-ARGS 4) 
(PUT 'OFSF_XOPT-UPDCO 'DEFINED-ON-LINE '702) 
(PUT 'OFSF_XOPT-UPDCO 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-UPDCO 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-UPDCO (CEL CO RESL THEO)
    (PROG (CE F W)
      (PROG ()
       WHILELABEL
        (COND ((NOT CEL) (RETURN NIL)))
        (PROGN
         (SETQ CE (CAR CEL))
         (SETQ CEL (CDR CEL))
         (SETQ F (CADR CE))
         (COND
          ((EQ F 'FALSE)
           (PROGN (SETQ OFSF_XOPT-FNODES* (PLUS OFSF_XOPT-FNODES* 1)) NIL))
          ((EQ F 'TRUE)
           (PROGN (SETQ RESL (LIST CE)) (SETQ CO NIL) (SETQ CEL NIL)))
          ((NULL (CAR CE))
           (PROGN
            (PROG (G335 G336)
              (SETQ G335 (OFSF_XOPT-RESINHERIT CE RESL CO THEO))
              (SETQ G336 G335)
              (SETQ RESL (CAR G335))
              (SETQ G335 (CDR G335))
              (SETQ CO (CAR G335))
              (SETQ G335 (CDR G335))
              (SETQ THEO (CAR G335))
              (SETQ G335 (CDR G335))
              (RETURN G336))
            (COND ((EQ THEO 'INCTHEO) (PROGN (SETQ CO NIL) (SETQ CEL NIL))))))
          ((EQ (COND ((ATOM F) F) (T (CAR F))) 'OR)
           (PROG (FF)
             (SETQ FF (CDR F))
            LAB
             (COND ((NULL FF) (RETURN NIL)))
             ((LAMBDA (FF)
                (PROGN
                 (SETQ CO
                         (OFSF_XOPT-CCOPUT CO
                          (LIST (CAR CE) FF (CADDR CE) (CADDDR CE))))
                 NIL))
              (CAR FF))
             (SETQ FF (CDR FF))
             (GO LAB)))
          (T (SETQ CO (OFSF_XOPT-CCOPUT CO CE))))
         NIL)
        (GO WHILELABEL))
      (RETURN (LIST CO RESL THEO)))) 
(PUT 'OFSF_XOPT-RESINHERIT 'NUMBER-OF-ARGS 4) 
(PUT 'OFSF_XOPT-RESINHERIT 'DEFINED-ON-LINE '740) 
(PUT 'OFSF_XOPT-RESINHERIT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-RESINHERIT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-RESINHERIT (CE RESL CO THEO)
    (PROG (F)
      (COND ((OFSF_XOPT-CELMEMBER CE RESL) (RETURN (LIST RESL CO THEO))))
      (COND
       ((NOT *RLXOPTRI)
        (PROGN
         (COND (*RLVERBOSE (IOTO_PRIN2 ".")))
         (RETURN (LIST (CONS CE RESL) CO THEO)))))
      (SETQ F (CADR CE))
      (COND
       ((EQ (COND ((ATOM F) F) (T (CAR F))) 'AND)
        (PROGN
         (COND (*RLVERBOSE (IOTO_PRIN2 ".")))
         (RETURN (LIST (CONS CE RESL) CO THEO)))))
      (SETQ THEO
              (CL_SIMPL
               ((LAMBDA (G338)
                  (COND ((AND G338 (CDR G338)) (CONS 'AND G338))
                        ((NULL G338) (COND ((EQ 'AND 'AND) 'TRUE) (T 'FALSE)))
                        (T (CAR G338))))
                (CONS (CL_NNFNOT F) THEO))
               NIL (MINUS 1)))
      (COND ((CL_ATFP THEO) (SETQ THEO (LIST THEO)))
            ((EQ THEO 'FALSE) (RETURN (LIST (CONS CE RESL) CO 'INCTHEO)))
            ((NEQ (COND ((ATOM THEO) THEO) (T (CAR THEO))) 'AND)
             (REDERR
              (LIST "ofsf_xopt!-resinherit: Unexpected operator"
                    (COND ((ATOM THEO) THEO) (T (CAR THEO))))))
            (T
             (SETQ THEO
                     (PROG (ATF FORALL-RESULT FORALL-ENDPTR)
                       (SETQ ATF (CDR THEO))
                      STARTOVER
                       (COND ((NULL ATF) (RETURN NIL)))
                       (SETQ FORALL-RESULT
                               ((LAMBDA (ATF)
                                  (COND ((CL_ATFP ATF) (LIST ATF))))
                                (CAR ATF)))
                       (SETQ FORALL-ENDPTR (LASTPAIR FORALL-RESULT))
                       (SETQ ATF (CDR ATF))
                       (COND ((ATOM FORALL-ENDPTR) (GO STARTOVER)))
                      LOOPLABEL
                       (COND ((NULL ATF) (RETURN FORALL-RESULT)))
                       (RPLACD FORALL-ENDPTR
                               ((LAMBDA (ATF)
                                  (COND ((CL_ATFP ATF) (LIST ATF))))
                                (CAR ATF)))
                       (SETQ FORALL-ENDPTR (LASTPAIR FORALL-ENDPTR))
                       (SETQ ATF (CDR ATF))
                       (GO LOOPLABEL)))))
      (COND (*RLXOPTRIR (SETQ RESL (OFSF_XOPT-THAPPLYCEL RESL THEO))))
      (COND (*RLXOPTRIC (SETQ CO (OFSF_XOPT-THAPPLYCO CO THEO))))
      (COND (*RLVERBOSE (IOTO_PRIN2 ".")))
      (RETURN (LIST (CONS CE RESL) CO THEO)))) 
(PUT 'OFSF_XOPT-CELMEMBER 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_XOPT-CELMEMBER 'DEFINED-ON-LINE '776) 
(PUT 'OFSF_XOPT-CELMEMBER 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CELMEMBER 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-CELMEMBER (CE CEL)
    (PROG (F A SCEL FLG)
      (SETQ F (CADR CE))
      (SETQ SCEL CEL)
      (PROG ()
       WHILELABEL
        (COND ((NOT SCEL) (RETURN NIL)))
        (PROGN
         (SETQ A (CAR SCEL))
         (SETQ SCEL (CDR SCEL))
         (COND ((EQUAL F (CADR A)) (PROGN (SETQ SCEL NIL) (SETQ FLG T)))))
        (GO WHILELABEL))
      (RETURN FLG))) 
(PUT 'OFSF_XOPT-THAPPLYCEL 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_XOPT-THAPPLYCEL 'DEFINED-ON-LINE '793) 
(PUT 'OFSF_XOPT-THAPPLYCEL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-THAPPLYCEL 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-THAPPLYCEL (CEL THEO)
    (PROG (CE FORALL-RESULT FORALL-ENDPTR)
      (SETQ CE CEL)
     STARTOVER
      (COND ((NULL CE) (RETURN NIL)))
      (SETQ FORALL-RESULT
              ((LAMBDA (CE)
                 (COND
                  ((NEQ (CL_SIMPL (CADR CE) THEO (MINUS 1)) 'FALSE)
                   (LIST CE))))
               (CAR CE)))
      (SETQ FORALL-ENDPTR (LASTPAIR FORALL-RESULT))
      (SETQ CE (CDR CE))
      (COND ((ATOM FORALL-ENDPTR) (GO STARTOVER)))
     LOOPLABEL
      (COND ((NULL CE) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR
              ((LAMBDA (CE)
                 (COND
                  ((NEQ (CL_SIMPL (CADR CE) THEO (MINUS 1)) 'FALSE)
                   (LIST CE))))
               (CAR CE)))
      (SETQ FORALL-ENDPTR (LASTPAIR FORALL-ENDPTR))
      (SETQ CE (CDR CE))
      (GO LOOPLABEL))) 
(PUT 'OFSF_XOPT-THAPPLYCO 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_XOPT-THAPPLYCO 'DEFINED-ON-LINE '800) 
(PUT 'OFSF_XOPT-THAPPLYCO 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-THAPPLYCO 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-THAPPLYCO (CO THEO)
    (PROG (CE W R F)
      (PROG ()
       WHILELABEL
        (COND ((NOT CO) (RETURN NIL)))
        (PROGN
         (SETQ W CO)
         (SETQ CE (CAR W))
         (SETQ CO (CDR W))
         (SETQ F (CL_SIMPL (CADR CE) THEO (MINUS 1)))
         (COND
          ((EQ F 'FALSE) (SETQ OFSF_XOPT-THCOF* (PLUS OFSF_XOPT-THCOF* 1)))
          (T (SETQ R (CONS (LIST (CAR CE) F (CADDR CE) (CADDDR CE)) R)))))
        (GO WHILELABEL))
      (RETURN R))) 
(PUT 'OFSF_XOPT-CCOPUT 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_XOPT-CCOPUT 'DEFINED-ON-LINE '820) 
(PUT 'OFSF_XOPT-CCOPUT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CCOPUT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_XOPT-CCOPUT (CO CE)
    (PROG (SCO W F FLG PL)
      (SETQ F (CADR CE))
      (SETQ SCO CO)
      (PROG ()
       WHILELABEL
        (COND ((NOT SCO) (RETURN NIL)))
        (PROGN
         (SETQ W SCO)
         (SETQ SCO (CDR W))
         (SETQ W (CAR W))
         (COND ((EQUAL (CADR W) F) (PROGN (SETQ SCO NIL) (SETQ FLG T)))))
        (GO WHILELABEL))
      (COND
       (FLG
        (PROGN
         (SETQ CO (LTO_DELQ W CO))
         (SETQ PL (INTERSECTION (CADDDR CE) (CADDDR W)))
         (SETQ CE (LIST (CAR CE) F (CADDR CE) PL))
         (SETQ OFSF_XOPT-DELNODES* (PLUS OFSF_XOPT-DELNODES* 1))))
       (T (SETQ OFSF_XOPT-NODES* (PLUS OFSF_XOPT-NODES* 1))))
      (RETURN (CONS CE CO)))) 
(PUT 'OFSF_XOPT-CEL2ANSL 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-CEL2ANSL 'DEFINED-ON-LINE '845) 
(PUT 'OFSF_XOPT-CEL2ANSL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-CEL2ANSL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_XOPT-CEL2ANSL (CEL)
    (PROG (CE FORALL-RESULT FORALL-ENDPTR)
      (SETQ CE CEL)
      (COND ((NULL CE) (RETURN NIL)))
      (SETQ FORALL-RESULT
              (SETQ FORALL-ENDPTR
                      (CONS
                       ((LAMBDA (CE) (CONS (CADR CE) (CADDR CE))) (CAR CE))
                       NIL)))
     LOOPLABEL
      (SETQ CE (CDR CE))
      (COND ((NULL CE) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR
              (CONS ((LAMBDA (CE) (CONS (CADR CE) (CADDR CE))) (CAR CE)) NIL))
      (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
      (GO LOOPLABEL))) 
(PUT 'OFSF_XOPT-BACKSUB 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-BACKSUB 'DEFINED-ON-LINE '851) 
(PUT 'OFSF_XOPT-BACKSUB 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-BACKSUB 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_XOPT-BACKSUB (ANSL)
    (PROG (ANS FORALL-RESULT FORALL-ENDPTR)
      (SETQ ANS ANSL)
      (COND ((NULL ANS) (RETURN NIL)))
      (SETQ FORALL-RESULT
              (SETQ FORALL-ENDPTR
                      (CONS
                       ((LAMBDA (ANS) (OFSF_XOPT-BACKSUBANS ANS)) (CAR ANS))
                       NIL)))
     LOOPLABEL
      (SETQ ANS (CDR ANS))
      (COND ((NULL ANS) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR
              (CONS ((LAMBDA (ANS) (OFSF_XOPT-BACKSUBANS ANS)) (CAR ANS)) NIL))
      (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
      (GO LOOPLABEL))) 
(PUT 'OFSF_XOPT-BACKSUBANS 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-BACKSUBANS 'DEFINED-ON-LINE '857) 
(PUT 'OFSF_XOPT-BACKSUBANS 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-BACKSUBANS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_XOPT-BACKSUBANS (ANS) (CONS (CAR ANS) (OFSF_XOPT-BACKSUBPT (CDR ANS)))) 
(PUT 'OFSF_XOPT-BACKSUBPT 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_XOPT-BACKSUBPT 'DEFINED-ON-LINE '863) 
(PUT 'OFSF_XOPT-BACKSUBPT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFXOPT.RED) 
(PUT 'OFSF_XOPT-BACKSUBPT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_XOPT-BACKSUBPT (PT)
    (PROG (SUBL W)
      (RETURN
       (PROG (CT FORALL-RESULT FORALL-ENDPTR)
         (SETQ CT PT)
         (COND ((NULL CT) (RETURN NIL)))
         (SETQ FORALL-RESULT
                 (SETQ FORALL-ENDPTR
                         (CONS
                          ((LAMBDA (CT)
                             (PROGN
                              (SETQ W (PREPSQ (SUBSQ (SIMP (CDR CT)) SUBL)))
                              (SETQ SUBL (CONS (CONS (CAR CT) W) SUBL))
                              (CONS (CAR CT) W)))
                           (CAR CT))
                          NIL)))
        LOOPLABEL
         (SETQ CT (CDR CT))
         (COND ((NULL CT) (RETURN FORALL-RESULT)))
         (RPLACD FORALL-ENDPTR
                 (CONS
                  ((LAMBDA (CT)
                     (PROGN
                      (SETQ W (PREPSQ (SUBSQ (SIMP (CDR CT)) SUBL)))
                      (SETQ SUBL (CONS (CONS (CAR CT) W) SUBL))
                      (CONS (CAR CT) W)))
                   (CAR CT))
                  NIL))
         (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
         (GO LOOPLABEL))))) 
(ENDMODULE) 