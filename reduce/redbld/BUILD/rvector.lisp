(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'RVECTOR)) 
(FLUID '(*FASTVECTOR)) 
(GLOBAL '(CURSYM*)) 
(SWITCH (LIST 'FASTVECTOR)) 
(FLAG '(VEC*) 'VECFN) 
(PUT 'XREADVEC 'NUMBER-OF-ARGS 0) 
(PUT 'XREADVEC 'DEFINED-ON-LINE '44) 
(PUT 'XREADVEC 'DEFINED-IN-FILE 'RLISP88/RVECTOR.RED) 
(PUT 'XREADVEC 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE XREADVEC NIL
    (PROG (CURSYM DELIM LST)
      (COND ((EQ (SCAN) '*RSQBKT*) (PROGN (SCAN) (RETURN (LIST 'LIST)))))
     A
      (SETQ LST (ACONC LST (XREAD1 'GROUP)))
      (SETQ CURSYM CURSYM*)
      (SCAN)
      (COND
       ((EQ CURSYM '*RSQBKT*)
        (RETURN
         (COND ((EQ DELIM '*SEMICOL*) (CONS 'PROGN LST))
               (T (LIST 'VEC* (CONS 'LIST LST))))))
       ((NULL DELIM) (SETQ DELIM CURSYM))
       ((NOT (EQ DELIM CURSYM))
        (SYMERR "Syntax error: mixed , and ; in vector" NIL)))
      (GO A))) 
(PUT '*LSQBKT* 'STAT 'XREADVEC) 
(NEWTOK '(([) *LSQBKT*)) 
(NEWTOK '((]) *RSQBKT*)) 
(FLAG '(*RSQBKT*) 'DELIM) 
(FLAG '(*RSQBKT*) 'NODEL) 
(PUT 'FORMVECT 'NUMBER-OF-ARGS 3) 
(PUT 'FORMVECT 'DEFINED-ON-LINE '70) 
(PUT 'FORMVECT 'DEFINED-IN-FILE 'RLISP88/RVECTOR.RED) 
(PUT 'FORMVECT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMVECT (U VARS MODE) (CONS 'VEC* (CDR U))) 
(PUT 'VECT 'FORMFN 'FORMVECT) 
(PUT 'VEC* 'NUMBER-OF-ARGS 1) 
(PUT 'VEC* 'DEFINED-ON-LINE '75) 
(PUT 'VEC* 'DEFINED-IN-FILE 'RLISP88/RVECTOR.RED) 
(PUT 'VEC* 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE VEC* (U)
    (PROG (N X)
      (SETQ N (DIFFERENCE (LENGTH U) 1))
      (SETQ X (MKVECT N))
      (PROG (I)
        (SETQ I 0)
       LAB
        (COND ((MINUSP (DIFFERENCE N I)) (RETURN NIL)))
        (PROGN (PUTV X I (CAR U)) (SETQ U (CDR U)))
        (SETQ I (PLUS2 I 1))
        (GO LAB))
      (RETURN X))) 
(PUT 'GETVECT 'NUMBER-OF-ARGS 3) 
(PUT 'GETVECT 'DEFINED-ON-LINE '98) 
(PUT 'GETVECT 'DEFINED-IN-FILE 'RLISP88/RVECTOR.RED) 
(PUT 'GETVECT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE GETVECT (U VARS MODE)
    (EXPANDGETV (SYMBID (CAR U) VARS) (FORMLIS (EVALVECARG (CDR U)) VARS MODE))) 
(PUT 'EXPANDGETV 'NUMBER-OF-ARGS 2) 
(PUT 'EXPANDGETV 'DEFINED-ON-LINE '101) 
(PUT 'EXPANDGETV 'DEFINED-IN-FILE 'RLISP88/RVECTOR.RED) 
(PUT 'EXPANDGETV 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE EXPANDGETV (U V)
    (COND ((NULL V) U)
          (T
           (EXPANDGETV (LIST (COND (*FASTVECTOR 'IGETV) (T 'GETV)) U (CAR V))
            (CDR V))))) 
(PUT 'PUTVECT 'NUMBER-OF-ARGS 3) 
(PUT 'PUTVECT 'DEFINED-ON-LINE '107) 
(PUT 'PUTVECT 'DEFINED-IN-FILE 'RLISP88/RVECTOR.RED) 
(PUT 'PUTVECT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE PUTVECT (U VARS MODE)
    (EXPANDPUTV (SYMBID (CAAR U) VARS)
     (FORMLIS (EVALVECARG (CDAR U)) VARS MODE) (FORM1 (CADR U) VARS MODE))) 
(PUT 'EXPANDPUTV 'NUMBER-OF-ARGS 3) 
(PUT 'EXPANDPUTV 'DEFINED-ON-LINE '111) 
(PUT 'EXPANDPUTV 'DEFINED-IN-FILE 'RLISP88/RVECTOR.RED) 
(PUT 'EXPANDPUTV 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE EXPANDPUTV (U V W)
    (COND
     ((NULL (CDR V)) (LIST (COND (*FASTVECTOR 'IPUTV) (T 'PUTV)) U (CAR V) W))
     (T
      (EXPANDPUTV (LIST (COND (*FASTVECTOR 'IGETV) (T 'GETV)) U (CAR V))
       (CDR V) W)))) 
(PUT 'EVALVECARG 'NUMBER-OF-ARGS 1) 
(PUT 'EVALVECARG 'DEFINED-ON-LINE '118) 
(PUT 'EVALVECARG 'DEFINED-IN-FILE 'RLISP88/RVECTOR.RED) 
(PUT 'EVALVECARG 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE EVALVECARG (U)
    (COND
     ((AND U (NULL (CDR U)) (EQCAR (CAR U) 'VEC*) (EQCAR (CADAR U) 'LIST))
      (CDADAR U))
     (T U))) 
(PUT 'MKAR1 'NUMBER-OF-ARGS 1) 
(PUT 'MKAR1 'DEFINED-ON-LINE '128) 
(PUT 'MKAR1 'DEFINED-IN-FILE 'RLISP88/RVECTOR.RED) 
(PUT 'MKAR1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MKAR1 (U)
    (PROG (X)
      (SETQ X (MKVECT (CAR U)))
      (COND
       ((CDR U)
        (PROG (I)
          (SETQ I 0)
         LAB
          (COND ((MINUSP (DIFFERENCE (UPBV X) I)) (RETURN NIL)))
          (PUTV X I (MKAR1 (CDR U)))
          (SETQ I (PLUS2 I 1))
          (GO LAB))))
      (RETURN X))) 
(PUT 'ARRAY 'DEFINED-ON-LINE '135) 
(PUT 'ARRAY 'DEFINED-IN-FILE 'RLISP88/RVECTOR.RED) 
(PUT 'ARRAY 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DM ARRAY (U) (LIST 'VEC* (CONS 'LIST (CDR U)))) 
(ENDMODULE) 