(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'RESET)) 
(CREATE-PACKAGE '(RESET) '(CONTRIB MISC)) 
(GLOBAL '(*ASTERISK *DFPRINT INPUTBUFLIS* STATCOUNTER SWITCHLIST*)) 
(FLUID '(*FORTUPPER *HORNER *LIST *NOARG *NOSPLIT *RATPRI *REVPRI WTL*)) 
(PUT 'ALLBRANCH 'SWITCHDEFAULT T) 
(PUT 'ALLFAC 'SWITCHDEFAULT T) 
(PUT 'ANYGCD 'SWITCHDEFAULT T) 
(PUT 'ARBVARS 'SWITCHDEFAULT T) 
(PUT 'ASTERISK 'SWITCHDEFAULT T) 
(PUT 'EVALLHSEQP 'SWITCHDEFAULT T) 
(PUT 'EXP 'SWITCHDEFAULT T) 
(PUT 'EXPANDEXPT 'SWITCHDEFAULT T) 
(PUT 'FULLTRACE 'SWITCHDEFAULT T) 
(PUT 'INT 'SWITCHDEFAULT T) 
(PUT 'LCM 'SWITCHDEFAULT T) 
(PUT 'MCD 'SWITCHDEFAULT T) 
(PUT 'MSG 'SWITCHDEFAULT T) 
(PUT 'NAT 'SWITCHDEFAULT T) 
(PUT 'NOARG 'SWITCHDEFAULT T) 
(PUT 'NOSPLIT 'SWITCHDEFAULT T) 
(PUT 'NUMVAL 'SWITCHDEFAULT T) 
(PUT 'OUTPUT 'SWITCHDEFAULT T) 
(PUT 'PERIOD 'SWITCHDEFAULT T) 
(PUT 'PRECISE 'SWITCHDEFAULT T) 
(PUT 'PREPHOLD 'SWITCHDEFAULT T) 
(PUT 'PRI 'SWITCHDEFAULT T) 
(PUT 'QUOTENEWNAM 'SWITCHDEFAULT T) 
(PUT 'RATPRI 'SWITCHDEFAULT T) 
(PUT 'REVALP 'SWITCHDEFAULT T) 
(PUT 'ROUNDALL 'SWITCHDEFAULT T) 
(PUT 'SOLVESINGULAR 'SWITCHDEFAULT T) 
(PUT 'VAROPT 'SWITCHDEFAULT T) 
(PUT 'ONESPACE 'SWITCHDEFAULT T) 
(PUT 'FACTORPRIMES 'SWITCHDEFAULT T) 
(PUT 'RED_TOTAL 'SWITCHDEFAULT T) 
(PUT 'BCSIMP 'SWITCHDEFAULT T) 
(PUT 'NOETHERIAN 'SWITCHDEFAULT T) 
(PUT 'CGBFULLRED 'SWITCHDEFAULT T) 
(PUT 'TDUSETORDER 'SWITCHDEFAULT T) 
(PUT 'CLPRLVERBOSE 'SWITCHDEFAULT T) 
(PUT 'CLPRLPROJECT 'SWITCHDEFAULT T) 
(PUT 'PRFOURMAT 'SWITCHDEFAULT T) 
(PUT 'TWOGRID 'SWITCHDEFAULT T) 
(PUT 'FULLEQ 'SWITCHDEFAULT T) 
(PUT 'CENTERGRID 'SWITCHDEFAULT T) 
(PUT 'GCREFALL 'SWITCHDEFAULT T) 
(PUT 'GENDECS 'SWITCHDEFAULT T) 
(PUT 'GENTRANSEG 'SWITCHDEFAULT T) 
(PUT 'MAKECALLS 'SWITCHDEFAULT T) 
(PUT 'DOUBLE 'SWITCHDEFAULT T) 
(PUT 'GUARDIAN 'SWITCHDEFAULT T) 
(PUT 'GDQE 'SWITCHDEFAULT T) 
(PUT 'GDMART 'SWITCHDEFAULT T) 
(PUT 'MYMATCH 'SWITCHDEFAULT T) 
(PUT 'LPDODF 'SWITCHDEFAULT T) 
(PUT 'LPDOCOEFFNORM 'SWITCHDEFAULT T) 
(PUT 'LASIMP 'SWITCHDEFAULT T) 
(PUT 'SEMANTIC 'SWITCHDEFAULT T) 
(PUT 'RLKAPURSPLITEQUIV 'SWITCHDEFAULT T) 
(PUT 'RLKAPURMULTIMON 'SWITCHDEFAULT T) 
(PUT 'DQEVERBOSE 'SWITCHDEFAULT T) 
(PUT 'DQEGRADORD 'SWITCHDEFAULT T) 
(PUT 'DQEOPTQELIM 'SWITCHDEFAULT T) 
(PUT 'DQEOPTSIMP 'SWITCHDEFAULT T) 
(PUT 'RLPCPRINTALL 'SWITCHDEFAULT T) 
(PUT 'RLMRIVB 'SWITCHDEFAULT T) 
(PUT 'RLSIMPLFLOOR 'SWITCHDEFAULT T) 
(PUT 'RLPASFBAPPROX 'SWITCHDEFAULT T) 
(PUT 'RLPASFGAUSS 'SWITCHDEFAULT T) 
(PUT 'RLPASFGC 'SWITCHDEFAULT T) 
(PUT 'RLPASFSC 'SWITCHDEFAULT T) 
(PUT 'RLPASFSES 'SWITCHDEFAULT T) 
(PUT 'RLPASFCONF 'SWITCHDEFAULT T) 
(PUT 'RLQESUBI 'SWITCHDEFAULT T) 
(PUT 'RLQEPNF 'SWITCHDEFAULT T) 
(PUT 'USEOLD 'SWITCHDEFAULT T) 
(PUT 'USEZ 'SWITCHDEFAULT T) 
(PUT 'RLCADMC3 'SWITCHDEFAULT T) 
(PUT 'RLPSCSGEN 'SWITCHDEFAULT T) 
(PUT 'RLCADTV 'SWITCHDEFAULT T) 
(PUT 'RLCADRMWC 'SWITCHDEFAULT T) 
(PUT 'RLQEFBSLFQ 'SWITCHDEFAULT T) 
(PUT 'PSEN 'SWITCHDEFAULT T) 
(PUT 'SFTO_YUN 'SWITCHDEFAULT T) 
(PUT 'RLSETEQUALQHASH 'SWITCHDEFAULT T) 
(PUT 'TALPQEGAUSS 'SWITCHDEFAULT T) 
(PUT 'TALPQP 'SWITCHDEFAULT T) 
(PUT 'RLBROP 'SWITCHDEFAULT T) 
(PUT 'RLBNFSAC 'SWITCHDEFAULT T) 
(PUT 'RLQEPNF 'SWITCHDEFAULT T) 
(PUT 'RLSISO 'SWITCHDEFAULT T) 
(PUT 'RLSIIDEM 'SWITCHDEFAULT T) 
(PUT 'RLSICHK 'SWITCHDEFAULT T) 
(PUT 'RLSISM 'SWITCHDEFAULT T) 
(PUT 'RLSIPO 'SWITCHDEFAULT T) 
(PUT 'RLTABIB 'SWITCHDEFAULT T) 
(PUT 'RLGSSUB 'SWITCHDEFAULT T) 
(PUT 'RLGSRAD 'SWITCHDEFAULT T) 
(PUT 'RLGSRED 'SWITCHDEFAULT T) 
(PUT 'RLFSERF 'SWITCHDEFAULT T) 
(PUT 'RLGSVB 'SWITCHDEFAULT T) 
(PUT 'RLSIATADV 'SWITCHDEFAULT T) 
(PUT 'RLSIPD 'SWITCHDEFAULT T) 
(PUT 'RLSIEXPL 'SWITCHDEFAULT T) 
(PUT 'RLSIEXPLA 'SWITCHDEFAULT T) 
(PUT 'RLSIFAC 'SWITCHDEFAULT T) 
(PUT 'RLQEHEU 'SWITCHDEFAULT T) 
(PUT 'RLDAVGCD 'SWITCHDEFAULT T) 
(PUT 'RLSITSQSPL 'SWITCHDEFAULT T) 
(PUT 'RLGSBNF 'SWITCHDEFAULT T) 
(PUT 'RLQEGENCT 'SWITCHDEFAULT T) 
(PUT 'RLTNFT 'SWITCHDEFAULT T) 
(PUT 'RLQEVARSEL 'SWITCHDEFAULT T) 
(PUT 'RLSUSIMULT 'SWITCHDEFAULT T) 
(PUT 'RLSUSIADD 'SWITCHDEFAULT T) 
(PUT 'RLCADFAC 'SWITCHDEFAULT T) 
(PUT 'RLCADDNFFORMULA 'SWITCHDEFAULT T) 
(PUT 'RLCADVERBOSE 'SWITCHDEFAULT T) 
(PUT 'RLCADFASTEVAL 'SWITCHDEFAULT T) 
(PUT 'RLCADPARTIAL 'SWITCHDEFAULT T) 
(PUT 'RLCADTRIMTREE 'SWITCHDEFAULT T) 
(PUT 'RLCADHONGPROJ 'SWITCHDEFAULT T) 
(PUT 'RLANUEXDIFFERENTROOLS 'SWITCHDEFAULT T) 
(PUT 'RLANUEXGCDNORMALIZE 'SWITCHDEFAULT T) 
(PUT 'RLCADTE 'SWITCHDEFAULT T) 
(PUT 'RLCADPBFVS 'SWITCHDEFAULT T) 
(PUT 'RLQEFB 'SWITCHDEFAULT T) 
(PUT 'RLXOPT 'SWITCHDEFAULT T) 
(PUT 'RLXOPTSB 'SWITCHDEFAULT T) 
(PUT 'RLXOPTPL 'SWITCHDEFAULT T) 
(PUT 'RLXOPTRI 'SWITCHDEFAULT T) 
(PUT 'RLXOPTSES 'SWITCHDEFAULT T) 
(PUT 'RLHQETFCSPLIT 'SWITCHDEFAULT T) 
(PUT 'RLHQEVARSEL 'SWITCHDEFAULT T) 
(PUT 'RLHQEVARSELX 'SWITCHDEFAULT T) 
(PUT 'RLHQETHEORY 'SWITCHDEFAULT T) 
(PUT 'RLHQESTRCONST 'SWITCHDEFAULT T) 
(PUT 'RLHQEGBDIMMIN 'SWITCHDEFAULT T) 
(PUT 'RLRESI 'SWITCHDEFAULT T) 
(PUT 'RLQEASRI 'SWITCHDEFAULT T) 
(PUT 'RLQEFILTERBOUNDS 'SWITCHDEFAULT T) 
(PUT 'RLSID 'SWITCHDEFAULT T) 
(PUT 'RLSIPLUGTHEO 'SWITCHDEFAULT T) 
(PUT 'RLENFFACNE 'SWITCHDEFAULT T) 
(PUT 'RLPLSIMPL 'SWITCHDEFAULT T) 
(PUT 'RLSMPRINT 'SWITCHDEFAULT T) 
(PUT 'FTCH 'SWITCHDEFAULT T) 
(PUT 'ALGPRI 'SWITCHDEFAULT T) 
(PUT 'UTF8 'SWITCHDEFAULT T) 
(PUT 'UTF82D 'SWITCHDEFAULT T) 
(PUT 'UTF82DROUND 'SWITCHDEFAULT T) 
(PUT 'UTF8EXPALL 'SWITCHDEFAULT T) 
(PUT 'UTF8DIFFQUOT 'SWITCHDEFAULT T) 
(PUT 'UTF8PAD 'SWITCHDEFAULT T) 
(PUT 'XFULLREDUCE 'SWITCHDEFAULT T) 
(PUT 'RESETREDUCE 'NUMBER-OF-ARGS 0) 
(PUT 'RESETREDUCE 'DEFINED-ON-LINE '248) 
(PUT 'RESETREDUCE 'DEFINED-IN-FILE 'MISC/RESET.RED) 
(PUT 'RESETREDUCE 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE RESETREDUCE NIL
    (PROG (MODE STATNO COMM)
      (PROG (SW)
        (SETQ SW SWITCHLIST*)
       LAB
        (COND ((NULL SW) (RETURN NIL)))
        ((LAMBDA (SW) (ONOFF-RESET SW)) (CAR SW))
        (SETQ SW (CDR SW))
        (GO LAB))
      (PROG (STAT)
        (SETQ STAT INPUTBUFLIS*)
       LAB
        (COND ((NULL STAT) (RETURN NIL)))
        ((LAMBDA (STAT)
           (PROGN
            (SETQ STATNO (CAR STAT))
            (SETQ MODE (CADR STAT))
            (SETQ COMM (CADDR STAT))
            (COND ((NOT (ATOM COMM)) (RESET-UNDO COMM MODE)))))
         (CAR STAT))
        (SETQ STAT (CDR STAT))
        (GO LAB))
      (SETQ INPUTBUFLIS* NIL)
      (SETQ STATCOUNTER 0))) 
(PUT 'RESET-UNDO 'NUMBER-OF-ARGS 2) 
(PUT 'RESET-UNDO 'DEFINED-ON-LINE '269) 
(PUT 'RESET-UNDO 'DEFINED-IN-FILE 'MISC/RESET.RED) 
(PUT 'RESET-UNDO 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE RESET-UNDO (COMM MODE)
    (COND
     ((EQ (CAR COMM) 'PROGN)
      (PROG (Y)
        (SETQ Y (CDR COMM))
       LAB
        (COND ((NULL Y) (RETURN NIL)))
        ((LAMBDA (Y) (RESET-UNDO Y MODE)) (CAR Y))
        (SETQ Y (CDR Y))
        (GO LAB)))
     ((EQ (CAR COMM) 'PROG)
      (PROG (Y)
        (SETQ Y (CDDR COMM))
       LAB
        (COND ((NULL Y) (RETURN NIL)))
        ((LAMBDA (Y) (RESET-UNDO Y MODE)) (CAR Y))
        (SETQ Y (CDR Y))
        (GO LAB)))
     ((EQ (CAR COMM) 'GO) NIL)
     ((EQ (CAR COMM) 'COND)
      (PROG (Y)
        (SETQ Y (CDR COMM))
       LAB
        (COND ((NULL Y) (RETURN NIL)))
        ((LAMBDA (Y)
           (PROGN (RESET-UNDO (CAR COMM) MODE) (RESET-UNDO (CADR COMM) MODE)))
         (CAR Y))
        (SETQ Y (CDR Y))
        (GO LAB)))
     ((MEMQ (CAR COMM) '(WHILE REPEAT))
      (PROGN (RESET-UNDO (CADR COMM) MODE) (RESET-UNDO (CADDR COMM) MODE)))
     ((EQ (CAR COMM) 'FLAG) (LISPEVAL (CONS 'REMFLAG (CDR COMM))))
     ((EQ (CAR COMM) 'PUT) (LISPEVAL (LIST 'REMPROP (CADR COMM) (CADDR COMM))))
     ((EQ (CAR COMM) 'ARRAYFN)
      (PROG (Y)
        (SETQ Y (CDADDR COMM))
       LAB
        (COND ((NULL Y) (RETURN NIL)))
        ((LAMBDA (Y)
           (PROGN
            (REMPROP (CADADR Y) 'DIMENSION)
            (REMPROP (CADADR Y) 'RVALUE)
            (REMPROP (CADADR Y) 'RTYPE)))
         (CAR Y))
        (SETQ Y (CDR Y))
        (GO LAB)))
     ((EQ (CAR COMM) 'SETEL) (SETEL (LISPEVAL (CADR COMM)) 0))
     ((EQUAL MODE 'ALGEBRAIC) (ALGRESET COMM))
     ((EQUAL MODE 'SYMBOLIC) (SYMBRESET COMM)))) 
(PUT 'ALGRESET 'NUMBER-OF-ARGS 1) 
(PUT 'ALGRESET 'DEFINED-ON-LINE '291) 
(PUT 'ALGRESET 'DEFINED-IN-FILE 'MISC/RESET.RED) 
(PUT 'ALGRESET 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ALGRESET (COMM)
    (PROG (FORALLFN)
      (COND ((ATOM COMM) (RETURN NIL)))
      (SETQ FORALLFN 'FORALL)
      (COND
       ((EQ (CAR COMM) 'SETK)
        (COND ((IDP (CADADR COMM)) (REMPROP (CADADR COMM) 'AVALUE))
              (T (LISPEVAL (CONS 'CLEAR (LIST (CADR COMM)))))))
       ((EQ (CAR COMM) 'SETQ) NIL) ((EQ (CAR COMM) 'SETQ) NIL)
       ((EQ (CAR COMM) 'DE) (REMD (CADR COMM)))
       ((EQ (CAR COMM) 'LET)
        (PROG (XX)
          (SETQ XX (CDADR COMM))
         LAB
          (COND ((NULL XX) (RETURN NIL)))
          ((LAMBDA (XX) (CLEAR (LIST (CAR (CDADDR XX))))) (CAR XX))
          (SETQ XX (CDR XX))
          (GO LAB)))
       ((EQ (CAR COMM) 'CLEAR) NIL)
       ((EQ (CAR COMM) 'ASSGNPRI) (ALGRESET (CADR COMM)))
       ((EQ (CAR COMM) 'INFIX)
        (PROG (XX)
          (SETQ XX (CDR (CADR COMM)))
         LAB
          (COND ((NULL XX) (RETURN NIL)))
          ((LAMBDA (XX)
             (PROGN (REMPROP XX 'INFIX) (REMPROP XX 'OP) (REMPROP XX 'SIMPFN)))
           (CAR XX))
          (SETQ XX (CDR XX))
          (GO LAB)))
       ((EQ (CAR COMM) 'WTLEVEL) (WTLEVEL (LIST 1)))
       ((EQ (CAR COMM) 'WEIGHT)
        (PROG (XX)
          (SETQ XX (CDR (CADR COMM)))
         LAB
          (COND ((NULL XX) (RETURN NIL)))
          ((LAMBDA (XX)
             (SETQ WTL* (DELASC (*A2KWOWEIGHT (CADR (LISPEVAL XX))) WTL*)))
           (CAR XX))
          (SETQ XX (CDR XX))
          (GO LAB)))))) 
(PUT 'SYMBRESET 'NUMBER-OF-ARGS 1) 
(PUT 'SYMBRESET 'DEFINED-ON-LINE '317) 
(PUT 'SYMBRESET 'DEFINED-IN-FILE 'MISC/RESET.RED) 
(PUT 'SYMBRESET 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SYMBRESET (COMM)
    (COND ((ATOM COMM) NIL)
          (T
           (PROGN
            (COND ((EQ (CAR COMM) 'SETQ) (SET (CADR COMM) NIL))
                  ((EQ (CAR COMM) 'DE) (REMD (CADR COMM)))
                  ((EQ (CAR COMM) 'DEFINE)
                   (PROG (XX)
                     (SETQ XX (CDR (CADR COMM)))
                    LAB
                     (COND ((NULL XX) (RETURN NIL)))
                     ((LAMBDA (XX) (REMPROP (CADR (CADDR XX)) 'NEWNAM))
                      (CAR XX))
                     (SETQ XX (CDR XX))
                     (GO LAB)))
                  ((EQ (CAR COMM) 'SWITCH)
                   (PROG (XX)
                     (SETQ XX (CDR (CADR COMM)))
                    LAB
                     (COND ((NULL XX) (RETURN NIL)))
                     ((LAMBDA (XX)
                        (COND
                         ((EQUAL (CAR XX) 'LIST)
                          (PROGN
                           (REMFLAG (CADR (CADDR XX)) 'SWITCH)
                           (REMPROP (CADR (CADDR XX)) 'SWITCHDEFAULT)))
                         (T (REMFLAG (CADR XX) 'SWITCH))))
                      (CAR XX))
                     (SETQ XX (CDR XX))
                     (GO LAB)))
                  ((EQ (CAR COMM) 'MATRIX)
                   (PROG (XX)
                     (SETQ XX (CDR (CADR COMM)))
                    LAB
                     (COND ((NULL XX) (RETURN NIL)))
                     ((LAMBDA (XX) (CLEAR (LIST (CADR (CADR XX))))) (CAR XX))
                     (SETQ XX (CDR XX))
                     (GO LAB)))
                  ((EQ (CAR COMM) 'OPERATOR)
                   (PROG (XX)
                     (SETQ XX (CDR (CADR COMM)))
                    LAB
                     (COND ((NULL XX) (RETURN NIL)))
                     ((LAMBDA (XX) (REMPROP (CADR XX) 'SIMPFN)) (CAR XX))
                     (SETQ XX (CDR XX))
                     (GO LAB)))
                  ((EQ (CAR COMM) 'SHARE)
                   (PROG (XX)
                     (SETQ XX (CDR (CADR COMM)))
                    LAB
                     (COND ((NULL XX) (RETURN NIL)))
                     ((LAMBDA (XX) (REMFLAG (LIST XX) 'SHARE)) (CAR XX))
                     (SETQ XX (CDR XX))
                     (GO LAB)))
                  ((EQ (CAR COMM) 'INFIX)
                   (PROG (XX)
                     (SETQ XX (CDR (CADR COMM)))
                    LAB
                     (COND ((NULL XX) (RETURN NIL)))
                     ((LAMBDA (XX)
                        (PROGN (REMPROP XX 'INFIX) (REMPROP XX 'OP)))
                      (CAR XX))
                     (SETQ XX (CDR XX))
                     (GO LAB)))
                  ((EQ (CAR COMM) 'PRECEDENCE)
                   (PROG (XX)
                     (SETQ XX (CDR (CADR COMM)))
                    LAB
                     (COND ((NULL XX) (RETURN NIL)))
                     ((LAMBDA (XX) (REMPROP XX 'OP)) (CAR XX))
                     (SETQ XX (CDR XX))
                     (GO LAB)))
                  ((EQ (CAR COMM) 'DEPEND)
                   (LISPEVAL (CONS 'NODEPEND (CDR COMM))))
                  ((AND (EQ (CAR COMM) 'FORALL)
                        (MEMQ (CAADR (CADDDR (CADR COMM))) '(LET SAVEAS)))
                   (PROG (XX)
                     (SETQ XX (CDADR (CADDDR (CADR COMM))))
                    LAB
                     (COND ((NULL XX) (RETURN NIL)))
                     ((LAMBDA (XX)
                        (FORALLFN
                         (LIST (CADR (CADADR COMM)) (CADR (CADR (CDADR COMM)))
                               (LIST 'CLEAR (LIST 'LIST (CADDR (CADR XX)))))))
                      (CAR XX))
                     (SETQ XX (CDR XX))
                     (GO LAB)))
                  ((EQ (CAR COMM) 'SAVEAS)
                   (LISPEVAL (CONS 'CLEAR (CDR COMM))))))))) 
(PUT 'RESETREDUCE 'STAT 'ENDSTAT) 
(ENDMODULE) 