(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'DISTRIB)) 
(FLUID '(INDEXLIST SQRTLIST ZLIST)) 
(EXPORTS
 (LIST 'DF2PRINTFORM 'MULTBYARBPOWERS 'NEGDF 'QUOTDFCONST 'SUB1IND 'VP1 'VP2
       'PLUSDF 'MULTDF 'MULTDFCONST 'ORDDF)) 
(IMPORTS
 (LIST 'INTERR 'ADDSQ 'NEGSQ 'EXPTSQ 'SIMP 'DOMAINP 'MK*SQ 'ADDF 'MULTSQ 'INVSQ
       'MINUSP 'MKSP 'SUB1)) 
(PUT 'PLUSDF 'NUMBER-OF-ARGS 2) 
(PUT 'PLUSDF 'DEFINED-ON-LINE '51) 
(PUT 'PLUSDF 'DEFINED-IN-FILE 'INT/DISTRIB.RED) 
(PUT 'PLUSDF 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE PLUSDF (U V)
    (COND ((NULL U) V) ((NULL V) U)
          ((EQUAL (CAAR U) (CAAR V))
           ((LAMBDA (X Y)
              (COND ((NULL (CAR X)) Y) (T (CONS (CONS (CAAR U) X) Y))))
            (*ADDSQ (CDAR U) (CDAR V)) (PLUSDF (CDR U) (CDR V))))
          ((ORDDF (CAAR U) (CAAR V)) (CONS (CAR U) (PLUSDF (CDR U) V)))
          (T (CONS (CAR V) (PLUSDF U (CDR V)))))) 
(PUT 'ORDDF 'NUMBER-OF-ARGS 2) 
(PUT 'ORDDF 'DEFINED-ON-LINE '61) 
(PUT 'ORDDF 'DEFINED-IN-FILE 'INT/DISTRIB.RED) 
(PUT 'ORDDF 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE ORDDF (U V)
    (COND
     ((NULL U)
      (COND ((NULL V) (INTERR "Orddf = case"))
            (T (INTERR "Orddf v longer than u"))))
     ((NULL V) (INTERR "Orddf u longer than v"))
     ((EXPTCOMPARE (CAR U) (CAR V)) T) ((EXPTCOMPARE (CAR V) (CAR U)) NIL)
     (T (ORDDF (CDR U) (CDR V))))) 
(PUT 'EXPTCOMPARE 'NUMBER-OF-ARGS 2) 
(PUT 'EXPTCOMPARE 'DEFINED-ON-LINE '71) 
(PUT 'EXPTCOMPARE 'DEFINED-IN-FILE 'INT/DISTRIB.RED) 
(PUT 'EXPTCOMPARE 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE EXPTCOMPARE (X Y)
    (COND ((ATOM X) (COND ((ATOM Y) (GREATERP X Y)) (T NIL))) ((ATOM Y) T)
          (T (GREATERP (CAR X) (CAR Y))))) 
(PUT 'NEGDF 'NUMBER-OF-ARGS 1) 
(PUT 'NEGDF 'DEFINED-ON-LINE '76) 
(PUT 'NEGDF 'DEFINED-IN-FILE 'INT/DISTRIB.RED) 
(PUT 'NEGDF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE NEGDF (U)
    (COND ((NULL U) NIL)
          (T (CONS (CONS (CAAR U) (NEGSQ (CDAR U))) (NEGDF (CDR U)))))) 
(PUT 'MULTDF 'NUMBER-OF-ARGS 2) 
(PUT 'MULTDF 'DEFINED-ON-LINE '80) 
(PUT 'MULTDF 'DEFINED-IN-FILE 'INT/DISTRIB.RED) 
(PUT 'MULTDF 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MULTDF (U V)
    (COND ((OR (NULL U) (NULL V)) NIL)
          (T
           (PROG (Y)
             (SETQ Y (MULTERM (CAR U) (CAR V)))
             (SETQ Y (PLUSDF Y (MULTDF (CDR U) V)))
             (SETQ Y (PLUSDF Y (MULTDF (CONS (CAR U) NIL) (CDR V))))
             (RETURN Y))))) 
(PUT 'MULTERM 'NUMBER-OF-ARGS 2) 
(PUT 'MULTERM 'DEFINED-ON-LINE '92) 
(PUT 'MULTERM 'DEFINED-IN-FILE 'INT/DISTRIB.RED) 
(PUT 'MULTERM 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MULTERM (U V)
    (PROG (COEF)
      (SETQ COEF (*MULTSQ (CDR U) (CDR V)))
      (RETURN (MULTDFCONST COEF (MULPOWER (CAR U) (CAR V)))))) 
(PUT 'MULPOWER 'NUMBER-OF-ARGS 2) 
(PUT 'MULPOWER 'DEFINED-ON-LINE '99) 
(PUT 'MULPOWER 'DEFINED-IN-FILE 'INT/DISTRIB.RED) 
(PUT 'MULPOWER 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MULPOWER (U V)
    (PROG (R S)
      (SETQ R (ADDEXPTSDF U V))
      (COND ((NOT (NULL SQRTLIST)) (SETQ S (REDUCEROOTS R ZLIST))))
      (SETQ R (CONS (CONS R (CONS 1 1)) NIL))
      (COND ((NOT (EQUAL S NIL)) (SETQ R (MULTDF R S))))
      (RETURN R))) 
(PUT 'REDUCEROOTS 'NUMBER-OF-ARGS 2) 
(PUT 'REDUCEROOTS 'DEFINED-ON-LINE '109) 
(PUT 'REDUCEROOTS 'DEFINED-IN-FILE 'INT/DISTRIB.RED) 
(PUT 'REDUCEROOTS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE REDUCEROOTS (R ZL)
    (PROG (S)
      (PROG ()
       WHILELABEL
        (COND ((NOT (NOT (NULL R))) (RETURN NIL)))
        (PROGN
         (COND ((EQCAR (CAR ZL) 'SQRT) (SETQ S (TRYREDUCTION R (CAR ZL) S))))
         (SETQ R (CDR R))
         (SETQ ZL (CDR ZL)))
        (GO WHILELABEL))
      (RETURN S))) 
(PUT 'TRYREDUCTION 'NUMBER-OF-ARGS 3) 
(PUT 'TRYREDUCTION 'DEFINED-ON-LINE '118) 
(PUT 'TRYREDUCTION 'DEFINED-IN-FILE 'INT/DISTRIB.RED) 
(PUT 'TRYREDUCTION 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE TRYREDUCTION (R VAR S)
    (PROG (X)
      (SETQ X (CAR R))
      (COND ((NOT (ATOM X)) (PROGN (SETQ R X) (SETQ X (CAR R)))))
      (COND ((OR (EQUAL X 0) (EQUAL X 1)) (RETURN S)))
      (SETQ X (DIVIDE X 2))
      (RPLACA R (CDR X))
      (SETQ X (CAR X))
      (SETQ VAR (SIMP (CADR VAR)))
      (SETQ VAR (*EXPTSQ VAR X))
      (SETQ X (MULTDFCONST (CONS 1 (CDR VAR)) (F2DF (CAR VAR))))
      (COND ((EQUAL S NIL) (SETQ S X)) (T (SETQ S (MULTDF S X))))
      (RETURN S))) 
(PUT 'ADDEXPTSDF 'NUMBER-OF-ARGS 2) 
(PUT 'ADDEXPTSDF 'DEFINED-ON-LINE '136) 
(PUT 'ADDEXPTSDF 'DEFINED-IN-FILE 'INT/DISTRIB.RED) 
(PUT 'ADDEXPTSDF 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE ADDEXPTSDF (X Y)
    (COND ((NULL X) (COND ((NULL Y) NIL) (T (INTERR "X too long"))))
          ((NULL Y) (INTERR "Y too long"))
          (T (CONS (EXPTPLUS (CAR X) (CAR Y)) (ADDEXPTSDF (CDR X) (CDR Y)))))) 
(PUT 'EXPTPLUS 'NUMBER-OF-ARGS 2) 
(PUT 'EXPTPLUS 'DEFINED-ON-LINE '142) 
(PUT 'EXPTPLUS 'DEFINED-IN-FILE 'INT/DISTRIB.RED) 
(PUT 'EXPTPLUS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE EXPTPLUS (X Y)
    (COND ((ATOM X) (COND ((ATOM Y) (PLUS X Y)) (T (LIST (PLUS X (CAR Y))))))
          ((ATOM Y) (LIST (PLUS (CAR X) Y))) (T (INTERR "Bad exponent sum")))) 
(PUT 'MULTDFCONST 'NUMBER-OF-ARGS 2) 
(PUT 'MULTDFCONST 'DEFINED-ON-LINE '147) 
(PUT 'MULTDFCONST 'DEFINED-IN-FILE 'INT/DISTRIB.RED) 
(PUT 'MULTDFCONST 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MULTDFCONST (X U)
    (COND ((OR (NULL U) (NULL (CAR X))) NIL)
          (T
           (CONS (CONS (CAAR U) (SUBS2Q (MULTSQ X (CDAR U))))
                 (MULTDFCONST X (CDR U)))))) 
(PUT 'F2DF 'NUMBER-OF-ARGS 1) 
(PUT 'F2DF 'DEFINED-ON-LINE '159) 
(PUT 'F2DF 'DEFINED-IN-FILE 'INT/DISTRIB.RED) 
(PUT 'F2DF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE F2DF (P)
    (COND ((OR (ATOM P) (ATOM (CAR P))) (DFCONST (CONS P 1)))
          ((MEMBER (CAAAR P) ZLIST)
           (PLUSDF
            (MULTDF (VP2DF (CAAAR P) (CDAR (CAR P)) ZLIST) (F2DF (CDAR P)))
            (F2DF (CDR P))))
          (T
           (PLUSDF
            (MULTDFCONST (CONS (CONS (CONS (CAAR P) 1) NIL) 1) (F2DF (CDAR P)))
            (F2DF (CDR P)))))) 
(PUT 'VP1 'NUMBER-OF-ARGS 3) 
(PUT 'VP1 'DEFINED-ON-LINE '171) 
(PUT 'VP1 'DEFINED-IN-FILE 'INT/DISTRIB.RED) 
(PUT 'VP1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE VP1 (VAR DEGG Z)
    (COND ((NULL Z) (INTERR "Var not in z-list after all"))
          ((EQUAL VAR (CAR Z)) (CONS DEGG (VP2 (CDR Z))))
          (T (CONS 0 (VP1 VAR DEGG (CDR Z)))))) 
(PUT 'VP2 'NUMBER-OF-ARGS 1) 
(PUT 'VP2 'DEFINED-ON-LINE '178) 
(PUT 'VP2 'DEFINED-IN-FILE 'INT/DISTRIB.RED) 
(PUT 'VP2 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE VP2 (Z) (COND ((NULL Z) NIL) (T (CONS 0 (VP2 (CDR Z)))))) 
(PUT 'VP2DF 'NUMBER-OF-ARGS 3) 
(PUT 'VP2DF 'DEFINED-ON-LINE '183) 
(PUT 'VP2DF 'DEFINED-IN-FILE 'INT/DISTRIB.RED) 
(PUT 'VP2DF 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE VP2DF (VAR EXPRN Z)
    (COND
     ((AND (EQCAR VAR 'SQRT) (GREATERP EXPRN 1))
      (MULPOWER (VP1 VAR EXPRN Z) (VP2 Z)))
     (T (CONS (CONS (VP1 VAR EXPRN Z) (CONS 1 1)) NIL)))) 
(PUT 'DFCONST 'NUMBER-OF-ARGS 1) 
(PUT 'DFCONST 'DEFINED-ON-LINE '190) 
(PUT 'DFCONST 'DEFINED-IN-FILE 'INT/DISTRIB.RED) 
(PUT 'DFCONST 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DFCONST (Q)
    (COND ((EQUAL (CAR Q) NIL) NIL) (T (CONS (CONS (VP2 ZLIST) Q) NIL)))) 
(PUT 'DF2PRINTFORM 'NUMBER-OF-ARGS 1) 
(PUT 'DF2PRINTFORM 'DEFINED-ON-LINE '197) 
(PUT 'DF2PRINTFORM 'DEFINED-IN-FILE 'INT/DISTRIB.RED) 
(PUT 'DF2PRINTFORM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DF2PRINTFORM (P)
    (COND ((NULL P) NIL)
          (T
           (PROG (MV CO)
             (SETQ MV (XL2Q (CAAR P) ZLIST INDEXLIST))
             (COND
              ((EQUAL MV (CONS 1 1))
               (PROGN
                (SETQ CO (CDAR P))
                (COND
                 ((EQUAL (CDR CO) 1)
                  (RETURN (ADDF (CAR CO) (DF2PRINTFORM (CDR P))))))
                (SETQ CO (GETPOWER (FKERN (MK*SQ CO)) 1))
                (RETURN (CONS (CONS CO 1) (DF2PRINTFORM (CDR P)))))))
             (SETQ CO (CDAR P))
             (COND
              ((NOT (EQUAL (CDR CO) 1))
               (SETQ MV (*MULTSQ MV (CONS 1 (CDR CO))))))
             (SETQ MV (CONS (GETPOWER (FKERN (MK*SQ MV)) 1) (CAR CO)))
             (RETURN (CONS MV (DF2PRINTFORM (CDR P)))))))) 
(PUT 'XL2Q 'NUMBER-OF-ARGS 3) 
(PUT 'XL2Q 'DEFINED-ON-LINE '216) 
(PUT 'XL2Q 'DEFINED-IN-FILE 'INT/DISTRIB.RED) 
(PUT 'XL2Q 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE XL2Q (L Z IL)
    (COND ((NULL Z) (CONS 1 1))
          ((EQUAL (CAR L) 0) (XL2Q (CDR L) (CDR Z) (CDR IL)))
          ((NOT (ATOM (CAR L)))
           (PROG (TEMP)
             (COND ((EQUAL (CAAR L) 0) (SETQ TEMP (CAR IL)))
                   (T (SETQ TEMP (LIST 'PLUS (CAR IL) (CAAR L)))))
             (SETQ TEMP (GETPOWER (FKERN (LIST 'EXPT (CAR Z) TEMP)) 1))
             (RETURN
              (*MULTSQ (CONS (CONS (CONS TEMP 1) NIL) 1)
               (XL2Q (CDR L) (CDR Z) (CDR IL))))))
          ((MINUSP (CAR L))
           (*MULTSQ
            (*INVSQ
             (CONS
              (CONS (CONS (GETPOWER (FKERN (CAR Z)) (MINUS (CAR L))) 1) NIL)
              1))
            (XL2Q (CDR L) (CDR Z) (CDR IL))))
          (T
           (*MULTSQ
            (CONS (CONS (CONS (GETPOWER (FKERN (CAR Z)) (CAR L)) 1) NIL) 1)
            (XL2Q (CDR L) (CDR Z) (CDR IL)))))) 
(PUT 'MULTBYARBPOWERS 'NUMBER-OF-ARGS 1) 
(PUT 'MULTBYARBPOWERS 'DEFINED-ON-LINE '239) 
(PUT 'MULTBYARBPOWERS 'DEFINED-IN-FILE 'INT/DISTRIB.RED) 
(PUT 'MULTBYARBPOWERS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MULTBYARBPOWERS (U)
    (COND ((NULL U) NIL)
          (T
           (CONS (CONS (ADDARBEXPTSDF (CAAR U)) (CDAR U))
                 (MULTBYARBPOWERS (CDR U)))))) 
(PUT 'ADDARBEXPTSDF 'NUMBER-OF-ARGS 1) 
(PUT 'ADDARBEXPTSDF 'DEFINED-ON-LINE '249) 
(PUT 'ADDARBEXPTSDF 'DEFINED-IN-FILE 'INT/DISTRIB.RED) 
(PUT 'ADDARBEXPTSDF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ADDARBEXPTSDF (X)
    (COND ((NULL X) NIL)
          (T
           (CONS (LIST (EXPTPLUS (CAR X) (MINUS 1))) (ADDARBEXPTSDF (CDR X)))))) 
(ENDMODULE) 