(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'QQEQEMISC)) 
(REVISION 'QQEQEMISC
          "$Id: qqeqemisc.red 5962 2021-08-22 15:41:06Z thomas-sturm $") 
(COPYRIGHT 'QQEQEMISC "Copyright (c) 2005-2009 A. Dolzmann and T. Sturm") 
(FLUID
 '(QQE_RESF* QQE_QVARF* QQE_ATF-QEQUAL-EXT-C* QQE_ATF-QEQUAL-EXT-P*
   QQE_ATF-EQUAL-EXT* QQE_ATF-EQUAL-INT* QQE_ATF-MISC-BASIC*
   QQE_ATF-QEQUAL-INT* QQE_LA* QQE_RA* QQE_PAT-LENGTHS* QQE_SF*
   QQE_ATF-QNEQ-INT* QQE_ATF-QNEQ-EXT* QQE_ATF-QNEQ-EXT-QEPSILON* QQE_ATF-NEQ*
   QQE_VAR* QQE_QQU-LIST* QQE_BQU-LIST*)) 
(PUT 'QQE_INSERT-RESF 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_INSERT-RESF 'DEFINED-ON-LINE '67) 
(PUT 'QQE_INSERT-RESF 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_INSERT-RESF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_INSERT-RESF (U) (SETQ QQE_RESF* (CONS U QQE_RESF*))) 
(PUT 'QQE_INSERT-QVARF 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_INSERT-QVARF 'DEFINED-ON-LINE '70) 
(PUT 'QQE_INSERT-QVARF 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_INSERT-QVARF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_INSERT-QVARF (U) (SETQ QQE_QVARF* (CONS U QQE_QVARF*))) 
(PUT 'QQE_SORT-RESF-QVARF 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_SORT-RESF-QVARF 'DEFINED-ON-LINE '73) 
(PUT 'QQE_SORT-RESF-QVARF 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_SORT-RESF-QVARF 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_SORT-RESF-QVARF (U QVAR)
    (PROG (X)
      (COND ((NEQ (CAR U) 'AND) (SETQ X (LIST U))) (T (SETQ X (CDR U))))
      (PROG ()
       WHILELABEL
        (COND ((NOT (NEQ X NIL)) (RETURN NIL)))
        (PROGN
         (COND
          ((QQE_DFS (CADR (RL_PREPAT (CAR X))) QVAR)
           (QQE_INSERT-QVARF (CAR X)))
          ((QQE_DFS (CADDR (RL_PREPAT (CAR X))) QVAR)
           (PROGN
            (QQE_INSERT-QVARF (LIST (CAAR X) (CADDR (CAR X)) (CADR (CAR X))))
            NIL))
          (T (PROGN (QQE_INSERT-RESF (CAR X)) NIL)))
         (SETQ X (CDR X))
         NIL)
        (GO WHILELABEL)))) 
(PUT 'QQE_ATF-QEQUAL-EXT-C 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_ATF-QEQUAL-EXT-C 'DEFINED-ON-LINE '101) 
(PUT 'QQE_ATF-QEQUAL-EXT-C 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_ATF-QEQUAL-EXT-C 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_ATF-QEQUAL-EXT-C (X QVAR)
    (AND (EQ (CAR X) 'QEQUAL) (ATOM (CADR X)) (NOT (QQE_DFS (CADDR X) QVAR)))) 
(PUT 'QQE_ATF-QEQUAL-EXT-P 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_ATF-QEQUAL-EXT-P 'DEFINED-ON-LINE '108) 
(PUT 'QQE_ATF-QEQUAL-EXT-P 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_ATF-QEQUAL-EXT-P 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_ATF-QEQUAL-EXT-P (X QVAR)
    (AND (EQ (CAR X) 'QEQUAL) (NOT (ATOM (CADR X)))
         (COND ((MEMQ (CAR (CADR X)) '(RTAIL LTAIL)) T))
         (NOT (QQE_DFS (CADDR X) QVAR)))) 
(PUT 'QQE_ATF-EQUAL-EXT 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_ATF-EQUAL-EXT 'DEFINED-ON-LINE '116) 
(PUT 'QQE_ATF-EQUAL-EXT 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_ATF-EQUAL-EXT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_ATF-EQUAL-EXT (X QVAR)
    (AND (EQ (CAR X) 'EQUAL) (NOT (QQE_DFS (CADDR X) QVAR)))) 
(PUT 'QQE_ATF-EQUAL-INT 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_ATF-EQUAL-INT 'DEFINED-ON-LINE '120) 
(PUT 'QQE_ATF-EQUAL-INT 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_ATF-EQUAL-INT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_ATF-EQUAL-INT (X) (EQ (CAR X) 'EQUAL)) 
(PUT 'QQE_ATF-QEQUAL-INT 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_ATF-QEQUAL-INT 'DEFINED-ON-LINE '124) 
(PUT 'QQE_ATF-QEQUAL-INT 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_ATF-QEQUAL-INT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_ATF-QEQUAL-INT (X QVAR)
    (AND (EQ (CAR X) 'QEQUAL) (NOT (ATOM (CADR X)))
         (COND ((MEMQ (CAR (CADR X)) '(RTAIL LTAIL)) T))
         (QQE_DFS (CADR X) QVAR) (NOT (ATOM (CADDR X)))
         (COND ((MEMQ (CAR (CADDR X)) '(RTAIL LTAIL)) T))
         (QQE_DFS (CADDR X) QVAR))) 
(PUT 'QQE_ATF-QNEQ-EXT 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_ATF-QNEQ-EXT 'DEFINED-ON-LINE '134) 
(PUT 'QQE_ATF-QNEQ-EXT 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_ATF-QNEQ-EXT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_ATF-QNEQ-EXT (X QVAR)
    (AND (EQ (CAR X) 'QNEQ) (NOT (QQE_DFS (CADDR X) QVAR))
         (NEQ (CADDR X) 'QEPSILON))) 
(PUT 'QQE_ATF-QNEQ-EXT-QEPSILON 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_ATF-QNEQ-EXT-QEPSILON 'DEFINED-ON-LINE '140) 
(PUT 'QQE_ATF-QNEQ-EXT-QEPSILON 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_ATF-QNEQ-EXT-QEPSILON 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_ATF-QNEQ-EXT-QEPSILON (X)
    (AND (EQ (CAR X) 'QNEQ) (EQ (CADDR X) 'QEPSILON))) 
(PUT 'QQE_ATF-NEQ 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_ATF-NEQ 'DEFINED-ON-LINE '143) 
(PUT 'QQE_ATF-NEQ 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_ATF-NEQ 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_ATF-NEQ (X) (EQ (CAR X) 'NEQ)) 
(PUT 'QQE_ATF-QNEQ-INT 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_ATF-QNEQ-INT 'DEFINED-ON-LINE '147) 
(PUT 'QQE_ATF-QNEQ-INT 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_ATF-QNEQ-INT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_ATF-QNEQ-INT (X QVAR) (AND (EQ (CAR X) 'QNEQ) (QQE_DFS (CADDR X) QVAR))) 
(PUT 'QQE_ATF-MISC-BASIC 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_ATF-MISC-BASIC 'DEFINED-ON-LINE '152) 
(PUT 'QQE_ATF-MISC-BASIC 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_ATF-MISC-BASIC 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_ATF-MISC-BASIC (X) (NOT (MEMQ (CAR X) '(EQUAL NEQ QEQUAL QNEQ)))) 
(PUT 'QQE_SORT-ATF 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_SORT-ATF 'DEFINED-ON-LINE '157) 
(PUT 'QQE_SORT-ATF 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_SORT-ATF 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_SORT-ATF (U QVAR)
    (PROG ()
      (QQE_SORT-RESF-QVARF U QVAR)
      (PROG (X)
        (SETQ X QQE_QVARF*)
       LAB
        (COND ((NULL X) (RETURN NIL)))
        ((LAMBDA (X)
           (PROGN
            (COND
             ((QQE_ATF-QEQUAL-EXT-C X QVAR)
              (SETQ QQE_ATF-QEQUAL-EXT-C* (CONS X QQE_ATF-QEQUAL-EXT-C*)))
             ((QQE_ATF-QEQUAL-EXT-P X QVAR)
              (SETQ QQE_ATF-QEQUAL-EXT-P* (CONS X QQE_ATF-QEQUAL-EXT-P*)))
             ((QQE_ATF-EQUAL-EXT X QVAR)
              (SETQ QQE_ATF-EQUAL-EXT* (CONS X QQE_ATF-EQUAL-EXT*)))
             ((QQE_ATF-EQUAL-INT X)
              (SETQ QQE_ATF-EQUAL-INT* (CONS X QQE_ATF-EQUAL-INT*)))
             ((QQE_ATF-QEQUAL-INT X QVAR)
              (SETQ QQE_ATF-QEQUAL-INT* (CONS X QQE_ATF-QEQUAL-INT*)))
             ((QQE_ATF-QNEQ-EXT-QEPSILON X)
              (SETQ QQE_ATF-QNEQ-EXT-QEPSILON*
                      (CONS X QQE_ATF-QNEQ-EXT-QEPSILON*)))
             ((QQE_ATF-QNEQ-EXT X QVAR)
              (SETQ QQE_ATF-QNEQ-EXT* (CONS X QQE_ATF-QNEQ-EXT*)))
             ((QQE_ATF-NEQ X) (SETQ QQE_ATF-NEQ* (CONS X QQE_ATF-NEQ*)))
             ((QQE_ATF-QNEQ-INT X QVAR)
              (SETQ QQE_ATF-QNEQ-INT* (CONS X QQE_ATF-QNEQ-INT*)))
             ((QQE_ATF-MISC-BASIC X)
              (SETQ QQE_ATF-MISC-BASIC* (CONS X QQE_ATF-MISC-BASIC*))))
            NIL))
         (CAR X))
        (SETQ X (CDR X))
        (GO LAB)))) 
(PUT 'QQE_LA 'NUMBER-OF-ARGS 0) 
(PUT 'QQE_LA 'DEFINED-ON-LINE '196) 
(PUT 'QQE_LA 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_LA 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE QQE_LA NIL
    (PROG (LA)
      (SETQ LA 0)
      (SETQ LA (MAX LA (QQE_MAX-LEFTS-LHS QQE_ATF-QEQUAL-EXT-P*)))
      (SETQ LA (MAX LA (QQE_MAX-LEFTS-LHS QQE_ATF-QEQUAL-EXT-C*)))
      (SETQ LA (MAX LA (QQE_MAX-LEFTS-LS-RECURSIVE QQE_ATF-EQUAL-EXT*)))
      (SETQ LA (MAX LA (QQE_MAX-LEFTS-LS-RECURSIVE QQE_ATF-EQUAL-INT*)))
      (SETQ LA (MAX LA (QQE_MAX-LEFTS-BS QQE_ATF-QEQUAL-INT*)))
      (SETQ LA (MAX LA (QQE_MAX-LEFTS-BS-RECURSIVE QQE_ATF-NEQ*)))
      (SETQ LA (MAX LA (QQE_MAX-LEFTS-LHS QQE_ATF-QNEQ-EXT*)))
      (SETQ LA (MAX LA (QQE_MAX-LEFTS-BS QQE_ATF-QNEQ-INT*)))
      (SETQ LA (MAX LA (QQE_MAX-LEFTS-BS-RECURSIVE QQE_ATF-MISC-BASIC*)))
      (SETQ QQE_LA* LA)
      (RETURN LA))) 
(PUT 'QQE_RA 'NUMBER-OF-ARGS 0) 
(PUT 'QQE_RA 'DEFINED-ON-LINE '216) 
(PUT 'QQE_RA 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_RA 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE QQE_RA NIL
    (PROG (RA)
      (SETQ RA 0)
      (SETQ RA (MAX RA (QQE_MAX-RIGHTS-LHS QQE_ATF-QEQUAL-EXT-P*)))
      (SETQ RA (MAX RA (QQE_MAX-RIGHTS-LHS QQE_ATF-QEQUAL-EXT-C*)))
      (SETQ RA (MAX RA (QQE_MAX-RIGHTS-LS-RECURSIVE QQE_ATF-EQUAL-EXT*)))
      (SETQ RA (MAX RA (QQE_MAX-RIGHTS-BS-RECURSIVE QQE_ATF-EQUAL-INT*)))
      (SETQ RA (MAX RA (QQE_MAX-RIGHTS-BS QQE_ATF-QEQUAL-INT*)))
      (SETQ RA (MAX RA (QQE_MAX-RIGHTS-BS-RECURSIVE QQE_ATF-NEQ*)))
      (SETQ RA (MAX RA (QQE_MAX-RIGHTS-LHS QQE_ATF-QNEQ-EXT*)))
      (SETQ RA (MAX RA (QQE_MAX-RIGHTS-BS QQE_ATF-QNEQ-INT*)))
      (SETQ RA (MAX RA (QQE_MAX-RIGHTS-BS-RECURSIVE QQE_ATF-MISC-BASIC*)))
      (SETQ QQE_RA* RA)
      (RETURN RA))) 
(PUT 'QQE_MAX-LEFTS-BS-RECURSIVE 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_MAX-LEFTS-BS-RECURSIVE 'DEFINED-ON-LINE '238) 
(PUT 'QQE_MAX-LEFTS-BS-RECURSIVE 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_MAX-LEFTS-BS-RECURSIVE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_MAX-LEFTS-BS-RECURSIVE (ATFLIST)
    (PROG (MAX)
      (SETQ MAX 0)
      (COND ((NULL ATFLIST) (RETURN 0)))
      (PROG (X)
        (SETQ X ATFLIST)
       LAB
        (COND ((NULL X) (RETURN NIL)))
        ((LAMBDA (X)
           (PROGN
            (SETQ MAX
                    (MAX MAX
                         (MAX
                          (QQE_MAX-LEFTS-TERM-RECURSIVE (CADR (RL_PREPAT X)) 0)
                          (QQE_MAX-LEFTS-TERM-RECURSIVE (CADDR (RL_PREPAT X))
                           0))))
            NIL))
         (CAR X))
        (SETQ X (CDR X))
        (GO LAB))
      (RETURN MAX))) 
(PUT 'QQE_MAX-LEFTS-LS-RECURSIVE 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_MAX-LEFTS-LS-RECURSIVE 'DEFINED-ON-LINE '254) 
(PUT 'QQE_MAX-LEFTS-LS-RECURSIVE 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_MAX-LEFTS-LS-RECURSIVE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_MAX-LEFTS-LS-RECURSIVE (ATFLIST)
    (PROG (MAX)
      (SETQ MAX 0)
      (COND ((NULL ATFLIST) (RETURN 0)))
      (PROG (X)
        (SETQ X ATFLIST)
       LAB
        (COND ((NULL X) (RETURN NIL)))
        ((LAMBDA (X)
           (SETQ MAX
                   (MAX MAX
                        (QQE_MAX-LEFTS-TERM-RECURSIVE (CADR (RL_PREPAT X))
                         0))))
         (CAR X))
        (SETQ X (CDR X))
        (GO LAB))
      (RETURN MAX))) 
(PUT 'QQE_MAX-LEFTS-TERM-RECURSIVE 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_MAX-LEFTS-TERM-RECURSIVE 'DEFINED-ON-LINE '267) 
(PUT 'QQE_MAX-LEFTS-TERM-RECURSIVE 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_MAX-LEFTS-TERM-RECURSIVE 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_MAX-LEFTS-TERM-RECURSIVE (TERM LEFTS)
    (PROG (X)
      (SETQ X TERM)
      (COND ((ATOM X) (RETURN LEFTS)))
      (COND
       ((MEMQ (CAR X) '(LHEAD RHEAD))
        (RETURN (MAX LEFTS (QQE_PREFIX-LEFTS X)))))
      (SETQ X (CDR X))
      (PROG ()
       WHILELABEL
        (COND ((NOT X) (RETURN NIL)))
        (PROGN
         (COND
          ((AND (NOT (ATOM (CAR X))) (MEMQ (CAR (CAR X)) '(LHEAD RHEAD))
                (QQE_DFS (CADR (CAR X)) QQE_VAR*))
           (SETQ LEFTS (MAX LEFTS (QQE_PREFIX-LEFTS (CAR X)))))
          (T (SETQ LEFTS (QQE_MAX-LEFTS-TERM-RECURSIVE (CAR X) LEFTS))))
         (SETQ X (CDR X))
         NIL)
        (GO WHILELABEL))
      (RETURN LEFTS))) 
(PUT 'QQE_MAX-LEFTS-LHS 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_MAX-LEFTS-LHS 'DEFINED-ON-LINE '291) 
(PUT 'QQE_MAX-LEFTS-LHS 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_MAX-LEFTS-LHS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_MAX-LEFTS-LHS (U)
    (PROG (L X)
      (COND ((NULL U) (SETQ X NIL)) (T (SETQ X U)))
      (SETQ L 0)
      (PROG ()
       WHILELABEL
        (COND ((NOT (NEQ X NIL)) (RETURN NIL)))
        (PROGN
         (SETQ L (MAX L (QQE_PREFIX-LEFTS (CADR (RL_PREPAT (CAR X))))))
         (SETQ X (CDR X))
         NIL)
        (GO WHILELABEL))
      (RETURN L))) 
(PUT 'QQE_MAX-LEFTS-BS 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_MAX-LEFTS-BS 'DEFINED-ON-LINE '309) 
(PUT 'QQE_MAX-LEFTS-BS 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_MAX-LEFTS-BS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_MAX-LEFTS-BS (U)
    (PROG (L X)
      (COND ((NULL U) (SETQ X NIL)) (T (SETQ X U)))
      (SETQ L 0)
      (PROG ()
       WHILELABEL
        (COND ((NOT (NEQ X NIL)) (RETURN NIL)))
        (PROGN
         (SETQ L
                 (MAX L
                      (MAX (QQE_PREFIX-LEFTS (CADR (RL_PREPAT (CAR X))))
                           (QQE_PREFIX-LEFTS (CADDR (RL_PREPAT (CAR X)))))))
         (SETQ X (CDR X))
         NIL)
        (GO WHILELABEL))
      (RETURN L))) 
(PUT 'QQE_MAX-RIGHTS-LHS 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_MAX-RIGHTS-LHS 'DEFINED-ON-LINE '330) 
(PUT 'QQE_MAX-RIGHTS-LHS 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_MAX-RIGHTS-LHS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_MAX-RIGHTS-LHS (U)
    (PROG (L X)
      (COND ((NULL U) (SETQ X NIL)) (T (SETQ X U)))
      (SETQ L 0)
      (PROG ()
       WHILELABEL
        (COND ((NOT (NEQ X NIL)) (RETURN NIL)))
        (PROGN
         (SETQ L (MAX L (QQE_PREFIX-RIGHTS (CADR (RL_PREPAT (CAR X))))))
         (SETQ X (CDR X))
         NIL)
        (GO WHILELABEL))
      (RETURN L))) 
(PUT 'QQE_MAX-RIGHTS-BS 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_MAX-RIGHTS-BS 'DEFINED-ON-LINE '348) 
(PUT 'QQE_MAX-RIGHTS-BS 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_MAX-RIGHTS-BS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_MAX-RIGHTS-BS (U)
    (PROG (L X)
      (COND ((NULL U) (SETQ X NIL)) (T (SETQ X U)))
      (SETQ L 0)
      (PROG ()
       WHILELABEL
        (COND ((NOT (NEQ X NIL)) (RETURN NIL)))
        (PROGN
         (SETQ L
                 (MAX L
                      (MAX (QQE_PREFIX-RIGHTS (CADR (RL_PREPAT (CAR X))))
                           (QQE_PREFIX-RIGHTS (CADDR (RL_PREPAT (CAR X)))))))
         (SETQ X (CDR X))
         NIL)
        (GO WHILELABEL))
      (RETURN L))) 
(PUT 'QQE_MAX-RIGHTS-BS-RECURSIVE 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_MAX-RIGHTS-BS-RECURSIVE 'DEFINED-ON-LINE '369) 
(PUT 'QQE_MAX-RIGHTS-BS-RECURSIVE 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_MAX-RIGHTS-BS-RECURSIVE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_MAX-RIGHTS-BS-RECURSIVE (ATFLIST)
    (PROG (MAX)
      (COND ((NULL ATFLIST) (RETURN 0)))
      (SETQ MAX 0)
      (PROG (X)
        (SETQ X ATFLIST)
       LAB
        (COND ((NULL X) (RETURN NIL)))
        ((LAMBDA (X)
           (PROGN
            (MAX MAX
                 (MAX (QQE_MAX-RIGHTS-TERM-RECURSIVE (CADR (RL_PREPAT X)) 0)
                      (QQE_MAX-RIGHTS-TERM-RECURSIVE (CADDR (RL_PREPAT X)) 0)))
            NIL))
         (CAR X))
        (SETQ X (CDR X))
        (GO LAB))
      (RETURN MAX))) 
(PUT 'QQE_MAX-RIGHTS-LS-RECURSIVE 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_MAX-RIGHTS-LS-RECURSIVE 'DEFINED-ON-LINE '386) 
(PUT 'QQE_MAX-RIGHTS-LS-RECURSIVE 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_MAX-RIGHTS-LS-RECURSIVE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_MAX-RIGHTS-LS-RECURSIVE (ATFLIST)
    (PROG (MAX)
      (COND ((NULL ATFLIST) (RETURN 0)))
      (SETQ MAX 0)
      (PROG (X)
        (SETQ X ATFLIST)
       LAB
        (COND ((NULL X) (RETURN NIL)))
        ((LAMBDA (X)
           (PROGN
            (SETQ MAX
                    (MAX MAX
                         (QQE_MAX-RIGHTS-TERM-RECURSIVE (CADR (RL_PREPAT X))
                          0)))
            NIL))
         (CAR X))
        (SETQ X (CDR X))
        (GO LAB))
      (RETURN MAX))) 
(PUT 'QQE_MAX-RIGHTS-TERM-RECURSIVE 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_MAX-RIGHTS-TERM-RECURSIVE 'DEFINED-ON-LINE '402) 
(PUT 'QQE_MAX-RIGHTS-TERM-RECURSIVE 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_MAX-RIGHTS-TERM-RECURSIVE 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_MAX-RIGHTS-TERM-RECURSIVE (TERM RIGHTS)
    (PROG (X)
      (SETQ X TERM)
      (COND ((ATOM X) (RETURN RIGHTS)))
      (COND
       ((MEMQ (CAR X) '(LHEAD RHEAD))
        (RETURN (MAX RIGHTS (QQE_PREFIX-RIGHTS X)))))
      (SETQ X (CDR X))
      (PROG ()
       WHILELABEL
        (COND ((NOT X) (RETURN NIL)))
        (PROGN
         (COND
          ((AND (NOT (ATOM (CAR X))) (MEMQ (CAR (CAR X)) '(LHEAD RHEAD))
                (QQE_DFS (CADR (CAR X)) QQE_VAR*))
           (SETQ RIGHTS (MAX RIGHTS (QQE_PREFIX-RIGHTS (CAR X)))))
          (T (SETQ RIGHTS (QQE_MAX-RIGHTS-TERM-RECURSIVE (CAR X) RIGHTS))))
         (SETQ X (CDR X))
         NIL)
        (GO WHILELABEL))
      (RETURN RIGHTS))) 
(PUT 'QQE_MAX-PREFIX-LENGTH-TERM-RECURSIVE 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_MAX-PREFIX-LENGTH-TERM-RECURSIVE 'DEFINED-ON-LINE '426) 
(PUT 'QQE_MAX-PREFIX-LENGTH-TERM-RECURSIVE 'DEFINED-IN-FILE
     'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_MAX-PREFIX-LENGTH-TERM-RECURSIVE 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_MAX-PREFIX-LENGTH-TERM-RECURSIVE (TERM L)
    (PROG ()
      (COND ((ATOM TERM) (RETURN L)))
      (COND
       ((MEMQ (CAR TERM) '(LHEAD RHEAD))
        (RETURN (MAX L (QQE_PREFIX-LENGTH TERM)))))
      (PROG (X)
        (SETQ X (CDR TERM))
       LAB
        (COND ((NULL X) (RETURN NIL)))
        ((LAMBDA (X)
           (PROGN
            (COND
             ((AND (NOT (ATOM X)) (MEMQ (CAR X) '(LHEAD RHEAD))
                   (QQE_DFS (CADR X) QQE_VAR*))
              (SETQ L (MAX L (QQE_PREFIX-LENGTH X))))
             (T (QQE_MAX-PREFIX-LENGTH-TERM-RECURSIVE X L)))
            NIL))
         (CAR X))
        (SETQ X (CDR X))
        (GO LAB))
      (RETURN L))) 
(PUT 'QQE_PATPOS 'NUMBER-OF-ARGS 3) 
(PUT 'QQE_PATPOS 'DEFINED-ON-LINE '445) 
(PUT 'QQE_PATPOS 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_PATPOS 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE QQE_PATPOS (AT PATLENGTH POS)
    (PROG (L REM)
      (SETQ L (MIN (QQE_PREFIX-LEFTS (CADR AT)) (QQE_PREFIX-LEFTS (CADDR AT))))
      (SETQ REM (REMAINDER (DIFFERENCE POS L) PATLENGTH))
      (COND ((LESSP POS L) (RETURN (MINUS 1))) ((EQ REM 0) (RETURN PATLENGTH))
            (T (RETURN REM))))) 
(PUT 'QQE_PAT-LENGTHS 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_PAT-LENGTHS 'DEFINED-ON-LINE '459) 
(PUT 'QQE_PAT-LENGTHS 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_PAT-LENGTHS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_PAT-LENGTHS (L)
    (PROG (LIST X)
      (SETQ X QQE_ATF-QEQUAL-INT*)
      (COND ((NULL X) (SETQ X QQE_ATF-QNEQ-INT*)))
      (COND ((NULL X) (RETURN NIL)))
      (SETQ LIST (LIST (QQE_PAT-LENGTH (CAR X) L)))
      (SETQ X (CDR X))
      (PROG ()
       WHILELABEL
        (COND ((NOT X) (RETURN NIL)))
        (PROGN
         (SETQ LIST (APPEND LIST (LIST (QQE_PAT-LENGTH (CAR X) L))))
         (SETQ X (CDR X))
         NIL)
        (GO WHILELABEL))
      (SETQ X QQE_ATF-QNEQ-INT*)
      (COND ((NULL X) (RETURN LIST)))
      (PROG ()
       WHILELABEL
        (COND ((NOT X) (RETURN NIL)))
        (PROGN
         (SETQ LIST (APPEND LIST (LIST (QQE_PAT-LENGTH (CAR X) L))))
         (SETQ X (CDR X))
         NIL)
        (GO WHILELABEL))
      (RETURN LIST))) 
(PUT 'QQE_PAT-LENGTH 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_PAT-LENGTH 'DEFINED-ON-LINE '486) 
(PUT 'QQE_PAT-LENGTH 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_PAT-LENGTH 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_PAT-LENGTH (PAT L)
    (PROG (A PREPAT)
      (SETQ PREPAT (RL_PREPAT PAT))
      (SETQ A (QQE_PREFIX-LENGTH (CADR PREPAT)))
      (COND
       ((LESSP A L)
        (PROGN
         (COND
          ((LEQ
            (MAX (QQE_PREFIX-LEFTS (CADR PREPAT))
                 (QQE_PREFIX-LEFTS (CADDR PREPAT)))
            (DIFFERENCE L
                        (MAX (QQE_PREFIX-RIGHTS (CADR PREPAT))
                             (QQE_PREFIX-RIGHTS (CADDR PREPAT)))))
           (RETURN
            (ABS
             (DIFFERENCE (QQE_PREFIX-LEFTS (CADR PREPAT))
                         (QQE_PREFIX-LEFTS (CADDR PREPAT))))))
          (T (RETURN (DIFFERENCE L A))))
         NIL))
       (T (RETURN 0))))) 
(PUT 'QQE_GET-QUANTIFIER-SEQUENZ 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_GET-QUANTIFIER-SEQUENZ 'DEFINED-ON-LINE '509) 
(PUT 'QQE_GET-QUANTIFIER-SEQUENZ 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_GET-QUANTIFIER-SEQUENZ 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_GET-QUANTIFIER-SEQUENZ (U)
    (PROG (X Y)
      (COND ((ATOM U) (RETURN (LIST NIL NIL))))
      (SETQ X U)
      (PROG ()
       WHILELABEL
        (COND ((NOT (MEMQ (CAR X) '(EX ALL))) (RETURN NIL)))
        (PROGN
         (SETQ Y (APPEND Y (LIST (LIST (CAR X) (CADR X)))))
         (COND
          ((EQ (GET (CADR X) 'IDTYPE) 'QT)
           (SETQ QQE_QQU-LIST*
                   (LTO_INSERTQ (LIST (CAR X) (CADR X)) QQE_QQU-LIST*)))
          (T
           (SETQ QQE_BQU-LIST*
                   (LTO_INSERTQ (LIST (CAR X) (CADR X)) QQE_BQU-LIST*))))
         (SETQ X (CADDR X))
         NIL)
        (GO WHILELABEL))
      (RETURN (LIST Y X)))) 
(PUT 'QQE_ATF-QEQUAL-EXT-MIN-PREFIX 'NUMBER-OF-ARGS 0) 
(PUT 'QQE_ATF-QEQUAL-EXT-MIN-PREFIX 'DEFINED-ON-LINE '533) 
(PUT 'QQE_ATF-QEQUAL-EXT-MIN-PREFIX 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_ATF-QEQUAL-EXT-MIN-PREFIX 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE QQE_ATF-QEQUAL-EXT-MIN-PREFIX NIL
    (PROG (M MM TERM LIST)
      (SETQ M (QQE_PREFIX-LENGTH (CADR (CAR QQE_ATF-QEQUAL-EXT-P*))))
      (SETQ TERM (CAR QQE_ATF-QEQUAL-EXT-P*))
      (SETQ LIST (CDR QQE_ATF-QEQUAL-EXT-P*))
      (COND
       (LIST
        (PROGN
         (PROG (X)
           (SETQ X LIST)
          LAB
           (COND ((NULL X) (RETURN NIL)))
           ((LAMBDA (X)
              (PROGN
               (SETQ MM (QQE_PREFIX-LENGTH (CADR X)))
               (COND ((LESSP MM M) (PROGN (SETQ M MM) (SETQ TERM X) NIL)))
               NIL))
            (CAR X))
           (SETQ X (CDR X))
           (GO LAB))
         NIL)))
      (RETURN (LIST M TERM)))) 
(PUT 'QQE_ATF-QEQUAL-EXT-P-MIN-LEFTS 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_ATF-QEQUAL-EXT-P-MIN-LEFTS 'DEFINED-ON-LINE '558) 
(PUT 'QQE_ATF-QEQUAL-EXT-P-MIN-LEFTS 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_ATF-QEQUAL-EXT-P-MIN-LEFTS 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_ATF-QEQUAL-EXT-P-MIN-LEFTS (MINLENGTH MINPREF)
    (PROG (M MM TERM LIST L)
      (SETQ L (QQE_PREFIX-LEFTS (CADR MINPREF)))
      (SETQ M (QQE_PREFIX-LEFTS (CADR MINPREF)))
      (SETQ TERM MINPREF)
      (SETQ LIST QQE_ATF-QEQUAL-EXT-P*)
      (COND
       (LIST
        (PROGN
         (PROG (X)
           (SETQ X LIST)
          LAB
           (COND ((NULL X) (RETURN NIL)))
           ((LAMBDA (X)
              (PROGN
               (SETQ MM (QQE_PREFIX-LEFTS (CADR X)))
               (COND
                ((AND (LESSP MM M)
                      (GEQ MINLENGTH (PLUS L (QQE_PREFIX-RIGHTS (CADR X)))))
                 (PROGN (SETQ M MM) (SETQ TERM X) NIL)))
               NIL))
            (CAR X))
           (SETQ X (CDR X))
           (GO LAB))
         NIL)))
      (RETURN (LIST M TERM)))) 
(PUT 'QQE_ATF-QEQUAL-EXT-P-MIN-RIGHTS 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_ATF-QEQUAL-EXT-P-MIN-RIGHTS 'DEFINED-ON-LINE '584) 
(PUT 'QQE_ATF-QEQUAL-EXT-P-MIN-RIGHTS 'DEFINED-IN-FILE
     'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_ATF-QEQUAL-EXT-P-MIN-RIGHTS 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_ATF-QEQUAL-EXT-P-MIN-RIGHTS (MINLENGTH MINPREF)
    (PROG (M MM TERM LIST R)
      (SETQ R (QQE_PREFIX-RIGHTS (CADR MINPREF)))
      (SETQ M (QQE_PREFIX-RIGHTS (CADR MINPREF)))
      (SETQ TERM MINPREF)
      (SETQ LIST QQE_ATF-QEQUAL-EXT-P*)
      (PROG (X)
        (SETQ X LIST)
       LAB
        (COND ((NULL X) (RETURN NIL)))
        ((LAMBDA (X)
           (PROGN
            (SETQ MM (QQE_PREFIX-RIGHTS (CADR X)))
            (COND
             ((AND (LESSP MM M)
                   (GEQ MINLENGTH (PLUS R (QQE_PREFIX-LEFTS (CADR X)))))
              (PROGN (SETQ M MM) (SETQ TERM X) NIL)))
            NIL))
         (CAR X))
        (SETQ X (CDR X))
        (GO LAB))
      (RETURN (LIST M TERM)))) 
(PUT 'QQE_NEW-IDS-X 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_NEW-IDS-X 'DEFINED-ON-LINE '610) 
(PUT 'QQE_NEW-IDS-X 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_NEW-IDS-X 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_NEW-IDS-X (NUM U)
    (PROG (J JJ X IDLIST)
      (SETQ J 1)
      (SETQ JJ 1)
      (PROG ()
       WHILELABEL
        (COND ((NOT (LEQ J NUM)) (RETURN NIL)))
        (PROGN
         (COND
          ((NULL (SMEMQ (SETQ X (QQE_MAKE-ID-X JJ)) U))
           (PROGN
            (SETQ J (PLUS J 1))
            (SETQ JJ (PLUS JJ 1))
            (COND (IDLIST (SETQ IDLIST (APPEND IDLIST (LIST X))))
                  (T (SETQ IDLIST (LIST X))))
            NIL))
          (T (PROGN (SETQ JJ (PLUS JJ 1)) NIL)))
         NIL)
        (GO WHILELABEL))
      (RETURN IDLIST))) 
(PUT 'QQE_MAKE-ID-X 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_MAKE-ID-X 'DEFINED-ON-LINE '635) 
(PUT 'QQE_MAKE-ID-X 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_MAKE-ID-X 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_MAKE-ID-X (NUM)
    ((LAMBDA (A) (INTERN (COMPRESS (APPEND (LIST (CADR A)) (CDDDR A)))))
     (EXPLODE (LIST 'X NUM)))) 
(PUT 'QQE_LIST-TAKE-N 'NUMBER-OF-ARGS 3) 
(PUT 'QQE_LIST-TAKE-N 'DEFINED-ON-LINE '642) 
(PUT 'QQE_LIST-TAKE-N 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_LIST-TAKE-N 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE QQE_LIST-TAKE-N (LIST LENGTH N)
    (PROG ()
      (PROG (I)
        (SETQ I 1)
       LAB
        (COND ((MINUSP (DIFFERENCE (DIFFERENCE LENGTH N) I)) (RETURN NIL)))
        (SETQ LIST (CDR LIST))
        (SETQ I (PLUS2 I 1))
        (GO LAB))
      (RETURN LIST))) 
(PUT 'QQE_SUBST 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_SUBST 'DEFINED-ON-LINE '654) 
(PUT 'QQE_SUBST 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_SUBST 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_SUBST (NUM NEW_IDS)
    (PROG (F)
      (COND ((EQ NUM 0) (RETURN (SUBST 'QEPSILON QQE_VAR* QQE_SF*)))
            (T
             (PROGN
              (COND
               (QQE_ATF-QEQUAL-EXT-P*
                (SETQ F (CONS (QQE_SUBST-QEQUAL-EXT-P NUM NEW_IDS) F))))
              (COND
               (QQE_ATF-EQUAL-EXT*
                (SETQ F
                        (CONS (QQE_SUBST-BATF NUM NEW_IDS QQE_ATF-EQUAL-EXT*)
                              F))))
              (COND
               (QQE_ATF-EQUAL-INT*
                (SETQ F
                        (CONS (QQE_SUBST-BATF NUM NEW_IDS QQE_ATF-EQUAL-INT*)
                              F))))
              (COND
               (QQE_ATF-QEQUAL-INT*
                (SETQ F (CONS (QQE_SUBST-QEQUAL-INT NUM NEW_IDS) F))))
              (COND
               (QQE_ATF-QNEQ-EXT*
                (SETQ F (CONS (QQE_SUBST-QNEQ-EXT NUM NEW_IDS) F))))
              (COND (QQE_ATF-QNEQ-EXT-QEPSILON* (SETQ F (CONS 'TRUE F))))
              (COND
               (QQE_ATF-NEQ*
                (SETQ F (CONS (QQE_SUBST-BATF NUM NEW_IDS QQE_ATF-NEQ*) F))))
              (COND
               (QQE_ATF-QNEQ-INT*
                (SETQ F (CONS (QQE_SUBST-QNEQ-INT NUM NEW_IDS) F))))
              (COND
               (QQE_ATF-MISC-BASIC*
                (SETQ F
                        (CONS (QQE_SUBST-BATF NUM NEW_IDS QQE_ATF-MISC-BASIC*)
                              F))))
              NIL)))
      (COND ((CDR QQE_QVARF*) (SETQ F (CONS 'AND F))) (T (SETQ F (CAR F))))
      (RETURN F))) 
(PUT 'QQE_SUBST-BATF 'NUMBER-OF-ARGS 3) 
(PUT 'QQE_SUBST-BATF 'DEFINED-ON-LINE '688) 
(PUT 'QQE_SUBST-BATF 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_SUBST-BATF 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE QQE_SUBST-BATF (NUM NEW_IDS ATLIST)
    (PROG (LIST)
      (PROG (F)
        (SETQ F ATLIST)
       LAB
        (COND ((NULL F) (RETURN NIL)))
        ((LAMBDA (F)
           (PROGN
            (SETQ F (RL_PREPAT F))
            (SETQ LIST
                    (CONS
                     (RL_SIMPAT
                      (LIST (CAR F) (QQE_SUBST-BTERM NUM NEW_IDS (CADR F))
                            (QQE_SUBST-BTERM NUM NEW_IDS (CADDR F))))
                     LIST))
            NIL))
         (CAR F))
        (SETQ F (CDR F))
        (GO LAB))
      (RETURN (COND ((CDR ATLIST) (CONS 'AND LIST)) (T (CAR LIST)))))) 
(PUT 'QQE_SUBST-BTERM 'NUMBER-OF-ARGS 3) 
(PUT 'QQE_SUBST-BTERM 'DEFINED-ON-LINE '704) 
(PUT 'QQE_SUBST-BTERM 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_SUBST-BTERM 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE QQE_SUBST-BTERM (NUM NEW_IDS TERM)
    (PROG (TERM3)
      (COND ((OR (NULL TERM) (ATOM TERM)) (RETURN TERM))
            ((AND (MEMQ (CAR TERM) '(LHEAD RHEAD))
                  (EQ (QQE_QPREFIX-VAR TERM) QQE_VAR*))
             (PROGN (RETURN (QQE_SUBST-SIMPLTERM TERM NUM NEW_IDS)) NIL))
            (T
             (PROG (TERM2)
               (SETQ TERM2 (CDR TERM))
              LAB
               (COND ((NULL TERM2) (RETURN NIL)))
               ((LAMBDA (TERM2)
                  (SETQ TERM3
                          (APPEND TERM3
                                  (LIST (QQE_SUBST-BTERM NUM NEW_IDS TERM2)))))
                (CAR TERM2))
               (SETQ TERM2 (CDR TERM2))
               (GO LAB))))
      (RETURN (CONS (CAR TERM) TERM3)))) 
(PUT 'QQE_SUBST-QEQUAL-EXT-P 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_SUBST-QEQUAL-EXT-P 'DEFINED-ON-LINE '719) 
(PUT 'QQE_SUBST-QEQUAL-EXT-P 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_SUBST-QEQUAL-EXT-P 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_SUBST-QEQUAL-EXT-P (NUM NEW_IDS)
    (PROG (LIST G)
      (PROG (F)
        (SETQ F QQE_ATF-QEQUAL-EXT-P*)
       LAB
        (COND ((NULL F) (RETURN NIL)))
        ((LAMBDA (F)
           (PROGN
            (SETQ LIST (QQE_SUBST-SIMPLTERM (CADR F) NUM NEW_IDS))
            (COND
             ((NULL LIST) (SETQ G (CONS (LIST 'QEQUAL (CADDR F) 'QEPSILON) G)))
             (T
              (SETQ G
                      (CONS (QQE_MAKEF-TERMLENGTH-L (CADDR F) NUM)
                            (CONS
                             (QQE_MAKEF-TERMLENGTH-G (CADDR F)
                              (DIFFERENCE NUM 1))
                             (CONS (QQE_MAKEF-QEQUAL2EQUAL (CADDR F) LIST)
                                   G))))))
            NIL))
         (CAR F))
        (SETQ F (CDR F))
        (GO LAB))
      (RETURN (COND ((CDR QQE_ATF-QEQUAL-EXT-P*) (CONS 'AND G)) (T (CAR G)))))) 
(PUT 'QQE_SUBST-QNEQ-EXT 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_SUBST-QNEQ-EXT 'DEFINED-ON-LINE '738) 
(PUT 'QQE_SUBST-QNEQ-EXT 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_SUBST-QNEQ-EXT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_SUBST-QNEQ-EXT (NUM NEW_IDS)
    (PROG (LIST G)
      (PROG (F)
        (SETQ F QQE_ATF-QNEQ-EXT*)
       LAB
        (COND ((NULL F) (RETURN NIL)))
        ((LAMBDA (F)
           (PROGN
            (SETQ LIST (QQE_SUBST-SIMPLTERM (CADR F) NUM NEW_IDS))
            (COND
             ((NULL LIST) (SETQ G (CONS (LIST 'QNEQ (CADDR F) 'QEPSILON) G)))
             (T
              (SETQ G
                      (CONS
                       (LIST 'OR
                             (QQE_MAKEF-TERMLENGTH-G (CADDR F) (PLUS NUM 1))
                             (QQE_MAKEF-TERMLENGTH-L (CADDR F)
                              (DIFFERENCE NUM 1))
                             (LIST 'AND (QQE_MAKEF-QNEQ2EQUAL (CADDR F) LIST)
                                   (QQE_MAKEF-TERMLENGTH-L (CADDR F) NUM)
                                   (QQE_MAKEF-TERMLENGTH-G (CADDR F)
                                    (DIFFERENCE NUM 1))))
                       G))))
            NIL))
         (CAR F))
        (SETQ F (CDR F))
        (GO LAB))
      (RETURN (COND ((CDR QQE_ATF-QNEQ-EXT*) (CONS 'AND G)) (T (CAR G)))))) 
(PUT 'QQE_MAKEF-QNEQ2EQUAL 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_MAKEF-QNEQ2EQUAL 'DEFINED-ON-LINE '759) 
(PUT 'QQE_MAKEF-QNEQ2EQUAL 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_MAKEF-QNEQ2EQUAL 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_MAKEF-QNEQ2EQUAL (TERM LIST)
    (PROG (F TAIL LIST2)
      (SETQ LIST2 LIST)
      (SETQ TAIL TERM)
      (PROG ()
       WHILELABEL
        (COND ((NOT LIST2) (RETURN NIL)))
        (PROGN
         (SETQ F
                 (CONS
                  (RL_SIMPAT (LIST 'NEQ (CONS 'LHEAD (LIST TAIL)) (CAR LIST2)))
                  F))
         (SETQ TAIL (CONS 'LTAIL (LIST TAIL)))
         (SETQ LIST2 (CDR LIST2))
         NIL)
        (GO WHILELABEL))
      (COND ((NULL (CDR LIST)) (RETURN (CAR F))) (T (RETURN (CONS 'OR F)))))) 
(PUT 'QQE_SUBST-QNEQ-INT 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_SUBST-QNEQ-INT 'DEFINED-ON-LINE '776) 
(PUT 'QQE_SUBST-QNEQ-INT 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_SUBST-QNEQ-INT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_SUBST-QNEQ-INT (NUM NEW_IDS)
    (PROG (LIST1 LIST2 G)
      (PROG (F)
        (SETQ F QQE_ATF-QNEQ-INT*)
       LAB
        (COND ((NULL F) (RETURN NIL)))
        ((LAMBDA (F)
           (PROGN
            (SETQ LIST1 (QQE_SUBST-SIMPLTERM (CADR F) NUM NEW_IDS))
            (SETQ LIST2 (QQE_SUBST-SIMPLTERM (CADDR F) NUM NEW_IDS))
            (COND ((NEQ (LENGTH LIST1) (LENGTH LIST2)) (SETQ G (CONS 'TRUE G)))
                  ((NULL LIST1) (SETQ G (CONS 'FALSE G)))
                  (T (SETQ G (CONS (QQE_MAKEF-LIST2QNEQ LIST1 LIST2) G))))
            NIL))
         (CAR F))
        (SETQ F (CDR F))
        (GO LAB))
      (RETURN (COND ((CDR QQE_ATF-QNEQ-INT*) (CONS 'AND G)) (T (CAR G)))))) 
(PUT 'QQE_SUBST-QEQUAL-INT 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_SUBST-QEQUAL-INT 'DEFINED-ON-LINE '793) 
(PUT 'QQE_SUBST-QEQUAL-INT 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_SUBST-QEQUAL-INT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_SUBST-QEQUAL-INT (NUM NEW_IDS)
    (PROG (LIST1 LIST2 G LIST F)
      (SETQ LIST QQE_ATF-QEQUAL-INT*)
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND LIST (NEQ G 'FALSE))) (RETURN NIL)))
        (PROGN
         (SETQ F (CAR LIST))
         (SETQ LIST1 (QQE_SUBST-SIMPLTERM (CADR F) NUM NEW_IDS))
         (SETQ LIST2 (QQE_SUBST-SIMPLTERM (CADDR F) NUM NEW_IDS))
         (COND ((AND (NULL LIST1) (NULL LIST2)) (SETQ G (CONS 'TRUE G)))
               ((OR (NULL LIST1) (NULL LIST2)) (SETQ G 'FALSE))
               ((NEQ (QQE_PREFIX-LENGTH (CADR F))
                     (QQE_PREFIX-LENGTH (CADDR F)))
                (SETQ G 'FALSE))
               (T (SETQ G (CONS (QQE_MAKEF-LIST2EQUAL LIST1 LIST2) G))))
         (SETQ LIST (CDR LIST))
         NIL)
        (GO WHILELABEL))
      (RETURN (COND ((CDR QQE_ATF-QEQUAL-INT*) (CONS 'AND G)) (T (CAR G)))))) 
(PUT 'QQE_MAKEF-LIST2QNEQ 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_MAKEF-LIST2QNEQ 'DEFINED-ON-LINE '817) 
(PUT 'QQE_MAKEF-LIST2QNEQ 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_MAKEF-LIST2QNEQ 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_MAKEF-LIST2QNEQ (LIST1 LIST2)
    (PROG (F LIST)
      (SETQ LIST LIST1)
      (PROG ()
       WHILELABEL
        (COND ((NOT LIST1) (RETURN NIL)))
        (PROGN
         (SETQ F (CONS (RL_SIMPAT (LIST 'NEQ (CAR LIST1) (CAR LIST2))) F))
         (SETQ LIST1 (CDR LIST1))
         (SETQ LIST2 (CDR LIST2))
         NIL)
        (GO WHILELABEL))
      (COND ((NULL (CDR LIST)) (RETURN (CAR F))) (T (RETURN (CONS 'OR F)))))) 
(PUT 'QQE_MAKEF-LIST2EQUAL 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_MAKEF-LIST2EQUAL 'DEFINED-ON-LINE '833) 
(PUT 'QQE_MAKEF-LIST2EQUAL 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_MAKEF-LIST2EQUAL 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_MAKEF-LIST2EQUAL (LIST1 LIST2)
    (PROG (F LIST)
      (SETQ LIST LIST1)
      (PROG ()
       WHILELABEL
        (COND ((NOT LIST1) (RETURN NIL)))
        (PROGN
         (SETQ F (CONS (RL_SIMPAT (LIST 'EQUAL (CAR LIST1) (CAR LIST2))) F))
         (SETQ LIST1 (CDR LIST1))
         (SETQ LIST2 (CDR LIST2))
         NIL)
        (GO WHILELABEL))
      (COND ((NULL (CDR LIST)) (RETURN (CAR F))) (T (RETURN (CONS 'AND F)))))) 
(PUT 'QQE_MAKEF-QEQUAL2EQUAL 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_MAKEF-QEQUAL2EQUAL 'DEFINED-ON-LINE '850) 
(PUT 'QQE_MAKEF-QEQUAL2EQUAL 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_MAKEF-QEQUAL2EQUAL 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_MAKEF-QEQUAL2EQUAL (TERM LIST)
    (PROG (F TAIL LIST2)
      (SETQ TAIL TERM)
      (SETQ LIST2 LIST)
      (PROG ()
       WHILELABEL
        (COND ((NOT LIST2) (RETURN NIL)))
        (PROGN
         (SETQ F
                 (CONS
                  (RL_SIMPAT
                   (LIST 'EQUAL (CONS 'LHEAD (LIST TAIL)) (CAR LIST2)))
                  F))
         (SETQ TAIL (CONS 'LTAIL (LIST TAIL)))
         (SETQ LIST2 (CDR LIST2))
         NIL)
        (GO WHILELABEL))
      (COND ((NULL (CDR LIST)) (RETURN (CAR F))) (T (RETURN (CONS 'AND F)))))) 
(PUT 'QQE_MAKEF-TERMLENGTH-L 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_MAKEF-TERMLENGTH-L 'DEFINED-ON-LINE '868) 
(PUT 'QQE_MAKEF-TERMLENGTH-L 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_MAKEF-TERMLENGTH-L 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_MAKEF-TERMLENGTH-L (TERM NUM)
    (LIST 'QEQUAL (QQE_ITERATE-LTAIL NUM TERM) 'QEPSILON)) 
(PUT 'QQE_MAKEF-TERMLENGTH-G 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_MAKEF-TERMLENGTH-G 'DEFINED-ON-LINE '872) 
(PUT 'QQE_MAKEF-TERMLENGTH-G 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_MAKEF-TERMLENGTH-G 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_MAKEF-TERMLENGTH-G (TERM NUM)
    (LIST 'QNEQ (QQE_ITERATE-LTAIL NUM TERM) 'QEPSILON)) 
(PUT 'QQE_SUBST-SIMPLTERM 'NUMBER-OF-ARGS 3) 
(PUT 'QQE_SUBST-SIMPLTERM 'DEFINED-ON-LINE '876) 
(PUT 'QQE_SUBST-SIMPLTERM 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_SUBST-SIMPLTERM 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE QQE_SUBST-SIMPLTERM (OLD_TERM NUM NEW_IDS)
    (PROG (L R)
      (COND ((ATOM OLD_TERM) (RETURN NEW_IDS)))
      (SETQ L (QQE_PREFIX-LEFTS OLD_TERM))
      (SETQ R (QQE_PREFIX-RIGHTS OLD_TERM))
      (COND
       ((GREATERP (PLUS L R) NUM)
        (COND ((MEMQ (CAR OLD_TERM) '(LHEAD RHEAD)) (RETURN (LIST 'ETA)))
              (T (RETURN NIL)))))
      (COND
       ((EQ (CAR OLD_TERM) 'LHEAD)
        (RETURN (QQE_SUBST-SIMPLTERM-LHEAD (DIFFERENCE L 1) NEW_IDS))))
      (COND
       ((EQ (CAR OLD_TERM) 'RHEAD)
        (RETURN (QQE_SUBST-SIMPLTERM-RHEAD (DIFFERENCE R 1) NEW_IDS))))
      (COND
       ((GREATERP L 0)
        (PROG (I)
          (SETQ I 1)
         LAB
          (COND ((MINUSP (DIFFERENCE L I)) (RETURN NIL)))
          (SETQ NEW_IDS (CDR NEW_IDS))
          (SETQ I (PLUS2 I 1))
          (GO LAB))))
      (COND
       ((GREATERP R 0)
        (PROGN
         (SETQ NEW_IDS (REVERSE NEW_IDS))
         (PROG (I)
           (SETQ I 1)
          LAB
           (COND ((MINUSP (DIFFERENCE R I)) (RETURN NIL)))
           (SETQ NEW_IDS (CDR NEW_IDS))
           (SETQ I (PLUS2 I 1))
           (GO LAB))
         (SETQ NEW_IDS (REVERSE NEW_IDS))
         NIL)))
      (RETURN NEW_IDS))) 
(PUT 'QQE_SUBST-SIMPLTERM-LHEAD 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_SUBST-SIMPLTERM-LHEAD 'DEFINED-ON-LINE '913) 
(PUT 'QQE_SUBST-SIMPLTERM-LHEAD 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_SUBST-SIMPLTERM-LHEAD 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_SUBST-SIMPLTERM-LHEAD (LEFTS NEW_IDS)
    (PROG ()
      (COND
       ((GREATERP LEFTS 0)
        (PROG (I)
          (SETQ I 1)
         LAB
          (COND ((MINUSP (DIFFERENCE LEFTS I)) (RETURN NIL)))
          (SETQ NEW_IDS (CDR NEW_IDS))
          (SETQ I (PLUS2 I 1))
          (GO LAB))))
      (RETURN (CAR NEW_IDS)))) 
(PUT 'QQE_SUBST-SIMPLTERM-RHEAD 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_SUBST-SIMPLTERM-RHEAD 'DEFINED-ON-LINE '926) 
(PUT 'QQE_SUBST-SIMPLTERM-RHEAD 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_SUBST-SIMPLTERM-RHEAD 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_SUBST-SIMPLTERM-RHEAD (RIGHTS NEW_IDS)
    (PROG ()
      (SETQ NEW_IDS (REVERSE NEW_IDS))
      (COND
       ((GREATERP RIGHTS 0)
        (PROG (I)
          (SETQ I 1)
         LAB
          (COND ((MINUSP (DIFFERENCE RIGHTS I)) (RETURN NIL)))
          (SETQ NEW_IDS (CDR NEW_IDS))
          (SETQ I (PLUS2 I 1))
          (GO LAB))))
      (RETURN (CAR NEW_IDS)))) 
(PUT 'QQE_ITERATE-QUANTIFIER-EX 'NUMBER-OF-ARGS 3) 
(PUT 'QQE_ITERATE-QUANTIFIER-EX 'DEFINED-ON-LINE '942) 
(PUT 'QQE_ITERATE-QUANTIFIER-EX 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_ITERATE-QUANTIFIER-EX 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE QQE_ITERATE-QUANTIFIER-EX (L LIST ARG)
    (PROG (Q X)
      (SETQ Q ARG)
      (SETQ X LIST)
      (PROG (J)
        (SETQ J 1)
       LAB
        (COND ((MINUSP (DIFFERENCE L J)) (RETURN NIL)))
        (PROGN (SETQ Q (LIST 'EX (CAR X) Q)) (SETQ X (CDR X)) NIL)
        (SETQ J (PLUS2 J 1))
        (GO LAB))
      (RETURN Q))) 
(PUT 'QQE_ITERATE-QUANTIFIER 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_ITERATE-QUANTIFIER 'DEFINED-ON-LINE '959) 
(PUT 'QQE_ITERATE-QUANTIFIER 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_ITERATE-QUANTIFIER 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_ITERATE-QUANTIFIER (QLIST F)
    (PROG ()
      (PROG (X)
        (SETQ X QLIST)
       LAB
        (COND ((NULL X) (RETURN NIL)))
        ((LAMBDA (X) (SETQ F (LIST (CAR X) (CADR X) F))) (CAR X))
        (SETQ X (CDR X))
        (GO LAB))
      (RETURN F))) 
(PUT 'QQE_SIMPL-DNF 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_SIMPL-DNF 'DEFINED-ON-LINE '972) 
(PUT 'QQE_SIMPL-DNF 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_SIMPL-DNF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_SIMPL-DNF (U)
    (PROG (LIST CLAUSES LENGTH_LIST)
      (COND
       ((EQ (CAR U) 'OR)
        (PROGN
         (SETQ LIST (CDR U))
         (PROG (CLAUSE)
           (SETQ CLAUSE LIST)
          LAB
           (COND ((NULL CLAUSE) (RETURN NIL)))
           ((LAMBDA (CLAUSE)
              (PROGN
               (SETQ LENGTH_LIST (QQE_CLAUSE-UPDATE-LENGTHS CLAUSE NIL))
               (COND
                ((EQ LENGTH_LIST 'FALSE)
                 (PROGN (SETQ CLAUSES (APPEND CLAUSES (LIST 'FALSE))) NIL))
                (T
                 (PROGN
                  (SETQ CLAUSES
                          (APPEND CLAUSES (LIST (QQE_SIMPL-CLAUSE CLAUSE))))
                  (QQE_LENGTH-GRAPH-DELETE LENGTH_LIST)
                  NIL)))
               NIL))
            (CAR CLAUSE))
           (SETQ CLAUSE (CDR CLAUSE))
           (GO LAB))
         (SETQ LIST (APPEND (LIST 'OR) CLAUSES))
         NIL))
       (T (SETQ LIST (QQE_SIMPL-CLAUSE U))))
      (RETURN (RL_SIMPLBASIC LIST NIL (MINUS 1))))) 
(PUT 'QQE_SIMPL-CLAUSE 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_SIMPL-CLAUSE 'DEFINED-ON-LINE '999) 
(PUT 'QQE_SIMPL-CLAUSE 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_SIMPL-CLAUSE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_SIMPL-CLAUSE (U)
    (PROG (LIST FLAG AT ATLIST_REST VARLIST X)
      (SETQ FLAG T)
      (SETQ LIST (COND ((EQ (CAR U) 'AND) (CDR U)) (T (LIST U))))
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND FLAG LIST)) (RETURN NIL)))
        (PROGN
         (SETQ AT (CAR LIST))
         (COND
          ((AND (PAIRP AT) (MEMQ (CAR AT) '(QEQUAL QNEQ)))
           (PROGN
            (SETQ AT
                    (LIST (CAR AT)
                          (QQE_SIMPL-CLAUSE-TERM (QQE_SIMPLTERM (CADR AT)))
                          (QQE_SIMPL-CLAUSE-TERM (QQE_SIMPLTERM (CADDR AT)))))
            (COND
             ((OR (EQ (QQE_QPREFIX-VAR (CADR AT)) 'QEPSILON)
                  (EQ (QQE_QPREFIX-VAR (CADDR AT)) 'QEPSILON))
              (PROGN
               (COND
                ((EQ (CAR AT) 'QEQUAL) (SETQ X (QQE_SIMPL-CLAUSE-QEQUAL AT)))
                (T (SETQ X (QQE_SIMPL-CLAUSE-QNEQ AT))))
               (COND ((NULL X) (SETQ FLAG NIL))
                     ((NEQ X 'TRUE)
                      (PROGN
                       (SETQ ATLIST_REST (CONS AT ATLIST_REST))
                       (COND ((NEQ X T) (SETQ VARLIST (CONS X VARLIST))))
                       NIL)))
               NIL))
             (T (SETQ ATLIST_REST (CONS AT ATLIST_REST))))
            NIL))
          (T (SETQ ATLIST_REST (CONS AT ATLIST_REST))))
         (SETQ LIST (CDR LIST))
         NIL)
        (GO WHILELABEL))
      (QQE_SIMPL-CLAUSE-REMPROP VARLIST)
      (COND
       (FLAG
        (PROGN
         (COND ((NULL ATLIST_REST) (RETURN 'TRUE))
               ((NULL (CDR ATLIST_REST)) (RETURN (CAR ATLIST_REST)))
               (T (RETURN (CONS 'AND ATLIST_REST))))
         NIL))
       (T (RETURN 'FALSE))))) 
(PUT 'QQE_SIMPL-CLAUSE-REMPROP 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_SIMPL-CLAUSE-REMPROP 'DEFINED-ON-LINE '1043) 
(PUT 'QQE_SIMPL-CLAUSE-REMPROP 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_SIMPL-CLAUSE-REMPROP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_SIMPL-CLAUSE-REMPROP (VARLIST)
    (PROG (X)
      (SETQ X VARLIST)
     LAB
      (COND ((NULL X) (RETURN NIL)))
      ((LAMBDA (X)
         (PROGN (REMPROP X 'QQEQEMISCEQ) (REMPROP X 'QQEQEMISCNEQ) NIL))
       (CAR X))
      (SETQ X (CDR X))
      (GO LAB))) 
(PUT 'QQE_SIMPL-CLAUSE-QEQUAL 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_SIMPL-CLAUSE-QEQUAL 'DEFINED-ON-LINE '1051) 
(PUT 'QQE_SIMPL-CLAUSE-QEQUAL 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_SIMPL-CLAUSE-QEQUAL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_SIMPL-CLAUSE-QEQUAL (AT)
    (PROG (VAR)
      (COND
       ((AND (EQ (CADR AT) 'QEPSILON) (EQ (CADDR AT) 'QEPSILON))
        (RETURN 'TRUE))
       ((AND (EQ (CADR AT) 'QEPSILON)
             (EQ (QQE_QPREFIX-VAR (CADDR AT)) 'QEPSILON)
             (LEQ (QQE_NUMBER-OF-ADDS-IN-QTERM (CADDR AT))
                  (QQE_NUMBER-OF-TAILS-IN-QTERM (CADDR AT))))
        (RETURN 'TRUE))
       ((AND (EQ (CADDR AT) 'QEPSILON)
             (EQ (QQE_QPREFIX-VAR (CADR AT)) 'QEPSILON)
             (LEQ (QQE_NUMBER-OF-ADDS-IN-QTERM (CADR AT))
                  (QQE_NUMBER-OF-TAILS-IN-QTERM (CADR AT))))
        (RETURN 'TRUE))
       ((AND (EQ (CADR AT) 'QEPSILON)
             (EQUAL (QQE_NUMBER-OF-ADDS-IN-QTERM (CADDR AT)) 0))
        (PROGN
         (SETQ VAR (QQE_QPREFIX-VAR (CADDR AT)))
         (COND
          ((AND (NULL (GET VAR 'QQEQEMISCEQ))
                (QQE_LESSEQ-LENGTH (QQE_PREFIX-LENGTH (CADDR AT))
                 (QQE_MAXLENGTH-VAR VAR)))
           (PROGN (PUT VAR 'QQEQEMISCEQ T) (RETURN VAR) NIL))
          (T (RETURN 'TRUE)))
         NIL))
       ((AND (EQ (CADDR AT) 'QEPSILON)
             (EQUAL (QQE_NUMBER-OF-ADDS-IN-QTERM (CADR AT)) 0))
        (PROGN
         (SETQ VAR (QQE_QPREFIX-VAR (CADR AT)))
         (COND
          ((AND (NULL (GET VAR 'QQEQEMISCEQ))
                (QQE_LESSEQ-LENGTH (QQE_PREFIX-LENGTH (CADR AT))
                 (QQE_MAXLENGTH-VAR VAR)))
           (PROGN (PUT VAR 'QQEQEMISCEQ T) (RETURN VAR) NIL))
          (T (RETURN 'TRUE)))
         NIL))
       (T (RETURN T))))) 
(PUT 'QQE_SIMPL-CLAUSE-QNEQ 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_SIMPL-CLAUSE-QNEQ 'DEFINED-ON-LINE '1098) 
(PUT 'QQE_SIMPL-CLAUSE-QNEQ 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_SIMPL-CLAUSE-QNEQ 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_SIMPL-CLAUSE-QNEQ (AT)
    (PROG (VAR)
      (COND
       ((AND (EQ (CADR AT) 'QEPSILON) (EQ (CADDR AT) 'QEPSILON)) (RETURN NIL))
       ((AND (EQ (CADR AT) 'QEPSILON)
             (EQ (QQE_QPREFIX-VAR (CADDR AT)) 'QEPSILON)
             (LEQ (QQE_NUMBER-OF-ADDS-IN-QTERM (CADDR AT))
                  (QQE_NUMBER-OF-TAILS-IN-QTERM (CADDR AT))))
        (RETURN NIL))
       ((AND (EQ (CADDR AT) 'QEPSILON)
             (EQ (QQE_QPREFIX-VAR (CADR AT)) 'QEPSILON)
             (LEQ (QQE_NUMBER-OF-ADDS-IN-QTERM (CADR AT))
                  (QQE_NUMBER-OF-TAILS-IN-QTERM (CADR AT))))
        (RETURN NIL))
       ((AND (EQ (CADR AT) 'QEPSILON)
             (EQUAL (QQE_NUMBER-OF-ADDS-IN-QTERM (CADDR AT)) 0))
        (PROGN
         (SETQ VAR (QQE_QPREFIX-VAR (CADDR AT)))
         (COND
          ((AND (NULL (GET VAR 'QQEQEMISCNEQ))
                (QQE_GREATEREQ-LENGTH (PLUS (QQE_PREFIX-LENGTH (CADDR AT)) 1)
                 (QQE_MINLENGTH-VAR VAR)))
           (PROGN (PUT VAR 'QQEQEMISCNEQ T) (RETURN VAR) NIL))
          (T (RETURN 'TRUE)))
         NIL))
       ((AND (EQ (CADDR AT) 'QEPSILON)
             (EQUAL (QQE_NUMBER-OF-ADDS-IN-QTERM (CADR AT)) 0))
        (PROGN
         (SETQ VAR (QQE_QPREFIX-VAR (CADR AT)))
         (COND
          ((AND (NULL (GET VAR 'QQEQEMISCNEQ))
                (QQE_GREATEREQ-LENGTH (PLUS (QQE_PREFIX-LENGTH (CADR AT)) 1)
                 (QQE_MINLENGTH-VAR VAR)))
           (PROGN (PUT VAR 'QQEQEMISCNEQ T) (RETURN VAR) NIL))
          (T (RETURN 'TRUE)))
         NIL))
       (T (RETURN T))))) 
(PUT 'QQE_SIMPL-CLAUSE-TERM 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_SIMPL-CLAUSE-TERM 'DEFINED-ON-LINE '1145) 
(PUT 'QQE_SIMPL-CLAUSE-TERM 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQEMISC.RED) 
(PUT 'QQE_SIMPL-CLAUSE-TERM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_SIMPL-CLAUSE-TERM (TERM)
    (PROG (VAR MAXLENGTH)
      (COND ((ATOM TERM) (RETURN TERM)))
      (SETQ VAR (QQE_QPREFIX-VAR TERM))
      (SETQ MAXLENGTH (GET VAR 'MAXLENGTH))
      (COND ((NULL MAXLENGTH) (RETURN TERM)))
      (COND
       ((GREATERP
         (DIFFERENCE (QQE_NUMBER-OF-TAILS-IN-QTERM TERM)
                     (QQE_NUMBER-OF-ADDS-IN-QTERM TERM))
         MAXLENGTH)
        (RETURN 'QEPSILON))
       (T (RETURN TERM))))) 
(ENDMODULE) 