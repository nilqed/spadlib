(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'SUBS4Q)) 
(PUT 'SUBS4Q 'NUMBER-OF-ARGS 1) 
(PUT 'SUBS4Q 'DEFINED-ON-LINE '33) 
(PUT 'SUBS4Q 'DEFINED-IN-FILE 'POLY/SUBS4Q.RED) 
(PUT 'SUBS4Q 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SUBS4Q (U)
    (PROG (X W Q D)
      (COND ((NULL (SETQ X (GET 'SLASH 'OPMTCH))) (RETURN U)))
      (SETQ W (PREPSQ U))
      (REMPROP 'SLASH 'OPMTCH)
      (PUT 'SLASH* 'OPMTCH X)
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND W (EQCAR (SETQ Q W) 'QUOTIENT))) (RETURN NIL)))
        (PROGN
         (SETQ W
                 (OR (OPMTCH (CONS 'SLASH* (CDR W)))
                     (AND (SMEMQ 'MINUS (CADDR W))
                          (OPMTCH
                           (LIST 'SLASH* (REVAL1 (LIST 'MINUS (CADR W)) T)
                                 (REVAL1 (LIST 'MINUS (CADDR W)) T))))))
         (SETQ D (OR D W)))
        (GO WHILELABEL))
      (SETQ U (COND (D (SIMP* Q)) (T U)))
      (PUT 'SLASH 'OPMTCH X)
      (RETURN U))) 
(ENDMODULE) 