(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'TURTLE)) 
(LOAD_PACKAGE (LIST 'GNUPLOT)) 
(PUT 'SETHEADING 'NUMBER-OF-ARGS 1) 
(FLAG '(SETHEADING) 'OPFN) 
(PUT 'SETHEADING 'DEFINED-ON-LINE '47) 
(PUT 'SETHEADING 'DEFINED-IN-FILE 'PLOT/TURTLE.RED) 
(PUT 'SETHEADING 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SETHEADING (MU)
    (PROG (W)
      (SETQ W
              (COND ((EVALEQUAL (AEVAL MU) (AEVAL 'NIL)) (AEVAL 'HEADING))
                    (T (AEVAL (LIST 'CK MU)))))
      (SETK 'HEADING (AEVAL W))
      (RETURN (AEVAL (LIST 'LIST 'X_COORD 'Y_COORD))))) 
(PUT 'SETX 'NUMBER-OF-ARGS 1) 
(FLAG '(SETX) 'OPFN) 
(PUT 'SETX 'DEFINED-ON-LINE '56) 
(PUT 'SETX 'DEFINED-IN-FILE 'PLOT/TURTLE.RED) 
(PUT 'SETX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SETX (I)
    (PROG ()
      (SETK 'X_COORD (AEVAL I))
      (RETURN (AEVAL (LIST 'LIST 'X_COORD 'Y_COORD))))) 
(PUT 'SETY 'NUMBER-OF-ARGS 1) 
(FLAG '(SETY) 'OPFN) 
(PUT 'SETY 'DEFINED-ON-LINE '63) 
(PUT 'SETY 'DEFINED-IN-FILE 'PLOT/TURTLE.RED) 
(PUT 'SETY 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SETY (J)
    (PROG ()
      (SETK 'Y_COORD (AEVAL J))
      (RETURN (AEVAL (LIST 'LIST 'X_COORD 'Y_COORD))))) 
(PUT 'SETPOSITION 'NUMBER-OF-ARGS 1) 
(FLAG '(SETPOSITION) 'OPFN) 
(PUT 'SETPOSITION 'DEFINED-ON-LINE '70) 
(PUT 'SETPOSITION 'DEFINED-IN-FILE 'PLOT/TURTLE.RED) 
(PUT 'SETPOSITION 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SETPOSITION (Q)
    (PROG ()
      (SETK 'X_COORD (AEVAL (LIST 'FIRST Q)))
      (SETK 'Y_COORD (AEVAL (LIST 'SECOND Q)))
      (RETURN (AEVAL (LIST 'LIST 'X_COORD 'Y_COORD))))) 
(PUT 'TURNLEFT 'NUMBER-OF-ARGS 1) 
(FLAG '(TURNLEFT) 'OPFN) 
(PUT 'TURNLEFT 'DEFINED-ON-LINE '81) 
(PUT 'TURNLEFT 'DEFINED-IN-FILE 'PLOT/TURTLE.RED) 
(PUT 'TURNLEFT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE TURNLEFT (GAMMA)
    (PROG ()
      (SETK 'HEADING (AEVAL (LIST 'CK (LIST 'PLUS 'HEADING GAMMA))))
      (RETURN (AEVAL (LIST 'LIST 'X_COORD 'Y_COORD))))) 
(PUT 'TURNRIGHT 'NUMBER-OF-ARGS 1) 
(FLAG '(TURNRIGHT) 'OPFN) 
(PUT 'TURNRIGHT 'DEFINED-ON-LINE '88) 
(PUT 'TURNRIGHT 'DEFINED-IN-FILE 'PLOT/TURTLE.RED) 
(PUT 'TURNRIGHT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE TURNRIGHT (DELTA)
    (PROG ()
      (SETK 'HEADING (AEVAL (LIST 'CK (LIST 'DIFFERENCE 'HEADING DELTA))))
      (RETURN (AEVAL (LIST 'LIST 'X_COORD 'Y_COORD))))) 
(PUT 'SETHEADINGTOWARDS 'NUMBER-OF-ARGS 1) 
(FLAG '(SETHEADINGTOWARDS) 'OPFN) 
(PUT 'SETHEADINGTOWARDS 'DEFINED-ON-LINE '95) 
(PUT 'SETHEADINGTOWARDS 'DEFINED-IN-FILE 'PLOT/TURTLE.RED) 
(PUT 'SETHEADINGTOWARDS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SETHEADINGTOWARDS (Q)
    (PROG (X Y F)
      (SETQ X (AEVAL (LIST 'DIFFERENCE (LIST 'FIRST Q) 'X_COORD)))
      (SETQ Y (AEVAL (LIST 'DIFFERENCE (LIST 'SECOND Q) 'Y_COORD)))
      (SETQ F (AEVAL (LIST 'POLAR (LIST 'LIST X Y))))
      (SETK 'HEADING (AEVAL (LIST 'CK (LIST 'SECOND F))))
      (RETURN (AEVAL (LIST 'LIST 'X_COORD 'Y_COORD))))) 
(PUT 'SETFORWARD 'NUMBER-OF-ARGS 1) 
(FLAG '(SETFORWARD) 'OPFN) 
(PUT 'SETFORWARD 'DEFINED-ON-LINE '111) 
(PUT 'SETFORWARD 'DEFINED-IN-FILE 'PLOT/TURTLE.RED) 
(PUT 'SETFORWARD 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SETFORWARD (M)
    (PROG (THETA S U)
      (SETQ THETA (AEVAL 'HEADING))
      (SETQ S (AEVAL (LIST 'LIST M THETA)))
      (SETQ U (AEVAL (LIST 'CARTESIAN S)))
      (RETURN (AEVAL (LIST 'SETPOSITION U))))) 
(PUT 'SETBACK 'NUMBER-OF-ARGS 1) 
(FLAG '(SETBACK) 'OPFN) 
(PUT 'SETBACK 'DEFINED-ON-LINE '120) 
(PUT 'SETBACK 'DEFINED-IN-FILE 'PLOT/TURTLE.RED) 
(PUT 'SETBACK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SETBACK (N)
    (PROG (THETA V W)
      (SETQ THETA (AEVAL (LIST 'CK (LIST 'PLUS 'HEADING 180))))
      (SETQ V (AEVAL (LIST 'LIST N THETA)))
      (SETQ W (AEVAL (LIST 'CARTESIAN V)))
      (SETK 'HEADING (AEVAL (LIST 'CK (LIST 'DIFFERENCE THETA 180))))
      (RETURN (AEVAL (LIST 'SETPOSITION W))))) 
(PUT 'MOVE 'NUMBER-OF-ARGS 1) 
(FLAG '(MOVE) 'OPFN) 
(PUT 'MOVE 'DEFINED-ON-LINE '138) 
(PUT 'MOVE 'DEFINED-IN-FILE 'PLOT/TURTLE.RED) 
(PUT 'MOVE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MOVE (P)
    (PROG (X Y LINE)
      (SETQ X (AEVAL (LIST 'FIRST P)))
      (SETQ Y (AEVAL (LIST 'SECOND P)))
      (SETQ LINE
              (AEVAL
               (LIST 'LIST (LIST 'LIST 'X_COORD 'Y_COORD) (LIST 'LIST X Y))))
      (SETK 'X_COORD (AEVAL X))
      (SETK 'Y_COORD (AEVAL Y))
      (RETURN (AEVAL LINE)))) 
(PUT 'FORWARD 'NUMBER-OF-ARGS 1) 
(FLAG '(FORWARD) 'OPFN) 
(PUT 'FORWARD 'DEFINED-ON-LINE '150) 
(PUT 'FORWARD 'DEFINED-IN-FILE 'PLOT/TURTLE.RED) 
(PUT 'FORWARD 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE FORWARD (C)
    (PROG (THETA S U FL)
      (SETQ THETA (AEVAL 'HEADING))
      (SETQ S (AEVAL (LIST 'LIST C THETA)))
      (SETQ U (AEVAL (LIST 'CARTESIAN S)))
      (SETQ FL
              (AEVAL
               (LIST 'LIST (LIST 'LIST 'X_COORD 'Y_COORD)
                     (LIST 'LIST (LIST 'PLUS 'X_COORD (LIST 'FIRST U))
                           (LIST 'PLUS 'Y_COORD (LIST 'SECOND U))))))
      (SETK 'X_COORD (AEVAL (LIST 'PLUS 'X_COORD (LIST 'FIRST U))))
      (SETK 'Y_COORD (AEVAL (LIST 'PLUS 'Y_COORD (LIST 'SECOND U))))
      (RETURN (AEVAL FL)))) 
(PUT 'BACK 'NUMBER-OF-ARGS 1) 
(FLAG '(BACK) 'OPFN) 
(PUT 'BACK 'DEFINED-ON-LINE '162) 
(PUT 'BACK 'DEFINED-IN-FILE 'PLOT/TURTLE.RED) 
(PUT 'BACK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BACK (D)
    (PROG (THETA V W BL)
      (SETQ THETA (AEVAL (LIST 'CK (LIST 'PLUS 'HEADING 180))))
      (SETQ V (AEVAL (LIST 'LIST D THETA)))
      (SETQ W (AEVAL (LIST 'CARTESIAN V)))
      (SETQ BL
              (AEVAL
               (LIST 'LIST (LIST 'LIST 'X_COORD 'Y_COORD)
                     (LIST 'LIST (LIST 'PLUS 'X_COORD (LIST 'FIRST W))
                           (LIST 'PLUS 'Y_COORD (LIST 'SECOND W))))))
      (SETK 'X_COORD (AEVAL (LIST 'PLUS 'X_COORD (LIST 'FIRST W))))
      (SETK 'Y_COORD (AEVAL (LIST 'PLUS 'Y_COORD (LIST 'SECOND W))))
      (SETK 'HEADING (AEVAL (LIST 'CK (LIST 'DIFFERENCE THETA 180))))
      (RETURN (AEVAL BL)))) 
(PUT 'DRAW 'NUMBER-OF-ARGS 1) 
(FLAG '(DRAW) 'OPFN) 
(PUT 'DRAW 'DEFINED-ON-LINE '181) 
(PUT 'DRAW 'DEFINED-IN-FILE 'PLOT/TURTLE.RED) 
(PUT 'DRAW 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DRAW (P)
    (PROG (G)
      (SETQ G
              (PROG (A FORALL-RESULT FORALL-ENDPTR)
                (SETQ A (GETRLIST (AEVAL P)))
                (COND ((NULL A) (RETURN (MAKELIST NIL))))
                (SETQ FORALL-RESULT
                        (SETQ FORALL-ENDPTR
                                (CONS ((LAMBDA (A) (AEVAL A)) (CAR A)) NIL)))
               LOOPLABEL
                (SETQ A (CDR A))
                (COND ((NULL A) (RETURN (CONS 'LIST FORALL-RESULT))))
                (RPLACD FORALL-ENDPTR
                        (CONS ((LAMBDA (A) (AEVAL A)) (CAR A)) NIL))
                (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                (GO LOOPLABEL)))
      (AEVAL (LIST 'PLOT G)))) 
(SETK 'X_COORD (AEVAL 0)) 
(SETK 'Y_COORD (AEVAL 0)) 
(SETK 'HEADING (AEVAL 0)) 
(PUT 'CLEARSCREEN 'NUMBER-OF-ARGS 0) 
(FLAG '(CLEARSCREEN) 'OPFN) 
(PUT 'CLEARSCREEN 'DEFINED-ON-LINE '257) 
(PUT 'CLEARSCREEN 'DEFINED-IN-FILE 'PLOT/TURTLE.RED) 
(PUT 'CLEARSCREEN 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE CLEARSCREEN NIL
    (PROG ()
      (AEVAL (PLOTRESET))
      (SETK 'X_COORD (AEVAL 0))
      (SETK 'Y_COORD (AEVAL 0))
      (SETK 'HEADING (AEVAL 0))
      (RETURN (AEVAL (LIST 'LIST 'X_COORD 'Y_COORD))))) 
(PUT 'INFO 'NUMBER-OF-ARGS 0) 
(FLAG '(INFO) 'OPFN) 
(PUT 'INFO 'DEFINED-ON-LINE '268) 
(PUT 'INFO 'DEFINED-IN-FILE 'PLOT/TURTLE.RED) 
(PUT 'INFO 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE INFO NIL (PROG () (RETURN (AEVAL (LIST 'LIST 'X_COORD 'Y_COORD 'HEADING))))) 
(PUT 'HOME 'NUMBER-OF-ARGS 0) 
(FLAG '(HOME) 'OPFN) 
(PUT 'HOME 'DEFINED-ON-LINE '274) 
(PUT 'HOME 'DEFINED-IN-FILE 'PLOT/TURTLE.RED) 
(PUT 'HOME 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE HOME NIL
    (PROG ()
      (SETK 'X_COORD (AEVAL 0))
      (SETK 'Y_COORD (AEVAL 0))
      (SETK 'HEADING (AEVAL 0))
      (RETURN (AEVAL (LIST 'LIST 'X_COORD 'Y_COORD))))) 
(PUT 'DEGREE 'NUMBER-OF-ARGS 1) 
(FLAG '(DEGREE) 'OPFN) 
(PUT 'DEGREE 'DEFINED-ON-LINE '289) 
(PUT 'DEGREE 'DEFINED-IN-FILE 'PLOT/TURTLE.RED) 
(PUT 'DEGREE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DEGREE (THETA)
    (PROG (A)
      (SETQ A (AEVAL (LIST 'TIMES THETA (LIST 'QUOTIENT 180 'PI))))
      (RETURN (AEVAL A)))) 
(PUT 'RAD 'NUMBER-OF-ARGS 1) 
(FLAG '(RAD) 'OPFN) 
(PUT 'RAD 'DEFINED-ON-LINE '296) 
(PUT 'RAD 'DEFINED-IN-FILE 'PLOT/TURTLE.RED) 
(PUT 'RAD 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE RAD (MU)
    (PROG (B)
      (SETQ B (AEVAL (LIST 'TIMES MU (LIST 'QUOTIENT 'PI 180))))
      (RETURN (AEVAL B)))) 
(PUT 'POLAR 'NUMBER-OF-ARGS 1) 
(FLAG '(POLAR) 'OPFN) 
(PUT 'POLAR 'DEFINED-ON-LINE '309) 
(PUT 'POLAR 'DEFINED-IN-FILE 'PLOT/TURTLE.RED) 
(PUT 'POLAR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE POLAR (P)
    (PROG (X Y R THETA)
      (SETQ X (AEVAL (LIST 'FIRST P)))
      (SETQ Y (AEVAL (LIST 'SECOND P)))
      (SETQ R
              (AEVAL
               (LIST 'EXPT (LIST 'PLUS (LIST 'EXPT X 2) (LIST 'EXPT Y 2))
                     (LIST 'QUOTIENT 1 2))))
      (COND
       ((EVALGREATERP (AEVAL X) 0)
        (SETQ THETA (AEVAL (LIST 'ATAN (LIST 'QUOTIENT Y X)))))
       ((EVALEQUAL (AEVAL X) 0)
        (SETQ THETA
                (AEVAL (LIST 'TIMES (LIST 'SIGN Y) (LIST 'QUOTIENT 'PI 2)))))
       (T
        (SETQ THETA
                (AEVAL (LIST 'PLUS 'PI (LIST 'ATAN (LIST 'QUOTIENT Y X)))))))
      (RETURN (AEVAL (LIST 'LIST R (LIST 'DEGREE THETA)))))) 
(PUT 'CARTESIAN 'NUMBER-OF-ARGS 1) 
(FLAG '(CARTESIAN) 'OPFN) 
(PUT 'CARTESIAN 'DEFINED-ON-LINE '321) 
(PUT 'CARTESIAN 'DEFINED-IN-FILE 'PLOT/TURTLE.RED) 
(PUT 'CARTESIAN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CARTESIAN (P)
    (PROG (R THETA X Y)
      (SETQ R (AEVAL (LIST 'FIRST P)))
      (SETQ THETA (AEVAL (LIST 'RAD (LIST 'SECOND P))))
      (SETQ X (AEVAL (LIST 'TIMES R (LIST 'COS THETA))))
      (SETQ Y (AEVAL (LIST 'TIMES R (LIST 'SIN THETA))))
      (RETURN (AEVAL (LIST 'LIST X Y))))) 
(PUT 'CK 'NUMBER-OF-ARGS 1) 
(FLAG '(CK) 'OPFN) 
(PUT 'CK 'DEFINED-ON-LINE '331) 
(PUT 'CK 'DEFINED-IN-FILE 'PLOT/TURTLE.RED) 
(PUT 'CK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CK (M)
    (PROG ()
      (COND
       ((EVALNUMBERP (AEVAL M))
        (PROGN
         (COND
          ((AND (EVALGEQ (AEVAL M) 0) (EVALLESSP (AEVAL M) 360))
           (SETK 'HEADING (AEVAL M))))
         (COND ((EVALLESSP (AEVAL M) 0) (AEVAL (LIST 'CK (LIST 'PLUS 360 M)))))
         (COND
          ((EVALGEQ (AEVAL M) 360)
           (AEVAL (LIST 'CK (LIST 'DIFFERENCE M 360)))))))
       (T (AEVAL (REDERR (REVALX "error:ck needs numeric argument")))))
      (RETURN (AEVAL 'HEADING)))) 
(AEVAL 'NIL) 
(ENDMODULE) 