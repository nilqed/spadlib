(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'DVFSF)) 
(REVISION 'DVFSF "$Id: dvfsf.red 6086 2021-10-08 16:01:45Z thomas-sturm $") 
(COPYRIGHT 'DVFSF "(c) 1995-2009 A. Dolzmann, T. Sturm, 2017 T. Sturm") 
(CREATE-PACKAGE '(DVFSF DVFSFSIAT DVFSFSISM DVFSFQE DVFSFMISC) NIL) 
(LOAD-PACKAGE 'CL) 
(EXPORTS
 (LIST 'DVFSF_ENTER 'DVFSF_EXIT 'DVFSF_SIMPTERM 'DVFSF_PREPAT 'DVFSF_RESIMPAT
       'DVFSF_LENGTHAT 'DVFSF_CHSIMPAT 'DVFSF_SIMPAT 'DVFSF_OP 'DVFSF_ARG2L
       'DVFSF_ARG2R 'DVFSF_ARGN 'DVFSF_MK2 'DVFSF_0MK2 'DVFSF_MKN 'DVFSF_OPP
       'DVFSF_SIMPLAT1 'DVFSF_SUSIRMKNOWL 'DVFSF_VARSEL 'DVFSF_TRANSLAT
       'DVFSF_ELIMSET 'DVFSF_QESUBCQ 'DVFSF_QESUBQ 'DVFSF_TRANSFORM
       'DVFSF_TRYGAUSS 'DVFSF_QEMKANS 'DVFSF_ORDATP 'DVFSF_VARLAT
       'DVFSF_VARSUBSTAT 'DVFSF_NEGATEAT 'DVFSF_FCTRAT 'DVFSF_DNF 'DVFSF_CNF
       'DVFSF_SUBSUMPTION 'DVFSF_A2CDL 'DVFSF_SUBAT 'DVFSF_SUBALCHK
       'DVFSF_EQNRHSKERNELS 'DVFSF_STRUCTAT 'DVFSF_IFSTRUCTAT 'DVFSF_TERMMLAT
       'DVFSF_EXPLATS 'DVFSF_MKCANONIC)) 
(FLUID '(*RLVERBOSE DVFSF_P* *RLSIEXPL *RLSIEXPLA *RLSIFAC *RLBNFSAC)) 
(FLAG '(DVFSF) 'RL_PACKAGE) 
(PUT 'DVFSF 'RL_PARAMS
     '((RL_SMUPDKNOWL* . CL_SUSIUPDKNOWL) (RL_SMRMKNOWL* . DVFSF_SUSIRMKNOWL)
       (RL_SMCPKNOWL* . CL_SUSICPKNOWL) (RL_SMMKATL* . CL_SUSIMKATL)
       (RL_SACATLP* . CL_SACATLP) (RL_SACAT* . CL_SACAT)
       (RL_ORDATP* . DVFSF_ORDATP) (RL_TORDP* . ORDP)
       (RL_SIMPLAT1* . DVFSF_SIMPLAT1) (RL_NEGATEAT* . DVFSF_NEGATEAT)
       (RL_VARLAT* . DVFSF_VARLAT) (RL_VARSUBSTAT* . DVFSF_VARSUBSTAT)
       (RL_TRANSLAT* . DVFSF_TRANSLAT) (RL_TRANSFORM* . DVFSF_TRANSFORM)
       (RL_ELIMSET* . DVFSF_ELIMSET) (RL_TRYGAUSS* . DVFSF_TRYGAUSS)
       (RL_SUBSUMPTION* . DVFSF_SUBSUMPTION) (RL_BNFSIMPL* . CL_BNFSIMPL)
       (RL_FCTRAT* . DVFSF_FCTRAT) (RL_VARSEL* . DVFSF_VARSEL)
       (RL_BETTERP* . CL_BETTERP) (RL_A2CDL* . DVFSF_A2CDL)
       (RL_QEMKANS* . DVFSF_QEMKANS) (RL_TERMMLAT* . DVFSF_TERMMLAT)
       (RL_STRUCTAT* . DVFSF_STRUCTAT) (RL_IFSTRUCTAT* . DVFSF_IFSTRUCTAT)
       (RL_SUBAT* . DVFSF_SUBAT) (RL_SUBALCHK* . DVFSF_SUBALCHK)
       (RL_EQNRHSKERNELS* . DVFSF_EQNRHSKERNELS)
       (RL_SUSIPOST* . DVFSF_SUSIPOST) (RL_SUSITF* . DVFSF_SUSITF)
       (RL_SUSIBIN* . DVFSF_SUSIBIN) (RL_SPECELIM* . CL_SPECELIM)
       (RL_FBQE* . CL_FBQE))) 
(PUT 'DVFSF 'RL_CSWITCHES '((RLQEHEU) (RLQEDFS))) 
(PUT 'DVFSF 'RL_SERVICES
     '((RL_SUBFOF* . CL_SUBFOF) (RL_IDENTIFYONOFF* . CL_IDENTIFYONOFF)
       (RL_SIMPL* . CL_SIMPL) (RL_SIMPLBASIC* . CL_SIMPLBASIC)
       (RL_NNF* . CL_NNF) (RL_NNFNOT* . CL_NNFNOT) (RL_PNF* . CL_PNF)
       (RL_CNF* . DVFSF_CNF) (RL_DNF* . DVFSF_DNF) (RL_ALL* . CL_ALL)
       (RL_EX* . CL_EX) (RL_ATNUM* . CL_ATNUM) (RL_QNUM* . CL_QNUM)
       (RL_IFACL* . CL_IFACL) (RL_IFACML* . CL_IFACML) (RL_MATRIX* . CL_MATRIX)
       (RL_MINISCOPE* . CL_MINISCOPE) (RL_ATML* . CL_ATML) (RL_ATL* . CL_ATL)
       (RL_QE* . CL_QE) (RL_QEIPO* . CL_QEIPO) (RL_QEWS* . CL_QEWS)
       (RL_QEA* . CL_QEA) (RL_TAB* . CL_TAB) (RL_ATAB* . CL_ATAB)
       (RL_TERMML* . CL_TERMML) (RL_TERML* . CL_TERML) (RL_VARL* . CL_VARL)
       (RL_FVARL* . CL_FVARL) (RL_BVARL* . CL_BVARL) (RL_STRUCT* . CL_STRUCT)
       (RL_IFSTRUCT* . CL_IFSTRUCT) (RL_EXPLATS* . DVFSF_EXPLATS)
       (RL_MKCANONIC* . DVFSF_MKCANONIC) (RL_ITAB* . CL_ITAB))) 
(PUT 'DVFSF 'RL_ENTER 'DVFSF_ENTER) 
(PUT 'DVFSF 'RL_EXIT 'DVFSF_EXIT) 
(PUT 'DVFSF 'SIMPFNNAME 'DVFSF_SIMPFN) 
(PUT 'DVFSF 'RL_PREPAT 'DVFSF_PREPAT) 
(PUT 'DVFSF 'RL_RESIMPAT 'DVFSF_RESIMPAT) 
(PUT 'DVFSF 'RL_LENGTHAT 'DVFSF_LENGTHAT) 
(PUT 'DVFSF 'RL_PREPTERM 'PREPF) 
(PUT 'DVFSF 'RL_SIMPTERM 'DVFSF_SIMPTERM) 
(MKOP 'EQUAL) 
(INFIX (LIST 'EQUAL)) 
(PUT 'EQUAL 'DVFSF_SIMPFN 'DVFSF_CHSIMPAT) 
(PUT 'EQUAL 'NUMBER-OF-ARGS 2) 
(MKOP 'NEQ) 
(INFIX (LIST 'NEQ)) 
(PUT 'NEQ 'DVFSF_SIMPFN 'DVFSF_CHSIMPAT) 
(PUT 'NEQ 'NUMBER-OF-ARGS 2) 
(PUT 'NEQ 'RTYPEFN 'QUOTELOG) 
(NEWTOK '((< >) NEQ)) 
(MKOP 'SDIV) 
(INFIX (LIST 'SDIV)) 
(PUT 'SDIV 'DVFSF_SIMPFN 'DVFSF_CHSIMPAT) 
(PUT 'SDIV 'NUMBER-OF-ARGS 2) 
(PUT 'SDIV 'RTYPEFN 'QUOTELOG) 
(PRECEDENCE (LIST 'SDIV 'NEQ)) 
(NEWTOK '((|\|| |\||) SDIV)) 
(MKOP 'DIV) 
(INFIX (LIST 'DIV)) 
(PUT 'DIV 'DVFSF_SIMPFN 'DVFSF_CHSIMPAT) 
(PUT 'DIV 'NUMBER-OF-ARGS 2) 
(PUT 'DIV 'RTYPEFN 'QUOTELOG) 
(PRECEDENCE (LIST 'DIV 'SDIV)) 
(NEWTOK '((|\||) DIV)) 
(MKOP 'ASSOC) 
(INFIX (LIST 'ASSOC)) 
(PUT 'ASSOC 'DVFSF_SIMPFN 'DVFSF_CHSIMPAT) 
(PUT 'ASSOC 'NUMBER-OF-ARGS 2) 
(PUT 'ASSOC 'RTYPEFN 'QUOTELOG) 
(PRECEDENCE (LIST 'ASSOC 'DIV)) 
(NEWTOK '((~) ASSOC)) 
(MKOP 'NASSOC) 
(INFIX (LIST 'NASSOC)) 
(PUT 'NASSOC 'DVFSF_SIMPFN 'DVFSF_CHSIMPAT) 
(PUT 'NASSOC 'NUMBER-OF-ARGS 2) 
(PUT 'NASSOC 'RTYPEFN 'QUOTELOG) 
(PRECEDENCE (LIST 'NASSOC 'ASSOC)) 
(NEWTOK '((/ ~) NASSOC)) 
(FLAG '(EQUAL NEQ SDIV DIV ASSOC NASSOC) 'SPACED) 
(FLAG '(DVFSF_CHSIMPAT) 'FULL) 
(PUT 'DVFSF_ENTER 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_ENTER 'DEFINED-ON-LINE '190) 
(PUT 'DVFSF_ENTER 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSF.RED) 
(PUT 'DVFSF_ENTER 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_ENTER (ARGL)
    (PROG (N)
      (SETQ N (COND (ARGL (REVAL1 (CAR ARGL) T)) (T 0)))
      (COND
       ((AND ARGL (CDR ARGL))
        (PROGN
         (LPRIM (LIST "extra" (IOTO_CPLU "argument" (CDDR ARGL)) "ignored"))
         (SETQ ARGL (LIST (CAR ARGL))))))
      (COND
       ((NOT (OR (EQUAL N 0) (PRIMEP N)))
        (RETURN (CONS NIL "dvfsf extra argument must be 0 or prime"))))
      (COND
       ((LEQ N 0) (PROGN (LPRIM "p is being cleared") (CLEAR (LIST 'P)) NIL))
       (T (PROGN (LPRIM (LIST "p is set to" N)) (SETK 'P (AEVAL N)) NIL)))
      (FLAG '(P) 'RESERVED)
      (SETQ DVFSF_P* N)
      (RETURN (CONS T ARGL)))) 
(PUT 'DVFSF_EXIT 'NUMBER-OF-ARGS 0) 
(PUT 'DVFSF_EXIT 'DEFINED-ON-LINE '225) 
(PUT 'DVFSF_EXIT 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSF.RED) 
(PUT 'DVFSF_EXIT 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE DVFSF_EXIT NIL (PROGN (REMFLAG '(P) 'SHARE) (REMFLAG '(P) 'RESERVED))) 
(PUT 'DVFSF_SIMPTERM 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_SIMPTERM 'DEFINED-ON-LINE '233) 
(PUT 'DVFSF_SIMPTERM 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSF.RED) 
(PUT 'DVFSF_SIMPTERM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_SIMPTERM (U) (CAR (SIMP U))) 
(PUT 'DVFSF_PREPAT 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_PREPAT 'DEFINED-ON-LINE '238) 
(PUT 'DVFSF_PREPAT 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSF.RED) 
(PUT 'DVFSF_PREPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_PREPAT (F)
    (LIST (DVFSF_OP F) (PREPF (DVFSF_ARG2L F)) (PREPF (DVFSF_ARG2R F)))) 
(PUT 'DVFSF_RESIMPAT 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_RESIMPAT 'DEFINED-ON-LINE '243) 
(PUT 'DVFSF_RESIMPAT 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSF.RED) 
(PUT 'DVFSF_RESIMPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_RESIMPAT (F)
    (DVFSF_MK2 (DVFSF_OP F) (CAR (RESIMP (CONS (DVFSF_ARG2L F) 1)))
     (CAR (RESIMP (CONS (DVFSF_ARG2R F) 1))))) 
(PUT 'DVFSF_LENGTHAT 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_LENGTHAT 'DEFINED-ON-LINE '250) 
(PUT 'DVFSF_LENGTHAT 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSF.RED) 
(PUT 'DVFSF_LENGTHAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_LENGTHAT (F) 2) 
(PUT 'DVFSF_CHSIMPAT 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_CHSIMPAT 'DEFINED-ON-LINE '255) 
(PUT 'DVFSF_CHSIMPAT 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSF.RED) 
(PUT 'DVFSF_CHSIMPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_CHSIMPAT (U)
    ((LAMBDA (G124)
       (COND ((AND G124 (CDR G124)) (CONS 'AND G124))
             ((NULL G124) (COND ((EQ 'AND 'AND) 'TRUE) (T 'FALSE)))
             (T (CAR G124))))
     (PROG (X FORALL-RESULT FORALL-ENDPTR)
       (SETQ X (DVFSF_CHSIMPAT1 U))
       (COND ((NULL X) (RETURN NIL)))
       (SETQ FORALL-RESULT
               (SETQ FORALL-ENDPTR
                       (CONS ((LAMBDA (X) (DVFSF_SIMPAT X)) (CAR X)) NIL)))
      LOOPLABEL
       (SETQ X (CDR X))
       (COND ((NULL X) (RETURN FORALL-RESULT)))
       (RPLACD FORALL-ENDPTR
               (CONS ((LAMBDA (X) (DVFSF_SIMPAT X)) (CAR X)) NIL))
       (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
       (GO LOOPLABEL)))) 
(PUT 'DVFSF_CHSIMPAT1 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_CHSIMPAT1 'DEFINED-ON-LINE '262) 
(PUT 'DVFSF_CHSIMPAT1 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSF.RED) 
(PUT 'DVFSF_CHSIMPAT1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_CHSIMPAT1 (U)
    (PROG (LEFTL RIGHTL LHS RHS)
      (SETQ LHS (CADR U))
      (COND
       ((AND (PAIRP LHS) (DVFSF_OPP (CAR LHS)))
        (PROGN
         (SETQ LEFTL (DVFSF_CHSIMPAT1 LHS))
         (SETQ LHS (CADDR (LASTCAR LEFTL))))))
      (SETQ RHS (CADDR U))
      (COND
       ((AND (PAIRP RHS) (DVFSF_OPP (CAR RHS)))
        (PROGN
         (SETQ RIGHTL (DVFSF_CHSIMPAT1 RHS))
         (SETQ RHS (CADR (CAR RIGHTL))))))
      (RETURN (NCONC LEFTL (CONS (LIST (CAR U) LHS RHS) RIGHTL))))) 
(PUT 'DVFSF_SIMPAT 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_SIMPAT 'DEFINED-ON-LINE '280) 
(PUT 'DVFSF_SIMPAT 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSF.RED) 
(PUT 'DVFSF_SIMPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_SIMPAT (U)
    (PROG (OP LHS RHS W)
      (SETQ OP (CAR U))
      (SETQ LHS (SIMP (CADR U)))
      (COND ((NOT (NUMBERP (CDR LHS))) (TYPERR U "atomic formula")))
      (SETQ RHS (SIMP (CADDR U)))
      (COND ((NOT (NUMBERP (CDR RHS))) (TYPERR U "atomic formula")))
      (COND
       ((MEMQ OP '(EQUAL NEQ))
        (RETURN (DVFSF_0MK2 OP (CAR (ADDSQ LHS (NEGSQ RHS)))))))
      (SETQ W (LCM (CDR LHS) (CDR RHS)))
      (RETURN
       (DVFSF_MK2 OP (CAR (MULTSQ LHS (CONS W 1)))
        (CAR (MULTSQ RHS (CONS W 1))))))) 
(PUT 'DVFSF_OP 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_OP 'DEFINED-ON-LINE '297) 
(PUT 'DVFSF_OP 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSF.RED) 
(PUT 'DVFSF_OP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_OP (ATF) (CAR ATF)) 
(PUT 'DVFSF_ARG2L 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_ARG2L 'DEFINED-ON-LINE '302) 
(PUT 'DVFSF_ARG2L 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSF.RED) 
(PUT 'DVFSF_ARG2L 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_ARG2L (ATF) (CADR ATF)) 
(PUT 'DVFSF_ARG2R 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_ARG2R 'DEFINED-ON-LINE '307) 
(PUT 'DVFSF_ARG2R 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSF.RED) 
(PUT 'DVFSF_ARG2R 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_ARG2R (ATF) (CADDR ATF)) 
(PUT 'DVFSF_ARGN 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_ARGN 'DEFINED-ON-LINE '312) 
(PUT 'DVFSF_ARGN 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSF.RED) 
(PUT 'DVFSF_ARGN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_ARGN (ATF) (LIST (CADR ATF) (CADDR ATF))) 
(PUT 'DVFSF_MK2 'NUMBER-OF-ARGS 3) 
(PUT 'DVFSF_MK2 'DEFINED-ON-LINE '318) 
(PUT 'DVFSF_MK2 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSF.RED) 
(PUT 'DVFSF_MK2 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_MK2 (OP LHS RHS) (LIST OP LHS RHS)) 
(PUT 'DVFSF_0MK2 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_0MK2 'DEFINED-ON-LINE '325) 
(PUT 'DVFSF_0MK2 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSF.RED) 
(PUT 'DVFSF_0MK2 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DVFSF_0MK2 (OP LHS) (LIST OP LHS NIL)) 
(PUT 'DVFSF_MKN 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_MKN 'DEFINED-ON-LINE '332) 
(PUT 'DVFSF_MKN 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSF.RED) 
(PUT 'DVFSF_MKN 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DVFSF_MKN (OP ARGL) (LIST OP (CAR ARGL) (CADR ARGL))) 
(PUT 'DVFSF_OPP 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_OPP 'DEFINED-ON-LINE '339) 
(PUT 'DVFSF_OPP 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSF.RED) 
(PUT 'DVFSF_OPP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_OPP (OP) (MEMQ OP '(EQUAL NEQ DIV SDIV ASSOC NASSOC))) 
(ENDMODULE) 