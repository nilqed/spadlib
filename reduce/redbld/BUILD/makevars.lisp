(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'MAKEVARS)) 
(FLUID '(*GENSYMLIST* *PURERISCH)) 
(SETQ *GENSYMLIST*
        '(| J| | K| | M| | N| | P| | Q| | R| | S| | T| | U| | V| | W| | X| | Y|
          | Z|)) 
(PUT 'VARSINLIST 'NUMBER-OF-ARGS 2) 
(PUT 'VARSINLIST 'DEFINED-ON-LINE '47) 
(PUT 'VARSINLIST 'DEFINED-IN-FILE 'INT/MAKEVARS.RED) 
(PUT 'VARSINLIST 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VARSINLIST (L VL)
    (PROG ()
      (PROG ()
       WHILELABEL
        (COND ((NOT (NOT (NULL L))) (RETURN NIL)))
        (PROGN
         (SETQ VL (VARSINSF (CAR (CAR L)) (VARSINSF (CDR (CAR L)) VL)))
         (SETQ L (CDR L)))
        (GO WHILELABEL))
      (RETURN VL))) 
(PUT 'GETVARIABLES 'NUMBER-OF-ARGS 1) 
(PUT 'GETVARIABLES 'DEFINED-ON-LINE '56) 
(PUT 'GETVARIABLES 'DEFINED-IN-FILE 'INT/MAKEVARS.RED) 
(PUT 'GETVARIABLES 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE GETVARIABLES (SQ) (VARSINSF (CAR SQ) (VARSINSF (CDR SQ) NIL))) 
(PUT 'VARSINSF 'NUMBER-OF-ARGS 2) 
(PUT 'VARSINSF 'DEFINED-ON-LINE '59) 
(PUT 'VARSINSF 'DEFINED-IN-FILE 'INT/MAKEVARS.RED) 
(PUT 'VARSINSF 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VARSINSF (FORM L)
    (COND ((OR (ATOM FORM) (ATOM (CAR FORM))) L)
          (T
           (PROG ()
             (PROG ()
              WHILELABEL
               (COND
                ((NOT (NOT (OR (ATOM FORM) (ATOM (CAR FORM))))) (RETURN NIL)))
               (PROGN
                (SETQ L (VARSINSF (CDAR FORM) (UNION L (LIST (CAAAR FORM)))))
                (SETQ FORM (CDR FORM)))
               (GO WHILELABEL))
             (RETURN L))))) 
(PUT 'FINDZVARS 'NUMBER-OF-ARGS 4) 
(PUT 'FINDZVARS 'DEFINED-ON-LINE '68) 
(PUT 'FINDZVARS 'DEFINED-IN-FILE 'INT/MAKEVARS.RED) 
(PUT 'FINDZVARS 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE FINDZVARS (VL ZL VAR FLG)
    (PROG (V)
     SCAN
      (COND ((NULL VL) (RETURN ZL)))
      (SETQ V (CAR VL))
      (SETQ VL (CDR VL))
      (COND
       ((AND (ATOM V) (NEQ V VAR) (DEPENDS V VAR))
        (SETQ ZL (UNION (LIST V) ZL)))
       ((AND (NOT (ATOM V)) (NOT (MEMBER V ZL)) (DEPENDSP V VAR))
        (COND ((EQUAL (CAR V) '*SQ) (SETQ ZL (FINDZVARSSQ (CADR V) ZL VAR)))
              ((OR (MEMQ (CAR V) '(TIMES QUOTIENT PLUS MINUS DIFFERENCE))
                   (AND (EQ (CAR V) 'EXPT) (FIXP (CADDR V))))
               (SETQ ZL (FINDZVARS (CDR V) ZL VAR FLG)))
              ((AND (EQ (CAR V) 'EXPT) (EQCAR (CADDR V) 'TIMES)
                    (FIXP (CADR (CADDR V))))
               (PROGN
                (SETQ V
                        (CONS
                         (COND
                          ((NULL (CDDDR (CADDR V)))
                           (LIST 'EXPT (CADR V) (CADDR (CADDR V))))
                          (T
                           (LIST 'EXPT (CADR V)
                                 (CONS 'TIMES (CDDR (CADDR V))))))
                         (CDR V)))
                (SETQ ZL (FINDZVARS V ZL VAR FLG))))
              ((AND FLG (EQ (CAR V) 'DF))
               (PROGN (SETQ *PURERISCH T) (RETURN ZL)))
              (T (SETQ ZL (CONS V (FINDZVARS (CDR V) ZL VAR FLG)))))))
      (GO SCAN))) 
(PUT 'FINDZVARSSQ 'NUMBER-OF-ARGS 3) 
(PUT 'FINDZVARSSQ 'DEFINED-ON-LINE '105) 
(PUT 'FINDZVARSSQ 'DEFINED-IN-FILE 'INT/MAKEVARS.RED) 
(PUT 'FINDZVARSSQ 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FINDZVARSSQ (SQ ZL VAR)
    (FINDZVARSF (CAR SQ) (FINDZVARSF (CDR SQ) ZL VAR) VAR)) 
(PUT 'FINDZVARSF 'NUMBER-OF-ARGS 3) 
(PUT 'FINDZVARSF 'DEFINED-ON-LINE '108) 
(PUT 'FINDZVARSF 'DEFINED-IN-FILE 'INT/MAKEVARS.RED) 
(PUT 'FINDZVARSF 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FINDZVARSF (SF ZL VAR)
    (COND ((OR (ATOM SF) (ATOM (CAR SF))) ZL)
          (T
           (FINDZVARSF (CDAR SF)
            (FINDZVARSF (CDR SF) (FINDZVARS (LIST (CAAAR SF)) ZL VAR NIL) VAR)
            VAR)))) 
(PUT 'CREATEINDICES 'NUMBER-OF-ARGS 1) 
(PUT 'CREATEINDICES 'DEFINED-ON-LINE '116) 
(PUT 'CREATEINDICES 'DEFINED-IN-FILE 'INT/MAKEVARS.RED) 
(PUT 'CREATEINDICES 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CREATEINDICES (ZL) (REVERSIP (CRINDEX1 ZL *GENSYMLIST*))) 
(PUT 'CRINDEX1 'NUMBER-OF-ARGS 2) 
(PUT 'CRINDEX1 'DEFINED-ON-LINE '121) 
(PUT 'CRINDEX1 'DEFINED-IN-FILE 'INT/MAKEVARS.RED) 
(PUT 'CRINDEX1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CRINDEX1 (ZL GL)
    (PROG ()
      (COND ((NULL ZL) (RETURN NIL)))
      (COND
       ((NULL GL)
        (PROGN (SETQ GL (LIST (INT-GENSYM1 'I))) (NCONC *GENSYMLIST* GL))))
      (RETURN (CONS (CAR GL) (CRINDEX1 (CDR ZL) (CDR GL)))))) 
(PUT 'CDRMEMBER 'NUMBER-OF-ARGS 2) 
(PUT 'CDRMEMBER 'DEFINED-ON-LINE '127) 
(PUT 'CDRMEMBER 'DEFINED-IN-FILE 'INT/MAKEVARS.RED) 
(PUT 'CDRMEMBER 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CDRMEMBER (A B)
    (COND ((NULL B) NIL) ((EQUAL A (CDAR B)) (CAR B))
          (T (CDRMEMBER A (CDR B))))) 
(PUT 'MERGEIN 'NUMBER-OF-ARGS 2) 
(PUT 'MERGEIN 'DEFINED-ON-LINE '132) 
(PUT 'MERGEIN 'DEFINED-IN-FILE 'INT/MAKEVARS.RED) 
(PUT 'MERGEIN 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MERGEIN (DL LL)
    (COND ((NULL DL) LL) ((CDRMEMBER (CAR DL) LL) (MERGEIN (CDR DL) LL))
          (T (MERGEIN (CDR DL) (CONS (CONS 'LOG (CAR DL)) LL))))) 
(ENDMODULE) 