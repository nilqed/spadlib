(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'EXPTCHK)) 
(FLUID '(*COMBINEEXPT)) 
(SWITCH (LIST 'COMBINEEXPT)) 
(PUT 'COMBINEEXPT 'SIMPFG '((T (RMSUBS)) (NIL (RMSUBS)))) 
(PUT 'EXPTCHKSQ 'NUMBER-OF-ARGS 1) 
(PUT 'EXPTCHKSQ 'DEFINED-ON-LINE '38) 
(PUT 'EXPTCHKSQ 'DEFINED-IN-FILE 'ALG/EXPTCHK.RED) 
(PUT 'EXPTCHKSQ 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE EXPTCHKSQ (U)
    (COND ((NULL *COMBINEEXPT) U)
          (T (MULTSQ (EXPTCHK (CAR U)) (INVSQ (EXPTCHK (CDR U))))))) 
(PUT 'EXPTCHK 'NUMBER-OF-ARGS 1) 
(PUT 'EXPTCHK 'DEFINED-ON-LINE '44) 
(PUT 'EXPTCHK 'DEFINED-IN-FILE 'ALG/EXPTCHK.RED) 
(PUT 'EXPTCHK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE EXPTCHK (U)
    (COND ((OR (ATOM U) (ATOM (CAR U))) (CONS U 1))
          (T
           ((LAMBDA (V)
              (COND ((LESSP (LENGTH V) 2) (CONS U 1)) (T (EXPTCHK0 U NIL V))))
            (COMM_KERNELS U))))) 
(PUT 'EXPTCHK0 'NUMBER-OF-ARGS 3) 
(PUT 'EXPTCHK0 'DEFINED-ON-LINE '48) 
(PUT 'EXPTCHK0 'DEFINED-IN-FILE 'ALG/EXPTCHK.RED) 
(PUT 'EXPTCHK0 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE EXPTCHK0 (U V W)
    (COND ((NULL U) (CONS NIL 1))
          ((OR (ATOM U) (ATOM (CAR U))) (EXPTUNWIND U V))
          ((EXPTTERMP (CAAAR U) W)
           (ADDSQ (EXPTCHK0 (CDAR U) (CONS (CAAR U) V) W)
                  (EXPTCHK0 (CDR U) V W)))
          (T
           (ADDSQ
            (MULTSQ (CONS (LIST (CONS (CAAR U) 1)) 1) (EXPTCHK0 (CDAR U) V W))
            (EXPTCHK0 (CDR U) V W))))) 
(PUT 'EXPTTERMP 'NUMBER-OF-ARGS 2) 
(PUT 'EXPTTERMP 'DEFINED-ON-LINE '55) 
(PUT 'EXPTTERMP 'DEFINED-IN-FILE 'ALG/EXPTCHK.RED) 
(PUT 'EXPTTERMP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE EXPTTERMP (U V)
    (COND ((EQCAR U 'EXPT) (EXPTTERMP1 (CADR U) V)) (T (EXPTTERMP1 U V)))) 
(PUT 'EXPTTERMP1 'NUMBER-OF-ARGS 2) 
(PUT 'EXPTTERMP1 'DEFINED-ON-LINE '58) 
(PUT 'EXPTTERMP1 'DEFINED-IN-FILE 'ALG/EXPTCHK.RED) 
(PUT 'EXPTTERMP1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE EXPTTERMP1 (U V)
    (AND V
         (OR (EQUAL U (CAR V)) (AND (EQCAR (CAR V) 'EXPT) (EQUAL U (CADAR V)))
             (EXPTTERMP1 U (CDR V))))) 
(PUT 'EXPTUNWIND 'NUMBER-OF-ARGS 2) 
(PUT 'EXPTUNWIND 'DEFINED-ON-LINE '62) 
(PUT 'EXPTUNWIND 'DEFINED-IN-FILE 'ALG/EXPTCHK.RED) 
(PUT 'EXPTUNWIND 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE EXPTUNWIND (U V)
    (PROG (N W X)
      (SETQ N 0)
      (SETQ N 1)
      (PROG ()
       WHILELABEL
        (COND ((NOT V) (RETURN NIL)))
        (PROGN
         (COND
          ((AND (CDR V) (SETQ W (MELDX (CAR V) (CDR V))))
           (PROGN
            (SETQ X (MERGEX (CAR V) W))
            (COND
             ((FIXP X)
              (PROGN (SETQ N (TIMES X N)) (SETQ V (DELETE W (CDR V)))))
             (T (SETQ V (CONS X (DELETE W (CDR V))))))))
          (T
           (PROGN
            (SETQ U
                    ((LAMBDA (G188)
                       (COND (*PHYSOP-LOADED (PHYSOP-MULTF G188 U))
                             (T (POLY-MULTF G188 U))))
                     (LIST (CONS (CAR V) 1))))
            (SETQ V (CDR V))))))
        (GO WHILELABEL))
      (SETQ U (RM_NEG_POW U))
      (RETURN (MULTSQ (CONS N 1) U)))) 
(PUT 'RM_NEG_POW 'NUMBER-OF-ARGS 1) 
(PUT 'RM_NEG_POW 'DEFINED-ON-LINE '79) 
(PUT 'RM_NEG_POW 'DEFINED-IN-FILE 'ALG/EXPTCHK.RED) 
(PUT 'RM_NEG_POW 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE RM_NEG_POW (U)
    (COND ((OR (ATOM U) (ATOM (CAR U))) (CONS U 1))
          ((MINUSP (CDAAR U))
           (ADDSQ
            (MULTSQ
             (CONS 1 (CONS (CONS (CONS (CAAAR U) (MINUS (CDAAR U))) 1) NIL))
             (RM_NEG_POW (CDAR U)))
            (RM_NEG_POW (CDR U))))
          (T
           (ADDSQ
            (MULTSQ (CONS (LIST (CONS (CAAR U) 1)) 1) (RM_NEG_POW (CDAR U)))
            (RM_NEG_POW (CDR U)))))) 
(PUT 'MERGEX 'NUMBER-OF-ARGS 2) 
(PUT 'MERGEX 'DEFINED-ON-LINE '86) 
(PUT 'MERGEX 'DEFINED-IN-FILE 'ALG/EXPTCHK.RED) 
(PUT 'MERGEX 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MERGEX (U V)
    (COND
     ((EQCAR (CAR U) 'EXPT)
      (COND
       ((EQCAR (CAR V) 'EXPT)
        (COND
         ((EQUAL (CADAR U) (CADAR V))
          (MERGEY (CADAR U) (CADDAR U) (CADDAR V) (CDR U) (CDR V)))
         ((AND (EQUAL (CADDAR U) (CADDAR V)) (EQUAL (CDR U) (CDR V)))
          (GETPOWER
           (FKERN (LIST 'EXPT (LIST 'TIMES (CADAR U) (CADAR V)) (CADDAR U)))
           (CDR U)))
         (T (REDERR 'FOO))))
       (T (MERGEY (CADAR U) (CADDAR U) 1 (CDR U) (CDR V)))))
     ((EQCAR (CAR V) 'EXPT) (MERGEY (CAR U) 1 (CADDAR V) (CDR U) (CDR V)))
     (T (REDERR (LIST 'MERGEX U V))))) 
(PUT 'MERGEY 'NUMBER-OF-ARGS 5) 
(PUT 'MERGEY 'DEFINED-ON-LINE '99) 
(PUT 'MERGEY 'DEFINED-IN-FILE 'ALG/EXPTCHK.RED) 
(PUT 'MERGEY 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE MERGEY (U V W X Y)
    (PROG ()
      (SETQ X (SIMP* (LIST 'PLUS (LIST 'TIMES V X) (LIST 'TIMES W Y))))
      (COND
       ((NEQ (SETQ Y (INTCOEFF (CAR X))) 1)
        (SETQ X (CONS ((LAMBDA (*EXP) (QUOTF1 (CAR X) Y)) T) (CDR X)))))
      (SETQ X (PREPSQ* X))
      (RETURN
       (COND ((AND (FIXP U) (FIXP X)) (EXPT (EXPT U X) Y))
             (T (GETPOWER (FKERN (LIST 'EXPT U X)) Y)))))) 
(PUT 'INTCOEFF 'NUMBER-OF-ARGS 1) 
(PUT 'INTCOEFF 'DEFINED-ON-LINE '107) 
(PUT 'INTCOEFF 'DEFINED-IN-FILE 'ALG/EXPTCHK.RED) 
(PUT 'INTCOEFF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE INTCOEFF (U)
    (COND ((OR (ATOM U) (ATOM (CAR U))) (COND ((FIXP U) U) (T 1)))
          (T
           ((LAMBDA (N)
              (COND ((NULL (CDR U)) N) (T (GCDN N (INTCOEFF (CDR U))))))
            (INTCOEFF (CDAR U)))))) 
(PUT 'MELDX 'NUMBER-OF-ARGS 2) 
(PUT 'MELDX 'DEFINED-ON-LINE '113) 
(PUT 'MELDX 'DEFINED-IN-FILE 'ALG/EXPTCHK.RED) 
(PUT 'MELDX 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MELDX (U V)
    (COND
     ((EQCAR (CAR U) 'EXPT)
      ((LAMBDA (W)
         (COND (W W) ((EQCAR (CAAR V) 'EXPT) (MELDX1 U (DELETE U V))) (T NIL)))
       (MELDX0 (CADAR U) (DELETE U V))))
     (T (MELDX0 (CAR U) (DELETE U V))))) 
(PUT 'MELDX0 'NUMBER-OF-ARGS 2) 
(PUT 'MELDX0 'DEFINED-ON-LINE '120) 
(PUT 'MELDX0 'DEFINED-IN-FILE 'ALG/EXPTCHK.RED) 
(PUT 'MELDX0 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MELDX0 (U V)
    (COND ((NULL V) NIL)
          ((OR (AND (EQCAR (CAAR V) 'EXPT) (EQUAL U (CADAAR V)))
               (EQUAL U (CAAR V)))
           (CAR V))
          (T (MELDX0 U (CDR V))))) 
(PUT 'MELDX1 'NUMBER-OF-ARGS 2) 
(PUT 'MELDX1 'DEFINED-ON-LINE '125) 
(PUT 'MELDX1 'DEFINED-IN-FILE 'ALG/EXPTCHK.RED) 
(PUT 'MELDX1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MELDX1 (U V)
    (COND ((NULL V) NIL)
          ((AND (EQCAR (CAR V) 'EXPT) (EQUAL (CADDAR U) (CADDAR (CAR V)))
                (EQUAL (CDR U) (CDAR V)))
           (CAR V))
          (T (MELDX1 U (CDR V))))) 
(PUT 'COMM_KERNELS 'NUMBER-OF-ARGS 1) 
(PUT 'COMM_KERNELS 'DEFINED-ON-LINE '132) 
(PUT 'COMM_KERNELS 'DEFINED-IN-FILE 'ALG/EXPTCHK.RED) 
(PUT 'COMM_KERNELS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE COMM_KERNELS (U) (COMM_KERNELS1 U NIL)) 
(PUT 'COMM_KERNELS1 'NUMBER-OF-ARGS 2) 
(PUT 'COMM_KERNELS1 'DEFINED-ON-LINE '136) 
(PUT 'COMM_KERNELS1 'DEFINED-IN-FILE 'ALG/EXPTCHK.RED) 
(PUT 'COMM_KERNELS1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE COMM_KERNELS1 (U V)
    (COND ((OR (ATOM U) (ATOM (CAR U))) V)
          (T
           ((LAMBDA (X)
              (COMM_KERNELS1 (CDAR U)
                             (COMM_KERNELS1 (CDR U)
                                            (COND
                                             ((OR (MEMQ X V)
                                                  (AND *NCMP (NONCOMP1 X)))
                                              V)
                                             (T (APPEND V (LIST X)))))))
            (CAAAR U))))) 
(ENDMODULE) 