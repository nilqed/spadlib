(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'QQEQE)) 
(REVISION 'QQEQE "$Id: qqeqe.red 5986 2021-08-28 13:35:27Z thomas-sturm $") 
(COPYRIGHT 'QQEQE "Copyright (c) 2005-2021 A. Dolzmann and T. Sturm") 
(FLUID
 '(QQE_RESF* QQE_QVARF* QQE_ATF-QEQUAL-EXT-C* QQE_ATF-QEQUAL-EXT-P*
   QQE_ATF-EQUAL-EXT* QQE_ATF-EQUAL-INT* QQE_ATF-MISC-BASIC*
   QQE_ATF-QEQUAL-INT* QQE_LA* QQE_RA* QQE_PAT-LENGTHS* QQE_SF*
   QQE_ATF-QNEQ-INT* QQE_ATF-QNEQ-EXT* QQE_ATF-QNEQ-EXT-QEPSILON* QQE_ATF-NEQ*
   QQE_VAR* QQE_QQU-LIST* QQE_BQU-LIST*)) 
(PUT 'QQE_SATLENGTHS 'NUMBER-OF-ARGS 4) 
(PUT 'QQE_SATLENGTHS 'DEFINED-ON-LINE '63) 
(PUT 'QQE_SATLENGTHS 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQE.RED) 
(PUT 'QQE_SATLENGTHS 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE QQE_SATLENGTHS (MINLENGTH MAXLENGTH LCM LARA)
    (PROG (LIST SLL)
      (COND
       (LCM
        (PROG (J)
          (SETQ J 0)
         LAB
          (COND ((MINUSP (DIFFERENCE (DIFFERENCE LCM 1) J)) (RETURN NIL)))
          (SETQ SLL (APPEND SLL (LIST J)))
          (SETQ J (PLUS2 J 1))
          (GO LAB)))
       (T (SETQ SLL (LIST 0))))
      (PROG (J)
        (SETQ J MINLENGTH)
       LAB
        (COND ((MINUSP (DIFFERENCE (MAX LARA MINLENGTH) J)) (RETURN NIL)))
        (PROGN
         (PROG (X)
           (SETQ X SLL)
          LAB
           (COND ((NULL X) (RETURN NIL)))
           ((LAMBDA (X)
              (COND
               ((OR (NULL MAXLENGTH) (GEQ MAXLENGTH (PLUS J X)))
                (SETQ LIST (LTO_INSERTQ (PLUS J X) LIST)))))
            (CAR X))
           (SETQ X (CDR X))
           (GO LAB))
         NIL)
        (SETQ J (PLUS2 J 1))
        (GO LAB))
      (COND
       ((AND (NULL LCM) QQE_ATF-QNEQ-INT*)
        (SETQ LIST (LTO_INSERTQ (PLUS LARA 1) LIST))))
      (RETURN (QQE_QUICKSORT LIST)))) 
(PUT 'QQE_QE 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_QE 'DEFINED-ON-LINE '94) 
(PUT 'QQE_QE 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQE.RED) 
(PUT 'QQE_QE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_QE (U)
    (PROG (F)
      (SETQ F (RL_PNF U))
      (SETQ F (CADR (QQE_GET-QUANTIFIER-SEQUENZ F)))
      (SETQ F (QQE_LA2LTH F))
      (SETQ QQE_ELIMB* T)
      (COND
       ((NULL QQE_QQU-LIST*)
        (PROGN
         (COND
          (QQE_ELIMB*
           (PROGN
            (SETQ F
                    (QQE_SIMPL-DNF
                     (RL_DNF
                      (QQE_QE-BASIC
                       (QQE_ITERATE-QUANTIFIER QQE_BQU-LIST* F)))))
            (QQE_QEEXIT)
            (RETURN F)
            NIL))
          (T (PROGN (QQE_QEEXIT) (RETURN U) NIL)))
         NIL)))
      (PROG (Q)
        (SETQ Q QQE_QQU-LIST*)
       LAB
        (COND ((NULL Q) (RETURN NIL)))
        ((LAMBDA (Q)
           (PROGN
            (COND
             ((NOT (ATOM F))
              (PROGN
               (COND
                ((EQ (CAR Q) 'EX)
                 (SETQ F (CADR (QQE_GET-QUANTIFIER-SEQUENZ F))))
                (T
                 (PROGN
                  (SETQ F
                          (RL_DNF
                           (CADR (QQE_GET-QUANTIFIER-SEQUENZ (LIST 'NOT F)))))
                  (SETQ F (QQE_MAKE-HARMLESS F))
                  NIL)))
               (SETQ F (QQE_LA2LTH F))
               (SETQ F (RL_DNF F))
               (COND
                ((EQ (CAR Q) 'EX) (SETQ F (RL_PNF (QQE_QE-DNF F (CADR Q)))))
                (T (SETQ F (RL_PNF (LIST 'NOT (QQE_QE-DNF F (CADR Q)))))))
               NIL)))
            NIL))
         (CAR Q))
        (SETQ Q (CDR Q))
        (GO LAB))
      (SETQ F (RL_PNF (RL_SIMPLBASIC F NIL (MINUS 1))))
      (COND
       ((NOT (ATOM F))
        (PROGN
         ((LAMBDA (X) (PROGN (COND (X (SETQ F (CADR X))))))
          (QQE_GET-QUANTIFIER-SEQUENZ F))
         (SETQ F (QQE_SIMPL-DNF (RL_DNF F)))
         (SETQ F (QQE_ITERATE-QUANTIFIER QQE_BQU-LIST* F))
         NIL)))
      (QQE_QEEXIT)
      (RETURN (COND (QQE_ELIMB* (QQE_QE-BASIC F)) (T F))))) 
(PUT 'QQE_QEEXIT 'NUMBER-OF-ARGS 0) 
(PUT 'QQE_QEEXIT 'DEFINED-ON-LINE '149) 
(PUT 'QQE_QEEXIT 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQE.RED) 
(PUT 'QQE_QEEXIT 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE QQE_QEEXIT NIL
    (PROG ()
      (SETQ QQE_RESF* NIL)
      (SETQ QQE_QVARF* NIL)
      (SETQ QQE_ATF-QEQUAL-EXT-C* NIL)
      (SETQ QQE_ATF-QEQUAL-EXT-P* NIL)
      (SETQ QQE_ATF-EQUAL-EXT* NIL)
      (SETQ QQE_ATF-EQUAL-INT* NIL)
      (SETQ QQE_ATF-MISC-BASIC* NIL)
      (SETQ QQE_ATF-QEQUAL-INT* NIL)
      (SETQ QQE_LA* NIL)
      (SETQ QQE_RA* NIL)
      (SETQ QQE_PAT-LENGTHS* NIL)
      (SETQ QQE_SF* NIL)
      (SETQ QQE_ATF-QNEQ-INT* NIL)
      (SETQ QQE_ATF-QNEQ-EXT* NIL)
      (SETQ QQE_ATF-QNEQ-EXT-QEPSILON* NIL)
      (SETQ QQE_ATF-NEQ* NIL)
      (SETQ QQE_VAR* NIL)
      (SETQ QQE_QQU-LIST* NIL)
      (SETQ QQE_BQU-LIST* NIL))) 
(PUT 'QQE_QE-CLAUSE-INIT 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_QE-CLAUSE-INIT 'DEFINED-ON-LINE '173) 
(PUT 'QQE_QE-CLAUSE-INIT 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQE.RED) 
(PUT 'QQE_QE-CLAUSE-INIT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_QE-CLAUSE-INIT (U)
    (PROG ()
      (SETQ QQE_RESF* NIL)
      (SETQ QQE_QVARF* NIL)
      (SETQ QQE_ATF-QEQUAL-EXT-C* NIL)
      (SETQ QQE_ATF-QEQUAL-EXT-P* NIL)
      (SETQ QQE_ATF-EQUAL-EXT* NIL)
      (SETQ QQE_ATF-EQUAL-INT* NIL)
      (SETQ QQE_ATF-MISC-BASIC* NIL)
      (SETQ QQE_ATF-QEQUAL-INT* NIL)
      (SETQ QQE_LA* NIL)
      (SETQ QQE_RA* NIL)
      (SETQ QQE_PAT-LENGTHS* NIL)
      (SETQ QQE_SF* NIL)
      (SETQ QQE_ATF-QNEQ-INT* NIL)
      (SETQ QQE_ATF-QNEQ-EXT* NIL)
      (SETQ QQE_ATF-QNEQ-EXT-QEPSILON* NIL)
      (SETQ QQE_ATF-NEQ* NIL)
      (SETQ QQE_VAR* NIL)
      (RETURN (QQE_CLAUSE-UPDATE-LENGTHS U T)))) 
(PUT 'QQE_QE-DNF 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_QE-DNF 'DEFINED-ON-LINE '201) 
(PUT 'QQE_QE-DNF 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQE.RED) 
(PUT 'QQE_QE-DNF 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_QE-DNF (U Q)
    (PROG (F TEMP)
      (COND ((MEMQ U '(TRUE FALSE)) (RETURN U))
            ((EQ (CAR U) 'OR)
             (PROGN
              (SETQ F (LIST 'OR))
              (COND
               ((CDDR U)
                (PROGN
                 (PROG (X)
                   (SETQ X (CDR U))
                  LAB
                   (COND ((NULL X) (RETURN NIL)))
                   ((LAMBDA (X)
                      (PROGN
                       (SETQ TEMP (QQE_QE-CLAUSE X Q))
                       (SETQ F (APPEND F (LIST TEMP)))
                       NIL))
                    (CAR X))
                   (SETQ X (CDR X))
                   (GO LAB))
                 NIL))
               (T (SETQ F (QQE_QE-CLAUSE (CADR U) Q))))
              NIL))
            (T (SETQ F (QQE_QE-CLAUSE U Q))))
      (RETURN F))) 
(PUT 'QQE_QE-CLAUSE 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_QE-CLAUSE 'DEFINED-ON-LINE '225) 
(PUT 'QQE_QE-CLAUSE 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQE.RED) 
(PUT 'QQE_QE-CLAUSE 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_QE-CLAUSE (U Q)
    (PROG (F LIST)
      (SETQ LIST (QQE_QE-CLAUSE-INIT U))
      (COND ((EQ LIST 'FALSE) (SETQ U 'FALSE))
            (LIST
             (PROGN
              (COND
               ((NULL (QQE_HARMLESS-FORMULA-TEST-CLAUSE1 U LIST))
                (PROGN
                 (QQE_LENGTH-GRAPH-DELETE LIST)
                 (QQE_QEEXIT)
                 (REDERR "input formula is not harmless")
                 NIL)))
              NIL)))
      (COND ((NOT (ATOM U)) (SETQ U (QQE_SIMPL-CLAUSE U))))
      (COND
       ((IDP U)
        (PROGN
         (COND ((NEQ LIST 'FALSE) (QQE_LENGTH-GRAPH-DELETE LIST)))
         (RETURN U)
         NIL)))
      (SETQ F U)
      (SETQ QQE_VAR* Q)
      (SETQ QQE_SF* F)
      (QQE_SORT-ATF QQE_SF* QQE_VAR*)
      (COND
       ((NULL QQE_QVARF*)
        (PROGN (QQE_LENGTH-GRAPH-DELETE LIST) (RETURN F) NIL)))
      (SETQ QQE_LA* (QQE_LA))
      (SETQ QQE_RA* (QQE_RA))
      (COND
       ((OR QQE_ATF-QEQUAL-EXT-C* QQE_ATF-QEQUAL-EXT-P*)
        (PROGN
         (SETQ F (QQE_QE-DNA))
         (COND (QQE_RESF* (SETQ F (APPEND (LIST 'AND F) QQE_RESF*))))
         NIL))
       (T
        (PROGN
         (COND (QQE_ATF-QNEQ-EXT* (SETQ F (QQE_NDNA-QNEQ-EXT)))
               (T (SETQ F (QQE_NDNA NIL NIL NIL (PLUS QQE_LA* QQE_RA*)))))
         (COND (QQE_RESF* (SETQ F (APPEND (LIST 'AND F) QQE_RESF*))))
         NIL)))
      (SETQ F (RL_SIMPLBASIC F NIL (MINUS 1)))
      (QQE_LENGTH-GRAPH-DELETE LIST)
      (RETURN F))) 
(PUT 'QQE_QE-DNA 'NUMBER-OF-ARGS 0) 
(PUT 'QQE_QE-DNA 'DEFINED-ON-LINE '285) 
(PUT 'QQE_QE-DNA 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQE.RED) 
(PUT 'QQE_QE-DNA 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE QQE_QE-DNA NIL
    (COND (QQE_ATF-QEQUAL-EXT-C* (QQE_QE-DNA-FD)) (T (QQE_QE-DNA-NFD)))) 
(PUT 'QQE_QE-DNA-FD 'NUMBER-OF-ARGS 0) 
(PUT 'QQE_QE-DNA-FD 'DEFINED-ON-LINE '292) 
(PUT 'QQE_QE-DNA-FD 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQE.RED) 
(PUT 'QQE_QE-DNA-FD 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE QQE_QE-DNA-FD NIL
    (QQE_SIMPL-CLAUSE
     (SUBST (CADDR (CAR QQE_ATF-QEQUAL-EXT-C*)) QQE_VAR* QQE_SF*))) 
(PUT 'QQE_QE-DNA-NFD 'NUMBER-OF-ARGS 0) 
(PUT 'QQE_QE-DNA-NFD 'DEFINED-ON-LINE '298) 
(PUT 'QQE_QE-DNA-NFD 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQE.RED) 
(PUT 'QQE_QE-DNA-NFD 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE QQE_QE-DNA-NFD NIL
    (PROG (L R J PHI RHO PHI_E K IDLIST MINLENGTH MAXLENGTH)
      (SETQ MINLENGTH (GET QQE_VAR* 'MINLENGTH))
      (COND ((NULL MINLENGTH) (SETQ MINLENGTH 0)))
      (SETQ MAXLENGTH (GET QQE_VAR* 'MAXLENGTH))
      (COND
       (QQE_DEBUG*
        (PRIN2T (LIST "minlength=" MINLENGTH " maxlength=" MAXLENGTH))))
      (SETQ J (QQE_ATF-QEQUAL-EXT-MIN-PREFIX))
      (SETQ L (QQE_ATF-QEQUAL-EXT-P-MIN-LEFTS MINLENGTH (CADR J)))
      (SETQ R (QQE_ATF-QEQUAL-EXT-P-MIN-RIGHTS MINLENGTH (CADR J)))
      (SETQ K (PLUS (CAR L) (CAR R)))
      (COND (MAXLENGTH (SETQ K (MIN MAXLENGTH K))))
      (SETQ IDLIST (QQE_NEW-IDS-X K QQE_SF*))
      (COND
       ((LESSP (PLUS MINLENGTH 1) K)
        (SETQ RHO (QQE_ATF-DNA-NFD-RHO IDLIST MINLENGTH K)))
       (T (SETQ RHO 'FALSE)))
      (SETQ PHI
              (QQE_SIMPL-CLAUSE
               (SUBST (QQE_ATF-DNA-NFD-PSI-SUBST L R J IDLIST) QQE_VAR*
                      QQE_SF*)))
      (COND
       ((EQUAL MINLENGTH 0)
        (SETQ PHI_E (QQE_SIMPL-CLAUSE (SUBST 'QEPSILON QQE_VAR* QQE_SF*))))
       (T (SETQ PHI_E 'FALSE)))
      (COND (QQE_DEBUG* (PROGN (PRIN2T (LIST PHI RHO PHI_E)) (PAUSE) NIL)))
      (RETURN
       (QQE_QE-BASIC
        (QQE_ITERATE-QUANTIFIER-EX K IDLIST
         (QQE_LA2LTH (LIST 'OR RHO PHI PHI_E))))))) 
(PUT 'QQE_ATF-DNA-NFD-RHO 'NUMBER-OF-ARGS 3) 
(PUT 'QQE_ATF-DNA-NFD-RHO 'DEFINED-ON-LINE '334) 
(PUT 'QQE_ATF-DNA-NFD-RHO 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQE.RED) 
(PUT 'QQE_ATF-DNA-NFD-RHO 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE QQE_ATF-DNA-NFD-RHO (IDLIST MINLENGTH KUP)
    (PROG (F FF IDLISTX)
      (PROG (J)
        (SETQ J (MAX MINLENGTH 1))
       LAB
        (COND ((MINUSP (DIFFERENCE KUP J)) (RETURN NIL)))
        (PROGN
         (SETQ IDLISTX (QQE_LIST-TAKE-N IDLIST KUP J))
         (SETQ F (QQE_SUBST J IDLISTX))
         (SETQ FF (CONS F FF))
         NIL)
        (SETQ J (PLUS2 J 1))
        (GO LAB))
      (COND ((NULL (CDR FF)) (RETURN (CAR FF))) (T (RETURN (CONS 'OR FF)))))) 
(PUT 'QQE_ATF-DNA-NFD-RHO-SUBST 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_ATF-DNA-NFD-RHO-SUBST 'DEFINED-ON-LINE '347) 
(PUT 'QQE_ATF-DNA-NFD-RHO-SUBST 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQE.RED) 
(PUT 'QQE_ATF-DNA-NFD-RHO-SUBST 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_ATF-DNA-NFD-RHO-SUBST (LIST K)
    (PROG (X F)
      (SETQ X LIST)
      (SETQ F 'QEPSILON)
      (PROG (J)
        (SETQ J 1)
       LAB
        (COND ((MINUSP (DIFFERENCE K J)) (RETURN NIL)))
        (PROGN (SETQ F (LIST 'RADD (CAR X) F)) (SETQ X (CDR X)) NIL)
        (SETQ J (PLUS2 J 1))
        (GO LAB))
      (RETURN F))) 
(PUT 'QQE_ATF-DNA-NFD-PSI-SUBST 'NUMBER-OF-ARGS 4) 
(PUT 'QQE_ATF-DNA-NFD-PSI-SUBST 'DEFINED-ON-LINE '361) 
(PUT 'QQE_ATF-DNA-NFD-PSI-SUBST 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQE.RED) 
(PUT 'QQE_ATF-DNA-NFD-PSI-SUBST 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE QQE_ATF-DNA-NFD-PSI-SUBST (L R J IDLIST)
    (PROG (X F)
      (SETQ X IDLIST)
      (SETQ F (CADDR (CADR J)))
      (COND
       ((NEQ (CADR L) (CADR J))
        (PROGN
         (PROG (JJ)
           (SETQ JJ 0)
          LAB
           (COND
            ((MINUSP
              (DIFFERENCE
               (DIFFERENCE
                (DIFFERENCE (QQE_PREFIX-LEFTS (CADR (CADR J)))
                            (QQE_PREFIX-LEFTS (CADR (CADR L))))
                1)
               JJ))
             (RETURN NIL)))
           (SETQ F
                   (LIST 'LADD
                         (LIST 'LHEAD (QQE_ITERATE-RTAIL JJ (CADDR (CADR L))))
                         F))
           (SETQ JJ (PLUS2 JJ 1))
           (GO LAB))
         NIL)))
      (COND
       ((NEQ (CAR L) 0)
        (PROGN
         (PROG (J)
           (SETQ J 1)
          LAB
           (COND ((MINUSP (DIFFERENCE (CAR L) J)) (RETURN NIL)))
           (PROGN (SETQ F (LIST 'LADD (CAR X) F)) (SETQ X (CDR X)) NIL)
           (SETQ J (PLUS2 J 1))
           (GO LAB))
         NIL)))
      (COND
       ((NEQ (CADR R) (CADR J))
        (PROGN
         (PROG (JJ)
           (SETQ JJ 0)
          LAB
           (COND
            ((MINUSP
              (DIFFERENCE
               (DIFFERENCE
                (DIFFERENCE (QQE_PREFIX-RIGHTS (CADR (CADR J)))
                            (QQE_PREFIX-RIGHTS (CADR (CADR R))))
                1)
               JJ))
             (RETURN NIL)))
           (SETQ F
                   (LIST 'RADD
                         (LIST 'RHEAD (QQE_ITERATE-LTAIL JJ (CADDR (CADR R))))
                         F))
           (SETQ JJ (PLUS2 JJ 1))
           (GO LAB))
         NIL)))
      (COND
       ((NEQ (CAR R) 0)
        (PROGN
         (PROG (JJ)
           (SETQ JJ 1)
          LAB
           (COND ((MINUSP (DIFFERENCE (CAR R) JJ)) (RETURN NIL)))
           (PROGN (SETQ F (LIST 'RADD (CAR X) F)) (SETQ X (CDR X)) NIL)
           (SETQ JJ (PLUS2 JJ 1))
           (GO LAB))
         NIL)))
      (RETURN F))) 
(PUT 'QQE_NDNA 'NUMBER-OF-ARGS 4) 
(PUT 'QQE_NDNA 'DEFINED-ON-LINE '408) 
(PUT 'QQE_NDNA 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQE.RED) 
(PUT 'QQE_NDNA 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE QQE_NDNA (MINLENGTH MAXLENGTH LCM LARA)
    (PROG (SATLENGTHS F NEW_IDS NEW_IDSX)
      (COND ((NULL MINLENGTH) (SETQ MINLENGTH (GET QQE_VAR* 'MINLENGTH))))
      (COND ((NULL MAXLENGTH) (SETQ MAXLENGTH (GET QQE_VAR* 'MAXLENGTH))))
      (COND ((NULL MINLENGTH) (SETQ MINLENGTH 0)))
      (COND
       ((AND (NULL QQE_PAT-LENGTHS*) QQE_ATF-QEQUAL-INT*)
        (PROGN
         (SETQ QQE_PAT-LENGTHS* (QQE_PAT-LENGTHS LARA))
         (COND ((NULL LCM) (SETQ LCM (QQE_LCM-LIST QQE_PAT-LENGTHS*))))
         NIL)))
      (SETQ SATLENGTHS (QQE_SATLENGTHS MINLENGTH MAXLENGTH LCM LARA))
      (COND
       (QQE_DEBUG* (PRIN2T (LIST "satlengths=" SATLENGTHS "for " QQE_VAR*))))
      (SETQ NEW_IDS (QQE_NEW-IDS-X (CAR SATLENGTHS) QQE_SF*))
      (SETQ F NIL)
      (PROG (X)
        (SETQ X SATLENGTHS)
       LAB
        (COND ((NULL X) (RETURN NIL)))
        ((LAMBDA (X)
           (PROGN
            (SETQ NEW_IDSX (QQE_LIST-TAKE-N NEW_IDS (CAR SATLENGTHS) X))
            (SETQ F
                    (CONS
                     (QQE_QE-BASIC
                      (QQE_ITERATE-QUANTIFIER-EX X NEW_IDSX
                       (QQE_SUBST X NEW_IDSX)))
                     F))
            NIL))
         (CAR X))
        (SETQ X (CDR X))
        (GO LAB))
      (COND ((CDR SATLENGTHS) (SETQ F (CONS 'OR F))) (T (SETQ F (CAR F))))
      (RETURN F))) 
(PUT 'QQE_NDNA-QNEQ-EXT-PHI2-TRUE 'NUMBER-OF-ARGS 0) 
(PUT 'QQE_NDNA-QNEQ-EXT-PHI2-TRUE 'DEFINED-ON-LINE '442) 
(PUT 'QQE_NDNA-QNEQ-EXT-PHI2-TRUE 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQE.RED) 
(PUT 'QQE_NDNA-QNEQ-EXT-PHI2-TRUE 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE QQE_NDNA-QNEQ-EXT-PHI2-TRUE NIL
    (COND
     ((OR QQE_ATF-QEQUAL-EXT-C* QQE_ATF-QEQUAL-EXT-P* QQE_ATF-EQUAL-EXT*
          QQE_ATF-EQUAL-INT* QQE_ATF-MISC-BASIC* QQE_ATF-QEQUAL-INT*
          QQE_ATF-QNEQ-INT* QQE_ATF-NEQ*)
      NIL)
     (T 'TRUE))) 
(PUT 'QQE_NDNA-QNEQ-EXT 'NUMBER-OF-ARGS 0) 
(PUT 'QQE_NDNA-QNEQ-EXT 'DEFINED-ON-LINE '450) 
(PUT 'QQE_NDNA-QNEQ-EXT 'DEFINED-IN-FILE 'REDLOG/QQE/QQEQE.RED) 
(PUT 'QQE_NDNA-QNEQ-EXT 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE QQE_NDNA-QNEQ-EXT NIL
    (PROG (PHI1 PHI2 LCM LARA)
      (SETQ LARA (PLUS QQE_LA* QQE_RA*))
      (COND
       (QQE_ATF-QEQUAL-INT*
        (PROGN
         (SETQ QQE_PAT-LENGTHS* (QQE_PAT-LENGTHS LARA))
         (SETQ LCM (QQE_LCM-LIST QQE_PAT-LENGTHS*))
         NIL))
       (T (SETQ LCM 1)))
      (SETQ PHI1 (RL_SIMPLBASIC (QQE_NDNA NIL NIL LCM LARA) NIL (MINUS 1)))
      (COND (QQE_DEBUG* (PAUSE)))
      (SETQ PHI2 (QQE_NDNA-QNEQ-EXT-PHI2-TRUE))
      (SETQ QQE_ATF-QNEQ-EXT* NIL)
      (SETQ QQE_ATF-QNEQ-EXT-QEPSILON* NIL)
      (COND
       ((NULL PHI2)
        (SETQ PHI2
                (RL_SIMPLBASIC
                 (QQE_NDNA (PLUS LARA LCM)
                  (PLUS LARA (DIFFERENCE (TIMES 2 LCM) 1)) LCM (PLUS LARA LCM))
                 NIL (MINUS 1)))))
      (COND (QQE_DEBUG* (PAUSE)))
      (RETURN (LIST 'OR PHI1 PHI2)))) 
(ENDMODULE) 