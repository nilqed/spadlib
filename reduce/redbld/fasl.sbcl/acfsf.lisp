(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'ACFSF)) 
(REVISION 'ACFSF "$Id: acfsf.red 5962 2021-08-22 15:41:06Z thomas-sturm $") 
(COPYRIGHT 'ACFSF "(c) 1995-2009 A. Dolzmann, T. Sturm, 2017 T. Sturm") 
(CREATE-PACKAGE '(ACFSF ACFSFSIAT ACFSFSISM ACFSFBNF ACFSFGS ACFSFMISC ACFSFQE)
                NIL) 
(LOAD-PACKAGE 'REDLOG) 
(LOADTIME (LOAD-PACKAGE 'CL)) 
(LOADTIME (LOAD-PACKAGE 'CGB)) 
(EXPORTS
 (LIST 'ACFSF_SIMPTERM 'ACFSF_PREPAT 'ACFSF_RESIMPAT 'ACFSF_LENGTHAT
       'ACFSF_CHSIMPAT 'ACFSF_SIMPAT 'ACFSF_OP 'ACFSF_ARG2L 'ACFSF_ARG2R
       'ACFSF_ARGN 'ACFSF_MK2 'ACFSF_0MK2 'ACFSF_MKN 'ACFSF_OPP 'ACFSF_SIMPLAT1
       'ACFSF_SMRMKNOWL 'ACFSF_SMCPKNOWL 'ACFSF_SMUPDKNOWL 'ACFSF_SMMKATL
       'ACFSF_DNF 'ACFSF_CNF 'ACFSF_SUBSUMPTION 'ACFSF_SACATLP 'ACFSF_SACAT
       'ACFSF_GSC 'ACFSF_GSD 'ACFSF_GSN 'ACFSF_GSSIMPLIFY 'ACFSF_GSSIMPLIFY0
       'ACFSF_TERMPRINT 'ACFSF_CLNEGREL 'ACFSF_LNEGREL 'ACFSF_FCTRAT
       'ACFSF_NEGATEAT 'ACFSF_VARLAT 'ACFSF_VARSUBSTAT 'ACFSF_ORDATP
       'ACFSF_A2CDL 'ACFSF_T2CDL 'ACFSF_SUBAT 'ACFSF_SUBALCHK
       'ACFSF_EQNRHSKERNELS 'ACFSF_GETINEQ 'ACFSF_STRUCTAT 'ACFSF_IFSTRUCTAT
       'ACFSF_TERMMLAT 'ACFSF_DECDEG 'ACFSF_DECDEG1 'ACFSF_MULTSUREP 'ACFSF_GQE
       'ACFSF_QE 'ACFSF_THSIMPL)) 
(FLUID
 '(*RLSIATADV *RLSIEXPL *RLSIEXPLA *RLGSSUB *RLSISO *RLGSRAD *RLGSRED *RLGSPROD
   *RLGSERF *RLVERBOSE *RLSIFAC *RLBNFSAC *RLGSVB *RLGSBNF *RLGSUTORD *RLNZDEN
   *RLADDCOND *RLQEGEN *CGBGEN *CGBREAL ACFSF_GSTV* *CGBVERBOSE *GROEBOPT)) 
(FLAG '(ACFSF) 'RL_PACKAGE) 
(PUT 'ACFSF 'RL_PARAMS
     '((RL_SUBAT* . ACFSF_SUBAT) (RL_SUBALCHK* . ACFSF_SUBALCHK)
       (RL_EQNRHSKERNELS* . ACFSF_EQNRHSKERNELS) (RL_ORDATP* . ACFSF_ORDATP)
       (RL_SIMPLAT1* . ACFSF_SIMPLAT1) (RL_SMUPDKNOWL* . ACFSF_SMUPDKNOWL)
       (RL_SMRMKNOWL* . ACFSF_SMRMKNOWL) (RL_SMCPKNOWL* . ACFSF_SMCPKNOWL)
       (RL_SMMKATL* . ACFSF_SMMKATL) (RL_NEGATEAT* . ACFSF_NEGATEAT)
       (RL_VARLAT* . ACFSF_VARLAT) (RL_VARSUBSTAT* . ACFSF_VARSUBSTAT)
       (RL_SUBSUMPTION* . ACFSF_SUBSUMPTION) (RL_BNFSIMPL* . CL_BNFSIMPL)
       (RL_SACAT* . ACFSF_SACAT) (RL_SACATLP* . ACFSF_SACATLP)
       (RL_FCTRAT* . ACFSF_FCTRAT) (RL_TORDP* . ORDP) (RL_A2CDL* . ACFSF_A2CDL)
       (RL_T2CDL* . ACFSF_T2CDL) (RL_GETINEQ* . ACFSF_GETINEQ)
       (RL_STRUCTAT* . ACFSF_STRUCTAT) (RL_IFSTRUCTAT* . ACFSF_IFSTRUCTAT)
       (RL_TERMMLAT* . ACFSF_TERMMLAT) (RL_MULTSUREP* . ACFSF_MULTSUREP)
       (RL_FBQE* . CL_FBQE))) 
(PUT 'ACFSF 'RL_SERVICES
     '((RL_SUBFOF* . CL_SUBFOF) (RL_IDENTIFYONOFF* . CL_IDENTIFYONOFF)
       (RL_SIMPL* . CL_SIMPL) (RL_SIMPLBASIC* . CL_SIMPLBASIC)
       (RL_THSIMPL* . ACFSF_THSIMPL) (RL_NNF* . CL_NNF)
       (RL_NNFNOT* . CL_NNFNOT) (RL_PNF* . CL_PNF) (RL_CNF* . ACFSF_CNF)
       (RL_DNF* . ACFSF_DNF) (RL_ALL* . CL_ALL) (RL_EX* . CL_EX)
       (RL_ATNUM* . CL_ATNUM) (RL_QNUM* . CL_QNUM) (RL_TAB* . CL_TAB)
       (RL_ATAB* . CL_ATAB) (RL_ITAB* . CL_ITAB) (RL_GSC* . ACFSF_GSC)
       (RL_GSD* . ACFSF_GSD) (RL_GSN* . ACFSF_GSN) (RL_IFACL* . CL_IFACL)
       (RL_IFACML* . CL_IFACML) (RL_MATRIX* . CL_MATRIX)
       (RL_MINISCOPE* . CL_MINISCOPE) (RL_ATML* . CL_ATML) (RL_TNF* . CL_TNF)
       (RL_ATL* . CL_ATL) (RL_STRUCT* . CL_STRUCT) (RL_IFSTRUCT* . CL_IFSTRUCT)
       (RL_TERMML* . CL_TERMML) (RL_TERML* . CL_TERML) (RL_VARL* . CL_VARL)
       (RL_FVARL* . CL_FVARL) (RL_BVARL* . CL_BVARL) (RL_GENTHEO* . CL_GENTHEO)
       (RL_DECDEG* . ACFSF_DECDEG) (RL_DECDEG1* . ACFSF_DECDEG1)
       (RL_SUREP* . CL_SUREP) (RL_QE* . ACFSF_QE) (RL_QEIPO* . CL_QEIPO)
       (RL_SIADDATL* . CL_SIADDATL))) 
(PUT 'ACFSF 'SIMPFNNAME 'ACFSF_SIMPFN) 
(PUT 'ACFSF 'SIMPDEFAULT 'ACFSF_SIMPREL) 
(PUT 'ACFSF 'RL_PREPAT 'ACFSF_PREPAT) 
(PUT 'ACFSF 'RL_RESIMPAT 'ACFSF_RESIMPAT) 
(PUT 'ACFSF 'RL_LENGTHAT 'ACFSF_LENGTHAT) 
(PUT 'ACFSF 'RL_PREPTERM 'PREPF) 
(PUT 'ACFSF 'RL_SIMPTERM 'ACFSF_SIMPTERM) 
(MKOP 'EQUAL) 
(INFIX (LIST 'EQUAL)) 
(PUT 'EQUAL 'ACFSF_SIMPFN 'ACFSF_CHSIMPAT) 
(PUT 'EQUAL 'NUMBER-OF-ARGS 2) 
(MKOP 'NEQ) 
(INFIX (LIST 'NEQ)) 
(PUT 'NEQ 'ACFSF_SIMPFN 'ACFSF_CHSIMPAT) 
(PUT 'NEQ 'NUMBER-OF-ARGS 2) 
(PUT 'NEQ 'RTYPEFN 'QUOTELOG) 
(NEWTOK '((< >) NEQ)) 
(FLAG '(EQUAL NEQ) 'SPACED) 
(FLAG '(ACFSF_CHSIMPAT) 'FULL) 
(PUT 'ACFSF_SIMPTERM 'NUMBER-OF-ARGS 1) 
(PUT 'ACFSF_SIMPTERM 'DEFINED-ON-LINE '158) 
(PUT 'ACFSF_SIMPTERM 'DEFINED-IN-FILE 'REDLOG/ACFSF/ACFSF.RED) 
(PUT 'ACFSF_SIMPTERM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ACFSF_SIMPTERM (U) (CAR (SIMP U))) 
(PUT 'ACFSF_PREPAT 'NUMBER-OF-ARGS 1) 
(PUT 'ACFSF_PREPAT 'DEFINED-ON-LINE '163) 
(PUT 'ACFSF_PREPAT 'DEFINED-IN-FILE 'REDLOG/ACFSF/ACFSF.RED) 
(PUT 'ACFSF_PREPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ACFSF_PREPAT (F)
    (LIST (ACFSF_OP F) (PREPF (ACFSF_ARG2L F)) (PREPF (ACFSF_ARG2R F)))) 
(PUT 'ACFSF_RESIMPAT 'NUMBER-OF-ARGS 1) 
(PUT 'ACFSF_RESIMPAT 'DEFINED-ON-LINE '168) 
(PUT 'ACFSF_RESIMPAT 'DEFINED-IN-FILE 'REDLOG/ACFSF/ACFSF.RED) 
(PUT 'ACFSF_RESIMPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ACFSF_RESIMPAT (F)
    (ACFSF_MK2 (ACFSF_OP F) (CAR (RESIMP (CONS (ACFSF_ARG2L F) 1)))
     (CAR (RESIMP (CONS (ACFSF_ARG2R F) 1))))) 
(PUT 'ACFSF_LENGTHAT 'NUMBER-OF-ARGS 1) 
(PUT 'ACFSF_LENGTHAT 'DEFINED-ON-LINE '175) 
(PUT 'ACFSF_LENGTHAT 'DEFINED-IN-FILE 'REDLOG/ACFSF/ACFSF.RED) 
(PUT 'ACFSF_LENGTHAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ACFSF_LENGTHAT (F) 2) 
(PUT 'ACFSF_CHSIMPAT 'NUMBER-OF-ARGS 1) 
(PUT 'ACFSF_CHSIMPAT 'DEFINED-ON-LINE '180) 
(PUT 'ACFSF_CHSIMPAT 'DEFINED-IN-FILE 'REDLOG/ACFSF/ACFSF.RED) 
(PUT 'ACFSF_CHSIMPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ACFSF_CHSIMPAT (U)
    ((LAMBDA (G124)
       (COND ((AND G124 (CDR G124)) (CONS 'AND G124))
             ((NULL G124) (COND ((EQ 'AND 'AND) 'TRUE) (T 'FALSE)))
             (T (CAR G124))))
     (PROG (X FORALL-RESULT FORALL-ENDPTR)
       (SETQ X (ACFSF_CHSIMPAT1 U))
       (COND ((NULL X) (RETURN NIL)))
       (SETQ FORALL-RESULT
               (SETQ FORALL-ENDPTR
                       (CONS ((LAMBDA (X) (ACFSF_SIMPAT X)) (CAR X)) NIL)))
      LOOPLABEL
       (SETQ X (CDR X))
       (COND ((NULL X) (RETURN FORALL-RESULT)))
       (RPLACD FORALL-ENDPTR
               (CONS ((LAMBDA (X) (ACFSF_SIMPAT X)) (CAR X)) NIL))
       (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
       (GO LOOPLABEL)))) 
(PUT 'ACFSF_CHSIMPAT1 'NUMBER-OF-ARGS 1) 
(PUT 'ACFSF_CHSIMPAT1 'DEFINED-ON-LINE '187) 
(PUT 'ACFSF_CHSIMPAT1 'DEFINED-IN-FILE 'REDLOG/ACFSF/ACFSF.RED) 
(PUT 'ACFSF_CHSIMPAT1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ACFSF_CHSIMPAT1 (U)
    (PROG (LEFTL RIGHTL LHS RHS)
      (SETQ LHS (CADR U))
      (COND
       ((AND (PAIRP LHS) (ACFSF_OPP (CAR LHS)))
        (PROGN
         (SETQ LEFTL (ACFSF_CHSIMPAT1 LHS))
         (SETQ LHS (CADDR (LASTCAR LEFTL))))))
      (SETQ RHS (CADDR U))
      (COND
       ((AND (PAIRP RHS) (ACFSF_OPP (CAR RHS)))
        (PROGN
         (SETQ RIGHTL (ACFSF_CHSIMPAT1 RHS))
         (SETQ RHS (CADR (CAR RIGHTL))))))
      (RETURN (NCONC LEFTL (CONS (LIST (CAR U) LHS RHS) RIGHTL))))) 
(PUT 'ACFSF_SIMPAT 'NUMBER-OF-ARGS 1) 
(PUT 'ACFSF_SIMPAT 'DEFINED-ON-LINE '205) 
(PUT 'ACFSF_SIMPAT 'DEFINED-IN-FILE 'REDLOG/ACFSF/ACFSF.RED) 
(PUT 'ACFSF_SIMPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ACFSF_SIMPAT (U)
    (PROG (OP LHS RHS NLHS F)
      (SETQ OP (CAR U))
      (SETQ LHS (SIMP (CADR U)))
      (COND
       ((NOT (OR *RLNZDEN (OR (ATOM (CDR LHS)) (ATOM (CAR (CDR LHS))))))
        (TYPERR U "atomic formula")))
      (SETQ RHS (SIMP (CADDR U)))
      (COND
       ((NOT (OR *RLNZDEN (OR (ATOM (CDR RHS)) (ATOM (CAR (CDR RHS))))))
        (TYPERR U "atomic formula")))
      (SETQ LHS (ADDSQ LHS (NEGSQ RHS)))
      (SETQ NLHS (CAR LHS))
      (COND
       ((AND *RLNZDEN (NOT (OR (ATOM (CDR LHS)) (ATOM (CAR (CDR LHS))))))
        (PROGN
         (SETQ F (ACFSF_0MK2 OP NLHS))
         (COND
          (*RLADDCOND
           (SETQ F (CONS 'AND (LIST (ACFSF_0MK2 'NEQ (CDR LHS)) F)))))
         (RETURN F))))
      (RETURN (ACFSF_0MK2 OP NLHS)))) 
(PUT 'ACFSF_OP 'NUMBER-OF-ARGS 1) 
(PUT 'ACFSF_OP 'DEFINED-ON-LINE '227) 
(PUT 'ACFSF_OP 'DEFINED-IN-FILE 'REDLOG/ACFSF/ACFSF.RED) 
(PUT 'ACFSF_OP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ACFSF_OP (ATF) (CAR ATF)) 
(PUT 'ACFSF_ARG2L 'NUMBER-OF-ARGS 1) 
(PUT 'ACFSF_ARG2L 'DEFINED-ON-LINE '232) 
(PUT 'ACFSF_ARG2L 'DEFINED-IN-FILE 'REDLOG/ACFSF/ACFSF.RED) 
(PUT 'ACFSF_ARG2L 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ACFSF_ARG2L (ATF) (CADR ATF)) 
(PUT 'ACFSF_ARG2R 'NUMBER-OF-ARGS 1) 
(PUT 'ACFSF_ARG2R 'DEFINED-ON-LINE '237) 
(PUT 'ACFSF_ARG2R 'DEFINED-IN-FILE 'REDLOG/ACFSF/ACFSF.RED) 
(PUT 'ACFSF_ARG2R 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ACFSF_ARG2R (ATF) (CADDR ATF)) 
(PUT 'ACFSF_ARGN 'NUMBER-OF-ARGS 1) 
(PUT 'ACFSF_ARGN 'DEFINED-ON-LINE '242) 
(PUT 'ACFSF_ARGN 'DEFINED-IN-FILE 'REDLOG/ACFSF/ACFSF.RED) 
(PUT 'ACFSF_ARGN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ACFSF_ARGN (ATF) (LIST (CADR ATF) (CADDR ATF))) 
(PUT 'ACFSF_MK2 'NUMBER-OF-ARGS 3) 
(PUT 'ACFSF_MK2 'DEFINED-ON-LINE '247) 
(PUT 'ACFSF_MK2 'DEFINED-IN-FILE 'REDLOG/ACFSF/ACFSF.RED) 
(PUT 'ACFSF_MK2 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE ACFSF_MK2 (OP LHS RHS) (LIST OP LHS RHS)) 
(PUT 'ACFSF_0MK2 'NUMBER-OF-ARGS 2) 
(PUT 'ACFSF_0MK2 'DEFINED-ON-LINE '253) 
(PUT 'ACFSF_0MK2 'DEFINED-IN-FILE 'REDLOG/ACFSF/ACFSF.RED) 
(PUT 'ACFSF_0MK2 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE ACFSF_0MK2 (OP LHS) (LIST OP LHS NIL)) 
(PUT 'ACFSF_MKN 'NUMBER-OF-ARGS 2) 
(PUT 'ACFSF_MKN 'DEFINED-ON-LINE '259) 
(PUT 'ACFSF_MKN 'DEFINED-IN-FILE 'REDLOG/ACFSF/ACFSF.RED) 
(PUT 'ACFSF_MKN 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE ACFSF_MKN (OP ARGL) (LIST OP (CAR ARGL) (CADR ARGL))) 
(PUT 'ACFSF_OPP 'NUMBER-OF-ARGS 1) 
(PUT 'ACFSF_OPP 'DEFINED-ON-LINE '265) 
(PUT 'ACFSF_OPP 'DEFINED-IN-FILE 'REDLOG/ACFSF/ACFSF.RED) 
(PUT 'ACFSF_OPP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ACFSF_OPP (OP) (MEMQ OP '(EQUAL NEQ))) 
(ENDMODULE) 