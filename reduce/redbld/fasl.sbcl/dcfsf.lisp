(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'DCFSF)) 
(REVISION 'DCFSF "$Id: dcfsf.red 5962 2021-08-22 15:41:06Z thomas-sturm $") 
(COPYRIGHT 'DCFSF "(c) 2004-2009 A. Dolzmann, T. Sturm, 2010-2017 T. Sturm") 
(CREATE-PACKAGE '(DCFSF DCFSFMISC DCFSFQE DCFSFSISM DCFSFKACEM) NIL) 
(LOAD-PACKAGE 'REDLOG) 
(LOADTIME (LOAD-PACKAGE 'CL)) 
(LOADTIME (LOAD-PACKAGE 'CGB)) 
(LOADTIME (LOAD-PACKAGE 'ACFSF)) 
(EXPORTS
 (LIST 'DCFSF_SIMPTERM 'DCFSF_PREPAT 'DCFSF_RESIMPAT 'DCFSF_LENGTHAT
       'DCFSF_CHSIMPAT 'DCFSF_SIMPAT 'DCFSF_OP 'DCFSF_ARG2L 'DCFSF_ARG2R
       'DCFSF_ARGN 'DCFSF_MK2 'DCFSF_0MK2 'DCFSF_MKN 'DCFSF_OPP)) 
(FLUID
 '(*RLSIATADV *RLSIEXPL *RLSIEXPLA *RLGSSUB *RLSISO *RLGSRAD *RLGSRED *RLGSPROD
   *RLGSERF *RLVERBOSE *RLSIFAC *RLBNFSAC *RLGSVB *RLGSBNF *RLGSUTORD *RLNZDEN
   *RLADDCOND *RLQEGEN *CGBGEN *CGBREAL *GBVERBOSE DCFSF_GSTV* *CGBVERBOSE
   *GROEBOPT *NAT *RLSID *RLSIPLUGTHEO *RLENFFAC *RLENFFACNE *RLPLSIMPL)) 
(FLAG '(DCFSF) 'RL_PACKAGE) 
(PUT 'DCFSF 'RL_PARAMS
     '((RL_SUBAT* . DCFSF_SUBAT) (RL_SUBALCHK* . DCFSF_SUBALCHK)
       (RL_EQNRHSKERNELS* . DCFSF_EQNRHSKERNELS) (RL_ORDATP* . DCFSF_ORDATP)
       (RL_SIMPLAT1* . ACFSF_SIMPLAT1) (RL_SMUPDKNOWL* . DCFSF_SMUPDKNOWL)
       (RL_SMRMKNOWL* . DCFSF_SMRMKNOWL) (RL_SMCPKNOWL* . DCFSF_SMCPKNOWL)
       (RL_SMMKATL* . DCFSF_SMMKATL) (RL_NEGATEAT* . DCFSF_NEGATEAT)
       (RL_VARLAT* . DCFSF_VARLAT) (RL_VARSUBSTAT* . DCFSF_VARSUBSTAT)
       (RL_SUBSUMPTION* . ACFSF_SUBSUMPTION) (RL_BNFSIMPL* . CL_BNFSIMPL)
       (RL_SACAT* . ACFSF_SACAT) (RL_SACATLP* . ACFSF_SACATLP)
       (RL_FCTRAT* . ACFSF_FCTRAT) (RL_TORDP* . ORDP) (RL_A2CDL* . ACFSF_A2CDL)
       (RL_T2CDL* . ACFSF_T2CDL) (RL_GETINEQ* . ACFSF_GETINEQ)
       (RL_STRUCTAT* . ACFSF_STRUCTAT) (RL_IFSTRUCTAT* . ACFSF_IFSTRUCTAT)
       (RL_TERMMLAT* . ACFSF_TERMMLAT) (RL_MULTSUREP* . ACFSF_MULTSUREP)
       (RL_FBQE* . CL_FBQE))) 
(PUT 'DCFSF 'RL_SERVICES
     '((RL_SUBFOF* . CL_SUBFOF) (RL_IDENTIFYONOFF* . CL_IDENTIFYONOFF)
       (RL_SIMPL* . CL_SIMPL) (RL_SIMPLBASIC* . CL_SIMPLBASIC)
       (RL_THSIMPL* . ACFSF_THSIMPL) (RL_NNF* . CL_NNF)
       (RL_NNFNOT* . CL_NNFNOT) (RL_PNF* . CL_PNF) (RL_CNF* . ACFSF_CNF)
       (RL_DNF* . ACFSF_DNF) (RL_ALL* . CL_ALL) (RL_EX* . CL_EX)
       (RL_ATNUM* . CL_ATNUM) (RL_QNUM* . CL_QNUM) (RL_TAB* . CL_TAB)
       (RL_ATAB* . CL_ATAB) (RL_ITAB* . CL_ITAB) (RL_GSC* . ACFSF_GSC)
       (RL_GSD* . ACFSF_GSD) (RL_GSN* . ACFSF_GSN) (RL_IFACL* . CL_IFACL)
       (RL_IFACML* . CL_IFACML) (RL_MATRIX* . CL_MATRIX)
       (RL_MINISCOPE* . CL_MINISCOPE) (RL_ATML* . CL_ATML) (RL_TNF* . CL_TNF)
       (RL_ATL* . CL_ATL) (RL_STRUCT* . CL_STRUCT) (RL_IFSTRUCT* . CL_IFSTRUCT)
       (RL_TERMML* . CL_TERMML) (RL_TERML* . CL_TERML) (RL_VARL* . CL_VARL)
       (RL_FVARL* . CL_FVARL) (RL_BVARL* . CL_BVARL) (RL_GENTHEO* . CL_GENTHEO)
       (RL_DECDEG* . ACFSF_DECDEG) (RL_DECDEG1* . ACFSF_DECDEG1)
       (RL_SUREP* . CL_SUREP) (RL_QE* . DCFSF_QE)
       (RL_1EQUATION* . DCFSF_1EQUATION) (RL_ENF* . DCFSF_ENF)
       (RL_QEIPO* . CL_QEIPO) (RL_SIADDATL* . CL_SIADDATL))) 
(PUT 'DCFSF 'SIMPFNNAME 'DCFSF_SIMPFN) 
(PUT 'DCFSF 'SIMPDEFAULT 'DCFSF_SIMPREL) 
(PUT 'DCFSF 'RL_PREPAT 'DCFSF_PREPAT) 
(PUT 'DCFSF 'RL_RESIMPAT 'DCFSF_RESIMPAT) 
(PUT 'DCFSF 'RL_LENGTHAT 'DCFSF_LENGTHAT) 
(PUT 'DCFSF 'RL_PREPTERM 'PREPF) 
(PUT 'DCFSF 'RL_SIMPTERM 'DCFSF_SIMPTERM) 
(MKOP 'EQUAL) 
(INFIX (LIST 'EQUAL)) 
(PUT 'EQUAL 'DCFSF_SIMPFN 'DCFSF_CHSIMPAT) 
(PUT 'EQUAL 'NUMBER-OF-ARGS 2) 
(MKOP 'NEQ) 
(INFIX (LIST 'NEQ)) 
(PUT 'NEQ 'DCFSF_SIMPFN 'DCFSF_CHSIMPAT) 
(PUT 'NEQ 'NUMBER-OF-ARGS 2) 
(PUT 'NEQ 'RTYPEFN 'QUOTELOG) 
(NEWTOK '((< >) NEQ)) 
(AEVAL (OPERATOR (LIST 'D))) 
(PUT 'D 'NUMBER-OF-ARGS 2) 
(PUT 'D 'SIMPFN 'DCFSF_SIMPD) 
(PUT 'D 'PRIFN 'DCFSF_PRID) 
(FLAG '(EQUAL NEQ D) 'SPACED) 
(FLAG '(DCFSF_CHSIMPAT) 'FULL) 
(PUT 'DCFSF_PRID 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_PRID 'DEFINED-ON-LINE '161) 
(PUT 'DCFSF_PRID 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSF.RED) 
(PUT 'DCFSF_PRID 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_PRID (U)
    (COND ((NOT *NAT) 'FAILED)
          (T
           (PROGN
            (MAPRIN (CADR U))
            (PROG (I)
              (SETQ I 1)
             LAB
              (COND ((MINUSP (DIFFERENCE (CADDR U) I)) (RETURN NIL)))
              (PRIN2* "'")
              (SETQ I (PLUS2 I 1))
              (GO LAB)))))) 
(PUT 'DCFSF_SIMPTERM 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_SIMPTERM 'DEFINED-ON-LINE '169) 
(PUT 'DCFSF_SIMPTERM 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSF.RED) 
(PUT 'DCFSF_SIMPTERM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_SIMPTERM (U) (CAR (SIMP U))) 
(PUT 'DCFSF_PREPAT 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_PREPAT 'DEFINED-ON-LINE '174) 
(PUT 'DCFSF_PREPAT 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSF.RED) 
(PUT 'DCFSF_PREPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_PREPAT (F)
    (LIST (DCFSF_OP F) (PREPF (DCFSF_ARG2L F)) (PREPF (DCFSF_ARG2R F)))) 
(PUT 'DCFSF_RESIMPAT 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_RESIMPAT 'DEFINED-ON-LINE '179) 
(PUT 'DCFSF_RESIMPAT 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSF.RED) 
(PUT 'DCFSF_RESIMPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_RESIMPAT (F)
    (DCFSF_MK2 (DCFSF_OP F) (CAR (RESIMP (CONS (DCFSF_ARG2L F) 1)))
     (CAR (RESIMP (CONS (DCFSF_ARG2R F) 1))))) 
(PUT 'DCFSF_SIMPD 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_SIMPD 'DEFINED-ON-LINE '186) 
(PUT 'DCFSF_SIMPD 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSF.RED) 
(PUT 'DCFSF_SIMPD 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_SIMPD (U)
    (PROG (VF N W)
      (COND
       ((NEQ (LENGTH U) 2)
        (REDERR "dcfsf_simpd: d is infix with 2 arguments")))
      (SETQ VF (SIMP (CAR U)))
      (COND
       ((NOT (OR (ATOM (CDR VF)) (ATOM (CAR (CDR VF)))))
        (REDERR "parametric denominator")))
      (SETQ VF (CAR VF))
      (SETQ N (CADR U))
      (COND
       ((NOT (AND (NUMBERP N) (GEQ N 0)))
        (REDERR (LIST "dcfsf_simpd:" N "is not a natural number"))))
      (COND ((SETQ W (SFTO_IDVARF VF)) (RETURN (MKSQ (LIST 'D W N) 1))))
      (SETQ VF (DCFSF_DERIVATIONNF VF N NIL))
      (RETURN (CONS VF 1)))) 
(PUT 'DCFSF_LENGTHAT 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_LENGTHAT 'DEFINED-ON-LINE '203) 
(PUT 'DCFSF_LENGTHAT 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSF.RED) 
(PUT 'DCFSF_LENGTHAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_LENGTHAT (F) 2) 
(PUT 'DCFSF_CHSIMPAT 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_CHSIMPAT 'DEFINED-ON-LINE '208) 
(PUT 'DCFSF_CHSIMPAT 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSF.RED) 
(PUT 'DCFSF_CHSIMPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_CHSIMPAT (U)
    ((LAMBDA (G124)
       (COND ((AND G124 (CDR G124)) (CONS 'AND G124))
             ((NULL G124) (COND ((EQ 'AND 'AND) 'TRUE) (T 'FALSE)))
             (T (CAR G124))))
     (PROG (X FORALL-RESULT FORALL-ENDPTR)
       (SETQ X (DCFSF_CHSIMPAT1 U))
       (COND ((NULL X) (RETURN NIL)))
       (SETQ FORALL-RESULT
               (SETQ FORALL-ENDPTR
                       (CONS ((LAMBDA (X) (DCFSF_SIMPAT X)) (CAR X)) NIL)))
      LOOPLABEL
       (SETQ X (CDR X))
       (COND ((NULL X) (RETURN FORALL-RESULT)))
       (RPLACD FORALL-ENDPTR
               (CONS ((LAMBDA (X) (DCFSF_SIMPAT X)) (CAR X)) NIL))
       (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
       (GO LOOPLABEL)))) 
(PUT 'DCFSF_CHSIMPAT1 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_CHSIMPAT1 'DEFINED-ON-LINE '215) 
(PUT 'DCFSF_CHSIMPAT1 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSF.RED) 
(PUT 'DCFSF_CHSIMPAT1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_CHSIMPAT1 (U)
    (PROG (LEFTL RIGHTL LHS RHS)
      (SETQ LHS (CADR U))
      (COND
       ((AND (PAIRP LHS) (DCFSF_OPP (CAR LHS)))
        (PROGN
         (SETQ LEFTL (DCFSF_CHSIMPAT1 LHS))
         (SETQ LHS (CADDR (LASTCAR LEFTL))))))
      (SETQ RHS (CADDR U))
      (COND
       ((AND (PAIRP RHS) (DCFSF_OPP (CAR RHS)))
        (PROGN
         (SETQ RIGHTL (DCFSF_CHSIMPAT1 RHS))
         (SETQ RHS (CADR (CAR RIGHTL))))))
      (RETURN (NCONC LEFTL (CONS (LIST (CAR U) LHS RHS) RIGHTL))))) 
(PUT 'DCFSF_SIMPAT 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_SIMPAT 'DEFINED-ON-LINE '233) 
(PUT 'DCFSF_SIMPAT 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSF.RED) 
(PUT 'DCFSF_SIMPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_SIMPAT (U)
    (PROG (OP LHS RHS NLHS F)
      (SETQ OP (CAR U))
      (SETQ LHS (SIMP (CADR U)))
      (COND
       ((NOT (OR *RLNZDEN (OR (ATOM (CDR LHS)) (ATOM (CAR (CDR LHS))))))
        (TYPERR U "atomic formula")))
      (SETQ RHS (SIMP (CADDR U)))
      (COND
       ((NOT (OR *RLNZDEN (OR (ATOM (CDR RHS)) (ATOM (CAR (CDR RHS))))))
        (TYPERR U "atomic formula")))
      (SETQ LHS (ADDSQ LHS (NEGSQ RHS)))
      (SETQ NLHS (CAR LHS))
      (COND
       ((AND *RLNZDEN (NOT (OR (ATOM (CDR LHS)) (ATOM (CAR (CDR LHS))))))
        (PROGN
         (SETQ F (DCFSF_0MK2 OP NLHS))
         (COND
          (*RLADDCOND
           (SETQ F (CONS 'AND (LIST (DCFSF_0MK2 'NEQ (CDR LHS)) F)))))
         (RETURN F))))
      (RETURN (DCFSF_0MK2 OP NLHS)))) 
(PUT 'DCFSF_OP 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_OP 'DEFINED-ON-LINE '255) 
(PUT 'DCFSF_OP 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSF.RED) 
(PUT 'DCFSF_OP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_OP (ATF) (CAR ATF)) 
(PUT 'DCFSF_ARG2L 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_ARG2L 'DEFINED-ON-LINE '260) 
(PUT 'DCFSF_ARG2L 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSF.RED) 
(PUT 'DCFSF_ARG2L 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_ARG2L (ATF) (CADR ATF)) 
(PUT 'DCFSF_ARG2R 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_ARG2R 'DEFINED-ON-LINE '265) 
(PUT 'DCFSF_ARG2R 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSF.RED) 
(PUT 'DCFSF_ARG2R 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_ARG2R (ATF) (CADDR ATF)) 
(PUT 'DCFSF_ARGN 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_ARGN 'DEFINED-ON-LINE '270) 
(PUT 'DCFSF_ARGN 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSF.RED) 
(PUT 'DCFSF_ARGN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_ARGN (ATF) (LIST (CADR ATF) (CADDR ATF))) 
(PUT 'DCFSF_MK2 'NUMBER-OF-ARGS 3) 
(PUT 'DCFSF_MK2 'DEFINED-ON-LINE '275) 
(PUT 'DCFSF_MK2 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSF.RED) 
(PUT 'DCFSF_MK2 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DCFSF_MK2 (OP LHS RHS) (LIST OP LHS RHS)) 
(PUT 'DCFSF_0MK2 'NUMBER-OF-ARGS 2) 
(PUT 'DCFSF_0MK2 'DEFINED-ON-LINE '281) 
(PUT 'DCFSF_0MK2 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSF.RED) 
(PUT 'DCFSF_0MK2 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DCFSF_0MK2 (OP LHS) (LIST OP LHS NIL)) 
(PUT 'DCFSF_MKN 'NUMBER-OF-ARGS 2) 
(PUT 'DCFSF_MKN 'DEFINED-ON-LINE '287) 
(PUT 'DCFSF_MKN 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSF.RED) 
(PUT 'DCFSF_MKN 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DCFSF_MKN (OP ARGL) (LIST OP (CAR ARGL) (CADR ARGL))) 
(PUT 'DCFSF_OPP 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_OPP 'DEFINED-ON-LINE '293) 
(PUT 'DCFSF_OPP 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSF.RED) 
(PUT 'DCFSF_OPP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_OPP (OP) (MEMQ OP '(EQUAL NEQ))) 
(ENDMODULE) 