(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'GROEBIDQ)) 
(SWITCH (LIST 'GROEBFAC 'GROEBRM 'TRGROEB 'TRGROEBS 'TRGROEBR 'GROEBSTAT)) 
(SETQ *GROEBIDQBASIS T) 
(PUT 'GROEBIDQ2 'NUMBER-OF-ARGS 2) 
(PUT 'GROEBIDQ2 'DEFINED-ON-LINE '38) 
(PUT 'GROEBIDQ2 'DEFINED-IN-FILE 'GROEBNER/GROEBIDQ.RED) 
(PUT 'GROEBIDQ2 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE GROEBIDQ2 (P F)
    (PROG (GROETIME* TIM1 SPAC SPAC1 P1 PAIRSDONE* *GSUGAR)
      (SETQ GROETIME* (TIME))
      (VDPONEPOL)
      (SETQ HCOUNT* 0)
      (SETQ PCOUNT* 0)
      (SETQ MCOUNT* 0)
      (SETQ FCOUNT* 0)
      (SETQ BCOUNT* 0)
      (SETQ B4COUNT* 0)
      (SETQ HZEROCOUNT* 0)
      (SETQ BASECOUNT* 0)
      (COND (*TRGROEB (PROGN (PRIN2 "IDQ Calculation starting ") (TERPRIT 2))))
      (SETQ SPAC (GCTIME))
      (SETQ P1 (GROEBIDQ3 P F))
      (COND
       ((OR *TRGROEB *TRGROEBR *GROEBSTAT)
        (PROGN
         (SETQ SPAC1 (DIFFERENCE (GCTIME) SPAC))
         (TERPRI)
         (PRIN2T "statistics for IDQ calculation")
         (PRIN2T "==============================")
         (PRIN2 " total computing time(including gc): ")
         (PRIN2 (DIFFERENCE (SETQ TIM1 (TIME)) GROETIME*))
         (PRIN2T "          milliseconds  ")
         (PRIN2 "(time spent for garbage collection:  ")
         (PRIN2 SPAC1)
         (PRIN2T "          milliseconds)")
         (TERPRIT 1)
         (PRIN2 "H-polynomials total: ")
         (PRIN2T HCOUNT*)
         (PRIN2 "H-polynomials zero : ")
         (PRIN2T HZEROCOUNT*)
         (PRIN2 "Crit M hits: ")
         (PRIN2T MCOUNT*)
         (PRIN2 "Crit F hits: ")
         (PRIN2T FCOUNT*)
         (PRIN2 "Crit B hits: ")
         (PRIN2T BCOUNT*)
         (PRIN2 "Crit B4 hits: ")
         (PRIN2T B4COUNT*))))
      (RETURN (COND (*GROEBIDQBASIS (CAR (GROEBNER2 P1 NIL))) (T P1))))) 
(PUT 'GROEBIDQ3 'NUMBER-OF-ARGS 2) 
(PUT 'GROEBIDQ3 'DEFINED-ON-LINE '66) 
(PUT 'GROEBIDQ3 'DEFINED-IN-FILE 'GROEBNER/GROEBIDQ.RED) 
(PUT 'GROEBIDQ3 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE GROEBIDQ3 (G0 FFF)
    (PROG (RESULT X G D D1 D2 P P1 S H G99 ONE GI)
      (SETQ GI G0)
      (SETQ FFF (VDPSIMPCONT FFF))
      (VDPPUTPROP FFF 'NUMBER 0)
      (VDPPUTPROP FFF 'COFACT (A2VDP 1))
      (SETQ X
              (PROG (FJ FORALL-RESULT FORALL-ENDPTR)
                (SETQ FJ G0)
                (COND ((NULL FJ) (RETURN NIL)))
                (SETQ FORALL-RESULT
                        (SETQ FORALL-ENDPTR
                                (CONS
                                 ((LAMBDA (FJ)
                                    (PROGN
                                     (SETQ FJ (VDPENUMERATE (VDPSIMPCONT FJ)))
                                     (VDPPUTPROP FJ 'COFACT (A2VDP 0))
                                     FJ))
                                  (CAR FJ))
                                 NIL)))
               LOOPLABEL
                (SETQ FJ (CDR FJ))
                (COND ((NULL FJ) (RETURN FORALL-RESULT)))
                (RPLACD FORALL-ENDPTR
                        (CONS
                         ((LAMBDA (FJ)
                            (PROGN
                             (SETQ FJ (VDPENUMERATE (VDPSIMPCONT FJ)))
                             (VDPPUTPROP FJ 'COFACT (A2VDP 0))
                             FJ))
                          (CAR FJ))
                         NIL))
                (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                (GO LOOPLABEL)))
      (SETQ G0 (LIST FFF))
      (PROG (FJ)
        (SETQ FJ X)
       LAB
        (COND ((NULL FJ) (RETURN NIL)))
        ((LAMBDA (FJ) (SETQ G0 (VDPLSORTIN FJ G0))) (CAR FJ))
        (SETQ FJ (CDR FJ))
        (GO LAB))
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND (OR D G0) (NOT ONE))) (RETURN NIL)))
        (PROG ()
          (COND
           (G0
            (PROGN
             (SETQ H (CAR G0))
             (SETQ G0 (CDR G0))
             (SETQ P (LIST NIL H H))
             NIL))
           (T
            (PROGN
             (SETQ P (CAR D))
             (SETQ D (DELETE P D))
             (SETQ S (IDQSPOLYNOM (CADR P) (CADDR P)))
             (IDQMESS3 P S)
             (SETQ H (IDQSIMPCONT (IDQNORMALFORM S G99 'TREE)))
             (COND
              ((OR (NULL H) (NULL (CADR (CDDR H))))
               (PROGN
                (AND *TRGROEB (GROEBMESS4 P D))
                (SETQ X (VDPGETPROP H 'COFACT))
                (COND
                 ((NOT (OR (NULL X) (NULL (CADR (CDDR X)))))
                  (COND
                   ((OR (NULL (CADR X))
                        (AND (EQUAL (CAR (CADR X)) 0)
                             (VEVZERO?1 (CDR (CADR X)))))
                    (SETQ ONE T))
                   (T
                    (PROGN
                     (SETQ RESULT (IDQTORESULT X RESULT))
                     (IDQMESS0 X))))))
                NIL))))))
          (COND ((OR (NULL H) (NULL (CADR (CDDR H)))) (GO BOTT)))
          (COND
           ((OR (NULL (CADR H))
                (AND (EQUAL (CAR (CADR H)) 0) (VEVZERO?1 (CDR (CADR H)))))
            (PROGN
             (IDQMESS4 P H)
             (SETQ RESULT GI)
             (SETQ D (SETQ G0 NIL))
             (GO BOTT))))
          (SETQ S NIL)
          (SETQ H (VDPENUMERATE H))
          (IDQMESS4 P H)
          (SETQ D1 NIL)
          (PROG (F)
            (SETQ F G)
           LAB
            (COND ((NULL F) (RETURN NIL)))
            ((LAMBDA (F)
               (PROGN
                (SETQ D1
                        (GROEBCPLISTSORTIN
                         (LIST (VEVLCM (CADR F) (CADR H)) F H) D1))
                (COND
                 ((EQUAL (VEVLCM (CADR F) (CADR H)) (CADR F))
                  (PROGN
                   (SETQ G (DELETE F G))
                   (AND *TRGROEB (GROEBMESS2 F)))))))
             (CAR F))
            (SETQ F (CDR F))
            (GO LAB))
          (AND *TRGROEB (GROEBMESS51 D1))
          (SETQ D2 NIL)
          (PROG ()
           WHILELABEL
            (COND ((NOT D1) (RETURN NIL)))
            (PROGN
             (SETQ D1 (GROEBINVOKECRITF D1))
             (SETQ P1 (CAR D1))
             (SETQ D1 (CDR D1))
             (COND
              ((GROEBBUCHCRIT4T (CADR P1) (CADDR P1))
               (SETQ D2 (APPEND D2 (LIST P1))))
              (T
               (PROGN
                (SETQ X (IDQDIRECTELEMENT (CADR P1) (CADDR P1)))
                (COND
                 ((NOT (OR (NULL X) (NULL (CADR (CDDR X)))))
                  (COND
                   ((OR (NULL (CADR X))
                        (AND (EQUAL (CAR (CADR X)) 0)
                             (VEVZERO?1 (CDR (CADR X)))))
                    (SETQ ONE T))
                   (T
                    (PROGN
                     (IDQMESS1 X (CADR P1) (CADDR P1))
                     (SETQ RESULT (IDQTORESULT X RESULT))))))))))
             (SETQ D1 (GROEBINVOKECRITM P1 D1)))
            (GO WHILELABEL))
          (SETQ D (GROEBCPLISTMERGE D D2))
          (SETQ G (CONS H G))
          (SETQ G99 (GROEBSTREEADD H G99))
          (AND *TRGROEB (GROEBMESS8 G D))
         BOTT)
        (GO WHILELABEL))
      (COND
       (ONE
        (SETQ RESULT (LIST (VDPFMON (A2BC 1) (VEVMAPTOZERO1 VDPVARS* NIL))))))
      (IDQMESS2 RESULT)
      (RETURN RESULT))) 
(PUT 'IDQTORESULT 'NUMBER-OF-ARGS 2) 
(PUT 'IDQTORESULT 'DEFINED-ON-LINE '130) 
(PUT 'IDQTORESULT 'DEFINED-IN-FILE 'GROEBNER/GROEBIDQ.RED) 
(PUT 'IDQTORESULT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE IDQTORESULT (X R)
    (PROGN
     (SETQ X (GROEBSIMPCONTNORMALFORM (GROEBNORMALFORM X R 'SORT)))
     (COND ((OR (NULL X) (NULL (CADR (CDDR X)))) R) (T (VDPLSORTIN X R))))) 
(PUT 'IDQNORMALFORM 'NUMBER-OF-ARGS 3) 
(PUT 'IDQNORMALFORM 'DEFINED-ON-LINE '141) 
(PUT 'IDQNORMALFORM 'DEFINED-IN-FILE 'GROEBNER/GROEBIDQ.RED) 
(PUT 'IDQNORMALFORM 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE IDQNORMALFORM (F G TYPE)
    (PROG (C VEV DIVISOR DONE FOLD)
      (SETQ FOLD F)
      (PROG ()
       WHILELABEL
        (COND
         ((NOT (AND (NOT (OR (NULL F) (NULL (CADR (CDDR F))))) G))
          (RETURN NIL)))
        (PROG ()
          (SETQ VEV (CADR F))
          (SETQ C (CADDR F))
          (COND
           ((EQUAL TYPE 'SORT)
            (PROG ()
             WHILELABEL
              (COND
               ((NOT (AND G (EQUAL 1 (EVCOMP (CADR (CAR G)) VEV))))
                (RETURN NIL)))
              (SETQ G (CDR G))
              (GO WHILELABEL))))
          (SETQ DIVISOR (GROEBSEARCHINLIST VEV G))
          (COND (DIVISOR (SETQ DONE T)))
          (COND
           ((AND DIVISOR *TRGROEBS)
            (PROGN (PRIN2 "//-") (PRIN2 (VDPGETPROP DIVISOR 'NUMBER)))))
          (COND
           (DIVISOR
            (COND
             (*VDPINTEGER (SETQ F (IDQREDUCEONESTEPINT F NIL C VEV DIVISOR)))
             (T (SETQ F (IDQREDUCEONESTEPRAT F NIL C VEV DIVISOR)))))
           (T (SETQ G NIL))))
        (GO WHILELABEL))
      (RETURN (COND (DONE F) (T FOLD))))) 
(PUT 'IDQREDUCEONESTEPINT 'NUMBER-OF-ARGS 5) 
(PUT 'IDQREDUCEONESTEPINT 'DEFINED-ON-LINE '173) 
(PUT 'IDQREDUCEONESTEPINT 'DEFINED-IN-FILE 'GROEBNER/GROEBIDQ.RED) 
(PUT 'IDQREDUCEONESTEPINT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE IDQREDUCEONESTEPINT (F DUMMY C VEV G1)
    (PROG (VEVLCM A B CG X FCOFA GCOFA)
      (SETQ DUMMY NIL)
      (SETQ FCOFA (VDPGETPROP F 'COFACT))
      (SETQ GCOFA (VDPGETPROP G1 'COFACT))
      (SETQ VEVLCM (VEVDIF VEV (CADR G1)))
      (SETQ CG (CADDR G1))
      (SETQ X (VBCGCD C CG))
      (SETQ A (BCQUOT CG X))
      (SETQ B (BCQUOT C X))
      (SETQ F
              (VDPILCOMB1 (VDPRED F) A (VEVMAPTOZERO1 VDPVARS* NIL) (VDPRED G1)
                          (BCNEG B) VEVLCM))
      (SETQ X
              (VDPILCOMB1 FCOFA A (VEVMAPTOZERO1 VDPVARS* NIL) GCOFA (BCNEG B)
                          VEVLCM))
      (VDPPUTPROP F 'COFACT X)
      (RETURN F))) 
(PUT 'IDQREDUCEONESTEPRAT 'NUMBER-OF-ARGS 5) 
(PUT 'IDQREDUCEONESTEPRAT 'DEFINED-ON-LINE '191) 
(PUT 'IDQREDUCEONESTEPRAT 'DEFINED-IN-FILE 'GROEBNER/GROEBIDQ.RED) 
(PUT 'IDQREDUCEONESTEPRAT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE IDQREDUCEONESTEPRAT (F DUMMY C VEV G1)
    (PROG (X FCOFA GCOFA)
      (SETQ DUMMY NIL)
      (SETQ FCOFA (VDPGETPROP F 'COFACT))
      (SETQ GCOFA (VDPGETPROP G1 'COFACT))
      (SETQ VEV (VEVDIF VEV (CADR G1)))
      (SETQ X (BCNEG (BCQUOT C (CADDR G1))))
      (SETQ F
              (VDPILCOMB1 (VDPRED F) (A2BC 1) (VEVMAPTOZERO1 VDPVARS* NIL)
                          (VDPRED G1) X VEV))
      (SETQ X
              (VDPILCOMB1 FCOFA (A2BC 1) (VEVMAPTOZERO1 VDPVARS* NIL) GCOFA X
                          VEV))
      (VDPPUTPROP F 'COFACT X)
      (RETURN F))) 
(PUT 'IDQSPOLYNOM 'NUMBER-OF-ARGS 2) 
(PUT 'IDQSPOLYNOM 'DEFINED-ON-LINE '208) 
(PUT 'IDQSPOLYNOM 'DEFINED-IN-FILE 'GROEBNER/GROEBIDQ.RED) 
(PUT 'IDQSPOLYNOM 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE IDQSPOLYNOM (P1 P2)
    (PROG (S EP1 EP2 EP RP1 RP2 DB1 DB2 X COFAC1 COFAC2)
      (COND ((OR (NULL P1) (NULL (CADR (CDDR P1)))) (RETURN P1)))
      (COND ((OR (NULL P2) (NULL (CADR (CDDR P2)))) (RETURN P2)))
      (SETQ COFAC1 (VDPGETPROP P1 'COFACT))
      (SETQ COFAC2 (VDPGETPROP P2 'COFACT))
      (SETQ EP1 (CADR P1))
      (SETQ EP2 (CADR P2))
      (SETQ EP (VEVLCM EP1 EP2))
      (SETQ RP1 (VDPRED P1))
      (SETQ RP2 (VDPRED P2))
      (SETQ DB1 (CADDR P1))
      (SETQ DB2 (CADDR P2))
      (COND
       (*VDPINTEGER
        (PROGN
         (SETQ X (VBCGCD DB1 DB2))
         (SETQ DB1 (BCQUOT DB1 X))
         (SETQ DB2 (BCQUOT DB2 X)))))
      (SETQ EP1 (VEVDIF EP EP1))
      (SETQ EP2 (VEVDIF EP EP2))
      (SETQ DB2 (BCNEG DB2))
      (SETQ S (VDPILCOMB1 RP2 DB1 EP2 RP1 DB2 EP1))
      (SETQ X (VDPILCOMB1 COFAC2 DB1 EP2 COFAC1 DB2 EP1))
      (VDPPUTPROP S 'COFACT X)
      (RETURN S))) 
(PUT 'IDQDIRECTELEMENT 'NUMBER-OF-ARGS 2) 
(PUT 'IDQDIRECTELEMENT 'DEFINED-ON-LINE '224) 
(PUT 'IDQDIRECTELEMENT 'DEFINED-IN-FILE 'GROEBNER/GROEBIDQ.RED) 
(PUT 'IDQDIRECTELEMENT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE IDQDIRECTELEMENT (P1 P2)
    ((LAMBDA (C1 C2)
       (COND
        ((AND (OR (NULL C1) (NULL (CADR (CDDR C1))))
              (OR (NULL C2) (NULL (CADR (CDDR C2)))))
         C1)
        (T (VDPDIF (VDPPROD P1 C2) (VDPPROD P2 C1)))))
     (VDPGETPROP P1 'COFACT) (VDPGETPROP P2 'COFACT))) 
(PUT 'IDQSIMPCONT 'NUMBER-OF-ARGS 1) 
(PUT 'IDQSIMPCONT 'DEFINED-ON-LINE '239) 
(PUT 'IDQSIMPCONT 'DEFINED-IN-FILE 'GROEBNER/GROEBIDQ.RED) 
(PUT 'IDQSIMPCONT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE IDQSIMPCONT (P) (COND (*VDPINTEGER (IDQSIMPCONTI P)) (T (IDQSIMPCONTR P)))) 
(PUT 'IDQSIMPCONTI 'NUMBER-OF-ARGS 1) 
(PUT 'IDQSIMPCONTI 'DEFINED-ON-LINE '245) 
(PUT 'IDQSIMPCONTI 'DEFINED-IN-FILE 'GROEBNER/GROEBIDQ.RED) 
(PUT 'IDQSIMPCONTI 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE IDQSIMPCONTI (P)
    (PROG (RES NUM COFAC)
      (COND ((OR (NULL P) (NULL (CADR (CDDR P)))) (RETURN P)))
      (SETQ COFAC (VDPGETPROP P 'COFACT))
      (SETQ NUM (CAR (VDPCONTENTI P)))
      (COND
       ((NOT (OR (NULL COFAC) (NULL (CADR (CDDR COFAC)))))
        (SETQ NUM (VBCGCD NUM (CAR (VDPCONTENTI COFAC))))))
      (COND ((NOT (VBCPLUS? NUM)) (SETQ NUM (BCNEG NUM))))
      (COND ((NOT (VBCPLUS? (CADDR P))) (SETQ NUM (BCNEG NUM))))
      (COND ((BCONE? NUM) (RETURN P)))
      (SETQ RES (VDPDIVMON P NUM NIL))
      (COND
       ((NOT (OR (NULL COFAC) (NULL (CADR (CDDR COFAC)))))
        (SETQ COFAC (VDPDIVMON COFAC NUM NIL))))
      (SETQ RES (VDPPUTPROP RES 'COFACT COFAC))
      (RETURN RES))) 
(PUT 'IDQSIMPCONTR 'NUMBER-OF-ARGS 1) 
(PUT 'IDQSIMPCONTR 'DEFINED-ON-LINE '262) 
(PUT 'IDQSIMPCONTR 'DEFINED-IN-FILE 'GROEBNER/GROEBIDQ.RED) 
(PUT 'IDQSIMPCONTR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE IDQSIMPCONTR (P)
    (PROG (RES COFAC)
      (SETQ COFAC (VDPGETPROP P 'COFACT))
      (COND ((OR (NULL P) (NULL (CADR (CDDR P)))) (RETURN P)))
      (COND ((BCONE? (CADDR P)) (RETURN P)))
      (SETQ RES (VDPDIVMON P (CADDR P) NIL))
      (COND
       ((NOT (OR (NULL COFAC) (NULL (CADR (CDDR COFAC)))))
        (SETQ COFAC (VDPDIVMON COFAC (CADDR P) NIL))))
      (SETQ RES (VDPPUTPROP RES 'COFACT COFAC))
      (RETURN RES))) 
(PUT 'IDQMESS0 'NUMBER-OF-ARGS 1) 
(PUT 'IDQMESS0 'DEFINED-ON-LINE '278) 
(PUT 'IDQMESS0 'DEFINED-IN-FILE 'GROEBNER/GROEBIDQ.RED) 
(PUT 'IDQMESS0 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE IDQMESS0 (X)
    (COND
     (*TRGROEB
      (PROGN
       (PRIN2T "adding member to intermediate quotient basis:")
       (VDPPRINT X)
       (TERPRI))))) 
(PUT 'IDQMESS1 'NUMBER-OF-ARGS 3) 
(PUT 'IDQMESS1 'DEFINED-ON-LINE '283) 
(PUT 'IDQMESS1 'DEFINED-IN-FILE 'GROEBNER/GROEBIDQ.RED) 
(PUT 'IDQMESS1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE IDQMESS1 (X P1 P2)
    (COND
     (*TRGROEB
      (PROGN
       (PRIN2 "pair(")
       (PRIN2 (VDPGETPROP P1 'NUMBER))
       (PRIN2 ",")
       (PRIN2 (VDPGETPROP P2 'NUMBER))
       (PRIN2T ") adding member to intermediate quotient basis:")
       (VDPPRINT X)
       (TERPRI))))) 
(PUT 'IDQMESS2 'NUMBER-OF-ARGS 1) 
(PUT 'IDQMESS2 'DEFINED-ON-LINE '290) 
(PUT 'IDQMESS2 'DEFINED-IN-FILE 'GROEBNER/GROEBIDQ.RED) 
(PUT 'IDQMESS2 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE IDQMESS2 (B)
    (COND
     (*TRGROEB
      (PROGN
       (PRIN2T "---------------------------------------------------")
       (PRIN2 "the full intermediate base of the ideal quotient is:")
       (PROG (X)
         (SETQ X B)
        LAB
         (COND ((NULL X) (RETURN NIL)))
         ((LAMBDA (X) (VDPPRIN3T X)) (CAR X))
         (SETQ X (CDR X))
         (GO LAB))
       (PRIN2T "---------------------------------------------------")
       (TERPRI))))) 
(PUT 'IDQMESS3 'NUMBER-OF-ARGS 2) 
(PUT 'IDQMESS3 'DEFINED-ON-LINE '298) 
(PUT 'IDQMESS3 'DEFINED-IN-FILE 'GROEBNER/GROEBIDQ.RED) 
(PUT 'IDQMESS3 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE IDQMESS3 (P S)
    (COND
     (*TRGROEBS
      (PROGN
       (PRIN2 "S-polynomial from ")
       (GROEBPAIRPRINT P)
       (VDPPRINT S)
       (PRIN2T "with cofactor")
       (VDPPRINT (VDPGETPROP S 'COFACT))
       (GROETIMEPRINT)
       (TERPRIT 3))))) 
(PUT 'IDQMESS4 'NUMBER-OF-ARGS 2) 
(PUT 'IDQMESS4 'DEFINED-ON-LINE '304) 
(PUT 'IDQMESS4 'DEFINED-IN-FILE 'GROEBNER/GROEBIDQ.RED) 
(PUT 'IDQMESS4 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE IDQMESS4 (P H)
    (COND
     ((CAR P)
      (PROGN
       (SETQ HCOUNT* (IPLUS2 HCOUNT* 1))
       (COND
        (*TRGROEB
         (PROGN
          (TERPRI)
          (PRIN2 "H-polynomial ")
          (PRIN2 PCOUNT*)
          (GROEBMESSFF " from pair(" (CADR P) NIL)
          (GROEBMESSFF "," (CADDR P) ")")
          (VDPPRINT H)
          (PRIN2T "with cofactor")
          (VDPPRINT (VDPGETPROP H 'COFACT))
          (GROETIMEPRINT))))))
     (*TRGROEB
      (PROGN (PRIN2T "candidate from input:") (VDPPRINT H) (GROETIMEPRINT))))) 
(ENDMODULE) 