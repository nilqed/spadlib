(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'PACKAGE4)) 
(REMD 'PACKAGE) 
(FLUID '(CURR_PCKG*)) 
(PUT 'READ_PACKAGE 'NUMBER-OF-ARGS 0) 
(PUT 'READ_PACKAGE 'DEFINED-ON-LINE '40) 
(PUT 'READ_PACKAGE 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'READ_PACKAGE 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE READ_PACKAGE NIL
    (PROG (PCKGTYP PCKG BODY TMP X)
      (SETQ PCKGTYP CURSYM*)
      (SETQ BODY (SETQ PCKG (READ_PACKAGE_NAME)))
      (SETQ TMP (CDR PCKG))
      (COND
       ((EQ (SETQ X (SCAN)) 'EXTENDS)
        (PROGN
         (FLAG '(BY) 'DELIM)
         (SETQ X (XREAD T))
         (REMFLAG '(BY) 'DELIM)
         (SCAN)
         (SETQ TMP (CDR (RPLACD TMP (LIST (LIST 'EXTENDS X))))))))
     A
      (COND
       ((EQ X 'PACKAGE)
        (LPRIE (LIST "Nested package definition not allowed"))))
      (SETQ X (XREAD1 T))
      (COND
       ((AND (NULL (ATOM X)) (MEMQ (CAR X) '(ENDPACKAGE ENDASSERTIONS)))
        (RETURN (CONS PCKGTYP BODY))))
      (SETQ TMP (CDR (RPLACD TMP (LIST X))))
      (SETQ X (SCAN))
      (GO A))) 
(PUT 'READ_PACKAGE_NAME 'NUMBER-OF-ARGS 0) 
(PUT 'READ_PACKAGE_NAME 'DEFINED-ON-LINE '61) 
(PUT 'READ_PACKAGE_NAME 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'READ_PACKAGE_NAME 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE READ_PACKAGE_NAME NIL
    (PROG (N X Y Z)
      (SETQ N (SCAN))
      (COND ((NULL (EQ (SCAN) '*LPAR*)) (RETURN (LIST N NIL))))
     A
      (SETQ X (SCAN))
      (COND ((NOT (IDP X)) (TYPERR X "parameter")))
      (SETQ Y (SCAN))
      (COND ((EQ Y '*COLON*) (GO ASSERTION)))
     B
      (COND ((EQ Y '*COMMA*) (PROGN (SETQ Z (CONS X Z)) (GO A)))
            ((EQ Y '*RPAR*)
             (COND
              ((EQ (SCAN) '*SEMICOL*)
               (RETURN (CONS N (LIST (REVERSIP (CONS X Z)))))))))
     ASSERTION
      (SETQ X (CONS X (READ_TYPE4)))
      (SETQ Y CURSYM*)
      (GO B))) 
(PUT 'PACKAGE 'STAT 'READ_PACKAGE) 
(PUT 'ASSERTIONS 'STAT 'READ_PACKAGE) 
(PUT 'ENDPACKAGE 'STAT 'ENDSTAT) 
(PUT 'ENDASSERTIONS 'STAT 'ENDSTAT) 
(PUT 'N_FORM_PACKAGE 'NUMBER-OF-ARGS 2) 
(PUT 'N_FORM_PACKAGE 'DEFINED-ON-LINE '87) 
(PUT 'N_FORM_PACKAGE 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'N_FORM_PACKAGE 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE N_FORM_PACKAGE (U VARS)
    (PROG (PCKG_TYP PCKG_NAME PCKG_PARMS ENR MI X)
      (SETQ PCKG_TYP (CAR U))
      (SETQ U (CDR U))
      (SETQ PCKG_NAME (CAR U))
      (SETQ U (CDR U))
      (SETQ PCKG_PARMS (CAR U))
      (COND
       (PCKG_PARMS
        (SETQ MI
                (PROG (ARG FORALL-RESULT FORALL-ENDPTR)
                  (SETQ ARG PCKG_PARMS)
                  (COND ((NULL ARG) (RETURN NIL)))
                  (SETQ FORALL-RESULT
                          (SETQ FORALL-ENDPTR
                                  (CONS
                                   ((LAMBDA (ARG)
                                      (PROGN
                                       (SETQ X
                                               (COPY_ASSERTIONS
                                                (FORM_PCKG_EXPR (CDR ARG))
                                                (APPEND (EXPLODE (CAR ARG))
                                                        (EXPLODE (CDR ARG)))))
                                       (MK_NEW_BASE_ENV (CAR ARG) X)
                                       X))
                                    (CAR ARG))
                                   NIL)))
                 LOOPLABEL
                  (SETQ ARG (CDR ARG))
                  (COND ((NULL ARG) (RETURN FORALL-RESULT)))
                  (RPLACD FORALL-ENDPTR
                          (CONS
                           ((LAMBDA (ARG)
                              (PROGN
                               (SETQ X
                                       (COPY_ASSERTIONS
                                        (FORM_PCKG_EXPR (CDR ARG))
                                        (APPEND (EXPLODE (CAR ARG))
                                                (EXPLODE (CDR ARG)))))
                               (MK_NEW_BASE_ENV (CAR ARG) X)
                               X))
                            (CAR ARG))
                           NIL))
                  (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                  (GO LOOPLABEL)))))
      (SETQ U (CDR U))
      (COND ((NULL U) (REDERR (LIST "empty package" PCKG_NAME))))
      (SETQ ENR
              (COND
               ((NULL (EQCAR (CAR U) 'EXTENDS))
                (FORM_EXTENDS_PCKG PCKG_NAME NIL U))
               (T
                (FORM_EXTENDS_PCKG PCKG_NAME (FORM_PCKG_EXPR (CADAR U))
                 (CDR U)))))
      (COND
       (PCKG_PARMS
        (COND
         ((EQ PCKG_TYP 'PACKAGE)
          (PROGN
           (SETQ X (PCKG_BASE ENR))
           (PROG (J)
             (SETQ J PCKG_PARMS)
            LAB
             (COND ((NULL J) (RETURN NIL)))
             ((LAMBDA (J) (SETQ X (DELETE (CAR J) X))) (CAR J))
             (SETQ J (CDR J))
             (GO LAB))
           (MK_NEW_PARAM_ENV PCKG_NAME (CONS X (CDR ENR)) MI)
           (RM_BASE_ENV PCKG_PARMS)))
         ((EQ PCKG_TYP 'ASSERTIONS) (PROGN "to be filled in"))))
       (T
        (MK_NEW_BASE_ENV PCKG_NAME
         (CONS (CONS PCKG_NAME (CAR ENR)) (CDR ENR)))))
      (SETQ ENR (CDR ENR))
      (COND ((AND ENR (EQCAR (CAR ENR) 'TYPES)) (SETQ ENR (CDR ENR))))
      (COND
       ((AND (NULL PCKG_PARMS) (EQ PCKG_TYP 'PACKAGE))
        (RETURN
         (LIST 'NOVAL
               (CONS 'PROGN
                     (PROG (J FORALL-RESULT FORALL-ENDPTR)
                       (SETQ J ENR)
                       (COND ((NULL J) (RETURN NIL)))
                       (SETQ FORALL-RESULT
                               (SETQ FORALL-ENDPTR
                                       (CONS
                                        ((LAMBDA (J) (CADR (N_FORM1 J VARS)))
                                         (CAR J))
                                        NIL)))
                      LOOPLABEL
                       (SETQ J (CDR J))
                       (COND ((NULL J) (RETURN FORALL-RESULT)))
                       (RPLACD FORALL-ENDPTR
                               (CONS
                                ((LAMBDA (J) (CADR (N_FORM1 J VARS))) (CAR J))
                                NIL))
                       (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                       (GO LOOPLABEL)))))))
      (RETURN (MKNOVALOBJ)))) 
(PUT 'TYPES 'NUMBER-OF-ARGS 1) 
(PUT 'TYPES 'DEFINED-ON-LINE '135) 
(PUT 'TYPES 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'TYPES 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE TYPES (U) NIL) 
(FLAG '(TYPES) 'NON_FORM) 
(PUT 'MK_NEW_BASE_ENV 'NUMBER-OF-ARGS 2) 
(PUT 'MK_NEW_BASE_ENV 'DEFINED-ON-LINE '138) 
(PUT 'MK_NEW_BASE_ENV 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'MK_NEW_BASE_ENV 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MK_NEW_BASE_ENV (U V)
    (PROGN
     (COND ((PCKG_BASE V) (PUT U 'PACKAGE_DAG (CDR (PCKG_BASE V)))))
     (PUT U 'BASE_PCKG V))) 
(PUT 'GET_PCKG 'NUMBER-OF-ARGS 1) 
(PUT 'GET_PCKG 'DEFINED-ON-LINE '142) 
(PUT 'GET_PCKG 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'GET_PCKG 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE GET_PCKG (U) (GET U 'BASE_PCKG)) 
(PUT 'MK_NEW_ASSERTION_ENV 'NUMBER-OF-ARGS 2) 
(PUT 'MK_NEW_ASSERTION_ENV 'DEFINED-ON-LINE '145) 
(PUT 'MK_NEW_ASSERTION_ENV 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'MK_NEW_ASSERTION_ENV 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MK_NEW_ASSERTION_ENV (U V) (PUT U 'ASSERTION_PCKG V)) 
(PUT 'MK_NEW_PARAM_ENV 'NUMBER-OF-ARGS 3) 
(PUT 'MK_NEW_PARAM_ENV 'DEFINED-ON-LINE '148) 
(PUT 'MK_NEW_PARAM_ENV 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'MK_NEW_PARAM_ENV 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE MK_NEW_PARAM_ENV (U V W) (PUT U 'PARAM_PCKG (LIST V W))) 
(PUT 'RM_BASE_ENV 'NUMBER-OF-ARGS 1) 
(PUT 'RM_BASE_ENV 'DEFINED-ON-LINE '151) 
(PUT 'RM_BASE_ENV 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'RM_BASE_ENV 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE RM_BASE_ENV (U)
    (PROG (M)
      (SETQ M U)
     LAB
      (COND ((NULL M) (RETURN NIL)))
      ((LAMBDA (M) (REMPROP (CAR M) 'BASE_PCKG)) (CAR M))
      (SETQ M (CDR M))
      (GO LAB))) 
(PUT 'PCKG_BASE 'NUMBER-OF-ARGS 1) 
(PUT 'PCKG_BASE 'DEFINED-ON-LINE '154) 
(PUT 'PCKG_BASE 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'PCKG_BASE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PCKG_BASE (U) (CAR U)) 
(PUT 'COPY_ASSERTIONS 'NUMBER-OF-ARGS 2) 
(PUT 'COPY_ASSERTIONS 'DEFINED-ON-LINE '156) 
(PUT 'COPY_ASSERTIONS 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'COPY_ASSERTIONS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE COPY_ASSERTIONS (U TAG)
    (PROG (X Y SL)
      (PROG (BASE)
        (SETQ BASE (PCKG_BASE U))
       LAB
        (COND ((NULL BASE) (RETURN NIL)))
        ((LAMBDA (BASE)
           (COND
            ((SETQ X (ATSOC 'TYPES (GET BASE 'BASE_PCKG)))
             (SETQ Y (APPEND (CDDR X) Y)))))
         (CAR BASE))
        (SETQ BASE (CDR BASE))
        (GO LAB))
      (SETQ SL (MK_RETAG_SL Y U TAG))
      (RETURN (LIST NIL (RETAG_PACKAGE (CDR U) SL))))) 
(PUT 'MK_RETAG_SL 'NUMBER-OF-ARGS 3) 
(PUT 'MK_RETAG_SL 'DEFINED-ON-LINE '165) 
(PUT 'MK_RETAG_SL 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'MK_RETAG_SL 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE MK_RETAG_SL (U V TAG)
    (PROG (X Y Z)
      (COND ((SETQ X (ATSOC 'TYPES V)) (SETQ X (CDDR X))))
      (SETQ TAG (APPEND TAG '(|:|)))
      (PROG (EL)
        (SETQ EL X)
       LAB
        (COND ((NULL EL) (RETURN NIL)))
        ((LAMBDA (EL)
           (COND
            ((NULL (RASSOC (CDR EL) U))
             (SETQ Y
                     (CONS
                      (CONS (CDR EL)
                            (PROGN
                             (PUT (SETQ Z (MK_PREFIX TAG (CAR EL)))
                                  'PACKAGE_ORIG TAG)
                             Z))
                      Y)))))
         (CAR EL))
        (SETQ EL (CDR EL))
        (GO LAB))
      (RETURN Y))) 
(PUT 'RETAG_PACKAGE 'NUMBER-OF-ARGS 2) 
(PUT 'RETAG_PACKAGE 'DEFINED-ON-LINE '177) 
(PUT 'RETAG_PACKAGE 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'RETAG_PACKAGE 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE RETAG_PACKAGE (U SL)
    (COND ((NULL U) NIL)
          ((OR (EQCAR (CAR U) 'TYPES) (EQCAR (CAR U) 'SUBTYPERELS)
               (EQCAR (CAR U) 'RANKS))
           (CONS (SUBLA SL (CAR U)) (RETAG_PACKAGE (CDR U) SL)))
          ((EQCAR (CAR U) 'PROCEDURE)
           (CONS
            (CONS (CAAR U)
                  (CONS (CADAR U)
                        (CONS (SUBLA SL (CADDAR U))
                              (CONS (CAR (CDDDAR U))
                                    (CONS (SUBLA SL (CADR (CDDDAR U)))
                                          (CDDR (CDDDAR U)))))))
            (RETAG_PACKAGE (CDR U) SL))))) 
(PUT 'PACKAGE 'N_FORMFN 'N_FORM_PACKAGE) 
(PUT 'ASSERTIONS 'N_FORMFN 'N_FORM_PACKAGE) 
(PUT 'PACKAGE 'FORMFN 'N_FORM_PACKAGE) 
(PUT 'ASSERTIONS 'FORMFN 'N_FORM_PACKAGE) 
(PUT 'FORM_PCKG_EXPR 'NUMBER-OF-ARGS 1) 
(PUT 'FORM_PCKG_EXPR 'DEFINED-ON-LINE '197) 
(PUT 'FORM_PCKG_EXPR 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'FORM_PCKG_EXPR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE FORM_PCKG_EXPR (U)
    (COND ((ATOM U) (GET_PCKG U))
          ((EQ (CAR U) 'PLUS)
           (PCKG_COMBINE
            (PROG (ARG FORALL-RESULT FORALL-ENDPTR)
              (SETQ ARG (CDR U))
              (COND ((NULL ARG) (RETURN NIL)))
              (SETQ FORALL-RESULT
                      (SETQ FORALL-ENDPTR
                              (CONS
                               ((LAMBDA (ARG) (FORM_PCKG_EXPR ARG)) (CAR ARG))
                               NIL)))
             LOOPLABEL
              (SETQ ARG (CDR ARG))
              (COND ((NULL ARG) (RETURN FORALL-RESULT)))
              (RPLACD FORALL-ENDPTR
                      (CONS ((LAMBDA (ARG) (FORM_PCKG_EXPR ARG)) (CAR ARG))
                            NIL))
              (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
              (GO LOOPLABEL))))
          (T (MK_PARAMETRIZED_PCKG U)))) 
(PUT 'PCKG_COMBINE 'NUMBER-OF-ARGS 1) 
(PUT 'PCKG_COMBINE 'DEFINED-ON-LINE '204) 
(PUT 'PCKG_COMBINE 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'PCKG_COMBINE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PCKG_COMBINE (U)
    (PROG (BASE BODY TYPS)
      (SETQ BASE (CAAR U))
      (SETQ TYPS (CADAR U))
      (PROG (PCKG)
        (SETQ PCKG (CDR U))
       LAB
        (COND ((NULL PCKG) (RETURN NIL)))
        ((LAMBDA (PCKG)
           (PROGN
            (SETQ BASE (UNION (CAR PCKG) BASE))
            (SETQ TYPS (UNION (CADR PCKG) TYPS))
            NIL))
         (CAR PCKG))
        (SETQ PCKG (CDR PCKG))
        (GO LAB))
      (RETURN (LIST BASE TYPS BODY)))) 
(PUT 'FORM_EXTENDS_PCKG 'NUMBER-OF-ARGS 3) 
(PUT 'FORM_EXTENDS_PCKG 'DEFINED-ON-LINE '218) 
(PUT 'FORM_EXTENDS_PCKG 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'FORM_EXTENDS_PCKG 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORM_EXTENDS_PCKG (P U V)
    (PROG (PREFIX TA X)
      (SETQ PREFIX (APPEND (EXPLODE P) '(|:|)))
      (COND
       ((SETQ TA (ATSOC 'TYPES V))
        (PROG (TYPL)
          (SETQ TYPL (CDR TA))
         LAB
          (COND ((NULL TYPL) (RETURN NIL)))
          (RPLACA TYPL
                  (CONS (CAR TYPL)
                        (PROGN
                         (PUT (SETQ X (MK_PREFIX PREFIX (CAR TYPL)))
                              'PACKAGE_ORIG P)
                         X)))
          (SETQ TYPL (CDR TYPL))
          (GO LAB))))
      (SETQ TA (CDR TA))
      (COND ((SETQ X (ATSOC 'TYPES U)) (NCONC TA (CDR X))))
      (COND ((SETQ X (ATSOC 'SUBTYPERELS V)) (RPLACD X (SUBLA TA (CDR X)))))
      (COND ((SETQ X (ATSOC 'RANKS V)) (RPLACD X (SUBLA TA (CDR X)))))
      (PROG (J)
        (SETQ J V)
       LAB
        (COND ((NULL J) (RETURN NIL)))
        ((LAMBDA (J)
           (COND
            ((EQCAR J 'PROCEDURE)
             (PROGN
              (RPLACA (CDDR J) (SUBLA TA (CADDR J)))
              (RPLACA (CDDDR J) (CONS (CADDDR J) P))
              (RPLACA (CDDDDR J) (SUBLA TA (CAR (CDDDDR J))))))))
         (CAR J))
        (SETQ J (CDR J))
        (GO LAB))
      (RETURN (CONS (COND (U (PCKG_BASE U)) (T NIL)) V)))) 
(PUT 'MK_PREFIX 'NUMBER-OF-ARGS 2) 
(PUT 'MK_PREFIX 'DEFINED-ON-LINE '248) 
(PUT 'MK_PREFIX 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'MK_PREFIX 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MK_PREFIX (U V) (INTERN (COMPRESS (APPEND U (EXPLODE V))))) 
(PUT 'READ_VIEW 'NUMBER-OF-ARGS 0) 
(PUT 'READ_VIEW 'DEFINED-ON-LINE '254) 
(PUT 'READ_VIEW 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'READ_VIEW 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE READ_VIEW NIL
    (PROG (TARGET SOURCE)
      (SETQ TARGET (SCAN))
      (COND ((NULL (EQ (SCAN) 'AS)) (LPRIE (LIST "keyword 'as' expected"))))
      (SETQ SOURCE (SCAN))
      (COND
       ((NULL (EQ (SCAN) 'WITH)) (LPRIE (LIST "keyword 'with' expected"))))
      (RETURN (LIST 'VIEW TARGET SOURCE (XREAD T))))) 
(PUT 'BIND_PARAM_PACKAGE 'NUMBER-OF-ARGS 2) 
(PUT 'BIND_PARAM_PACKAGE 'DEFINED-ON-LINE '264) 
(PUT 'BIND_PARAM_PACKAGE 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'BIND_PARAM_PACKAGE 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE BIND_PARAM_PACKAGE (PCKG VIEWS)
    (PROG (X Y Z SL)
      (SETQ X (GET PCKG 'PARAM_PCKG))
      (SETQ Z (RETAG_PACKAGE (CAR X) SL))
      (SETQ Y
              (PCKG_COMBINE
               (PROG (V FORALL-RESULT FORALL-ENDPTR)
                 (SETQ V VIEWS)
                 (COND ((NULL V) (RETURN NIL)))
                 (SETQ FORALL-RESULT
                         (SETQ FORALL-ENDPTR
                                 (CONS ((LAMBDA (V) (CADR V)) (CAR V)) NIL)))
                LOOPLABEL
                 (SETQ V (CDR V))
                 (COND ((NULL V) (RETURN FORALL-RESULT)))
                 (RPLACD FORALL-ENDPTR
                         (CONS ((LAMBDA (V) (CADR V)) (CAR V)) NIL))
                 (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                 (GO LOOPLABEL))))
      (RETURN (CONS (PKG_BASE (CAR X)) Y)))) 
(PUT 'PCKG_GEQ 'NUMBER-OF-ARGS 2) 
(PUT 'PCKG_GEQ 'DEFINED-ON-LINE '275) 
(PUT 'PCKG_GEQ 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'PCKG_GEQ 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE PCKG_GEQ (U V) (OR (EQ U V) (PCKG_GEQL (GET U 'PACKAGE_DAG) V))) 
(PUT 'PCKG_GEQL 'NUMBER-OF-ARGS 2) 
(PUT 'PCKG_GEQL 'DEFINED-ON-LINE '278) 
(PUT 'PCKG_GEQL 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'PCKG_GEQL 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE PCKG_GEQL (U V) (AND U (OR (PCKG_GEQ (CAR U) V) (PCKG_GEQL (CDR U) V)))) 
(PUT 'OP_IN_PCKGP 'NUMBER-OF-ARGS 1) 
(PUT 'OP_IN_PCKGP 'DEFINED-ON-LINE '281) 
(PUT 'OP_IN_PCKGP 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'OP_IN_PCKGP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OP_IN_PCKGP (U) (PCKG_GEQ CURR_PCKG* U)) 
(PUT 'TYPE_IN_PCKGP 'NUMBER-OF-ARGS 1) 
(PUT 'TYPE_IN_PCKGP 'DEFINED-ON-LINE '284) 
(PUT 'TYPE_IN_PCKGP 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'TYPE_IN_PCKGP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE TYPE_IN_PCKGP (U) (PCKG_GEQ CURR_PCKG* (GET U 'PACKAGE_ORIG))) 
(PUT 'PCKG_TYPE 'NUMBER-OF-ARGS 1) 
(PUT 'PCKG_TYPE 'DEFINED-ON-LINE '287) 
(PUT 'PCKG_TYPE 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'PCKG_TYPE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PCKG_TYPE (U)
    (PROG (X Y)
      (COND ((NULL CURR_PCKG*) (RETURN U)))
      (SETQ X (ATSOC 'TYPES (GET CURR_PCKG* 'BASE_PCKG)))
      (COND ((NULL X) (RETURN U)))
      (SETQ Y (ASSOC U (CDR X)))
      (RETURN (COND (Y (CDR Y)) (T U))))) 
(PUT 'PCKG_OP_CHK 'NUMBER-OF-ARGS 1) 
(PUT 'PCKG_OP_CHK 'DEFINED-ON-LINE '297) 
(PUT 'PCKG_OP_CHK 'DEFINED-IN-FILE 'REDUCE4/PACKAGE4.RED) 
(PUT 'PCKG_OP_CHK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PCKG_OP_CHK (U)
    (COND ((NULL U) NIL) ((NULL CURR_PCKG*) U) ((OP_IN_PCKGP U) U) (T NIL))) 
(ENDMODULE) 