(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'DFPRIN)) 
(FLUID '(*FORT *NAT *NOARG DEPL* POSN*)) 
(GLOBAL '(*DFPRINT FARGLIST*)) 
(SWITCH (LIST 'DFPRINT (LIST 'EQUAL 'NOARG 'ON))) 
(SETQ *DFPRINT NIL) 
(SETQ *NOARG T) 
(SETQ FARGLIST* NIL) 
(PUT 'DFPRINTFN 'NUMBER-OF-ARGS 1) 
(PUT 'DFPRINTFN 'DEFINED-ON-LINE '51) 
(PUT 'DFPRINTFN 'DEFINED-IN-FILE 'MATHPR/DFPRIN.RED) 
(PUT 'DFPRINTFN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DFPRINTFN (U)
    (COND ((OR (NOT *NAT) *FORT (NOT *DFPRINT)) 'FAILED)
          (T
           (PROG (W)
             (SETQ W (LAYOUT-FORMULA (CONS '!DF! (CDR U)) 0 NIL))
             (COND ((EQUAL W NIL) (RETURN 'FAILED)) (T (PUTPLINE W))))))) 
(PUT 'DF 'PRIFN 'DFPRINTFN) 
(PUT 'DFLAYOUT 'NUMBER-OF-ARGS 1) 
(PUT 'DFLAYOUT 'DEFINED-ON-LINE '65) 
(PUT 'DFLAYOUT 'DEFINED-IN-FILE 'MATHPR/DFPRIN.RED) 
(PUT 'DFLAYOUT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DFLAYOUT (U)
    ((LAMBDA (*NOARG)
       (PROG (OP ARGS W)
         (SETQ W (CAR (SETQ U (CDR U))))
         (SETQ U (CDR U))
         (COND ((SMEMBER 'INT W) (SETQ *NOARG NIL)))
         (COND
          ((AND *NOARG (OR (ATOM W) (NOT (GET (CAR W) 'OP))))
           (PROGN
            (COND
             ((ATOM W)
              (PROGN
               (SETQ OP W)
               (SETQ ARGS (ASSOC OP DEPL*))
               (COND (ARGS (SETQ ARGS (CDR ARGS))))))
             (T (PROGN (SETQ OP (CAR W)) (SETQ ARGS (CDR W)))))
            (REMEMBER-ARGS OP ARGS)
            (SETQ W OP))))
         (MAPRIN W)
         (COND
          (U
           (PROGN
            (SETQ U (LAYOUT-FORMULA (CONS '!DFSUB! U) 0 NIL))
            (COND ((NULL U) (RETURN 'FAILED)))
            (SETQ W (PLUS 1 (CDDR U)))
            (PUTPLINE
             (CONS (CONS (UPDATE-PLINE 0 (MINUS W) (CAAR U)) (CDAR U))
                   (CONS (DIFFERENCE (CADR U) W)
                         (DIFFERENCE (CDDR U) W)))))))))
     *NOARG)) 
(PUT 'DFSUBLAYOUT 'NUMBER-OF-ARGS 1) 
(PUT 'DFSUBLAYOUT 'DEFINED-ON-LINE '95) 
(PUT 'DFSUBLAYOUT 'DEFINED-IN-FILE 'MATHPR/DFPRIN.RED) 
(PUT 'DFSUBLAYOUT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DFSUBLAYOUT (U)
    (PROG (DFCASE FIRSTFLAG W)
      (SETQ DFCASE (EQUAL (CAR U) '!DFSUB!))
      (SETQ U (CDR U))
      (SETQ FIRSTFLAG T)
      (PROG ()
       WHILELABEL
        (COND ((NOT U) (RETURN NIL)))
        (PROGN
         (SETQ W (CAR U))
         (SETQ U (CDR U))
         (COND (FIRSTFLAG (SETQ FIRSTFLAG NIL)) (T (PRIN2* ",")))
         (COND
          ((AND DFCASE U (NUMBERP (CAR U)))
           (PROGN (PRIN2* (CAR U)) (SETQ U (CDR U)))))
         (MAPRIN W))
        (GO WHILELABEL)))) 
(PUT '!DF! 'PRIFN 'DFLAYOUT) 
(PUT '!DFSUB! 'PRIFN 'DFSUBLAYOUT) 
(PUT 'REMEMBER-ARGS 'NUMBER-OF-ARGS 2) 
(PUT 'REMEMBER-ARGS 'DEFINED-ON-LINE '120) 
(PUT 'REMEMBER-ARGS 'DEFINED-IN-FILE 'MATHPR/DFPRIN.RED) 
(PUT 'REMEMBER-ARGS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE REMEMBER-ARGS (OP ARGS)
    (PROG (W)
      (SETQ W (ASSOC OP FARGLIST*))
      (COND ((NULL W) (SETQ FARGLIST* (CONS (CONS OP ARGS) FARGLIST*)))))) 
(PUT 'FARG 'NUMBER-OF-ARGS 0) 
(PUT 'FARG 'DEFINED-ON-LINE '129) 
(PUT 'FARG 'DEFINED-IN-FILE 'MATHPR/DFPRIN.RED) 
(PUT 'FARG 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE FARG NIL
    (PROG (NEWNAME)
      (PRIN2* "The operators have the following ")
      (PRIN2* "arguments or dependencies")
      (TERPRI* T)
      (PROG (P)
        (SETQ P FARGLIST*)
       LAB
        (COND ((NULL P) (RETURN NIL)))
        ((LAMBDA (P)
           (PROGN
            (PRIN2* (CAR P))
            (PRIN2* "=")
            (SETQ NEWNAME
                    (COMPRESS (CONS '|"| (APPEND (EXPLODE2 (CAR P)) '(|"|)))))
            (MAPRIN (CONS NEWNAME (CDR P)))
            (TERPRI* T)))
         (CAR P))
        (SETQ P (CDR P))
        (GO LAB)))) 
(PUT 'FARG 'STAT 'ENDSTAT) 
(PUT 'CLFARG 'NUMBER-OF-ARGS 0) 
(PUT 'CLFARG 'DEFINED-ON-LINE '150) 
(PUT 'CLFARG 'DEFINED-IN-FILE 'MATHPR/DFPRIN.RED) 
(PUT 'CLFARG 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE CLFARG NIL (SETQ FARGLIST* NIL)) 
(PUT 'CLFARG 'STAT 'ENDSTAT) 
(PUT 'SETPRIFN 'NUMBER-OF-ARGS 2) 
(PUT 'SETPRIFN 'DEFINED-ON-LINE '156) 
(PUT 'SETPRIFN 'DEFINED-IN-FILE 'MATHPR/DFPRIN.RED) 
(PUT 'SETPRIFN 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SETPRIFN (U FN)
    (PROG (N)
      (SETQ N U)
     LAB
      (COND ((NULL N) (RETURN NIL)))
      ((LAMBDA (N)
         (COND
          ((IDP N)
           (PROGN
            (COND ((NOT (EQ (GETTYPE N) 'OPERATOR)) (MKOP N)))
            (COND (FN (PUT N 'PRIFN FN)) (T (REMPROP N 'PRIFN)))))
          (T (LPRIM (LIST N "not an identifier")))))
       (CAR N))
      (SETQ N (CDR N))
      (GO LAB))) 
(PUT 'INDEXPRIN 'NUMBER-OF-ARGS 1) 
(PUT 'INDEXPRIN 'DEFINED-ON-LINE '167) 
(PUT 'INDEXPRIN 'DEFINED-IN-FILE 'MATHPR/DFPRIN.RED) 
(PUT 'INDEXPRIN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE INDEXPRIN (U)
    (COND ((OR (NOT *NAT) *FORT) 'FAILED)
          (T
           (PROG (W)
             (SETQ W (LAYOUT-FORMULA (CONS '!INDEX! U) 0 NIL))
             (COND ((EQUAL W NIL) (RETURN 'FAILED)) (T (PUTPLINE W))))))) 
(PUT 'INDEXPOWER 'NUMBER-OF-ARGS 2) 
(PUT 'INDEXPOWER 'DEFINED-ON-LINE '178) 
(PUT 'INDEXPOWER 'DEFINED-IN-FILE 'MATHPR/DFPRIN.RED) 
(PUT 'INDEXPOWER 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE INDEXPOWER (U N)
    (PROG (W)
      (SETQ W (LAYOUT-FORMULA (CONS '!INDEXPOWER! (CONS N U)) 0 NIL))
      (COND ((EQUAL W NIL) (RETURN 'FAILED)) (T (PUTPLINE W))))) 
(PUT 'INDEXLAYOUT 'NUMBER-OF-ARGS 1) 
(PUT 'INDEXLAYOUT 'DEFINED-ON-LINE '188) 
(PUT 'INDEXLAYOUT 'DEFINED-IN-FILE 'MATHPR/DFPRIN.RED) 
(PUT 'INDEXLAYOUT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE INDEXLAYOUT (U)
    (PROG (W)
      (SETQ W (CAR (SETQ U (CDR U))))
      (SETQ U (CDR U))
      (MAPRIN W)
      (COND
       (U
        (PROGN
         (SETQ U (LAYOUT-FORMULA (CONS '!INDEXSUB! U) 0 NIL))
         (COND ((NULL U) (RETURN 'FAILED)))
         (SETQ W (PLUS 1 (CDDR U)))
         (PUTPLINE
          (CONS (CONS (UPDATE-PLINE 0 (MINUS W) (CAAR U)) (CDAR U))
                (CONS (DIFFERENCE (CADR U) W) (DIFFERENCE (CDDR U) W))))))))) 
(PUT 'INDEXPOWERLAYOUT 'NUMBER-OF-ARGS 1) 
(PUT 'INDEXPOWERLAYOUT 'DEFINED-ON-LINE '206) 
(PUT 'INDEXPOWERLAYOUT 'DEFINED-IN-FILE 'MATHPR/DFPRIN.RED) 
(PUT 'INDEXPOWERLAYOUT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE INDEXPOWERLAYOUT (U)
    (PROG (N W POS MAXPOS)
      (SETQ N (CAR (SETQ U (CDR U))))
      (SETQ W (CAR (SETQ U (CDR U))))
      (SETQ U (CDR U))
      (MAPRIN W)
      (SETQ W (LAYOUT-FORMULA N 0 NIL))
      (SETQ POS POSN*)
      (PUTPLINE
       (CONS (CONS (UPDATE-PLINE 0 (DIFFERENCE 1 (CADR W)) (CAAR W)) (CDAR W))
             (CONS 1 (PLUS 1 (DIFFERENCE (CDDR W) (CADR W))))))
      (SETQ MAXPOS POSN*)
      (SETQ POSN* POS)
      (COND
       (U
        (PROGN
         (SETQ U (LAYOUT-FORMULA (CONS '!INDEXSUB! U) 0 NIL))
         (COND ((NULL U) (RETURN 'FAILED)))
         (SETQ W (PLUS 1 (CDDR U)))
         (PUTPLINE
          (CONS (CONS (UPDATE-PLINE 0 (MINUS W) (CAAR U)) (CDAR U))
                (CONS (DIFFERENCE (CADR U) W) (DIFFERENCE (CDDR U) W)))))))
      (SETQ POSN* (MAX POSN* MAXPOS)))) 
(PUT '!INDEX! 'PRIFN 'INDEXLAYOUT) 
(PUT '!INDEXPOWER! 'PRIFN 'INDEXPOWERLAYOUT) 
(PUT '!INDEXSUB! 'PRIFN 'DFSUBLAYOUT) 
(PUT 'NOARGSPRIN 'NUMBER-OF-ARGS 1) 
(PUT 'NOARGSPRIN 'DEFINED-ON-LINE '234) 
(PUT 'NOARGSPRIN 'DEFINED-IN-FILE 'MATHPR/DFPRIN.RED) 
(PUT 'NOARGSPRIN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE NOARGSPRIN (U)
    (COND ((OR (NOT *NAT) *FORT) 'FAILED)
          (T (PROGN (REMEMBER-ARGS (CAR U) (CDR U)) (MAPRIN (CAR U)))))) 
(PUT 'DOINDEX 'NUMBER-OF-ARGS 1) 
(PUT 'DOINDEX 'DEFINED-ON-LINE '242) 
(PUT 'DOINDEX 'DEFINED-IN-FILE 'MATHPR/DFPRIN.RED) 
(PUT 'DOINDEX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DOINDEX (U) (SETPRIFN U 'INDEXPRIN)) 
(PUT 'OFFINDEX 'NUMBER-OF-ARGS 1) 
(PUT 'OFFINDEX 'DEFINED-ON-LINE '246) 
(PUT 'OFFINDEX 'DEFINED-IN-FILE 'MATHPR/DFPRIN.RED) 
(PUT 'OFFINDEX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFFINDEX (U) (SETPRIFN U NIL)) 
(PUT 'DONOARGS 'NUMBER-OF-ARGS 1) 
(PUT 'DONOARGS 'DEFINED-ON-LINE '250) 
(PUT 'DONOARGS 'DEFINED-IN-FILE 'MATHPR/DFPRIN.RED) 
(PUT 'DONOARGS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DONOARGS (U) (SETPRIFN U 'NOARGSPRIN)) 
(PUT 'OFFNOARGS 'NUMBER-OF-ARGS 1) 
(PUT 'OFFNOARGS 'DEFINED-ON-LINE '254) 
(PUT 'OFFNOARGS 'DEFINED-IN-FILE 'MATHPR/DFPRIN.RED) 
(PUT 'OFFNOARGS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFFNOARGS (U) (SETPRIFN U NIL)) 
(PUT 'DOINDEX 'STAT 'RLIS) 
(PUT 'OFFINDEX 'STAT 'RLIS) 
(PUT 'DONOARGS 'STAT 'RLIS) 
(PUT 'OFFNOARGS 'STAT 'RLIS) 
(ENDMODULE) 