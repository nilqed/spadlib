(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'HODGE)) 
(GLOBAL '(DIMEX* SGN* DETM* BASISFORML*)) 
(FLUID '(FRLIS*)) 
(PUT 'FORMHODGE 'NUMBER-OF-ARGS 3) 
(PUT 'FORMHODGE 'DEFINED-ON-LINE '34) 
(PUT 'FORMHODGE 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'FORMHODGE 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMHODGE (U VARS MODE)
    (COND ((EQ MODE 'SYMBOLIC) (CONS 'HASH (FORMLIS (CDR U) VARS MODE)))
          (T (CONS 'LIST (CONS (MKQUOTE 'HODGE) (FORMLIS (CDR U) VARS MODE)))))) 
(PUT 'HASH 'FORMFN 'FORMHODGE) 
(PUT 'HODGE 'SIMPFN 'SIMPHODGE) 
(PUT 'HODGE 'RTYPEFN 'GETRTYPECAR) 
(PUT 'HODGE 'PARTITFN 'PARTITHODGE) 
(PUT '⋆ 'SCRIPTED_OP (CONS '(RSUP . HODGE) (GET '⋆ 'SCRIPTED_OP))) 
(PUT 'PARTITHODGE 'NUMBER-OF-ARGS 1) 
(PUT 'PARTITHODGE 'DEFINED-ON-LINE '49) 
(PUT 'PARTITHODGE 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'PARTITHODGE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PARTITHODGE (U) (HODGEPF (PARTITOP (CAR U)))) 
(PUT 'SIMPHODGE 'NUMBER-OF-ARGS 1) 
(PUT 'SIMPHODGE 'DEFINED-ON-LINE '52) 
(PUT 'SIMPHODGE 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'SIMPHODGE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SIMPHODGE (U) (*PF2SQ (PARTITHODGE U))) 
(PUT 'MKHODGE 'NUMBER-OF-ARGS 1) 
(PUT 'MKHODGE 'DEFINED-ON-LINE '55) 
(PUT 'MKHODGE 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'MKHODGE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MKHODGE (U)
    (PROG (X Y)
      (RETURN
       (COND ((SETQ X (OPMTCH (SETQ Y (LIST 'HODGE U)))) (PARTITOP X))
             ((EQUAL (DEG*FORM U) DIMEX*) (CONS (CONS 1 (MKSQ Y 1)) NIL))
             (T (MKUPF Y)))))) 
(DE MKBASEFORM (U) (MKUPF (LIST (CAAR BASISFORML*) U))) 
(PUT 'MKBASEFORM 'NUMBER-OF-ARGS 1) 
(PUT 'MKBASEFORM 'DEFINED-ON-LINE '64) 
(PUT 'MKBASEFORM 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'MKBASEFORM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'MKBASEFORM 'INLINE '(LAMBDA (U) (MKUPF (LIST (CAAR BASISFORML*) U)))) 
(PUT 'BASISFORMP 'NUMBER-OF-ARGS 1) 
(PUT 'BASISFORMP 'DEFINED-ON-LINE '67) 
(PUT 'BASISFORMP 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'BASISFORMP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BASISFORMP (U) (AND (NULL (ATOM U)) (MEMQ U BASISFORML*))) 
(PUT 'HODGEPF 'NUMBER-OF-ARGS 1) 
(PUT 'HODGEPF 'DEFINED-ON-LINE '70) 
(PUT 'HODGEPF 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'HODGEPF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE HODGEPF (U)
    (COND ((NULL U) NIL)
          (T (ADDPF (MULTPFSQ (HODGEK (CAAR U)) (CDAR U)) (HODGEPF (CDR U)))))) 
(PUT 'HODGEK 'NUMBER-OF-ARGS 1) 
(PUT 'HODGEK 'DEFINED-ON-LINE '74) 
(PUT 'HODGEK 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'HODGEK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE HODGEK (U)
    (COND
     ((EQCAR U 'HODGE)
      (CONS
       (CONS (CADR U)
             (MULTSQ
              (MKSGNSQ
               ((LAMBDA (G139 G140)
                  (COND (*PHYSOP-LOADED (PHYSOP-MULTF G139 G140))
                        (T (POLY-MULTF G139 G140))))
                (DEG*FORM (CADR U)) (ADDF DIMEX* (NEGF (DEG*FORM (CADR U))))))
              (RESIMP SGN*)))
       NIL))
     ((BASISFORMP U) (DUAL (LIST U)))
     ((EQCAR U 'WEDGE)
      (COND ((BOUNDINDP (CDR U) BASISFORML*) (DUAL (CDR U)))
            (T
             ((LAMBDA (X) (COND (X (XPNDHODGE2 (CDR U) X)) (T (MKHODGE U))))
              (XPNDABLEHODGEP (CDR U))))))
     ((AND BASISFORML* (NULL (DEG*FORM U))) (DUAL0 U)) (T (MKHODGE U)))) 
(PUT 'ALL1FORMSP 'NUMBER-OF-ARGS 1) 
(PUT 'ALL1FORMSP 'DEFINED-ON-LINE '89) 
(PUT 'ALL1FORMSP 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'ALL1FORMSP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ALL1FORMSP (U)
    (COND
     ((EQUAL (DEG*FORM (CAR U)) 1) (COND ((CDR U) (ALL1FORMSP (CDR U))) (T T)))
     (T NIL))) 
(PUT 'XPNDABLEHODGEP 'NUMBER-OF-ARGS 1) 
(PUT 'XPNDABLEHODGEP 'DEFINED-ON-LINE '95) 
(PUT 'XPNDABLEHODGEP 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'XPNDABLEHODGEP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE XPNDABLEHODGEP (U) (XPNDABLEHODGE1 U 0 NIL)) 
(PUT 'XPNDABLEHODGE1 'NUMBER-OF-ARGS 3) 
(PUT 'XPNDABLEHODGE1 'DEFINED-ON-LINE '98) 
(PUT 'XPNDABLEHODGE1 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'XPNDABLEHODGE1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE XPNDABLEHODGE1 (U V W)
    (COND ((NULL U) (COND (W (CONS V W)) (T NIL)))
          ((AND (EQCAR (CAR U) 'HODGE) (EQCAR (CADAR U) 'WEDGE))
           (COND ((ALL1FORMSP (CDADAR U)) (XPNDABLEHODGE1 (CDR U) V U))
                 (T NIL)))
          ((EQUAL (DEG*FORM (CAR U)) 1)
           (XPNDABLEHODGE1 (CDR U) (COND ((NULL W) (PLUS V 1)) (T V)) W))
          (T NIL))) 
(PUT 'XPNDHODGE2 'NUMBER-OF-ARGS 2) 
(PUT 'XPNDHODGE2 'DEFINED-ON-LINE '107) 
(PUT 'XPNDHODGE2 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'XPNDHODGE2 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE XPNDHODGE2 (U V)
    (PROG (H RW X)
      (SETQ H (CADR V))
      (SETQ RW (CDDR V))
      (SETQ X
              (CONS
               (CONS (CDADR H)
                     (MULTSQ
                      (MKSGNSQ
                       ((LAMBDA (G142)
                          (COND (*PHYSOP-LOADED (PHYSOP-MULTF (CAR V) G142))
                                (T (POLY-MULTF (CAR V) G142))))
                        (DEG*FORM H)))
                      (RESIMP SGN*)))
               NIL))
     A
      (COND ((EQ H (CAR U)) (GO B)))
      (SETQ X (HODGEINNERPRODWEDGEPF (CAR U) X))
      (SETQ U (CDR U))
      (GO A)
     B
      (COND ((NULL RW) (GO C)))
      (SETQ X (HODGEINNERPRODWEDGEPF (CAR RW) X))
      (SETQ RW (CDR RW))
      (GO B)
     C
      (RETURN (MKUNIQUEWEDGE X)))) 
(PUT 'HODGEINNERPRODWEDGEPF 'NUMBER-OF-ARGS 2) 
(PUT 'HODGEINNERPRODWEDGEPF 'DEFINED-ON-LINE '124) 
(PUT 'HODGEINNERPRODWEDGEPF 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'HODGEINNERPRODWEDGEPF 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE HODGEINNERPRODWEDGEPF (U V)
    (COND ((NULL V) NIL)
          (T
           (ADDPF (MULTPFSQ (HODGEINNERPRODWEDGE1 U (CAAR V) NIL) (CDAR V))
            (HODGEINNERPRODWEDGEPF U (CDR V)))))) 
(PUT 'HODGEINNERPRODWEDGE1 'NUMBER-OF-ARGS 3) 
(PUT 'HODGEINNERPRODWEDGE1 'DEFINED-ON-LINE '129) 
(PUT 'HODGEINNERPRODWEDGE1 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'HODGEINNERPRODWEDGE1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE HODGEINNERPRODWEDGE1 (U V W)
    (COND
     ((NULL (CDR V))
      (MKUNARYWEDGE (MULTPFSQ (HODGEINNERPROD U (CAR V)) (MKSGNSQ W))))
     (T
      (ADDPF
       (COND
        ((AND (NULL (CDR (CDR V))) (EQUAL (DEG*FORM (CAR (CDR V))) 1))
         (MULTPFSQ (CONS (CONS (LIST (CAR V)) (CONS 1 1)) NIL)
          (MULTSQ (MKSGNSQ (ADDF (DEG*FORM (CAR V)) W))
                  (*PF2SQ (HODGEINNERPROD U (CAR (CDR V)))))))
        (T
         (WEDGEPF2 (CONS (CONS (CAR V) (CONS 1 1)) NIL)
          (HODGEINNERPRODWEDGE1 U (CDR V) (ADDF W (DEG*FORM (CAR V)))))))
       (COND
        ((EQUAL (DEG*FORM (CAR V)) 1)
         (MULTPFSQ (CONS (CONS (CDR V) (CONS 1 1)) NIL)
          (MULTSQ (*PF2SQ (HODGEINNERPROD U (CAR V))) (MKSGNSQ W))))
        (T
         (WEDGEPF2 (HODGEINNERPROD U (CAR V))
          (CONS (CONS (CDR V) (MKSGNSQ W)) NIL)))))))) 
(PUT 'HODGEINNERPROD 'NUMBER-OF-ARGS 2) 
(PUT 'HODGEINNERPROD 'DEFINED-ON-LINE '146) 
(PUT 'HODGEINNERPROD 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'HODGEINNERPROD 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE HODGEINNERPROD (U V)
    (HODGEPF
     (MKUNIQUEWEDGE
      (WEDGEPF2 (CONS (CONS U (CONS 1 1)) NIL) (MKUNARYWEDGE (MKHODGE V)))))) 
(PUT 'DUAL0 'NUMBER-OF-ARGS 1) 
(PUT 'DUAL0 'DEFINED-ON-LINE '150) 
(PUT 'DUAL0 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'DUAL0 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DUAL0 (U)
    ((LAMBDA (X)
       (MULTPFSQ (MKWEDGE (CONS 'WEDGE BASISFORML*))
        ((LAMBDA (U)
           (COND (*QSUM-SIMPEXPT (QSUM-SIMPEXPT U)) (T (BASIC-SIMPEXPT U))))
         (LIST (MK*SQ (CONS (ABSF* (CAR X)) (ABSF* (CDR X))))
               '(QUOTIENT 1 2)))))
     (SIMP* DETM*))) 
(PUT 'DUAL 'NUMBER-OF-ARGS 1) 
(PUT 'DUAL 'DEFINED-ON-LINE '156) 
(PUT 'DUAL 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'DUAL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DUAL (U)
    ((LAMBDA (X)
       (MULTPFSQ (MKDUAL (XPNDDUAL U))
        ((LAMBDA (U)
           (COND (*QSUM-SIMPEXPT (QSUM-SIMPEXPT U)) (T (BASIC-SIMPEXPT U))))
         (LIST (MK*SQ (CONS (ABSF* (CAR X)) (ABSF* (CDR X))))
               '(QUOTIENT 1 2)))))
     (SIMP* DETM*))) 
(PUT '*MET2PF 'NUMBER-OF-ARGS 1) 
(PUT '*MET2PF 'DEFINED-ON-LINE '162) 
(PUT '*MET2PF 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT '*MET2PF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE *MET2PF (U) (METPF1 (GETUPPER (CADR U)))) 
(PUT 'XPNDDUAL 'NUMBER-OF-ARGS 1) 
(PUT 'XPNDDUAL 'DEFINED-ON-LINE '165) 
(PUT 'XPNDDUAL 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'XPNDDUAL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE XPNDDUAL (U)
    (COND ((NULL (CDR U)) (MKUNARYWEDGE (*MET2PF (CAR U))))
          (T (WEDGEPF2 (*MET2PF (CAR U)) (XPNDDUAL (CDR U)))))) 
(PUT 'METPF1 'NUMBER-OF-ARGS 1) 
(PUT 'METPF1 'DEFINED-ON-LINE '170) 
(PUT 'METPF1 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'METPF1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE METPF1 (U)
    (COND ((NULL U) NIL)
          (T
           (ADDPF
            (MULTPFSQ (MKUPF (LIST (CAAR BASISFORML*) (CAAR U)))
             (SIMP (CDAR U)))
            (METPF1 (CDR U)))))) 
(PUT 'MKDUAL 'NUMBER-OF-ARGS 1) 
(PUT 'MKDUAL 'DEFINED-ON-LINE '174) 
(PUT 'MKDUAL 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'MKDUAL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MKDUAL (U)
    (COND ((NULL U) NIL)
          (T
           (ADDPF
            (MULTPFSQ
             ((LAMBDA (X)
                (COND ((NULL X) NIL)
                      ((CDR (CAAR X))
                       (MULTPFSQ (MKUNIQUEWEDGE1 (CAAR X)) (CDAR X)))
                      (T (CONS (CONS (CAR (CAAR X)) (CDAR X)) NIL))))
              (DUALK (CAAR U)))
             (CDAR U))
            (MKDUAL (CDR U)))))) 
(PUT 'DUALK 'NUMBER-OF-ARGS 1) 
(PUT 'DUALK 'DEFINED-ON-LINE '184) 
(PUT 'DUALK 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'DUALK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DUALK (U)
    (PROG (X)
      (SETQ X (CONS (CONS BASISFORML* (CONS 1 1)) NIL))
     A
      (SETQ X (DUALK2 (CAR U) X))
      (COND ((NULL (SETQ U (CDR U))) (RETURN X)))
      (GO A))) 
(PUT 'DUALK2 'NUMBER-OF-ARGS 2) 
(PUT 'DUALK2 'DEFINED-ON-LINE '193) 
(PUT 'DUALK2 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'DUALK2 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DUALK2 (U V) (DUALK0 U V NIL)) 
(PUT 'DUALK0 'NUMBER-OF-ARGS 3) 
(PUT 'DUALK0 'DEFINED-ON-LINE '196) 
(PUT 'DUALK0 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'DUALK0 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DUALK0 (U V W)
    (COND
     ((EQ U (CAR (CAAR V)))
      (COND
       ((NULL (CDR (CAAR V)))
        (CONS (CONS (LIST 1) (MULTSQ (MKSGNSQ W) (CDAR V))) NIL))
       (T (CONS (CONS (CDR (CAAR V)) (MULTSQ (MKSGNSQ W) (CDAR V))) NIL))))
     ((NULL (CDR (CAAR V))) NIL)
     (T
      (WEDGEPF2 (CONS (CONS (CAAR (CAR V)) (CONS 1 1)) NIL)
       (DUALK0 U (CONS (CONS (CDR (CAAR V)) (CDAR V)) NIL) (ADDF W 1)))))) 
(PUT 'HODGEPRN 'NUMBER-OF-ARGS 1) 
(PUT 'HODGEPRN 'DEFINED-ON-LINE '205) 
(PUT 'HODGEPRN 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'HODGEPRN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE HODGEPRN (U) (PROGN (PRIN2* "#") (REMBRAS (CADR U)))) 
(PUT 'HODGE 'PRIFN 'HODGEPRN) 
(PUT 'XHODGEPRN 'NUMBER-OF-ARGS 1) 
(PUT 'XHODGEPRN 'DEFINED-ON-LINE '210) 
(PUT 'XHODGEPRN 'DEFINED-IN-FILE 'EXCALC/HODGE.RED) 
(PUT 'XHODGEPRN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE XHODGEPRN (U)
    (PROG ()
      (FANCY-PRIN2* "\\!" 1)
      (FANCY-PRINT-INDEXLIST1 '(⋆) '^ NIL)
      (RETURN (FANCY-MAPRINT (CADR U) 0)))) 
(PUT 'HODGE 'FANCY-PRIFN 'XHODGEPRN) 
(ENDMODULE) 