(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'BCOEFF)) 
(PUT 'BCINT2OP 'NUMBER-OF-ARGS 3) 
(PUT 'BCINT2OP 'DEFINED-ON-LINE '41) 
(PUT 'BCINT2OP 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'BCINT2OP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE BCINT2OP (A1 A2 OP)
    (COND
     ((AND (NULL DMODE*) (EQUAL 1 (CDR A1)) (NUMBERP (SETQ A1 (CAR A1)))
           (EQUAL 1 (CDR A2)) (NUMBERP (SETQ A2 (CAR A2)))
           (SETQ A1
                   (COND ((EQUAL OP 'TIMES) (TIMES A1 A2))
                         ((EQUAL OP 'PLUS) (PLUS A1 A2))
                         (T (APPLY2 OP A1 A2)))))
      (CONS (COND ((EQUAL A1 0) NIL) (T A1)) 1)))) 
(FLUID '(*NAT)) 
(PUT 'BCMINUS? 'NUMBER-OF-ARGS 1) 
(PUT 'BCMINUS? 'DEFINED-ON-LINE '55) 
(PUT 'BCMINUS? 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'BCMINUS? 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BCMINUS? (U) (AND (NULL *GRMOD*) (MINUSF (CAR U)))) 
(PUT 'BCZERO? 'NUMBER-OF-ARGS 1) 
(PUT 'BCZERO? 'DEFINED-ON-LINE '59) 
(PUT 'BCZERO? 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'BCZERO? 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BCZERO? (U) (COND (*GRMOD* (EQN U 0)) (T (NULL (CAR U))))) 
(PUT 'BCFD 'NUMBER-OF-ARGS 1) 
(PUT 'BCFD 'DEFINED-ON-LINE '64) 
(PUT 'BCFD 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'BCFD 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BCFD (A)
    (COND ((NULL *GRMOD*) (MKBC A 1)) ((FIXP A) (BCFI A))
          ((NOT (EQ (CAR A) '|:MOD:|))
           (REDERR (LIST "Invalid modular coefficient" A)))
          (T (BCFI (CDR A))))) 
(PUT 'BCFI 'NUMBER-OF-ARGS 1) 
(PUT 'BCFI 'DEFINED-ON-LINE '73) 
(PUT 'BCFI 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'BCFI 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BCFI (A)
    ((LAMBDA (U)
       (COND
        ((LESSP U 0)
         (COND
          ((AND *BALANCED_MOD (GREATERP (PLUS U U) (MINUS CURRENT-MODULUS))) U)
          (T (IPLUS2 U CURRENT-MODULUS))))
        ((AND *BALANCED_MOD (GREATERP (PLUS U U) CURRENT-MODULUS))
         (IDIFFERENCE U CURRENT-MODULUS))
        (T U)))
     (REMAINDER A CURRENT-MODULUS))) 
(PUT 'BCDOMAIN? 'NUMBER-OF-ARGS 1) 
(PUT 'BCDOMAIN? 'DEFINED-ON-LINE '82) 
(PUT 'BCDOMAIN? 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'BCDOMAIN? 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BCDOMAIN? (U)
    (OR *GRMOD*
        (AND (EQUAL (CDR U) 1) (OR (ATOM (CAR U)) (ATOM (CAR (CAR U))))))) 
(PUT 'BCLCMD 'NUMBER-OF-ARGS 2) 
(PUT 'BCLCMD 'DEFINED-ON-LINE '86) 
(PUT 'BCLCMD 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'BCLCMD 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE BCLCMD (U V)
    (COND ((BCZERO? U) (MKBC 1 (CDR V))) ((BCZERO? V) (MKBC 1 (CDR U)))
          (T
           (MKBC 1
            ((LAMBDA (G126)
               (COND (*PHYSOP-LOADED (PHYSOP-MULTF G126 (CDR V)))
                     (T (POLY-MULTF G126 (CDR V)))))
             (QUOTFX (CDR U) (GCDF (CDR U) (CDR V)))))))) 
(PUT 'BCLCMDPROD 'NUMBER-OF-ARGS 2) 
(PUT 'BCLCMDPROD 'DEFINED-ON-LINE '96) 
(PUT 'BCLCMDPROD 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'BCLCMDPROD 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE BCLCMDPROD (U V)
    (MKBC
     ((LAMBDA (G128)
        (COND (*PHYSOP-LOADED (PHYSOP-MULTF G128 (CAR V)))
              (T (POLY-MULTF G128 (CAR V)))))
      (QUOTFX (CDR U) (CDR V)))
     1)) 
(PUT 'BCONE? 'NUMBER-OF-ARGS 1) 
(PUT 'BCONE? 'DEFINED-ON-LINE '103) 
(PUT 'BCONE? 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'BCONE? 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BCONE? (U)
    (COND (*GRMOD* (EQN U 1)) (T (AND (EQUAL (CDR U) 1) (EQUAL (CAR U) 1))))) 
(PUT 'BCINV 'NUMBER-OF-ARGS 1) 
(PUT 'BCINV 'DEFINED-ON-LINE '109) 
(PUT 'BCINV 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'BCINV 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BCINV (U)
    (COND
     (*GRMOD*
      (COND
       (*BALANCED_MOD
        ((LAMBDA (V)
           (COND
            ((GREATERP (PLUS V V) CURRENT-MODULUS)
             (IDIFFERENCE V CURRENT-MODULUS))
            (T V)))
         (MODULAR-RECIPROCAL U)))
       (T (RECIPROCAL-BY-GCD CURRENT-MODULUS U 0 1))))
     (T (INVSQ U)))) 
(PUT 'BCNEG 'NUMBER-OF-ARGS 1) 
(PUT 'BCNEG 'DEFINED-ON-LINE '119) 
(PUT 'BCNEG 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'BCNEG 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BCNEG (U)
    (COND (*GRMOD* (COND ((EQN U 0) U) (T (IDIFFERENCE CURRENT-MODULUS U))))
          (T (NEGSQ U)))) 
(PUT 'BCPROD 'NUMBER-OF-ARGS 2) 
(PUT 'BCPROD 'DEFINED-ON-LINE '126) 
(PUT 'BCPROD 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'BCPROD 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE BCPROD (U V)
    (COND (*GRMOD* (BCFI (TIMES U V)))
          (T (OR (BCINT2OP U V 'TIMES) (BCCHECKZ (MULTSQ U V)))))) 
(PUT 'MKBC 'NUMBER-OF-ARGS 2) 
(PUT 'MKBC 'DEFINED-ON-LINE '132) 
(PUT 'MKBC 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'MKBC 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MKBC (U V)
    (PROGN
     (OR (NUMBERP U) (F2DIP11 U))
     (OR (NUMBERP V) (F2DIP11 V))
     (COND (*GRMOD* (BCFI (TIMES U (MODULAR-RECIPROCAL V))))
           ((EQUAL V 1) (COND ((EQUAL U 1) '(1 . 1)) (T (CONS U V))))
           ((MINUSF V) (MKBC (NEGF U) (NEGF V)))
           (T ((LAMBDA (M) (CONS (QUOTFX U M) (QUOTFX V M))) (GCDF U V)))))) 
(COND ((NULL (GETD 'QUOTIENTX)) (COPYD 'QUOTIENTX 'QUOTIENT))) 
(PUT 'BCQUOT 'NUMBER-OF-ARGS 2) 
(PUT 'BCQUOT 'DEFINED-ON-LINE '142) 
(PUT 'BCQUOT 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'BCQUOT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE BCQUOT (U V)
    (COND (*GRMOD* (BCFI (TIMES U (MODULAR-RECIPROCAL V))))
          (*VDPINTEGER
           (OR (BCINT2OP U V 'QUOTIENTX) (CONS (QUOTFX (CAR U) (CAR V)) 1)))
          (T (MULTSQ U (INVSQ V))))) 
(PUT 'BCSUM 'NUMBER-OF-ARGS 2) 
(PUT 'BCSUM 'DEFINED-ON-LINE '151) 
(PUT 'BCSUM 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'BCSUM 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE BCSUM (U V)
    (COND (*GRMOD* (BCFI (PLUS U V)))
          (T (OR (BCINT2OP U V 'PLUS2) (BCCHECKZ (ADDSQ U V)))))) 
(PUT 'BCCHECKZ 'NUMBER-OF-ARGS 1) 
(PUT 'BCCHECKZ 'DEFINED-ON-LINE '157) 
(PUT 'BCCHECKZ 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'BCCHECKZ 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BCCHECKZ (U)
    (COND ((NULL (CAR U)) U) (*BCSUBS2 (SUBS2 U))
          (T
           ((LAMBDA (L N D)
              (PROGN
               (PROG ()
                WHILELABEL
                 (COND ((NOT (AND L N)) (RETURN NIL)))
                 (PROGN (SETQ N (CDR (QREMF N (CAR L)))) (SETQ L (CDR L)))
                 (GO WHILELABEL))
               (CONS N D)))
            BCZERODIVL* (CAR U) (CDR U))))) 
(PUT 'BCDIF 'NUMBER-OF-ARGS 2) 
(PUT 'BCDIF 'DEFINED-ON-LINE '163) 
(PUT 'BCDIF 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'BCDIF 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE BCDIF (U V)
    (COND (*GRMOD* (BCFI (DIFFERENCE U V)))
          (T (OR (BCINT2OP U V 'DIFFERENCE) (BCSUM U (BCNEG V)))))) 
(PUT 'BCPOW 'NUMBER-OF-ARGS 2) 
(PUT 'BCPOW 'DEFINED-ON-LINE '169) 
(PUT 'BCPOW 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'BCPOW 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE BCPOW (U N) (COND (*GRMOD* (MODULAR-EXPT U N)) (T (EXPTSQ U N)))) 
(PUT 'A2BC 'NUMBER-OF-ARGS 1) 
(PUT 'A2BC 'DEFINED-ON-LINE '174) 
(PUT 'A2BC 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'A2BC 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE A2BC (U)
    (COND
     (*GRMOD*
      (COND
       ((NOT (OR (ATOM U) (ATOM (CAR U))))
        (REDERR (LIST " Invalid coefficient " U)))
       (T (BCFD U))))
     (T (SIMP* U)))) 
(PUT 'BC2A 'NUMBER-OF-ARGS 1) 
(PUT 'BC2A 'DEFINED-ON-LINE '181) 
(PUT 'BC2A 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'BC2A 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BC2A (U) (COND (*GRMOD* U) (T (PREPSQ U)))) 
(FLUID '(*GROEBIGPOS *GROEBIGNEG *GROESCALE)) 
(SETQ *GROESCALE 20) 
(SETQ *GROEBIGPOS (EXPT 10 *GROESCALE)) 
(SETQ *GROEBIGNEG (MINUS (EXPT 10 *GROESCALE))) 
(PUT 'BCPRIN 'NUMBER-OF-ARGS 1) 
(PUT 'BCPRIN 'DEFINED-ON-LINE '188) 
(PUT 'BCPRIN 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'BCPRIN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BCPRIN (U)
    (COND (*GRMOD* (PRIN2 U))
          (T
           (PROG (NAT)
             (SETQ NAT *NAT)
             (SETQ *NAT NIL)
             (COND
              ((AND (EQUAL (CDR U) 1) (NUMBERP (CAR U))
                    (OR (GREATERP (CAR U) *GROEBIGPOS)
                        (LESSP (CAR U) *GROEBIGNEG)))
               (BCPRIN2BIG (CAR U)))
              ((OR (NEQ (CDR U) 1) (NOT (NUMBERP (CAR U))))
               (PROGN (PRIN2* " [ ") (SQPRINT U) (PRIN2* " ] ")))
              (T (SQPRINT U)))
             (SETQ *NAT NAT))))) 
(PUT 'BCPRIN2BIG 'NUMBER-OF-ARGS 1) 
(PUT 'BCPRIN2BIG 'DEFINED-ON-LINE '201) 
(PUT 'BCPRIN2BIG 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'BCPRIN2BIG 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BCPRIN2BIG (U)
    (PROGN
     (COND ((LESSP U 0) (PROGN (PRIN2 "-") (SETQ U (MINUS U)))))
     (BCPRIN2BIG1 U 0))) 
(PUT 'BCPRIN2BIG1 'NUMBER-OF-ARGS 2) 
(PUT 'BCPRIN2BIG1 'DEFINED-ON-LINE '204) 
(PUT 'BCPRIN2BIG1 'DEFINED-IN-FILE 'DIPOLY/BCOEFF.RED) 
(PUT 'BCPRIN2BIG1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE BCPRIN2BIG1 (U N)
    (COND
     ((GREATERP U *GROEBIGPOS)
      (BCPRIN2BIG1 (QUOTIENT U *GROEBIGPOS) (IPLUS2 N *GROESCALE)))
     (T (PROGN (PRIN2 U) (PRIN2 "e") (PRIN2 N))))) 
(ENDMODULE) 