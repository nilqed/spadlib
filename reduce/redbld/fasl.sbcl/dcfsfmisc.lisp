(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'DCFSFMISC)) 
(REVISION 'DCFSFMISC
          "$Id: dcfsfmisc.red 5986 2021-08-28 13:35:27Z thomas-sturm $") 
(COPYRIGHT 'DCFSFMISC "Copyright (c) 2004-2009 A. Dolzmann and T. Sturm") 
(PUT 'DCFSF_TERMPRINT 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_TERMPRINT 'DEFINED-ON-LINE '33) 
(PUT 'DCFSF_TERMPRINT 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSFMISC.RED) 
(PUT 'DCFSF_TERMPRINT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_TERMPRINT (U)
    (PROGN ((LAMBDA (*NAT) (SQPRINT (CONS U 1))) NIL) (IOTO_PRIN2 NIL))) 
(PUT 'DCFSF_CLNEGREL 'NUMBER-OF-ARGS 2) 
(PUT 'DCFSF_CLNEGREL 'DEFINED-ON-LINE '41) 
(PUT 'DCFSF_CLNEGREL 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSFMISC.RED) 
(PUT 'DCFSF_CLNEGREL 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DCFSF_CLNEGREL (R FLG) (COND (FLG R) (T (DCFSF_LNEGREL R)))) 
(PUT 'DCFSF_LNEGREL 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_LNEGREL 'DEFINED-ON-LINE '49) 
(PUT 'DCFSF_LNEGREL 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSFMISC.RED) 
(PUT 'DCFSF_LNEGREL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_LNEGREL (R)
    (COND ((EQ R 'EQUAL) 'NEQ) ((EQ R 'NEQ) 'EQUAL)
          (T (REDERR (LIST "dcfsf_lnegrel: unknown operator " R))))) 
(PUT 'DCFSF_FCTRAT 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_FCTRAT 'DEFINED-ON-LINE '57) 
(PUT 'DCFSF_FCTRAT 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSFMISC.RED) 
(PUT 'DCFSF_FCTRAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_FCTRAT (ATF) (CDR (FCTRF (DCFSF_ARG2L ATF)))) 
(PUT 'DCFSF_NEGATEAT 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_NEGATEAT 'DEFINED-ON-LINE '65) 
(PUT 'DCFSF_NEGATEAT 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSFMISC.RED) 
(PUT 'DCFSF_NEGATEAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_NEGATEAT (F) (DCFSF_MKN (DCFSF_LNEGREL (DCFSF_OP F)) (DCFSF_ARGN F))) 
(PUT 'DCFSF_VARLAT 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_VARLAT 'DEFINED-ON-LINE '71) 
(PUT 'DCFSF_VARLAT 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSFMISC.RED) 
(PUT 'DCFSF_VARLAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_VARLAT (ATFORM) (DCFSF_VARLAT1 (KERNELS (DCFSF_ARG2L ATFORM)))) 
(PUT 'DCFSF_VARLAT1 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_VARLAT1 'DEFINED-ON-LINE '77) 
(PUT 'DCFSF_VARLAT1 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSFMISC.RED) 
(PUT 'DCFSF_VARLAT1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_VARLAT1 (KL)
    (PROG (K FORALL-RESULT FORALL-ENDPTR)
      (SETQ K KL)
     STARTOVER
      (COND ((NULL K) (RETURN NIL)))
      (SETQ FORALL-RESULT
              ((LAMBDA (K)
                 (COND ((AND (PAIRP K) (EQ (CAR K) 'D)) (LIST (CADR K)))
                       (T (LIST K))))
               (CAR K)))
      (SETQ FORALL-ENDPTR (LASTPAIR FORALL-RESULT))
      (SETQ K (CDR K))
      (COND ((ATOM FORALL-ENDPTR) (GO STARTOVER)))
     LOOPLABEL
      (COND ((NULL K) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR
              ((LAMBDA (K)
                 (COND ((AND (PAIRP K) (EQ (CAR K) 'D)) (LIST (CADR K)))
                       (T (LIST K))))
               (CAR K)))
      (SETQ FORALL-ENDPTR (LASTPAIR FORALL-ENDPTR))
      (SETQ K (CDR K))
      (GO LOOPLABEL))) 
(PUT 'DCFSF_VARSUBSTAT 'NUMBER-OF-ARGS 3) 
(PUT 'DCFSF_VARSUBSTAT 'DEFINED-ON-LINE '84) 
(PUT 'DCFSF_VARSUBSTAT 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSFMISC.RED) 
(PUT 'DCFSF_VARSUBSTAT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DCFSF_VARSUBSTAT (ATF NEW OLD)
    (DCFSF_0MK2 (DCFSF_OP ATF)
                (CAR (SUBF (DCFSF_ARG2L ATF) (LIST (CONS OLD NEW)))))) 
(PUT 'DCFSF_ORDATP 'NUMBER-OF-ARGS 2) 
(PUT 'DCFSF_ORDATP 'DEFINED-ON-LINE '90) 
(PUT 'DCFSF_ORDATP 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSFMISC.RED) 
(PUT 'DCFSF_ORDATP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DCFSF_ORDATP (A1 A2)
    (PROG (LHS1 LHS2)
      (SETQ LHS1 (DCFSF_ARG2L A1))
      (SETQ LHS2 (DCFSF_ARG2L A2))
      (COND ((NEQ LHS1 LHS2) (RETURN (ORDP LHS1 LHS2))))
      (RETURN (DCFSF_ORDRELP (DCFSF_OP A1) (DCFSF_OP A2))))) 
(PUT 'DCFSF_ORDRELP 'NUMBER-OF-ARGS 2) 
(PUT 'DCFSF_ORDRELP 'DEFINED-ON-LINE '103) 
(PUT 'DCFSF_ORDRELP 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSFMISC.RED) 
(PUT 'DCFSF_ORDRELP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DCFSF_ORDRELP (R1 R2) (OR (EQ R1 R2) (EQ R1 'EQUAL))) 
(PUT 'DCFSF_SUBALCHK 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_SUBALCHK 'DEFINED-ON-LINE '109) 
(PUT 'DCFSF_SUBALCHK 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSFMISC.RED) 
(PUT 'DCFSF_SUBALCHK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_SUBALCHK (AL)
    (PROG (X)
      (SETQ X AL)
     LAB
      (COND ((NULL X) (RETURN NIL)))
      ((LAMBDA (X)
         (COND
          ((NOT
            ((LAMBDA (U) (OR (ATOM U) (ATOM (CAR U)))) (CDR (SIMP (CDR X)))))
           (REDERR "parametric denominator in substituted term"))
          ((NOT (IDP (CAR X)))
           ((LAMBDA (*NAT) (TYPERR (LIST "expression " (CAR X)) "variable"))
            NIL))))
       (CAR X))
      (SETQ X (CDR X))
      (GO LAB))) 
(PUT 'DCFSF_EQNRHSKERNELS 'NUMBER-OF-ARGS 1) 
(PUT 'DCFSF_EQNRHSKERNELS 'DEFINED-ON-LINE '121) 
(PUT 'DCFSF_EQNRHSKERNELS 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSFMISC.RED) 
(PUT 'DCFSF_EQNRHSKERNELS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DCFSF_EQNRHSKERNELS (X)
    ((LAMBDA (W) (NCONC (KERNELS (CAR W)) (KERNELS (CDR W)))) (SIMP (CDR X)))) 
(PUT 'DCFSF_SUBAT 'NUMBER-OF-ARGS 2) 
(PUT 'DCFSF_SUBAT 'DEFINED-ON-LINE '127) 
(PUT 'DCFSF_SUBAT 'DEFINED-IN-FILE 'REDLOG/DCFSF/DCFSFMISC.RED) 
(PUT 'DCFSF_SUBAT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DCFSF_SUBAT (AL F)
    (PROG (NLHS)
      (SETQ NLHS (SUBF (DCFSF_ARG2L F) AL))
      (COND
       ((NOT (OR (ATOM (CDR NLHS)) (ATOM (CAR (CDR NLHS)))))
        (REDERR "parametric denominator after substitution")))
      (RETURN (DCFSF_0MK2 (ACFSF_OP F) (CAR NLHS))))) 
(ENDMODULE) 