(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'SYSTO)) 
(REVISION 'SYSTO "$Id: systo.red 5986 2021-08-28 13:35:27Z thomas-sturm $") 
(COPYRIGHT 'SYSTO "(c) 2017 T. Sturm") 
(FLAG '(MEMINFO) 'OPFN) 
(PUT 'MEMINFO 'NUMBER-OF-ARGS 0) 
(PUT 'MEMINFO 'DEFINED-ON-LINE '34) 
(PUT 'MEMINFO 'DEFINED-IN-FILE 'REDLOG/RLTOOLS/SYSTO.RED) 
(PUT 'MEMINFO 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE MEMINFO NIL (SYSTO_MEMINFO)) 
(PUT 'SYSTO_MEMINFO 'NUMBER-OF-ARGS 0) 
(PUT 'SYSTO_MEMINFO 'DEFINED-ON-LINE '129) 
(PUT 'SYSTO_MEMINFO 'DEFINED-IN-FILE 'REDLOG/RLTOOLS/SYSTO.RED) 
(PUT 'SYSTO_MEMINFO 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE SYSTO_MEMINFO NIL
    (COND ((BOUNDP 'LISPSYSTEM*) (PRETTYPRINT LISPSYSTEM*))
          (T (LPRIM "unknown Lisp")))) 
(PUT 'SYSTO_MEMINFOSCALE 'NUMBER-OF-ARGS 1) 
(PUT 'SYSTO_MEMINFOSCALE 'DEFINED-ON-LINE '137) 
(PUT 'SYSTO_MEMINFOSCALE 'DEFINED-IN-FILE 'REDLOG/RLTOOLS/SYSTO.RED) 
(PUT 'SYSTO_MEMINFOSCALE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SYSTO_MEMINFOSCALE (N)
    (COND ((GEQ N (EXPT 10 9)) (CONS (QUOTIENT (FLOAT N) (EXPT 10 9)) "GB"))
          ((GEQ N (EXPT 10 6)) (CONS (QUOTIENT (FLOAT N) (EXPT 10 6)) "MB"))
          ((GEQ N (EXPT 10 3)) (CONS (QUOTIENT (FLOAT N) (EXPT 10 3)) "kB"))
          (T (CONS N "B")))) 
(PUT 'SYSTO_MEMINFOISCALE 'NUMBER-OF-ARGS 1) 
(PUT 'SYSTO_MEMINFOISCALE 'DEFINED-ON-LINE '147) 
(PUT 'SYSTO_MEMINFOISCALE 'DEFINED-IN-FILE 'REDLOG/RLTOOLS/SYSTO.RED) 
(PUT 'SYSTO_MEMINFOISCALE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SYSTO_MEMINFOISCALE (N)
    (COND ((GEQ N (EXPT 2 30)) (CONS (QUOTIENT (FLOAT N) (EXPT 2 30)) "GiB"))
          ((GEQ N (EXPT 2 20)) (CONS (QUOTIENT (FLOAT N) (EXPT 2 20)) "MiB"))
          ((GEQ N (EXPT 2 10)) (CONS (QUOTIENT (FLOAT N) (EXPT 2 10)) "kiB"))
          (T (CONS N "B")))) 
(PUT 'SYSTO_MEMINFOCOMMA 'NUMBER-OF-ARGS 2) 
(PUT 'SYSTO_MEMINFOCOMMA 'DEFINED-ON-LINE '157) 
(PUT 'SYSTO_MEMINFOCOMMA 'DEFINED-IN-FILE 'REDLOG/RLTOOLS/SYSTO.RED) 
(PUT 'SYSTO_MEMINFOCOMMA 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SYSTO_MEMINFOCOMMA (N COMMA)
    (PROG (L C)
      (SETQ C 0)
      (SETQ L '(|"|))
      (PROG (D)
        (SETQ D (REVERSIP (EXPLODE N)))
       LAB
        (COND ((NULL D) (RETURN NIL)))
        (PROGN
         (SETQ L (CONS (CAR D) L))
         (SETQ C (PLUS C 1))
         (COND
          ((AND (CDR D) (EQN C 3))
           (PROGN (SETQ C 0) (SETQ L (CONS COMMA L))))))
        (SETQ D (CDR D))
        (GO LAB))
      (RETURN (COMPRESS (CONS '|"| L))))) 
(PUT 'SYSTO_DOTDOTX 'NUMBER-OF-ARGS 2) 
(PUT 'SYSTO_DOTDOTX 'DEFINED-ON-LINE '219) 
(PUT 'SYSTO_DOTDOTX 'DEFINED-IN-FILE 'REDLOG/RLTOOLS/SYSTO.RED) 
(PUT 'SYSTO_DOTDOTX 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SYSTO_DOTDOTX (S N)
    (COND ((EQN N 0) S) (T (SYSTO_DOTDOTX (SYSTO_DOTDOT S) (DIFFERENCE N 1))))) 
(PUT 'SYSTO_DOTDOT 'NUMBER-OF-ARGS 1) 
(PUT 'SYSTO_DOTDOT 'DEFINED-ON-LINE '225) 
(PUT 'SYSTO_DOTDOT 'DEFINED-IN-FILE 'REDLOG/RLTOOLS/SYSTO.RED) 
(PUT 'SYSTO_DOTDOT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SYSTO_DOTDOT (S)
    (PROG (W)
      (SETQ W (CDR (REVERSIP (EXPLODE S))))
      (COND ((EQCAR W '/) (SETQ W (CDR W))))
      (PROG ()
       REPEATLABEL
        (SETQ W (CDR W))
        (COND ((NOT (EQCAR W '/)) (GO REPEATLABEL))))
      (RETURN (COMPRESS (REVERSIP (CONS '|"| W)))))) 
(FLAG '(RNDSEED) 'OPFN) 
(PUT 'RNDSEED 'NUMBER-OF-ARGS 1) 
(PUT 'RNDSEED 'DEFINED-ON-LINE '235) 
(PUT 'RNDSEED 'DEFINED-IN-FILE 'REDLOG/RLTOOLS/SYSTO.RED) 
(PUT 'RNDSEED 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE RNDSEED (S) (SYSTO_RNDSEED S)) 
(PUT 'SYSTO_RNDSEED 'NUMBER-OF-ARGS 1) 
(PUT 'SYSTO_RNDSEED 'DEFINED-ON-LINE '238) 
(PUT 'SYSTO_RNDSEED 'DEFINED-IN-FILE 'REDLOG/RLTOOLS/SYSTO.RED) 
(PUT 'SYSTO_RNDSEED 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SYSTO_RNDSEED (S)
    (PROGN
     (COND ((MEMQ 'CSL LISPSYSTEM*) (SETQ S (TIMES 2 S))))
     (RANDOM_NEW_SEED S))) 
(ENDMODULE) 