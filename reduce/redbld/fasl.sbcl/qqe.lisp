(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'QQE)) 
(REVISION 'QQE "$Id: qqe.red 5986 2021-08-28 13:35:27Z thomas-sturm $") 
(COPYRIGHT 'QQE "(c) 2005-2009 A. Dolzmann and T. Sturm, 2017 T. Sturm") 
(CREATE-PACKAGE '(QQE QQETRANS QQEMISC QQESISM QQEQE QQESIAT QQEQEMISC) NIL) 
(LOAD-PACKAGE 'REDLOG) 
(EXPORTS (LIST 'QQE_CHSIMPAT)) 
(FLUID '(QQE_MARKED-IDS-ROLLBACK* QQE_QADD-LOCATION* QQE_ELIMB* QQE_DEBUG*)) 
(FLAG '(QQE) 'RL_PACKAGE) 
(PUT 'QQE 'RL_ENTER 'QQE_ENTER) 
(PUT 'QQE 'SIMPFNNAME 'RL_SIMPFN) 
(PUT 'QQE 'RL_LENGTHAT 'QQE_LENGTHAT) 
(PUT 'QQE 'RL_PREPTERM 'QQE_PREPTERM) 
(PUT 'QQE 'RL_SIMPTERM 'QQE_SIMPTERM) 
(MKOP 'QEQUAL) 
(INFIX (LIST 'QEQUAL)) 
(PUT 'QEQUAL 'RL_PREPFN 'QQE_PREPAT) 
(PUT 'QEQUAL 'RL_SIMPFN 'QQE_CHSIMPAT) 
(PUT 'QEQUAL 'NUMBER-OF-ARGS 2) 
(PUT 'QEQUAL 'RTYPEFN 'QUOTELOG) 
(PUT 'QEQUAL 'FANCY-PRIFN 'QQE_FANCY-PRIQEQUAL) 
(NEWTOK '((= =) QEQUAL)) 
(FLAG '(QEQUAL) 'SPACED) 
(MKOP 'QNEQ) 
(INFIX (LIST 'QNEQ)) 
(PUT 'QNEQ 'RL_PREPFN 'QQE_PREPAT) 
(PUT 'QNEQ 'RL_SIMPFN 'QQE_CHSIMPAT) 
(PUT 'QNEQ 'NUMBER-OF-ARGS 2) 
(PUT 'QNEQ 'RTYPEFN 'QUOTELOG) 
(PUT 'QNEQ 'FANCY-PRIFN 'QQE_FANCY-PRIQNEQ) 
(NEWTOK '((< < > >) QNEQ)) 
(FLAG '(QNEQ) 'SPACED) 
(AEVAL (OPERATOR (LIST 'QEPSILON))) 
(PUT 'QEPSILON 'NUMBER-OF-ARGS 0) 
(PUT 'QEPSILON 'IDTYPE 'QT) 
(AEVAL (OPERATOR (LIST 'LADD))) 
(PUT 'LADD 'QQE_NUMBER-OF-ARGS 2) 
(AEVAL (OPERATOR (LIST 'RADD))) 
(PUT 'LADD 'QQE_NUMBER-OF-ARGS 2) 
(AEVAL (OPERATOR (LIST 'LHEAD))) 
(PUT 'LADD 'QQE_NUMBER-OF-ARGS 1) 
(AEVAL (OPERATOR (LIST 'RHEAD))) 
(PUT 'LADD 'QQE_NUMBER-OF-ARGS 1) 
(AEVAL (OPERATOR (LIST 'RTAIL))) 
(PUT 'LADD 'QQE_NUMBER-OF-ARGS 1) 
(AEVAL (OPERATOR (LIST 'LTAIL))) 
(PUT 'LADD 'QQE_NUMBER-OF-ARGS 1) 
(FLAG '(QQE_CHSIMPAT) 'FULL) 
(PUT 'QQE_ENTER 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_ENTER 'DEFINED-ON-LINE '101) 
(PUT 'QQE_ENTER 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_ENTER 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_ENTER (ARGL)
    (PROG (W QQECID2)
      (COND ((NULL ARGL) (RETURN (CONS NIL "base type context missing"))))
      (SETQ QQE_ELIMB* NIL)
      (SETQ QQECID2
              (INTERN (COMPRESS (NCONC (EXPLODE 'QQE_) (EXPLODE (CAR ARGL))))))
      (SETQ W (QQE_LOAD-BASETYPE QQECID2 (CDR ARGL)))
      (COND (W (RETURN (CONS NIL W))))
      (QQE_PATCH-CTAG QQECID2 'QQE_PARAMS 'RL_PARAMS)
      (QQE_PATCH-CTAG QQECID2 'QQE_SERVICES 'RL_SERVICES)
      (QQE_PATCH-CTAG QQECID2 'QQE_CSWITCHES 'RL_CSWITCHES)
      (PUT 'QQE 'RL_RESIMPAT
           (INTERN (COMPRESS (NCONC (EXPLODE QQECID2) (EXPLODE '_RESIMPAT)))))
      (PUT 'QQE 'RL_PREPAT
           (INTERN (COMPRESS (NCONC (EXPLODE QQECID2) (EXPLODE '_PREPAT)))))
      (PUT 'QNEQ 'INFIX 32)
      (PUT 'QEQUAL 'INFIX 31)
      (RETURN (CONS T ARGL)))) 
(PUT 'QQE_LOAD-BASETYPE 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_LOAD-BASETYPE 'DEFINED-ON-LINE '129) 
(PUT 'QQE_LOAD-BASETYPE 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_LOAD-BASETYPE 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_LOAD-BASETYPE (QQECID2 ARGL)
    (PROG (W ENTER)
      ((LAMBDA (*MSG)
         (SETQ W
                 (ERRORSET (LIST 'LOAD-PACKAGE (MKQUOTE QQECID2)) NIL
                           *BACKTRACE)))
       NIL)
      (COND
       ((ERRORP W)
        (RETURN (LIST "switching to base type wrapper" QQECID2 "failed"))))
      (COND
       ((NOT (FLAGP QQECID2 'RL_PACKAGE))
        (RETURN (LIST QQECID2 "is not an rl package"))))
      (SETQ ENTER (GET QQECID2 'RL_ENTER))
      (COND
       ((AND (NULL ENTER) ARGL)
        (LPRIM (LIST "extra" (IOTO_CPLU "argument" (CDR ARGL)) "ignored"))))
      (COND
       (ENTER
        (PROGN
         (SETQ W (APPLY ENTER (LIST ARGL)))
         (COND ((NOT (CAR W)) (RETURN (CDR W))) (T (SETQ ARGL (CDR W)))))))
      (RETURN NIL))) 
(PUT 'QQE_PATCH-CTAG 'NUMBER-OF-ARGS 3) 
(PUT 'QQE_PATCH-CTAG 'DEFINED-ON-LINE '152) 
(PUT 'QQE_PATCH-CTAG 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_PATCH-CTAG 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE QQE_PATCH-CTAG (QQECID2 QQEAL RLAL)
    (PROG (W)
      (SETQ W (GET 'QQE QQEAL))
      (PROG (X)
        (SETQ X (GET QQECID2 RLAL))
       LAB
        (COND ((NULL X) (RETURN NIL)))
        ((LAMBDA (X) (COND ((NOT (ATSOC (CAR X) W)) (SETQ W (CONS X W)))))
         (CAR X))
        (SETQ X (CDR X))
        (GO LAB))
      (PUT 'QQE RLAL W))) 
(DE QQE_EXIT NIL NIL) 
(PUT 'QQE_EXIT 'NUMBER-OF-ARGS 0) 
(PUT 'QQE_EXIT 'DEFINED-ON-LINE '161) 
(PUT 'QQE_EXIT 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_EXIT 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(PUTC 'QQE_EXIT 'INLINE '(LAMBDA () NIL)) 
(DE QQE_LENGTHAT (F) 2) 
(PUT 'QQE_LENGTHAT 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_LENGTHAT 'DEFINED-ON-LINE '164) 
(PUT 'QQE_LENGTHAT 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_LENGTHAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_LENGTHAT 'INLINE '(LAMBDA (F) 2)) 
(DE QQE_PREPAT (F) F) 
(PUT 'QQE_PREPAT 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_PREPAT 'DEFINED-ON-LINE '167) 
(PUT 'QQE_PREPAT 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_PREPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_PREPAT 'INLINE '(LAMBDA (F) F)) 
(DE QQE_SIMPAT (F) F) 
(PUT 'QQE_SIMPAT 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_SIMPAT 'DEFINED-ON-LINE '170) 
(PUT 'QQE_SIMPAT 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_SIMPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_SIMPAT 'INLINE '(LAMBDA (F) F)) 
(DE QQE_PREPTERM (F) F) 
(PUT 'QQE_PREPTERM 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_PREPTERM 'DEFINED-ON-LINE '173) 
(PUT 'QQE_PREPTERM 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_PREPTERM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_PREPTERM 'INLINE '(LAMBDA (F) F)) 
(PUT 'QQE_CHSIMPAT 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_CHSIMPAT 'DEFINED-ON-LINE '176) 
(PUT 'QQE_CHSIMPAT 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_CHSIMPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_CHSIMPAT (F)
    (PROG ()
      (SETCAR (CDR F) (QQE_CHSIMPTERM (QQE_ARG2L F)))
      (SETCAR (CDDR F) (QQE_CHSIMPTERM (QQE_ARG2R F)))
      (QQE_ARG-CHECK F)
      (RETURN F))) 
(PUT 'QQE_CHSIMPTERM 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_CHSIMPTERM 'DEFINED-ON-LINE '184) 
(PUT 'QQE_CHSIMPTERM 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_CHSIMPTERM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_CHSIMPTERM (TERM)
    (PROG ()
      (COND ((ATOM TERM) TERM)
            ((EQ (QQE_OP TERM) 'EXPT) (SETQ TERM (QQE_CHSIMPTERM1 TERM)))
            ((MEMQ (QQE_OP TERM) '(LTAIL RTAIL))
             (SETCAR (CDR TERM) (QQE_CHSIMPTERM (CADR TERM))))
            ((MEMQ (QQE_OP TERM) '(LADD RADD))
             (SETCAR (CDDR TERM) (QQE_CHSIMPTERM (CADDR TERM))))
            ((MEMQ (QQE_OP TERM) '(LHEAD RHEAD))
             (SETCAR (CDR TERM) (QQE_CHSIMPTERM (CADR TERM)))))
      (RETURN TERM))) 
(PUT 'QQE_CHSIMPTERM1 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_CHSIMPTERM1 'DEFINED-ON-LINE '197) 
(PUT 'QQE_CHSIMPTERM1 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_CHSIMPTERM1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_CHSIMPTERM1 (TERM)
    (PROG (OP ARG)
      (SETQ OP (QQE_OP (QQE_ARG2L TERM)))
      (SETQ ARG (QQE_CHSIMPTERM (QQE_ARG2L TERM)))
      (PROG (J)
        (SETQ J 1)
       LAB
        (COND
         ((MINUSP (DIFFERENCE (DIFFERENCE (QQE_ARG2R TERM) 1) J))
          (RETURN NIL)))
        (PROGN (SETQ ARG (CONS OP (LIST ARG))) NIL)
        (SETQ J (PLUS2 J 1))
        (GO LAB))
      (RETURN ARG))) 
(DE QQE_OP (ATF) (CAR ATF)) 
(PUT 'QQE_OP 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_OP 'DEFINED-ON-LINE '207) 
(PUT 'QQE_OP 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_OP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_OP 'INLINE '(LAMBDA (ATF) (CAR ATF))) 
(DE QQE_LHS (ATF) (CADR ATF)) 
(PUT 'QQE_LHS 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_LHS 'DEFINED-ON-LINE '212) 
(PUT 'QQE_LHS 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_LHS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_LHS 'INLINE '(LAMBDA (ATF) (CADR ATF))) 
(DE QQE_RHS (ATF) (CADDR ATF)) 
(PUT 'QQE_RHS 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_RHS 'DEFINED-ON-LINE '215) 
(PUT 'QQE_RHS 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_RHS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_RHS 'INLINE '(LAMBDA (ATF) (CADDR ATF))) 
(DE QQE_ARG2L (ATF) (CADR ATF)) 
(PUT 'QQE_ARG2L 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_ARG2L 'DEFINED-ON-LINE '218) 
(PUT 'QQE_ARG2L 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_ARG2L 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_ARG2L 'INLINE '(LAMBDA (ATF) (CADR ATF))) 
(DE QQE_ARG2R (ATF) (CADDR ATF)) 
(PUT 'QQE_ARG2R 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_ARG2R 'DEFINED-ON-LINE '223) 
(PUT 'QQE_ARG2R 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_ARG2R 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_ARG2R 'INLINE '(LAMBDA (ATF) (CADDR ATF))) 
(DE QQE_ARGN (ATF) (LIST (CADR ATF) (CADDR ATF))) 
(PUT 'QQE_ARGN 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_ARGN 'DEFINED-ON-LINE '228) 
(PUT 'QQE_ARGN 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_ARGN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_ARGN 'INLINE '(LAMBDA (ATF) (LIST (CADR ATF) (CADDR ATF)))) 
(DE QQE_MK2 (OP LHS RHS) (LIST OP LHS RHS)) 
(PUT 'QQE_MK2 'NUMBER-OF-ARGS 3) 
(PUT 'QQE_MK2 'DEFINED-ON-LINE '233) 
(PUT 'QQE_MK2 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_MK2 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(PUTC 'QQE_MK2 'INLINE '(LAMBDA (OP LHS RHS) (LIST OP LHS RHS))) 
(DE QQE_0MK2 (OP LHS) (LIST OP LHS NIL)) 
(PUT 'QQE_0MK2 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_0MK2 'DEFINED-ON-LINE '239) 
(PUT 'QQE_0MK2 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_0MK2 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(PUTC 'QQE_0MK2 'INLINE '(LAMBDA (OP LHS) (LIST OP LHS NIL))) 
(DE QQE_MKN (OP ARGL) (LIST OP (CAR ARGL) (CADR ARGL))) 
(PUT 'QQE_MKN 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_MKN 'DEFINED-ON-LINE '245) 
(PUT 'QQE_MKN 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_MKN 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(PUTC 'QQE_MKN 'INLINE '(LAMBDA (OP ARGL) (LIST OP (CAR ARGL) (CADR ARGL)))) 
(DE QQE_RQOPP (OP) (MEMQ OP '(QEQUAL QNEQ))) 
(PUT 'QQE_RQOPP 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_RQOPP 'DEFINED-ON-LINE '265) 
(PUT 'QQE_RQOPP 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_RQOPP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_RQOPP 'INLINE '(LAMBDA (OP) (MEMQ OP '(QEQUAL QNEQ)))) 
(DE QQE_RBOPP (OP) (MEMQ OP '(EQUAL NEQ LESSP LEQ GEQ GREATERP))) 
(PUT 'QQE_RBOPP 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_RBOPP 'DEFINED-ON-LINE '274) 
(PUT 'QQE_RBOPP 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_RBOPP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_RBOPP 'INLINE
      '(LAMBDA (OP) (MEMQ OP '(EQUAL NEQ LESSP LEQ GEQ GREATERP)))) 
(DE QQE_ROPP (OP)
    (OR (MEMQ OP '(QEQUAL QNEQ)) (MEMQ OP '(EQUAL NEQ LESSP LEQ GEQ GREATERP)))) 
(PUT 'QQE_ROPP 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_ROPP 'DEFINED-ON-LINE '285) 
(PUT 'QQE_ROPP 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_ROPP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_ROPP 'INLINE
      '(LAMBDA (OP)
         (OR (MEMQ OP '(QEQUAL QNEQ))
             (MEMQ OP '(EQUAL NEQ LESSP LEQ GEQ GREATERP))))) 
(DE QQE_QOPP (OP) (MEMQ OP '(RADD LADD LHEAD RHEAD LTAIL RTAIL))) 
(PUT 'QQE_QOPP 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_QOPP 'DEFINED-ON-LINE '290) 
(PUT 'QQE_QOPP 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_QOPP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_QOPP 'INLINE
      '(LAMBDA (OP) (MEMQ OP '(RADD LADD LHEAD RHEAD LTAIL RTAIL)))) 
(DE QQE_QOPHEADP (OP) (MEMQ OP '(LHEAD RHEAD))) 
(PUT 'QQE_QOPHEADP 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_QOPHEADP 'DEFINED-ON-LINE '295) 
(PUT 'QQE_QOPHEADP 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_QOPHEADP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_QOPHEADP 'INLINE '(LAMBDA (OP) (MEMQ OP '(LHEAD RHEAD)))) 
(PUT 'QQE_ARG-CHECK 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_ARG-CHECK 'DEFINED-ON-LINE '300) 
(PUT 'QQE_ARG-CHECK 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_ARG-CHECK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_ARG-CHECK (U)
    ((LAMBDA (OP)
       (PROGN
        (COND ((MEMQ OP '(QEQUAL QNEQ)) (QQE_ARG-CHECK-LQ-RQ U))
              ((MEMQ OP '(EQUAL NEQ LESSP LEQ GEQ GREATERP))
               (QQE_ARG-CHECK-LB-RB U))
              ((OR (MEMQ OP '(LHEAD RHEAD)) (QQE_QOPTAILP OP))
               (PROGN
                (COND
                 ((NOT (QQE_ARG-CHECK-Q (CADR U)))
                  (PROGN
                   (QQE_ARG-CHECK-MARKED-IDS-ROLLBACK)
                   (TYPERR U "some arguments are not of queue type")
                   NIL)))
                NIL))
              ((QQE_QOPADDP OP) (QQE_ARG-CHECK-LB-RQ U))
              (T
               (PROG (X)
                 (SETQ X (CDR U))
                LAB
                 (COND ((NULL X) (RETURN NIL)))
                 ((LAMBDA (X)
                    (COND
                     ((NOT (QQE_ARG-CHECK-B X))
                      (PROGN
                       (QQE_ARG-CHECK-MARKED-IDS-ROLLBACK)
                       (TYPERR U "some arguments are not of basic type")
                       NIL))))
                  (CAR X))
                 (SETQ X (CDR X))
                 (GO LAB))))
        NIL))
     (CAR U))) 
(PUT 'QQE_ARG-CHECK-LB-RQ 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_ARG-CHECK-LB-RQ 'DEFINED-ON-LINE '342) 
(PUT 'QQE_ARG-CHECK-LB-RQ 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_ARG-CHECK-LB-RQ 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_ARG-CHECK-LB-RQ (U)
    (PROG (LHS RHS)
      (SETQ LHS (CADR U))
      (SETQ RHS (CADDR U))
      (COND
       ((NOT (QQE_ARG-CHECK-Q RHS))
        (PROGN
         (QQE_ARG-CHECK-MARKED-IDS-ROLLBACK)
         (TYPERR U "type conflict: arguments don't fit
            binary op with lhs basic type and rhs queue type")
         NIL)))
      (COND
       ((NOT (QQE_ARG-CHECK-B LHS))
        (PROGN
         (QQE_ARG-CHECK-MARKED-IDS-ROLLBACK)
         (TYPERR U "type conflict: arguments don't fit
            binary op with lhs basic type and rhs queue type")
         NIL))))) 
(PUT 'QQE_ARG-CHECK-LQ-RQ 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_ARG-CHECK-LQ-RQ 'DEFINED-ON-LINE '367) 
(PUT 'QQE_ARG-CHECK-LQ-RQ 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_ARG-CHECK-LQ-RQ 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_ARG-CHECK-LQ-RQ (U)
    (PROG (LHS RHS)
      (SETQ LHS (CADR U))
      (SETQ RHS (CADDR U))
      (COND
       ((NOT (QQE_ARG-CHECK-Q LHS))
        (PROGN
         (QQE_ARG-CHECK-MARKED-IDS-ROLLBACK)
         (TYPERR U "type conflict: arguments don't fit
             binary op with queue type args")
         NIL)))
      (COND
       ((NOT (QQE_ARG-CHECK-Q RHS))
        (PROGN
         (QQE_ARG-CHECK-MARKED-IDS-ROLLBACK)
         (TYPERR U "type conflict: arguments don't fit
             binary op with queue type args")
         NIL))))) 
(PUT 'QQE_ARG-CHECK-Q 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_ARG-CHECK-Q 'DEFINED-ON-LINE '391) 
(PUT 'QQE_ARG-CHECK-Q 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_ARG-CHECK-Q 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_ARG-CHECK-Q (U)
    (PROG ()
      (COND ((NOT (QQE_ID-NYT-BRANCHQ U)) (RETURN NIL))
            ((AND (ATOM U) (NOT (NUMBERP U)))
             (PROGN
              (COND ((QQE_BTIDP U) (RETURN NIL))
                    ((QQE_NYTIDP U)
                     (PROGN
                      (QQE_QTID U)
                      (QQE_ADD2ROLLBACKIDS U)
                      (RETURN T)
                      NIL))
                    (T (RETURN T)))
              NIL))
            ((NOT (NUMBERP U)) (PROGN (QQE_ARG-CHECK U) (RETURN T) NIL))))) 
(PUT 'QQE_ARG-CHECK-B 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_ARG-CHECK-B 'DEFINED-ON-LINE '416) 
(PUT 'QQE_ARG-CHECK-B 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_ARG-CHECK-B 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_ARG-CHECK-B (U)
    (PROG ()
      (COND ((NOT (QQE_ID-NYT-BRANCHB U)) (RETURN NIL))
            ((AND (ATOM U) (NOT (NUMBERP U)))
             (PROGN
              (COND ((QQE_QTIDP U) (RETURN NIL))
                    ((QQE_NYTIDP U)
                     (PROGN
                      (QQE_BTID U)
                      (QQE_ADD2ROLLBACKIDS U)
                      (RETURN T)
                      NIL))
                    (T (RETURN T)))
              NIL))
            ((NOT (ATOM U)) (PROGN (QQE_ARG-CHECK U) (RETURN T) NIL))
            (T (RETURN T))))) 
(PUT 'QQE_ARG-CHECK-LB-RB 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_ARG-CHECK-LB-RB 'DEFINED-ON-LINE '442) 
(PUT 'QQE_ARG-CHECK-LB-RB 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_ARG-CHECK-LB-RB 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_ARG-CHECK-LB-RB (U)
    (PROG (LHS RHS)
      (SETQ LHS (CADR U))
      (SETQ RHS (CADDR U))
      (COND
       ((NOT (QQE_ARG-CHECK-B LHS))
        (PROGN
         (QQE_ARG-CHECK-MARKED-IDS-ROLLBACK)
         (TYPERR U "type conflict: arguments don't fit
             binary op with basic type args")
         NIL)))
      (COND
       ((NOT (QQE_ARG-CHECK-B RHS))
        (PROGN
         (QQE_ARG-CHECK-MARKED-IDS-ROLLBACK)
         (TYPERR U "type conflict: arguments don't fit
             binary op with basic type args")
         NIL))))) 
(DE QQE_QOPTAILP (OP) (COND ((MEMQ OP '(RTAIL LTAIL)) T))) 
(PUT 'QQE_QOPTAILP 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_QOPTAILP 'DEFINED-ON-LINE '466) 
(PUT 'QQE_QOPTAILP 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_QOPTAILP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_QOPTAILP 'INLINE '(LAMBDA (OP) (COND ((MEMQ OP '(RTAIL LTAIL)) T)))) 
(DE QQE_QOPADDP (OP) (COND ((MEMQ OP '(LADD RADD)) T))) 
(PUT 'QQE_QOPADDP 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_QOPADDP 'DEFINED-ON-LINE '471) 
(PUT 'QQE_QOPADDP 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_QOPADDP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_QOPADDP 'INLINE '(LAMBDA (OP) (COND ((MEMQ OP '(LADD RADD)) T)))) 
(PUT 'QQE_ID-NYT-BRANCHQ 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_ID-NYT-BRANCHQ 'DEFINED-ON-LINE '476) 
(PUT 'QQE_ID-NYT-BRANCHQ 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_ID-NYT-BRANCHQ 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_ID-NYT-BRANCHQ (U)
    (COND ((ATOM U) (OR (QQE_QTIDP U) (QQE_NYTIDP U)))
          (T
           (OR (COND ((MEMQ (CAR U) '(LADD RADD)) T))
               (COND ((MEMQ (CAR U) '(RTAIL LTAIL)) T)))))) 
(PUT 'QQE_ID-NYT-BRANCHB 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_ID-NYT-BRANCHB 'DEFINED-ON-LINE '483) 
(PUT 'QQE_ID-NYT-BRANCHB 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_ID-NYT-BRANCHB 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_ID-NYT-BRANCHB (U)
    (COND ((ATOM U) (OR (QQE_BTIDP U) (QQE_NYTIDP U)))
          (T
           (NOT
            (OR (COND ((MEMQ (CAR U) '(LADD RADD)) T))
                (COND ((MEMQ (CAR U) '(RTAIL LTAIL)) T))))))) 
(DE QQE_BTID (U) (PUT U 'IDTYPE 'BT)) 
(PUT 'QQE_BTID 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_BTID 'DEFINED-ON-LINE '490) 
(PUT 'QQE_BTID 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_BTID 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_BTID 'INLINE '(LAMBDA (U) (PUT U 'IDTYPE 'BT))) 
(DE QQE_QTID (U) (PUT U 'IDTYPE 'QT)) 
(PUT 'QQE_QTID 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_QTID 'DEFINED-ON-LINE '498) 
(PUT 'QQE_QTID 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_QTID 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_QTID 'INLINE '(LAMBDA (U) (PUT U 'IDTYPE 'QT))) 
(DE QQE_NILTID (U) (PUT U 'IDTYPE NIL)) 
(PUT 'QQE_NILTID 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_NILTID 'DEFINED-ON-LINE '506) 
(PUT 'QQE_NILTID 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_NILTID 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_NILTID 'INLINE '(LAMBDA (U) (PUT U 'IDTYPE NIL))) 
(DE QQE_BTIDP (U) (EQUAL (GET U 'IDTYPE) 'BT)) 
(PUT 'QQE_BTIDP 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_BTIDP 'DEFINED-ON-LINE '512) 
(PUT 'QQE_BTIDP 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_BTIDP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_BTIDP 'INLINE '(LAMBDA (U) (EQUAL (GET U 'IDTYPE) 'BT))) 
(DE QQE_QTIDP (U) (EQUAL (GET U 'IDTYPE) 'QT)) 
(PUT 'QQE_QTIDP 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_QTIDP 'DEFINED-ON-LINE '517) 
(PUT 'QQE_QTIDP 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_QTIDP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_QTIDP 'INLINE '(LAMBDA (U) (EQUAL (GET U 'IDTYPE) 'QT))) 
(DE QQE_NYTIDP (U) (EQUAL (GET U 'IDTYPE) NIL)) 
(PUT 'QQE_NYTIDP 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_NYTIDP 'DEFINED-ON-LINE '522) 
(PUT 'QQE_NYTIDP 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_NYTIDP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'QQE_NYTIDP 'INLINE '(LAMBDA (U) (EQUAL (GET U 'IDTYPE) NIL))) 
(PUT 'QQE_FANCY-PRIQEQUAL 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_FANCY-PRIQEQUAL 'DEFINED-ON-LINE '527) 
(PUT 'QQE_FANCY-PRIQEQUAL 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_FANCY-PRIQEQUAL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_FANCY-PRIQEQUAL (L)
    (COND ((RL_TEXMACSP) (QQE_FANCY-PRIQEQUAL-TEXMACS L)))) 
(PUT 'QQE_FANCY-PRIQEQUAL-TEXMACS 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_FANCY-PRIQEQUAL-TEXMACS 'DEFINED-ON-LINE '533) 
(PUT 'QQE_FANCY-PRIQEQUAL-TEXMACS 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_FANCY-PRIQEQUAL-TEXMACS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_FANCY-PRIQEQUAL-TEXMACS (L)
    (COND ((NULL *NAT) 'FAILED)
          (T
           (PROGN
            (MAPRIN (CADR L))
            (FANCY-PRIN2 "\\leftrightharpoons")
            (FANCY-PRIN2 " ")
            (MAPRIN (CADDR L))
            NIL)))) 
(PUT 'QQE_FANCY-PRIQNEQ 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_FANCY-PRIQNEQ 'DEFINED-ON-LINE '548) 
(PUT 'QQE_FANCY-PRIQNEQ 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_FANCY-PRIQNEQ 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_FANCY-PRIQNEQ (L) (COND ((RL_TEXMACSP) (QQE_FANCY-PRIQNEQ-TEXMACS L)))) 
(PUT 'QQE_FANCY-PRIQNEQ-TEXMACS 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_FANCY-PRIQNEQ-TEXMACS 'DEFINED-ON-LINE '554) 
(PUT 'QQE_FANCY-PRIQNEQ-TEXMACS 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_FANCY-PRIQNEQ-TEXMACS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_FANCY-PRIQNEQ-TEXMACS (L)
    (COND ((NULL *NAT) 'FAILED)
          (T
           (PROGN
            (MAPRIN (CADR L))
            (FANCY-PRIN2 "\\ll\\gg")
            (FANCY-PRIN2-UNDERSCORE)
            (FANCY-PRIN2 " ")
            (MAPRIN (CADDR L))
            NIL)))) 
(PUT 'QQE_ARG-CHECK-MARKED-IDS-ROLLBACK 'NUMBER-OF-ARGS 0) 
(PUT 'QQE_ARG-CHECK-MARKED-IDS-ROLLBACK 'DEFINED-ON-LINE '566) 
(PUT 'QQE_ARG-CHECK-MARKED-IDS-ROLLBACK 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_ARG-CHECK-MARKED-IDS-ROLLBACK 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE QQE_ARG-CHECK-MARKED-IDS-ROLLBACK NIL
    (PROG ()
     WHILELABEL
      (COND ((NOT (NEQ QQE_MARKED-IDS-ROLLBACK* NIL)) (RETURN NIL)))
      (PROGN
       (PUT (CAR QQE_MARKED-IDS-ROLLBACK*) 'IDTYPE NIL)
       (SETQ QQE_MARKED-IDS-ROLLBACK* (CDR QQE_MARKED-IDS-ROLLBACK*))
       NIL)
      (GO WHILELABEL))) 
(PUT 'QQE_ADD2ROLLBACKIDS 'NUMBER-OF-ARGS 1) 
(PUT 'QQE_ADD2ROLLBACKIDS 'DEFINED-ON-LINE '580) 
(PUT 'QQE_ADD2ROLLBACKIDS 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_ADD2ROLLBACKIDS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QQE_ADD2ROLLBACKIDS (U)
    (SETQ QQE_MARKED-IDS-ROLLBACK* (CONS U QQE_MARKED-IDS-ROLLBACK*))) 
(PUT 'QQE_ITERATE-LTAIL 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_ITERATE-LTAIL 'DEFINED-ON-LINE '586) 
(PUT 'QQE_ITERATE-LTAIL 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_ITERATE-LTAIL 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_ITERATE-LTAIL (J ARG)
    (PROG (TERM)
      (SETQ TERM ARG)
      (PROG (JJ)
        (SETQ JJ 1)
       LAB
        (COND ((MINUSP (DIFFERENCE J JJ)) (RETURN NIL)))
        (PROGN (SETQ TERM (LIST 'LTAIL TERM)) NIL)
        (SETQ JJ (PLUS2 JJ 1))
        (GO LAB))
      (RETURN TERM))) 
(PUT 'QQE_ITERATE-RTAIL 'NUMBER-OF-ARGS 2) 
(PUT 'QQE_ITERATE-RTAIL 'DEFINED-ON-LINE '599) 
(PUT 'QQE_ITERATE-RTAIL 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_ITERATE-RTAIL 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QQE_ITERATE-RTAIL (J ARG)
    (PROG (TERM)
      (SETQ TERM ARG)
      (PROG (JJ)
        (SETQ JJ 1)
       LAB
        (COND ((MINUSP (DIFFERENCE J JJ)) (RETURN NIL)))
        (PROGN (SETQ TERM (LIST 'RTAIL TERM)) NIL)
        (SETQ JJ (PLUS2 JJ 1))
        (GO LAB))
      (RETURN TERM))) 
(PUT 'QQE_ITERATE-RADD 'NUMBER-OF-ARGS 3) 
(PUT 'QQE_ITERATE-RADD 'DEFINED-ON-LINE '612) 
(PUT 'QQE_ITERATE-RADD 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_ITERATE-RADD 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE QQE_ITERATE-RADD (J ARG LIST)
    (PROG (TERM L)
      (SETQ TERM ARG)
      (SETQ L LIST)
      (PROG (JJ)
        (SETQ JJ 1)
       LAB
        (COND ((MINUSP (DIFFERENCE J JJ)) (RETURN NIL)))
        (PROGN (SETQ TERM (LIST 'RADD (CAR L) TERM)) (SETQ L (CDR L)) NIL)
        (SETQ JJ (PLUS2 JJ 1))
        (GO LAB))
      (RETURN TERM))) 
(PUT 'QQE_ITERATE-LADD 'NUMBER-OF-ARGS 3) 
(PUT 'QQE_ITERATE-LADD 'DEFINED-ON-LINE '630) 
(PUT 'QQE_ITERATE-LADD 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_ITERATE-LADD 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE QQE_ITERATE-LADD (J ARG LIST)
    (PROG (TERM L)
      (SETQ TERM ARG)
      (SETQ L LIST)
      (PROG (JJ)
        (SETQ JJ 1)
       LAB
        (COND ((MINUSP (DIFFERENCE J JJ)) (RETURN NIL)))
        (PROGN (SETQ TERM (LIST 'LADD (CAR L) TERM)) (SETQ L (CDR L)) NIL)
        (SETQ JJ (PLUS2 JJ 1))
        (GO LAB))
      (RETURN TERM))) 
(PUT 'QQE_VARSUBSTAT 'NUMBER-OF-ARGS 3) 
(PUT 'QQE_VARSUBSTAT 'DEFINED-ON-LINE '648) 
(PUT 'QQE_VARSUBSTAT 'DEFINED-IN-FILE 'REDLOG/QQE/QQE.RED) 
(PUT 'QQE_VARSUBSTAT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE QQE_VARSUBSTAT (ATF NEW OLD)
    (LIST (CAR ATF) (SUBST NEW OLD (CADR ATF)) (SUBST NEW OLD (CADDR ATF)))) 
(ENDMODULE) 