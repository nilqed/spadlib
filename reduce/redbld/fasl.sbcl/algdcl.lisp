(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'ALGDCL)) 
(GLOBAL '(PRECLIS* WS)) 
(PUT 'FORMOPR 'NUMBER-OF-ARGS 3) 
(PUT 'FORMOPR 'DEFINED-ON-LINE '34) 
(PUT 'FORMOPR 'DEFINED-IN-FILE 'ALG/ALGDCL.RED) 
(PUT 'FORMOPR 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMOPR (U VARS MODE)
    (COND ((EQ MODE 'SYMBOLIC) (LIST 'FLAG (MKQUOTE (CDR U)) (MKQUOTE 'OPFN)))
          (T (LIST 'OPERATOR (MKARG (CDR U) VARS))))) 
(PUT 'OPERATOR 'FORMFN 'FORMOPR) 
(PUT 'OPERATOR 'NUMBER-OF-ARGS 1) 
(PUT 'OPERATOR 'DEFINED-ON-LINE '41) 
(PUT 'OPERATOR 'DEFINED-IN-FILE 'ALG/ALGDCL.RED) 
(PUT 'OPERATOR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OPERATOR (U)
    (PROG (J)
      (SETQ J U)
     LAB
      (COND ((NULL J) (RETURN NIL)))
      ((LAMBDA (J) (MKOP J)) (CAR J))
      (SETQ J (CDR J))
      (GO LAB))) 
(RLISTAT '(OPERATOR)) 
(PUT 'REMOPR 'NUMBER-OF-ARGS 1) 
(PUT 'REMOPR 'DEFINED-ON-LINE '45) 
(PUT 'REMOPR 'DEFINED-IN-FILE 'ALG/ALGDCL.RED) 
(PUT 'REMOPR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE REMOPR (U)
    (PROG ()
      (REMPROP U 'ALT)
      (REMPROP U 'INFIX)
      (REMPROP U 'OP)
      (REMPROP U 'PRTCH)
      (REMPROP U 'SIMPFN)
      (REMPROP U 'UNARY)
      (REMFLAG (LIST U) 'LINEAR)
      (REMFLAG (LIST U) 'NARY)
      (REMFLAG (LIST U) 'OPFN)
      (REMFLAG (LIST U) 'ANTISYMMETRIC)
      (REMFLAG (LIST U) 'SYMMETRIC)
      (REMFLAG (LIST U) 'RIGHT)
      (SETQ PRECLIS* (DELETE U PRECLIS*)))) 
(FLAG '(REMOPR) 'EVAL) 
(PUT 'DEN 'NUMBER-OF-ARGS 1) 
(PUT 'DEN 'DEFINED-ON-LINE '65) 
(PUT 'DEN 'DEFINED-IN-FILE 'ALG/ALGDCL.RED) 
(PUT 'DEN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DEN (U) (MK*SQ (CONS (CDR (SIMP* U)) 1))) 
(PUT 'NUM 'NUMBER-OF-ARGS 1) 
(PUT 'NUM 'DEFINED-ON-LINE '68) 
(PUT 'NUM 'DEFINED-IN-FILE 'ALG/ALGDCL.RED) 
(PUT 'NUM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE NUM (U) (MK*SQ (CONS (CAR (SIMP* U)) 1))) 
(FLAG '(DEN NUM) 'OPFN) 
(FLAG '(DEN NUM) 'NOVAL) 
(PUT 'SAVEAS 'FORMFN 'FORMSAVEAS) 
(PUT 'FORMSAVEAS 'NUMBER-OF-ARGS 3) 
(PUT 'FORMSAVEAS 'DEFINED-ON-LINE '77) 
(PUT 'FORMSAVEAS 'DEFINED-IN-FILE 'ALG/ALGDCL.RED) 
(PUT 'FORMSAVEAS 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMSAVEAS (U VARS MODE) (LIST 'SAVEAS (FORMCLEAR1 (CDR U) VARS MODE))) 
(PUT 'SAVEAS 'NUMBER-OF-ARGS 1) 
(PUT 'SAVEAS 'DEFINED-ON-LINE '80) 
(PUT 'SAVEAS 'DEFINED-IN-FILE 'ALG/ALGDCL.RED) 
(PUT 'SAVEAS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SAVEAS (U)
    (LET00
     (LIST
      (LIST (COND ((SMEMQ '~ (CAR U)) 'REPLACEBY) (T 'EQUAL)) (CAR U)
            (COND
             ((AND (EQCAR WS '*SQ)
                   (SMEMQL
                    (PROG (X FORALL-RESULT FORALL-ENDPTR)
                      (SETQ X FRASC*)
                      (COND ((NULL X) (RETURN NIL)))
                      (SETQ FORALL-RESULT
                              (SETQ FORALL-ENDPTR
                                      (CONS ((LAMBDA (X) (CAR X)) (CAR X))
                                            NIL)))
                     LOOPLABEL
                      (SETQ X (CDR X))
                      (COND ((NULL X) (RETURN FORALL-RESULT)))
                      (RPLACD FORALL-ENDPTR
                              (CONS ((LAMBDA (X) (CAR X)) (CAR X)) NIL))
                      (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                      (GO LOOPLABEL))
                    (CADR WS)))
              (LIST '*SQ (CADR WS) NIL))
             (T WS)))))) 
(RLISTAT '(SAVEAS)) 
(ENDMODULE) 