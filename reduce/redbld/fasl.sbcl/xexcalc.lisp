(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'XEXCALC)) 
(GLOBAL '(DIMEX*)) 
(PUT 'ADDPF 'NUMBER-OF-ARGS 2) 
(PUT 'ADDPF 'DEFINED-ON-LINE '49) 
(PUT 'ADDPF 'DEFINED-IN-FILE 'XIDEAL/XEXCALC.RED) 
(PUT 'ADDPF 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE ADDPF (U V)
    (COND ((NULL U) V) ((NULL V) U) ((EQUAL (CAAR U) 1) (ADDMPF U V))
          ((EQUAL (CAAR V) 1) (ADDMPF V U))
          ((EQUAL (CAAR U) (CAAR V))
           ((LAMBDA (X Y)
              (COND ((NULL (CAR X)) Y) (T (CONS (CONS (CAAR U) X) Y))))
            (ADDSQ (CDAR U) (CDAR V)) (ADDPF (CDR U) (CDR V))))
          ((TERMORDP! (CAAR U) (CAAR V)) (CONS (CAR U) (ADDPF (CDR U) V)))
          (T (CONS (CAR V) (ADDPF U (CDR V)))))) 
(PUT 'TERMORDP! 'NUMBER-OF-ARGS 2) 
(PUT 'TERMORDP! 'DEFINED-ON-LINE '63) 
(PUT 'TERMORDP! 'DEFINED-IN-FILE 'XIDEAL/XEXCALC.RED) 
(PUT 'TERMORDP! 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE TERMORDP! (U V) (AND (NEQ U V) (TERMORDP (GUESSPFTYPE U) (GUESSPFTYPE V)))) 
(PUT 'GUESSPFTYPE 'NUMBER-OF-ARGS 1) 
(PUT 'GUESSPFTYPE 'DEFINED-ON-LINE '70) 
(PUT 'GUESSPFTYPE 'DEFINED-IN-FILE 'XIDEAL/XEXCALC.RED) 
(PUT 'GUESSPFTYPE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE GUESSPFTYPE (U)
    (COND ((ATOM U) U)
          ((MEMQ (CAR U) '(WEDGE D PARTDF HODGE INNERPROD LIEDF)) U)
          ((AND (ASSOC (LENGTH (CDR U)) (GET (CAR U) 'IFDEGREE))
                (NOT (XVARLISTP (CDR U))))
           U)
          (T (MKNWEDGE U)))) 
(PUT 'XVARLISTP 'NUMBER-OF-ARGS 1) 
(PUT 'XVARLISTP 'DEFINED-ON-LINE '81) 
(PUT 'XVARLISTP 'DEFINED-IN-FILE 'XIDEAL/XEXCALC.RED) 
(PUT 'XVARLISTP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE XVARLISTP (X) (OR (NULL X) (AND (XVARP (CAR X)) (XVARLISTP (CDR X))))) 
(ENDMODULE) 