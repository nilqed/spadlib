(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'LPRI)) 
(FLUID '(*DEFN *ECHO *FORT *INT *MSG *NAT *PROTFG ERRMSG* CURLINE*)) 
(GLOBAL '(CURSYM* ERFG* OFL* OUTL*)) 
(PUT 'LPRI 'NUMBER-OF-ARGS 1) 
(PUT 'LPRI 'DEFINED-ON-LINE '36) 
(PUT 'LPRI 'DEFINED-IN-FILE 'RLISP/LPRI.RED) 
(PUT 'LPRI 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE LPRI (U)
    (PROG ()
     WHILELABEL
      (COND ((NOT U) (RETURN NIL)))
      (PROGN (PRIN2 (CAR U)) (PRIN2 " ") (SETQ U (CDR U)))
      (GO WHILELABEL))) 
(PUT 'LPRIW 'NUMBER-OF-ARGS 2) 
(PUT 'LPRIW 'DEFINED-ON-LINE '42) 
(PUT 'LPRIW 'DEFINED-IN-FILE 'RLISP/LPRI.RED) 
(PUT 'LPRIW 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE LPRIW (U V)
    (PROG ()
      (SETQ U (CONS U (COND ((AND V (ATOM V)) (LIST V)) (T V))))
      (COND ((NULL OFL*) (PROGN (TERPRI) (LPRI U) (TERPRI)))
            (T
             (PROGN
              (COND
               ((NOT (OR *FORT (NOT *NAT) *DEFN))
                (PROGN (TERPRI) (LPRI U) (TERPRI))))
              (WRS NIL)
              (LPRI U)
              (TERPRI)
              (WRS (CDR OFL*))))))) 
(PUT 'LPRIM 'NUMBER-OF-ARGS 1) 
(PUT 'LPRIM 'DEFINED-ON-LINE '66) 
(PUT 'LPRIM 'DEFINED-IN-FILE 'RLISP/LPRI.RED) 
(PUT 'LPRIM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE LPRIM (U) (AND *MSG (LPRIW "***" U))) 
(PUT 'LPRIE 'NUMBER-OF-ARGS 1) 
(PUT 'LPRIE 'DEFINED-ON-LINE '69) 
(PUT 'LPRIE 'DEFINED-IN-FILE 'RLISP/LPRI.RED) 
(PUT 'LPRIE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE LPRIE (U)
    (PROG (X)
      (COND ((NOT *INT) (PROGN (SETQ X *DEFN) (SETQ *DEFN NIL))))
      (SETQ ERFG* T)
      (LPRIW "*****" U)
      (COND ((NULL *INT) (SETQ *DEFN X))))) 
(PUT 'PRINTTY 'NUMBER-OF-ARGS 1) 
(PUT 'PRINTTY 'DEFINED-ON-LINE '80) 
(PUT 'PRINTTY 'DEFINED-IN-FILE 'RLISP/LPRI.RED) 
(PUT 'PRINTTY 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PRINTTY (U)
    (PROG (OFL)
      (COND ((AND (NULL *FORT) *NAT) (PRINT U)))
      (COND ((NULL OFL*) (RETURN NIL)))
      (SETQ OFL OFL*)
      (WRS NIL)
      (PRINT U)
      (WRS (CDR OFL)))) 
(PUT 'RERROR 'NUMBER-OF-ARGS 3) 
(PUT 'RERROR 'DEFINED-ON-LINE '91) 
(PUT 'RERROR 'DEFINED-IN-FILE 'RLISP/LPRI.RED) 
(PUT 'RERROR 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE RERROR (PACKAGENAME NUMBER MESSAGE)
    (PROGN (SETQ ERRMSG* MESSAGE) (REDERR MESSAGE))) 
(PUT 'REDERR 'NUMBER-OF-ARGS 1) 
(PUT 'REDERR 'DEFINED-ON-LINE '94) 
(PUT 'REDERR 'DEFINED-IN-FILE 'RLISP/LPRI.RED) 
(PUT 'REDERR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE REDERR (U) (PROG () (COND ((NOT *PROTFG) (LPRIE U))) (ERROR1))) 
(PUT 'SYMERR 'NUMBER-OF-ARGS 2) 
(PUT 'SYMERR 'DEFINED-ON-LINE '97) 
(PUT 'SYMERR 'DEFINED-IN-FILE 'RLISP/LPRI.RED) 
(PUT 'SYMERR 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SYMERR (U V)
    (PROG (X)
      (SETQ ERFG* T)
      (COND
       ((OR (NUMBERP CURSYM*) (NOT (SETQ X (GET CURSYM* 'PRTCH))))
        (SETQ X CURSYM*)))
      (TERPRI)
      (COND (*ECHO (TERPRI)))
      (SETQ OUTL* (CONS (CAR OUTL*) (CONS '$$$ (CDR OUTL*))))
      (COMM1 T)
      (SETQ OUTL* (REVERSIP* OUTL*))
      (PROG ()
       WHILELABEL
        (COND ((NOT OUTL*) (RETURN NIL)))
        (PROGN (PRIN2 (CAR OUTL*)) (SETQ OUTL* (CDR OUTL*)))
        (GO WHILELABEL))
      (TERPRI)
      (PRIN2 "at line ")
      (PRIN2 CURLINE*)
      (COND (IFL* (PROGN (PRIN2 " of file ") (PRIN2 (CAR IFL*)))))
      (TERPRI)
      (COND ((NULL V) (RERROR 'RLISP 5 U))
            (T
             (RERROR 'RLISP 6
                     (COND (U (LIST X "invalid" "in" U "statement"))
                           (T (LIST X "invalid")))))))) 
(PUT 'TYPERR 'NUMBER-OF-ARGS 2) 
(PUT 'TYPERR 'DEFINED-ON-LINE '121) 
(PUT 'TYPERR 'DEFINED-IN-FILE 'RLISP/LPRI.RED) 
(PUT 'TYPERR 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE TYPERR (U V) (RERROR 'RLISP 6 (LIST U "invalid as" V))) 
(ENDMODULE) 