(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'WEDGE)) 
(GLOBAL '(DIMEX* LFTSHFT* WEDGEMTCH*)) 
(NEWTOK '((^) WEDGE)) 
(FLAG '(WEDGE) 'NARY) 
(INFIX (LIST 'WEDGE)) 
(PRECEDENCE (LIST 'WEDGE 'TIMES)) 
(DE WEDGEORDP (U V) (WORDERP U V)) 
(PUT 'WEDGEORDP 'NUMBER-OF-ARGS 2) 
(PUT 'WEDGEORDP 'DEFINED-ON-LINE '40) 
(PUT 'WEDGEORDP 'DEFINED-IN-FILE 'EXCALC/WEDGE.RED) 
(PUT 'WEDGEORDP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(PUTC 'WEDGEORDP 'INLINE '(LAMBDA (U V) (WORDERP U V))) 
(PUT 'WEDGE 'SIMPFN 'SIMPWEDGE) 
(PUT 'WEDGE 'RTYPEFN 'GETRTYPEOR) 
(PUT 'WEDGE 'PARTITFN 'PARTITWEDGE) 
(PUT 'PARTITWEDGE 'NUMBER-OF-ARGS 1) 
(PUT 'PARTITWEDGE 'DEFINED-ON-LINE '48) 
(PUT 'PARTITWEDGE 'DEFINED-IN-FILE 'EXCALC/WEDGE.RED) 
(PUT 'PARTITWEDGE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PARTITWEDGE (U)
    (COND ((NULL (CDR U)) (PARTITOP (CAR U)))
          (T (MKUNIQUEWEDGE (XPNDWEDGE U))))) 
(PUT 'EXC_ODDP 'NUMBER-OF-ARGS 1) 
(PUT 'EXC_ODDP 'DEFINED-ON-LINE '53) 
(PUT 'EXC_ODDP 'DEFINED-IN-FILE 'EXCALC/WEDGE.RED) 
(PUT 'EXC_ODDP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE EXC_ODDP (M)
    (COND ((NOT (FIXP M)) (TYPERR M "integer")) (T (NEQ (REMAINDER M 2) 0)))) 
(PUT 'MKSGNSQ 'NUMBER-OF-ARGS 1) 
(PUT 'MKSGNSQ 'DEFINED-ON-LINE '56) 
(PUT 'MKSGNSQ 'DEFINED-IN-FILE 'EXCALC/WEDGE.RED) 
(PUT 'MKSGNSQ 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MKSGNSQ (U)
    (COND ((NULL (SETQ U (EVENFREE U))) (CONS 1 1))
          ((EQUAL U 1) (CONS (MINUS 1) 1))
          (T
           ((LAMBDA (U)
              (COND (*QSUM-SIMPEXPT (QSUM-SIMPEXPT U)) (T (BASIC-SIMPEXPT U))))
            (LIST (MINUS 1) (MK*SQ (CONS U 1))))))) 
(PUT 'EVENFREE 'NUMBER-OF-ARGS 1) 
(PUT 'EVENFREE 'DEFINED-ON-LINE '61) 
(PUT 'EVENFREE 'DEFINED-IN-FILE 'EXCALC/WEDGE.RED) 
(PUT 'EVENFREE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE EVENFREE (U)
    (COND ((NULL U) NIL) ((NUMBERP U) (ABSF (CDR (QREMD U 2))))
          (T (ADDF (ABSF (CDR (QREMD (LIST (CAR U)) 2))) (EVENFREE (CDR U)))))) 
(PUT 'MKWEDGE 'NUMBER-OF-ARGS 1) 
(PUT 'MKWEDGE 'DEFINED-ON-LINE '66) 
(PUT 'MKWEDGE 'DEFINED-IN-FILE 'EXCALC/WEDGE.RED) 
(PUT 'MKWEDGE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MKWEDGE (U) (CONS (CONS U (CONS 1 1)) NIL)) 
(PUT 'WEDGEMTCH 'NUMBER-OF-ARGS 1) 
(PUT 'WEDGEMTCH 'DEFINED-ON-LINE '68) 
(PUT 'WEDGEMTCH 'DEFINED-IN-FILE 'EXCALC/WEDGE.RED) 
(PUT 'WEDGEMTCH 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE WEDGEMTCH (U)
    (PROG (X Y Z)
      (SETQ Y U)
     A
      (SETQ X (CONS (CAR Y) X))
      (COND
       ((SETQ Z (ASSOC (REVERSE X) WEDGEMTCH*))
        (RETURN
         (COND
          ((CDR Z)
           (COND ((CDR Y) (CONS 'WEDGE (APPEND (CDR Z) (CDR Y)))) (T (CDR Z))))
          (T 0)))))
      (SETQ Y (CDR Y))
      (COND (Y (GO A)) (T (RETURN NIL))))) 
(PUT 'SIMPWEDGE 'NUMBER-OF-ARGS 1) 
(PUT 'SIMPWEDGE 'DEFINED-ON-LINE '82) 
(PUT 'SIMPWEDGE 'DEFINED-IN-FILE 'EXCALC/WEDGE.RED) 
(PUT 'SIMPWEDGE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SIMPWEDGE (U) (*PF2SQ (PARTITWEDGE U))) 
(PUT 'XPNDWEDGE 'NUMBER-OF-ARGS 1) 
(PUT 'XPNDWEDGE 'DEFINED-ON-LINE '85) 
(PUT 'XPNDWEDGE 'DEFINED-IN-FILE 'EXCALC/WEDGE.RED) 
(PUT 'XPNDWEDGE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE XPNDWEDGE (U)
    (COND ((NULL (CDR U)) (MKUNARYWEDGE (PARTITOP (CAR U))))
          (T (WEDGEPF2 (PARTITOP (CAR U)) (XPNDWEDGE (CDR U)))))) 
(PUT 'MKUNARYWEDGE 'NUMBER-OF-ARGS 1) 
(PUT 'MKUNARYWEDGE 'DEFINED-ON-LINE '90) 
(PUT 'MKUNARYWEDGE 'DEFINED-IN-FILE 'EXCALC/WEDGE.RED) 
(PUT 'MKUNARYWEDGE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MKUNARYWEDGE (U)
    (COND ((NULL U) NIL)
          (T (CONS (CONS (LIST (CAAR U)) (CDAR U)) (MKUNARYWEDGE (CDR U)))))) 
(PUT 'MKUNIQUEWEDGE 'NUMBER-OF-ARGS 1) 
(PUT 'MKUNIQUEWEDGE 'DEFINED-ON-LINE '94) 
(PUT 'MKUNIQUEWEDGE 'DEFINED-IN-FILE 'EXCALC/WEDGE.RED) 
(PUT 'MKUNIQUEWEDGE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MKUNIQUEWEDGE (U)
    (COND ((NULL U) NIL)
          (T
           (ADDPF (MULTPFSQ (MKUNIQUEWEDGE1 (CAAR U)) (CDAR U))
            (MKUNIQUEWEDGE (CDR U)))))) 
(PUT 'MKUNIQUEWEDGE1 'NUMBER-OF-ARGS 1) 
(PUT 'MKUNIQUEWEDGE1 'DEFINED-ON-LINE '99) 
(PUT 'MKUNIQUEWEDGE1 'DEFINED-IN-FILE 'EXCALC/WEDGE.RED) 
(PUT 'MKUNIQUEWEDGE1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MKUNIQUEWEDGE1 (U)
    (COND ((NULL (CDR U)) (MKUPF (CAR U)))
          (T
           (PROG (X)
             (RETURN
              (COND ((AND WEDGEMTCH* (SETQ X (WEDGEMTCH U))) (PARTITOP X))
                    (T (MKUPF (CONS 'WEDGE U))))))))) 
(PUT 'WEDGEPF2 'NUMBER-OF-ARGS 2) 
(PUT 'WEDGEPF2 'DEFINED-ON-LINE '108) 
(PUT 'WEDGEPF2 'DEFINED-IN-FILE 'EXCALC/WEDGE.RED) 
(PUT 'WEDGEPF2 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE WEDGEPF2 (U V)
    (COND ((OR (NULL U) (NULL V)) NIL)
          (T
           (ADDPF (WEDGET2 (CAR U) (CAR V))
            (ADDPF (WEDGEPF2 (CONS (CAR U) NIL) (CDR V))
             (WEDGEPF2 (CDR U) V)))))) 
(DE MULTWEDGESQ (U V) (MULTSQ U V)) 
(PUT 'MULTWEDGESQ 'NUMBER-OF-ARGS 2) 
(PUT 'MULTWEDGESQ 'DEFINED-ON-LINE '115) 
(PUT 'MULTWEDGESQ 'DEFINED-IN-FILE 'EXCALC/WEDGE.RED) 
(PUT 'MULTWEDGESQ 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(PUTC 'MULTWEDGESQ 'INLINE '(LAMBDA (U V) (MULTSQ U V))) 
(PUT 'WEDGET2 'NUMBER-OF-ARGS 2) 
(PUT 'WEDGET2 'DEFINED-ON-LINE '119) 
(PUT 'WEDGET2 'DEFINED-IN-FILE 'EXCALC/WEDGE.RED) 
(PUT 'WEDGET2 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE WEDGET2 (U V)
    (COND
     ((EQUAL (CAR U) 1) (CONS (CONS (CAR V) (MULTSQ (CDR U) (CDR V))) NIL))
     ((EQUAL (CAAR V) 1)
      (CONS (CONS (LIST (CAR U)) (MULTSQ (CDR U) (CDR V))) NIL))
     (T (MULTPFSQ (WEDGEK2 (CAR U) (CAR V) NIL) (MULTSQ (CDR U) (CDR V)))))) 
(PUT 'WEDGEK2 'NUMBER-OF-ARGS 3) 
(PUT 'WEDGEK2 'DEFINED-ON-LINE '124) 
(PUT 'WEDGEK2 'DEFINED-IN-FILE 'EXCALC/WEDGE.RED) 
(PUT 'WEDGEK2 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE WEDGEK2 (U V W)
    (COND
     ((AND (EQ U (CAR V)) (NULL (EQCAR U 'WEDGE)))
      (COND (((LAMBDA (N) (AND (FIXP N) (EXC_ODDP N))) (DEG*FORM U)) NIL)
            (T (MULTPFSQ (WEDGEF (CONS U V)) (MKSGNSQ W)))))
     ((EQCAR (CAR V) 'WEDGE) (WEDGEK2 U (CDAR V) W))
     ((EQCAR U 'WEDGE) (MULTPFSQ (WEDGEWEDGE (CDR U) V) (MKSGNSQ W)))
     ((WORDERP U (CAR V)) (MULTPFSQ (WEDGEF (CONS U V)) (MKSGNSQ W)))
     ((CDR V)
      (WEDGEPF2 (CONS (CONS (CAR V) (CONS 1 1)) NIL)
       (WEDGEK2 U (CDR V)
        (ADDF W
              ((LAMBDA (G164 G165)
                 (COND (*PHYSOP-LOADED (PHYSOP-MULTF G164 G165))
                       (T (POLY-MULTF G164 G165))))
               (DEG*FORM U) (DEG*FORM (CAR V)))))))
     (T
      (MULTPFSQ (WEDGEF (LIST (CAR V) U))
       (MKSGNSQ
        (ADDF W
              ((LAMBDA (G166 G167)
                 (COND (*PHYSOP-LOADED (PHYSOP-MULTF G166 G167))
                       (T (POLY-MULTF G166 G167))))
               (DEG*FORM U) (DEG*FORM (CAR V))))))))) 
(PUT 'WEDGEWEDGE 'NUMBER-OF-ARGS 2) 
(PUT 'WEDGEWEDGE 'DEFINED-ON-LINE '140) 
(PUT 'WEDGEWEDGE 'DEFINED-IN-FILE 'EXCALC/WEDGE.RED) 
(PUT 'WEDGEWEDGE 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE WEDGEWEDGE (U V)
    (COND
     ((NULL (CDR U))
      (WEDGEPF2 (CONS (CONS (CAR U) (CONS 1 1)) NIL)
       (CONS (CONS V (CONS 1 1)) NIL)))
     (T
      (WEDGEPF2 (CONS (CONS (CAR U) (CONS 1 1)) NIL) (WEDGEWEDGE (CDR U) V))))) 
(PUT 'WEDGEF 'NUMBER-OF-ARGS 1) 
(PUT 'WEDGEF 'DEFINED-ON-LINE '145) 
(PUT 'WEDGEF 'DEFINED-IN-FILE 'EXCALC/WEDGE.RED) 
(PUT 'WEDGEF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE WEDGEF (U)
    (COND ((DIM<DEG U) NIL)
          ((EQCAR (CAR U) 'HODGE)
           ((LAMBDA (M)
              (COND
               ((EQUAL M (DEG*FARG (CDR U)))
                (MULTPFSQ
                 (WEDGEPF2 (CONS (CONS (CADAR U) (CONS 1 1)) NIL)
                  (MKUNARYWEDGE
                   (HODGEPF
                    (COND ((CDDR U) (MKUNIQUEWEDGE1 (CDR U)))
                          (T (CONS (CONS (CADR U) (CONS 1 1)) NIL))))))
                 (MKSGNSQ
                  ((LAMBDA (G169)
                     (COND (*PHYSOP-LOADED (PHYSOP-MULTF M G169))
                           (T (POLY-MULTF M G169))))
                   (ADDF M (NEGF DIMEX*))))))
               (T (MKWEDGE U))))
            (DEG*FORM (CADAR U))))
          ((AND (EQCAR (CAR U) 'D)
                (OR (FLAGP 'D 'NOXPND) (SMEMQLP LFTSHFT* (CADAR U))))
           (ADDPF (MKUNARYWEDGE (DWEDGE (CONS (CADAR U) (CDR U))))
            (MULTPFSQ
             (WEDGEPF2 (CONS (CONS (CADAR U) (CONS 1 1)) NIL)
              (MKUNARYWEDGE
               (COND ((CDDR U) (DWEDGE (CDR U))) (T (EXDFK (CADR U))))))
             (NEGSQ (MKSGNSQ (DEG*FORM (CADAR U)))))))
          (T (MKWEDGE U)))) 
(PUT 'WEDGE 'FANCY-INFIX-SYMBOL 217) 
(ENDMODULE) 