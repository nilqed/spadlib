(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'BLOCK4)) 
(FLUID '(BLOCKRESTYPE*)) 
(REMPROP 'RETURN 'XFORM) 
(PUT 'N_FORMBLOCK 'NUMBER-OF-ARGS 2) 
(PUT 'N_FORMBLOCK 'DEFINED-ON-LINE '36) 
(PUT 'N_FORMBLOCK 'DEFINED-IN-FILE 'REDUCE4/BLOCK4.RED) 
(PUT 'N_FORMBLOCK 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE N_FORMBLOCK (U VARS)
    ((LAMBDA (X)
       (LIST (TYPE X)
             (CONS 'PROG (APPEND (N_INITPROGVARS (CADR U)) (VALUE X)))))
     (N_FORMPROG1 (CDDR U) (APPEND (CADR U) VARS)))) 
(PUT 'N_INITPROGVARS 'NUMBER-OF-ARGS 1) 
(PUT 'N_INITPROGVARS 'DEFINED-ON-LINE '40) 
(PUT 'N_INITPROGVARS 'DEFINED-IN-FILE 'REDUCE4/BLOCK4.RED) 
(PUT 'N_INITPROGVARS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE N_INITPROGVARS (U)
    (PROG (X Y Z)
      (PROG ()
       WHILELABEL
        (COND ((NOT U) (RETURN NIL)))
        (PROGN
         (COND
          ((OR (SETQ Z (GET (CAAR U) 'INITVALUE*))
               (SETQ Z (GET_TYPE_INITVALUE (CDAR U))))
           (SETQ Y (CONS (MKSETQ (CAAR U) (MKQUOTE Z)) Y)))
          (T (SETQ Y (CONS (MKSETQ (CAAR U) (MKQUOTE (IDEVAL NIL))) Y))))
         (SETQ X (CONS (CAAR U) X))
         (SETQ U (CDR U)))
        (GO WHILELABEL))
      (RETURN (CONS (REVERSIP* X) (REVERSIP* Y))))) 
(PUT 'GET_TYPE_INITVALUE 'NUMBER-OF-ARGS 1) 
(PUT 'GET_TYPE_INITVALUE 'DEFINED-ON-LINE '52) 
(PUT 'GET_TYPE_INITVALUE 'DEFINED-IN-FILE 'REDUCE4/BLOCK4.RED) 
(PUT 'GET_TYPE_INITVALUE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE GET_TYPE_INITVALUE (U)
    (COND ((ATOM U) (GET U 'INITVALUE*)) (T (GET (CAR U) 'INITVALUE*)))) 
(PUT 'MKOBJECT 'NUMBER-OF-ARGS 2) 
(PUT 'MKOBJECT 'DEFINED-ON-LINE '55) 
(PUT 'MKOBJECT 'DEFINED-IN-FILE 'REDUCE4/BLOCK4.RED) 
(PUT 'MKOBJECT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MKOBJECT (U V)
    (COND ((AND (NULL U) (EQUAL V 'POLY)) (LIST 'ZERO 0)) (T (LIST V U)))) 
(PUT 'INT 'INITVALUE* (MKOBJECT 0 'ZERO)) 
(PUT 'LIST 'INITVALUE* (MKOBJECT NIL 'LIST)) 
(PUT 'POLY 'INITVALUE* (MKOBJECT 0 'ZERO)) 
(PUT 'N_FORMPROG 'NUMBER-OF-ARGS 2) 
(PUT 'N_FORMPROG 'DEFINED-ON-LINE '67) 
(PUT 'N_FORMPROG 'DEFINED-IN-FILE 'REDUCE4/BLOCK4.RED) 
(PUT 'N_FORMPROG 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE N_FORMPROG (U VARS)
    ((LAMBDA (X) (LIST (TYPE X) (CONS 'PROG (CONS (CADR U) (VALUE X)))))
     (N_FORMPROG1 (CDDR U) (N_PAIRVARS (CADR U) VARS)))) 
(PUT 'N_FORMPROG1 'NUMBER-OF-ARGS 2) 
(PUT 'N_FORMPROG1 'DEFINED-ON-LINE '71) 
(PUT 'N_FORMPROG1 'DEFINED-IN-FILE 'REDUCE4/BLOCK4.RED) 
(PUT 'N_FORMPROG1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE N_FORMPROG1 (U VARS)
    (PROG (EPTR V BLOCKRESTYPE*)
      (SETQ V (SETQ EPTR (LIST NIL)))
     A
      (COND
       ((NULL U)
        (RETURN
         (LIST (COND (BLOCKRESTYPE* BLOCKRESTYPE*) (T 'NOVAL)) (CDR V)))))
      (COND ((NULL (CAR U)) NIL)
            ((ATOM (CAR U)) (SETQ EPTR (CDR (RPLACD EPTR (LIST (CAR U))))))
            (T (SETQ EPTR (CDR (RPLACD EPTR (CDR (N_FORM1 (CAR U) VARS)))))))
      (SETQ U (CDR U))
      (GO A))) 
(PUT 'N_FORMRETURN 'NUMBER-OF-ARGS 2) 
(PUT 'N_FORMRETURN 'DEFINED-ON-LINE '85) 
(PUT 'N_FORMRETURN 'DEFINED-IN-FILE 'REDUCE4/BLOCK4.RED) 
(PUT 'N_FORMRETURN 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE N_FORMRETURN (U VARS)
    (PROG (X)
      (SETQ X (N_FORM1 (CADR U) VARS))
      (COND ((NULL BLOCKRESTYPE*) (SETQ BLOCKRESTYPE* (TYPE X)))
            ((XTYPE1 (TYPE X) BLOCKRESTYPE*) NIL)
            ((XTYPE1 BLOCKRESTYPE* (TYPE X)) (SETQ BLOCKRESTYPE* (TYPE X)))
            (T
             (REDERR
              (LIST "block return types" (TYPE X) "and" BLOCKRESTYPE*
                    "are unrelated"))))
      (RETURN (LIST (TYPE X) (CONS 'RETURN (CDR X)))))) 
(PUT 'RETURN 'N_FORMFN 'N_FORMRETURN) 
(PUT 'RBLOCK 'N_FORMFN 'N_FORMBLOCK) 
(PUT 'READ_TYPE4 'NUMBER-OF-ARGS 0) 
(PUT 'READ_TYPE4 'DEFINED-ON-LINE '103) 
(PUT 'READ_TYPE4 'DEFINED-IN-FILE 'REDUCE4/BLOCK4.RED) 
(PUT 'READ_TYPE4 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE READ_TYPE4 NIL
    (PROG (Y Z)
      (SETQ Y (SCAN))
     A
      (SETQ Z (SCAN))
      (COND ((EQUAL Z '*LPAR*) (PROGN (SETQ Y (LIST Y (XREAD 'PAREN))) (GO A)))
            ((NULL (MEMQ Z '(*COMMA* *RPAR* *SEMICOL* MAPPED_TO)))
             (PROGN
              (SETQ Y (COND ((ATOM Y) (LIST Y Z)) (T (ACONC Y Z))))
              (GO A))))
      (RETURN Y))) 
(PUT 'READ_PARAM_LIST 'NUMBER-OF-ARGS 1) 
(PUT 'READ_PARAM_LIST 'DEFINED-ON-LINE '115) 
(PUT 'READ_PARAM_LIST 'DEFINED-IN-FILE 'REDUCE4/BLOCK4.RED) 
(PUT 'READ_PARAM_LIST 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE READ_PARAM_LIST (U)
    (PROG (LPARP X Y Z)
      (SETQ X CURSYM*)
      (COND ((EQUAL X '*LPAR*) (PROGN (SETQ LPARP T) (SETQ X (SCAN)))))
     B
      (COND ((NOT (IDP X)) (TYPERR X "parameter")))
      (SETQ Y (SCAN))
      (COND
       ((EQUAL Y '*COLON*)
        (PROGN (SETQ X (CONS X (READ_TYPE4))) (SETQ Y CURSYM*)))
       (T (SETQ X (CONS X 'GENERIC))))
      (COND
       ((EQUAL Y '*COMMA*) (PROGN (SETQ Z (CONS X Z)) (SETQ X (SCAN)) (GO B)))
       ((EQUAL Y '*RPAR*)
        (COND
         (LPARP
          (COND ((EQUAL (SCAN) '*SEMICOL*) (RETURN (REVERSIP (CONS X Z))))
                ((AND (EQUAL CURSYM* '*COLON*) (NULL U))
                 (RETURN (REVERSIP (CONS X Z))))
                (T (TYPERR CURSYM* "delimiter"))))
         (T (RERROR 'RLISP 100 "Too many right parentheses"))))
       ((EQUAL Y '*SEMICOL*)
        (COND (LPARP (RERROR 'RLISP 101 "Too few right parentheses"))
              (T (RETURN (REVERSIP (CONS X Z))))))))) 
(FLAG '(LOCAL) 'TYPE) 
(ENDMODULE) 