(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'OFSFMISC)) 
(REVISION 'OFSFMISC
          "$Id: ofsfmisc.red 5986 2021-08-28 13:35:27Z thomas-sturm $") 
(COPYRIGHT 'OFSFMISC "(c) 1995-2009 A. Dolzmann, T. Sturm, 2010-2017 T. Sturm") 
(PUT 'OFSF_TERMPRINT 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_TERMPRINT 'DEFINED-ON-LINE '32) 
(PUT 'OFSF_TERMPRINT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_TERMPRINT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_TERMPRINT (U)
    (PROGN ((LAMBDA (*NAT) (SQPRINT (CONS U 1))) NIL) (IOTO_PRIN2 NIL))) 
(PUT 'OFSF_CANEGREL 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_CANEGREL 'DEFINED-ON-LINE '40) 
(PUT 'OFSF_CANEGREL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_CANEGREL 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_CANEGREL (R FLG) (COND (FLG R) (T (OFSF_ANEGREL R)))) 
(PUT 'OFSF_ANEGREL 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_ANEGREL 'DEFINED-ON-LINE '48) 
(PUT 'OFSF_ANEGREL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_ANEGREL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_ANEGREL (R)
    (OR
     (CDR
      (ATSOC R
             '((EQUAL . EQUAL) (NEQ . NEQ) (LEQ . GEQ) (GEQ . LEQ)
               (LESSP . GREATERP) (GREATERP . LESSP))))
     (REDERR (LIST "ofsf_anegrel: unknown operator " R)))) 
(PUT 'OFSF_CLNEGREL 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_CLNEGREL 'DEFINED-ON-LINE '56) 
(PUT 'OFSF_CLNEGREL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_CLNEGREL 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_CLNEGREL (R FLG) (COND (FLG R) (T (OFSF_LNEGREL R)))) 
(PUT 'OFSF_LNEGREL 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_LNEGREL 'DEFINED-ON-LINE '64) 
(PUT 'OFSF_LNEGREL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_LNEGREL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_LNEGREL (R)
    (COND ((EQ R 'EQUAL) 'NEQ) ((EQ R 'NEQ) 'EQUAL) ((EQ R 'LEQ) 'GREATERP)
          ((EQ R 'LESSP) 'GEQ) ((EQ R 'GEQ) 'LESSP) ((EQ R 'GREATERP) 'LEQ)
          (T (REDERR (LIST "ofsf_lnegrel: unknown operator " R))))) 
(PUT 'OFSF_FCTRAT 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_FCTRAT 'DEFINED-ON-LINE '76) 
(PUT 'OFSF_FCTRAT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_FCTRAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_FCTRAT (ATF) (CDR (SFTO_FCTRF (CADR ATF)))) 
(PUT 'OFSF_NEGATEAT 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_NEGATEAT 'DEFINED-ON-LINE '84) 
(PUT 'OFSF_NEGATEAT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_NEGATEAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_NEGATEAT (F)
    ((LAMBDA (G269) (LIST (OFSF_LNEGREL (CAR F)) (CAR G269) (CADR G269)))
     (LIST (CADR F) (CADDR F)))) 
(PUT 'OFSF_VARLAT 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_VARLAT 'DEFINED-ON-LINE '90) 
(PUT 'OFSF_VARLAT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_VARLAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_VARLAT (ATFORM)
    (PROG (VL)
      (SETQ VL (KERNELS (CADR ATFORM)))
      (COND
       (*RLBRKCXK
        (SETQ VL
                (PROG (V FORALL-RESULT FORALL-ENDPTR)
                  (SETQ V VL)
                 STARTOVER
                  (COND ((NULL V) (RETURN NIL)))
                  (SETQ FORALL-RESULT ((LAMBDA (V) (LTO_LPVARL V)) (CAR V)))
                  (SETQ FORALL-ENDPTR (LASTPAIR FORALL-RESULT))
                  (SETQ V (CDR V))
                  (COND ((ATOM FORALL-ENDPTR) (GO STARTOVER)))
                 LOOPLABEL
                  (COND ((NULL V) (RETURN FORALL-RESULT)))
                  (RPLACD FORALL-ENDPTR ((LAMBDA (V) (LTO_LPVARL V)) (CAR V)))
                  (SETQ FORALL-ENDPTR (LASTPAIR FORALL-ENDPTR))
                  (SETQ V (CDR V))
                  (GO LOOPLABEL)))))
      (RETURN VL))) 
(PUT 'OFSF_VARSUBSTAT 'NUMBER-OF-ARGS 3) 
(PUT 'OFSF_VARSUBSTAT 'DEFINED-ON-LINE '102) 
(PUT 'OFSF_VARSUBSTAT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_VARSUBSTAT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE OFSF_VARSUBSTAT (ATF NEW OLD)
    (LIST (CAR ATF) (CAR (SUBF (CADR ATF) (LIST (CONS OLD NEW)))) NIL)) 
(PUT 'OFSF_ORDATP 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_ORDATP 'DEFINED-ON-LINE '109) 
(PUT 'OFSF_ORDATP 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_ORDATP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_ORDATP (A1 A2)
    (PROG (LHS1 LHS2)
      (SETQ LHS1 (CADR A1))
      (SETQ LHS2 (CADR A2))
      (COND ((NEQ LHS1 LHS2) (RETURN (NOT (ORDP LHS1 LHS2)))))
      (RETURN (OFSF_ORDRELP (CAR A1) (CAR A2))))) 
(PUT 'OFSF_ORDRELP 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_ORDRELP 'DEFINED-ON-LINE '119) 
(PUT 'OFSF_ORDRELP 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_ORDRELP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_ORDRELP (R1 R2)
    (MEMQ R2 (CDR (MEMQ R1 '(EQUAL NEQ LEQ LESSP GEQ GREATERP))))) 
(PUT 'OFSF_A2CDL 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_A2CDL 'DEFINED-ON-LINE '124) 
(PUT 'OFSF_A2CDL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_A2CDL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_A2CDL (ATML)
    (PROG (ATF TERML FLAG)
      (PROG ()
       WHILELABEL
        (COND ((NOT ATML) (RETURN NIL)))
        (PROGN
         (SETQ ATF (CAAR ATML))
         (SETQ ATML (CDR ATML))
         (SETQ TERML (CONS (CADR ATF) TERML))
         (COND ((NOT (MEMQ (CAR ATF) '(EQUAL NEQ))) (SETQ FLAG T))))
        (GO WHILELABEL))
      (RETURN
       (PROG (X FORALL-RESULT FORALL-ENDPTR)
         (SETQ X TERML)
         (COND ((NULL X) (RETURN NIL)))
         (SETQ FORALL-RESULT
                 (SETQ FORALL-ENDPTR
                         (CONS
                          ((LAMBDA (X)
                             (COND
                              (FLAG
                               (LIST (LIST 'LESSP X NIL) (LIST 'EQUAL X NIL)
                                     (LIST 'GREATERP X NIL)))
                              (T
                               (LIST (LIST 'EQUAL X NIL) (LIST 'NEQ X NIL)))))
                           (CAR X))
                          NIL)))
        LOOPLABEL
         (SETQ X (CDR X))
         (COND ((NULL X) (RETURN FORALL-RESULT)))
         (RPLACD FORALL-ENDPTR
                 (CONS
                  ((LAMBDA (X)
                     (COND
                      (FLAG
                       (LIST (LIST 'LESSP X NIL) (LIST 'EQUAL X NIL)
                             (LIST 'GREATERP X NIL)))
                      (T (LIST (LIST 'EQUAL X NIL) (LIST 'NEQ X NIL)))))
                   (CAR X))
                  NIL))
         (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
         (GO LOOPLABEL))))) 
(PUT 'OFSF_T2CDL 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_T2CDL 'DEFINED-ON-LINE '144) 
(PUT 'OFSF_T2CDL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_T2CDL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_T2CDL (TERM)
    (LIST (LIST 'LESSP TERM NIL) (LIST 'EQUAL TERM NIL)
          (LIST 'GREATERP TERM NIL))) 
(PUT 'OFSF_VSUBAT 'NUMBER-OF-ARGS 3) 
(PUT 'OFSF_VSUBAT 'DEFINED-ON-LINE '150) 
(PUT 'OFSF_VSUBAT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_VSUBAT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE OFSF_VSUBAT (V U F)
    (COND ((EQ U 'EPSILON) (OFSF_QESUBQPE F V '(NIL . 1)))
          ((EQUAL U '(MINUS EPSILON)) (OFSF_QESUBQME F V '(NIL . 1)))
          ((EQ U 'INFINITY) (OFSF_QESUBIAT F V 'PINF))
          ((EQUAL U '(MINUS INFINITY)) (OFSF_QESUBIAT F V 'MINF))
          ((EQCAR U 'LIST)
           (OFSF_QESUBRAT F V
            (PROG (P FORALL-RESULT FORALL-ENDPTR)
              (SETQ P (CDR U))
              (COND ((NULL P) (RETURN NIL)))
              (SETQ FORALL-RESULT
                      (SETQ FORALL-ENDPTR
                              (CONS ((LAMBDA (P) (CAR (SIMP P))) (CAR P))
                                    NIL)))
             LOOPLABEL
              (SETQ P (CDR P))
              (COND ((NULL P) (RETURN FORALL-RESULT)))
              (RPLACD FORALL-ENDPTR
                      (CONS ((LAMBDA (P) (CAR (SIMP P))) (CAR P)) NIL))
              (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
              (GO LOOPLABEL))))
          (T (REDERR (LIST "ofsf_vsubat: unexpected term" U))))) 
(PUT 'OFSF_SUBAT 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_SUBAT 'DEFINED-ON-LINE '164) 
(PUT 'OFSF_SUBAT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_SUBAT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_SUBAT (AL F)
    (OFSF_SIMPAT (LIST (CAR F) (OFSF_SUBA AL (PREPF (CADR F))) 0))) 
(PUT 'OFSF_SUBA 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_SUBA 'DEFINED-ON-LINE '167) 
(PUT 'OFSF_SUBA 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_SUBA 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_SUBA (AL F)
    (COND ((ATOM F) (OR (LTO_CATSOC F AL) F))
          (T
           (CONS (CAR F)
                 (PROG (ARG FORALL-RESULT FORALL-ENDPTR)
                   (SETQ ARG (CDR F))
                   (COND ((NULL ARG) (RETURN NIL)))
                   (SETQ FORALL-RESULT
                           (SETQ FORALL-ENDPTR
                                   (CONS
                                    ((LAMBDA (ARG) (OFSF_SUBA AL ARG))
                                     (CAR ARG))
                                    NIL)))
                  LOOPLABEL
                   (SETQ ARG (CDR ARG))
                   (COND ((NULL ARG) (RETURN FORALL-RESULT)))
                   (RPLACD FORALL-ENDPTR
                           (CONS ((LAMBDA (ARG) (OFSF_SUBA AL ARG)) (CAR ARG))
                                 NIL))
                   (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                   (GO LOOPLABEL)))))) 
(PUT 'OFSF_SUBALCHK 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_SUBALCHK 'DEFINED-ON-LINE '175) 
(PUT 'OFSF_SUBALCHK 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_SUBALCHK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_SUBALCHK (AL)
    (COND
     ((AND (NOT *RLNZDEN) (NOT *RLPOSDEN))
      (PROG (PR)
        (SETQ PR AL)
       LAB
        (COND ((NULL PR) (RETURN NIL)))
        ((LAMBDA (PR)
           (COND
            ((NOT
              ((LAMBDA (U) (OR (ATOM U) (ATOM (CAR U))))
               (CDR (SIMP (CDR PR)))))
             (REDERR "parametric denominator in substituted expression"))))
         (CAR PR))
        (SETQ PR (CDR PR))
        (GO LAB))))) 
(PUT 'OFSF_EQNRHSKERNELS 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_EQNRHSKERNELS 'DEFINED-ON-LINE '184) 
(PUT 'OFSF_EQNRHSKERNELS 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_EQNRHSKERNELS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_EQNRHSKERNELS (X)
    ((LAMBDA (W) (NCONC (KERNELS (CAR W)) (KERNELS (CDR W)))) (SIMP (CDR X)))) 
(PUT 'OFSF_VSUBALCHK 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_VSUBALCHK 'DEFINED-ON-LINE '187) 
(PUT 'OFSF_VSUBALCHK 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_VSUBALCHK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_VSUBALCHK (AL)
    (PROG (PR)
      (SETQ PR AL)
     LAB
      (COND ((NULL PR) (RETURN NIL)))
      ((LAMBDA (PR)
         (COND
          ((NOT (OFSF_NSTDP PR))
           (REDERR (LIST "illegal term" (CDR PR) "in vsub")))))
       (CAR PR))
      (SETQ PR (CDR PR))
      (GO LAB))) 
(PUT 'OFSF_NSTDP 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_NSTDP 'DEFINED-ON-LINE '192) 
(PUT 'OFSF_NSTDP 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_NSTDP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_NSTDP (U)
    (PROG (CNT)
      (SETQ U (CDR U))
      (COND
       ((MEMBER U '(EPSILON (MINUS EPSILON) INFINITY (MINUS INFINITY)))
        (RETURN T)))
      (COND ((OR (NOT (EQCAR U 'LIST)) (NEQ (LENGTH (CDR U)) 4)) (RETURN NIL)))
      (SETQ U (CDR U))
      (SETQ CNT T)
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND CNT U)) (RETURN NIL)))
        (COND ((NEQ (CDR (SIMP (CAR U))) 1) (SETQ CNT NIL))
              (T (SETQ U (CDR U))))
        (GO WHILELABEL))
      (RETURN CNT))) 
(PUT 'OFSF_GETINEQ 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_GETINEQ 'DEFINED-ON-LINE '208) 
(PUT 'OFSF_GETINEQ 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_GETINEQ 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_GETINEQ (F BVL)
    (PROG (ATML ATF CDL)
      (SETQ ATML (CL_ATML F))
      (PROG ()
       WHILELABEL
        (COND ((NOT ATML) (RETURN NIL)))
        (PROGN
         (SETQ ATF (CAAR ATML))
         (SETQ ATML (CDR ATML))
         (COND
          ((AND (MEMQ (CAR ATF) '(NEQ))
                (NULL (INTERSECTION BVL (KERNELS (CADR ATF)))))
           (SETQ CDL (CONS ATF CDL)))))
        (GO WHILELABEL))
      (RETURN CDL))) 
(PUT 'OFSF_STRUCTAT 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_STRUCTAT 'DEFINED-ON-LINE '225) 
(PUT 'OFSF_STRUCTAT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_STRUCTAT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_STRUCTAT (AT AL)
    (PROG (LHS)
      (SETQ LHS (CADR AT))
      (COND ((OR (ATOM LHS) (ATOM (CAR LHS))) (RETURN AT)))
      (RETURN (LIST (CAR AT) (CAR (SIMP (CDR (ASSOC LHS AL)))) NIL)))) 
(PUT 'OFSF_IFSTRUCTAT 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_IFSTRUCTAT 'DEFINED-ON-LINE '239) 
(PUT 'OFSF_IFSTRUCTAT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_IFSTRUCTAT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_IFSTRUCTAT (AT AL)
    (PROG (W R)
      (SETQ W (SFTO_FCTRF (CADR AT)))
      (SETQ R (CAR W))
      (PROG (X)
        (SETQ X (CDR W))
       LAB
        (COND ((NULL X) (RETURN NIL)))
        ((LAMBDA (X)
           (SETQ R
                   ((LAMBDA (G271)
                      (COND (*PHYSOP-LOADED (PHYSOP-MULTF R G271))
                            (T (POLY-MULTF R G271))))
                    (EXPF (CAR (SIMP (CDR (ASSOC (CAR X) AL)))) (CDR X)))))
         (CAR X))
        (SETQ X (CDR X))
        (GO LAB))
      (RETURN (LIST (CAR AT) R NIL)))) 
(PUT 'OFSF_TERMMLAT 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_TERMMLAT 'DEFINED-ON-LINE '248) 
(PUT 'OFSF_TERMMLAT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_TERMMLAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_TERMMLAT (AT) (COND ((CADR AT) (LIST (CONS (CADR AT) 1))))) 
(PUT 'OFSF_MULTSUREP 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_MULTSUREP 'DEFINED-ON-LINE '255) 
(PUT 'OFSF_MULTSUREP 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_MULTSUREP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_MULTSUREP (AT ATL)
    (COND ((EQ (CAR AT) 'EQUAL) (OFSF_MULTSUREP-EQUAL AT ATL))
          (T (OFSF_MULTSUREP-NEQ AT ATL)))) 
(PUT 'OFSF_MULTSUREP-EQUAL 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_MULTSUREP-EQUAL 'DEFINED-ON-LINE '262) 
(PUT 'OFSF_MULTSUREP-EQUAL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_MULTSUREP-EQUAL 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_MULTSUREP-EQUAL (AT ATL)
    (PROG (C A)
      (SETQ C (CADR AT))
      (PROG ()
       WHILELABEL
        (COND ((NOT ATL) (RETURN NIL)))
        (PROGN
         (SETQ A (CAR ATL))
         (SETQ ATL (CDR ATL))
         (COND
          ((AND (EQ (CAR A) 'EQUAL) ((LAMBDA (*EXP) (QUOTF1 C (CADR A))) T))
           (PROGN (SETQ A 'FOUND) (SETQ ATL NIL)))))
        (GO WHILELABEL))
      (RETURN (EQ A 'FOUND)))) 
(PUT 'OFSF_MULTSUREP-NEQ 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_MULTSUREP-NEQ 'DEFINED-ON-LINE '276) 
(PUT 'OFSF_MULTSUREP-NEQ 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_MULTSUREP-NEQ 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_MULTSUREP-NEQ (AT ATL)
    (PROG (C A)
      (SETQ C (CADR AT))
      (PROG ()
       WHILELABEL
        (COND ((NOT ATL) (RETURN NIL)))
        (PROGN
         (SETQ A (CAR ATL))
         (SETQ ATL (CDR ATL))
         (COND
          ((AND (EQ (CAR A) 'NEQ) ((LAMBDA (*EXP) (QUOTF1 (CADR A) C)) T))
           (PROGN (SETQ A 'FOUND) (SETQ ATL NIL)))))
        (GO WHILELABEL))
      (RETURN (EQ A 'FOUND)))) 
(PUT 'OFSF_POSVARP 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_POSVARP 'DEFINED-ON-LINE '290) 
(PUT 'OFSF_POSVARP 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_POSVARP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_POSVARP (F V)
    (PROG (OP ARGL A RES)
      (SETQ OP (COND ((ATOM F) F) (T (CAR F))))
      (COND
       ((EQ OP 'AND)
        (PROGN
         (SETQ ARGL (CDR F))
         (PROG ()
          WHILELABEL
           (COND ((NOT (AND (NOT RES) ARGL)) (RETURN NIL)))
           (PROGN
            (SETQ A (PROG1 (CAR ARGL) (SETQ ARGL (CDR ARGL))))
            (COND
             ((NOT
               (OR (OR (EQ F 'TRUE) (EQ F 'FALSE))
                   (OR (OR (OR (EQ F 'OR) (EQ F 'AND)) (EQ F 'NOT))
                       (OR (EQ F 'IMPL) (EQ F 'REPL) (EQ F 'EQUIV)))
                   (OR (EQ F 'EX) (EQ F 'ALL)) (OR (EQ F 'BEX) (EQ F 'BALL))))
              (SETQ RES (OFSF_POSVARPAT A V))))
            NIL)
           (GO WHILELABEL))
         (RETURN RES))))
      (RETURN (OFSF_POSVARPAT F V)))) 
(PUT 'OFSF_POSVARPAT 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_POSVARPAT 'DEFINED-ON-LINE '308) 
(PUT 'OFSF_POSVARPAT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_POSVARPAT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_POSVARPAT (A V)
    (PROG (OP)
      (SETQ OP (COND ((ATOM A) A) (T (CAR A))))
      (COND ((NOT (MEMQ OP '(GREATERP GEQ))) (RETURN NIL)))
      (COND ((EQ (SFTO_VARP (CADR A)) V) (RETURN OP))))) 
(PUT 'OFSF_POSPREP 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_POSPREP 'DEFINED-ON-LINE '320) 
(PUT 'OFSF_POSPREP 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_POSPREP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_POSPREP (F RESFNCHKP)
    (PROG (OP POSCONDS QVL)
      (SETQ F (CL_PNF F))
      (PROG ()
       WHILELABEL
        (COND
         ((NOT
           ((LAMBDA (X) (OR (EQ X 'EX) (EQ X 'ALL)))
            (SETQ OP (COND ((ATOM F) F) (T (CAR F))))))
          (RETURN NIL)))
        (PROGN
         (COND
          ((EQ OP 'ALL)
           (REDERR "pos methods admit only one existential quantifier block")))
         (SETQ QVL (CONS (CADR F) QVL))
         (SETQ F (CADDR F)))
        (GO WHILELABEL))
      (SETQ POSCONDS (OFSF_POSCONDS (CL_FVARL F) RESFNCHKP))
      (SETQ F (CONS 'AND (CONS F POSCONDS)))
      (PROG (V)
        (SETQ V QVL)
       LAB
        (COND ((NULL V) (RETURN NIL)))
        ((LAMBDA (V) (SETQ F (LIST 'EX V F))) (CAR V))
        (SETQ V (CDR V))
        (GO LAB))
      (RETURN F))) 
(PUT 'OFSF_POSCONDS 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_POSCONDS 'DEFINED-ON-LINE '336) 
(PUT 'OFSF_POSCONDS 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_POSCONDS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_POSCONDS (L RESFNCHKP)
    (PROG (V FORALL-RESULT FORALL-ENDPTR)
      (SETQ V L)
     STARTOVER
      (COND ((NULL V) (RETURN NIL)))
      (SETQ FORALL-RESULT
              ((LAMBDA (V)
                 (COND
                  ((AND RESFNCHKP (PAIRP V) (OFSF_RXFFN (CAR V)))
                   (PROG (W FORALL-RESULT FORALL-ENDPTR)
                     (SETQ W (LTO_LIST2SET (OFSF_LPVARL V)))
                     (COND ((NULL W) (RETURN NIL)))
                     (SETQ FORALL-RESULT
                             (SETQ FORALL-ENDPTR
                                     (CONS
                                      ((LAMBDA (W)
                                         (LIST 'GREATERP
                                               (LIST (CONS (CONS W 1) 1)) NIL))
                                       (CAR W))
                                      NIL)))
                    LOOPLABEL
                     (SETQ W (CDR W))
                     (COND ((NULL W) (RETURN FORALL-RESULT)))
                     (RPLACD FORALL-ENDPTR
                             (CONS
                              ((LAMBDA (W)
                                 (LIST 'GREATERP (LIST (CONS (CONS W 1) 1))
                                       NIL))
                               (CAR W))
                              NIL))
                     (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                     (GO LOOPLABEL)))
                  (T (LIST (LIST 'GREATERP (LIST (CONS (CONS V 1) 1)) NIL)))))
               (CAR V)))
      (SETQ FORALL-ENDPTR (LASTPAIR FORALL-RESULT))
      (SETQ V (CDR V))
      (COND ((ATOM FORALL-ENDPTR) (GO STARTOVER)))
     LOOPLABEL
      (COND ((NULL V) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR
              ((LAMBDA (V)
                 (COND
                  ((AND RESFNCHKP (PAIRP V) (OFSF_RXFFN (CAR V)))
                   (PROG (W FORALL-RESULT FORALL-ENDPTR)
                     (SETQ W (LTO_LIST2SET (OFSF_LPVARL V)))
                     (COND ((NULL W) (RETURN NIL)))
                     (SETQ FORALL-RESULT
                             (SETQ FORALL-ENDPTR
                                     (CONS
                                      ((LAMBDA (W)
                                         (LIST 'GREATERP
                                               (LIST (CONS (CONS W 1) 1)) NIL))
                                       (CAR W))
                                      NIL)))
                    LOOPLABEL
                     (SETQ W (CDR W))
                     (COND ((NULL W) (RETURN FORALL-RESULT)))
                     (RPLACD FORALL-ENDPTR
                             (CONS
                              ((LAMBDA (W)
                                 (LIST 'GREATERP (LIST (CONS (CONS W 1) 1))
                                       NIL))
                               (CAR W))
                              NIL))
                     (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                     (GO LOOPLABEL)))
                  (T (LIST (LIST 'GREATERP (LIST (CONS (CONS V 1) 1)) NIL)))))
               (CAR V)))
      (SETQ FORALL-ENDPTR (LASTPAIR FORALL-ENDPTR))
      (SETQ V (CDR V))
      (GO LOOPLABEL))) 
(PUT 'OFSF_LPVARL 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_LPVARL 'DEFINED-ON-LINE '344) 
(PUT 'OFSF_LPVARL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_LPVARL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_LPVARL (U)
    (COND ((IDP U) (LIST U))
          ((PAIRP U)
           (COND
            ((NOT
              (OR (MEMQ (CAR U) '(LESSP LEQ EQUAL NEQ GEQ GREATERP))
                  (OFSF_ARITHP (CAR U)) (OFSF_RXFFN (CAR U))))
             (LIST (*A2K U)))
            (T
             (PROG (ARG FORALL-RESULT FORALL-ENDPTR)
               (SETQ ARG (CDR U))
              STARTOVER
               (COND ((NULL ARG) (RETURN NIL)))
               (SETQ FORALL-RESULT
                       ((LAMBDA (ARG) (OFSF_LPVARL ARG)) (CAR ARG)))
               (SETQ FORALL-ENDPTR (LASTPAIR FORALL-RESULT))
               (SETQ ARG (CDR ARG))
               (COND ((ATOM FORALL-ENDPTR) (GO STARTOVER)))
              LOOPLABEL
               (COND ((NULL ARG) (RETURN FORALL-RESULT)))
               (RPLACD FORALL-ENDPTR
                       ((LAMBDA (ARG) (OFSF_LPVARL ARG)) (CAR ARG)))
               (SETQ FORALL-ENDPTR (LASTPAIR FORALL-ENDPTR))
               (SETQ ARG (CDR ARG))
               (GO LOOPLABEL))))))) 
(PUT 'OFSF_ARITHP 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_ARITHP 'DEFINED-ON-LINE '354) 
(PUT 'OFSF_ARITHP 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_ARITHP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_ARITHP (OP) (MEMQ OP '(PLUS MINUS TIMES EXPT QUOTIENT))) 
(PUT 'OFSF_RESOLVE 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_RESOLVE 'DEFINED-ON-LINE '357) 
(PUT 'OFSF_RESOLVE 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_RESOLVE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_RESOLVE (F) (OFSF_RESOLVE21 F NIL)) 
(PUT 'OFSF_POSRESOLVE 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_POSRESOLVE 'DEFINED-ON-LINE '360) 
(PUT 'OFSF_POSRESOLVE 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_POSRESOLVE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_POSRESOLVE (F) (OFSF_RESOLVE21 (OFSF_POSPREP F T) T)) 
(PUT 'OFSF_RESOLVE21 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_RESOLVE21 'DEFINED-ON-LINE '363) 
(PUT 'OFSF_RESOLVE21 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_RESOLVE21 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_RESOLVE21 (F POSP)
    (PROG (W)
      (SETQ W (CL_APPLY2ATS F (FUNCTION OFSF_RESOLVE2TOPMINMAX)))
      (SETQ W (CL_SIMPL W NIL (MINUS 1)))
      ((LAMBDA (*RLPOS) (SETQ W (CL_RESOLVE W))) POSP)
      ((LAMBDA (*RLPOS) (SETQ W (CL_SIMPL W NIL (MINUS 1)))) POSP)
      (RETURN W))) 
(PUT 'OFSF_RESOLVE2TOPMINMAX 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_RESOLVE2TOPMINMAX 'DEFINED-ON-LINE '375) 
(PUT 'OFSF_RESOLVE2TOPMINMAX 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_RESOLVE2TOPMINMAX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_RESOLVE2TOPMINMAX (AT)
    (PROG (LHS REL OP)
      (SETQ REL (CAR AT))
      (SETQ LHS (PREPF (CADR AT)))
      (COND ((NOT (PAIRP LHS)) (RETURN AT)))
      (SETQ OP (CAR LHS))
      (COND
       ((EQ OP 'MINUS)
        (PROGN
         (SETQ REL (OFSF_ANEGREL REL))
         (SETQ LHS (CADR LHS))
         (COND ((NOT (PAIRP LHS)) (RETURN AT)))
         (SETQ OP (CAR LHS)))))
      (COND
       ((NOT (AND (MEMQ OP '(MIN MAX)) (MEMQ REL '(LESSP GREATERP LEQ GEQ))))
        (RETURN AT)))
      (RETURN (OFSF_RESOLVEMINMAX REL OP (CDR LHS))))) 
(PUT 'OFSF_RESOLVEMINMAX 'NUMBER-OF-ARGS 3) 
(PUT 'OFSF_RESOLVEMINMAX 'DEFINED-ON-LINE '394) 
(PUT 'OFSF_RESOLVEMINMAX 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_RESOLVEMINMAX 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE OFSF_RESOLVEMINMAX (REL OP ARGL)
    (PROG (BOP)
      (SETQ BOP
              (COND
               ((OR (AND (EQ OP 'MIN) (MEMQ REL '(LESSP LEQ)))
                    (AND (EQ OP 'MAX) (MEMQ REL '(GREATERP GEQ))))
                'OR)
               (T 'AND)))
      (RETURN
       (CONS BOP
             (PROG (ARG FORALL-RESULT FORALL-ENDPTR)
               (SETQ ARG ARGL)
               (COND ((NULL ARG) (RETURN NIL)))
               (SETQ FORALL-RESULT
                       (SETQ FORALL-ENDPTR
                               (CONS
                                ((LAMBDA (ARG) (RL_SIMP (LIST REL ARG 0)))
                                 (CAR ARG))
                                NIL)))
              LOOPLABEL
               (SETQ ARG (CDR ARG))
               (COND ((NULL ARG) (RETURN FORALL-RESULT)))
               (RPLACD FORALL-ENDPTR
                       (CONS
                        ((LAMBDA (ARG) (RL_SIMP (LIST REL ARG 0))) (CAR ARG))
                        NIL))
               (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
               (GO LOOPLABEL)))))) 
(PUT 'OFSF_RXFFN-ABS 'NUMBER-OF-ARGS 4) 
(PUT 'OFSF_RXFFN-ABS 'DEFINED-ON-LINE '406) 
(PUT 'OFSF_RXFFN-ABS 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_RXFFN-ABS 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE OFSF_RXFFN-ABS (OP ARGL CONDL QLL)
    (COND
     ((CDR ARGL)
      (REDERR (LIST "ofsf_rxffn!-abs: length(argl)=" (LENGTH ARGL))))
     ((OFSF_SUREP (LIST 'GEQ (OFSF_SIMPTERM (CAR ARGL)) NIL) NIL)
      (LIST (RC_MK (CAR ARGL) (CONS 'AND CONDL) (LTO_APPENDN QLL))))
     ((OFSF_SUREP (LIST 'LESSP (OFSF_SIMPTERM (CAR ARGL)) NIL) NIL)
      (LIST
       (RC_MK (LIST 'MINUS (CAR ARGL)) (CONS 'AND CONDL) (LTO_APPENDN QLL))))
     (T
      (LIST
       (RC_MK (CAR ARGL) (CONS 'AND (CONS (LIST 'GEQ (CAR ARGL) 0) CONDL))
              (LTO_APPENDN QLL))
       (RC_MK (LIST 'MINUS (CAR ARGL))
              (CONS 'AND (CONS (LIST 'LEQ (CAR ARGL) 0) CONDL))
              (LTO_APPENDN QLL)))))) 
(PUT 'OFSF_RXFFN 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_RXFFN 'DEFINED-ON-LINE '423) 
(PUT 'OFSF_RXFFN 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_RXFFN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_RXFFN (OP)
    (COND ((EQ OP 'MAX) 'CL_RXFFN-MAX) ((EQ OP 'MIN) 'CL_RXFFN-MAX)
          ((EQ OP 'ABS) 'OFSF_RXFFN-ABS) ((EQ OP 'SIGN) 'CL_RXFFN-SIGN)
          ((EQ OP 'SQRT) 'CL_RXFFN-SQRT) (T NIL))) 
(PUT 'OFSF_TAN2 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_TAN2 'DEFINED-ON-LINE '437) 
(PUT 'OFSF_TAN2 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_TAN2 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_TAN2 (F) (CL_APPLY2ATS F (FUNCTION OFSF_TAN2AT))) 
(PUT 'OFSF_TAN2AT 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_TAN2AT 'DEFINED-ON-LINE '440) 
(PUT 'OFSF_TAN2AT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_TAN2AT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_TAN2AT (F) (LIST (CAR F) (CAR (OFSF_TAN2F (CADR F))) NIL)) 
(FLAG '(TAN2) 'OPFN) 
(PUT 'TAN2 'NUMBER-OF-ARGS 1) 
(PUT 'TAN2 'DEFINED-ON-LINE '445) 
(PUT 'TAN2 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'TAN2 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE TAN2 (U)
    ((LAMBDA (W)
       (MK*SQ (MULTSQ (OFSF_TAN2F (CAR W)) (INVSQ (OFSF_TAN2F (CDR W))))))
     (SIMP U))) 
(PUT 'OFSF_TAN2F 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_TAN2F 'DEFINED-ON-LINE '448) 
(PUT 'OFSF_TAN2F 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_TAN2F 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_TAN2F (U)
    (COND ((OR (ATOM U) (ATOM (CAR U))) (CONS U 1))
          (T
           (ADDSQ
            (MULTSQ (OFSF_TAN2F (CDAR U))
                    (EXPTSQ (OFSF_TAN2K (CAAAR U)) (CDAAR U)))
            (OFSF_TAN2F (CDR U)))))) 
(PUT 'OFSF_TAN2K 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_TAN2K 'DEFINED-ON-LINE '456) 
(PUT 'OFSF_TAN2K 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_TAN2K 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_TAN2K (K)
    (COND ((EQCAR K 'SIN) (SIMP (OFSF_TAN2K-SIN K)))
          ((EQCAR K 'COS) (SIMP (OFSF_TAN2K-COS K)))
          ((EQCAR K 'TAN) (SIMP (OFSF_TAN2K-TAN K)))
          ((EQCAR K 'COT) (SIMP (OFSF_TAN2K-COT K)))
          ((EQCAR K 'SEC) (SIMP (OFSF_TAN2K-SEC K)))
          ((EQCAR K 'CSC) (SIMP (OFSF_TAN2K-CSC K)))
          (T (CONS (LIST (CONS (CONS K 1) 1)) 1)))) 
(PUT 'OFSF_TAN2K-SIN 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_TAN2K-SIN 'DEFINED-ON-LINE '472) 
(PUT 'OFSF_TAN2K-SIN 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_TAN2K-SIN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_TAN2K-SIN (K)
    (PROG (TT)
      (SETQ TT (OFSF_MKTAN2 (CADR K)))
      (RETURN
       (LIST 'QUOTIENT (LIST 'TIMES 2 TT) (LIST 'PLUS 1 (LIST 'EXPT TT 2)))))) 
(PUT 'OFSF_TAN2K-COS 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_TAN2K-COS 'DEFINED-ON-LINE '478) 
(PUT 'OFSF_TAN2K-COS 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_TAN2K-COS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_TAN2K-COS (K)
    (PROG (TT)
      (SETQ TT (OFSF_MKTAN2 (CADR K)))
      (RETURN
       (LIST 'QUOTIENT (LIST 'DIFFERENCE 1 (LIST 'EXPT TT 2))
             (LIST 'PLUS 1 (LIST 'EXPT TT 2)))))) 
(PUT 'OFSF_TAN2K-TAN 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_TAN2K-TAN 'DEFINED-ON-LINE '484) 
(PUT 'OFSF_TAN2K-TAN 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_TAN2K-TAN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_TAN2K-TAN (K)
    (PROG (TT)
      (SETQ TT (OFSF_MKTAN2 (CADR K)))
      (RETURN
       (LIST 'QUOTIENT (LIST 'TIMES 2 TT)
             (LIST 'DIFFERENCE 1 (LIST 'EXPT TT 2)))))) 
(PUT 'OFSF_TAN2K-COT 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_TAN2K-COT 'DEFINED-ON-LINE '490) 
(PUT 'OFSF_TAN2K-COT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_TAN2K-COT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_TAN2K-COT (K)
    (PROG (TT)
      (SETQ TT (OFSF_MKTAN2 (CADR K)))
      (RETURN
       (LIST 'QUOTIENT (LIST 'DIFFERENCE 1 (LIST 'EXPT TT 2))
             (LIST 'TIMES 2 TT))))) 
(PUT 'OFSF_TAN2K-SEC 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_TAN2K-SEC 'DEFINED-ON-LINE '496) 
(PUT 'OFSF_TAN2K-SEC 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_TAN2K-SEC 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_TAN2K-SEC (K)
    (PROG (TT)
      (SETQ TT (OFSF_MKTAN2 (CADR K)))
      (RETURN
       (LIST 'QUOTIENT (LIST 'PLUS 1 (LIST 'EXPT TT 2))
             (LIST 'DIFFERENCE 1 (LIST 'EXPT TT 2)))))) 
(PUT 'OFSF_TAN2K-CSC 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_TAN2K-CSC 'DEFINED-ON-LINE '502) 
(PUT 'OFSF_TAN2K-CSC 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_TAN2K-CSC 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_TAN2K-CSC (K)
    (PROG (TT)
      (SETQ TT (OFSF_MKTAN2 (CADR K)))
      (RETURN
       (LIST 'QUOTIENT (LIST 'PLUS 1 (LIST 'EXPT TT 2)) (LIST 'TIMES 2 TT))))) 
(AEVAL (OPERATOR (LIST 'TN))) 
(PUT 'OFSF_MKTAN2 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_MKTAN2 'DEFINED-ON-LINE '510) 
(PUT 'OFSF_MKTAN2 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_MKTAN2 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_MKTAN2 (PHI) (LIST 'TAN (LIST 'QUOTIENT PHI 2))) 
(PUT 'OFSF_DFGPRINTV 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_DFGPRINTV 'DEFINED-ON-LINE '513) 
(PUT 'OFSF_DFGPRINTV 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_DFGPRINTV 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_DFGPRINTV (V) (PROGN (PRIN2 V) (PRIN2 ":Real"))) 
(PUT 'OFSF_DFGPRINTAT 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_DFGPRINTAT 'DEFINED-ON-LINE '520) 
(PUT 'OFSF_DFGPRINTAT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_DFGPRINTAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_DFGPRINTAT (F)
    (PROG (OPAL OP LHS W)
      (SETQ OP (COND ((ATOM F) F) (T (CAR F))))
      (SETQ LHS (PREPF (CADR F)))
      (COND
       ((EQ OP 'NEQ) (CL_DFGPRINTQFF (LIST 'NOT (LIST 'EQUAL (CADR F) NIL))))
       (T
        (PROGN
         (SETQ OPAL '((LESSP . LS) (LEQ . LE) (GREATERP . GS) (GEQ . GE)))
         (PRIN2 (COND ((SETQ W (ATSOC OP OPAL)) (CDR W)) (T OP)))
         (PRIN2 "(")
         (OFSF_DFGPRINTT LHS)
         (PRIN2 ",")
         (PRIN2 "0)")))))) 
(PUT 'OFSF_DFGPRINTT 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_DFGPRINTT 'DEFINED-ON-LINE '536) 
(PUT 'OFSF_DFGPRINTT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_DFGPRINTT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_DFGPRINTT (U)
    (COND ((OR (NUMBERP U) (IDP U)) (PRIN2 U))
          (T (OFSF_DFGPRINTT1 (CAR U) (CDR U))))) 
(PUT 'OFSF_DFGPRINTT1 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_DFGPRINTT1 'DEFINED-ON-LINE '542) 
(PUT 'OFSF_DFGPRINTT1 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_DFGPRINTT1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_DFGPRINTT1 (OP ARGL)
    (COND
     ((EQ OP 'MINUS)
      (PROGN
       (PRIN2 "minus(")
       (PRIN2 "0")
       (PRIN2 ",")
       (OFSF_DFGPRINTT (CAR ARGL))
       (PRIN2 ")")))
     ((EQ OP 'DIFFERENCE)
      (PROGN
       (PRIN2 "minus(")
       (OFSF_DFGPRINTT (CAR ARGL))
       (PRIN2 ",")
       (OFSF_DFGPRINTT (CADR ARGL))
       (PRIN2 ")")))
     ((EQ OP 'EXPT)
      (PROGN
       (PRIN2 "pow(")
       (OFSF_DFGPRINTT (CAR ARGL))
       (PRIN2 ",")
       (OFSF_DFGPRINTT (CADR ARGL))
       (PRIN2 ")")))
     (T
      (PROGN
       (COND ((NOT (CDR ARGL)) (OFSF_DFGPRINTT (CAR ARGL)))
             (T
              (PROGN
               (PRIN2 (COND ((EQ OP 'TIMES) "mult") (T OP)))
               (PRIN2 "(")
               (OFSF_DFGPRINTT (CAR ARGL))
               (PRIN2 ",")
               (OFSF_DFGPRINTT1 OP (CDR ARGL))
               (PRIN2 ")")))))))) 
(PUT 'OFSF_SMT2PRINTLOGIC 'NUMBER-OF-ARGS 0) 
(PUT 'OFSF_SMT2PRINTLOGIC 'DEFINED-ON-LINE '574) 
(PUT 'OFSF_SMT2PRINTLOGIC 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_SMT2PRINTLOGIC 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE OFSF_SMT2PRINTLOGIC NIL (PRIN2T "(set-logic QF_NRA)")) 
(PUT 'OFSF_SMT2PRINTAT 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_SMT2PRINTAT 'DEFINED-ON-LINE '577) 
(PUT 'OFSF_SMT2PRINTAT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_SMT2PRINTAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_SMT2PRINTAT (F)
    (PROG (OPAL OP LHS W)
      (SETQ OP (COND ((ATOM F) F) (T (CAR F))))
      (SETQ LHS (PREPF (CADR F)))
      (COND
       ((EQ OP 'NEQ) (CL_SMT2PRINTQFF (LIST 'NOT (LIST 'EQUAL (CADR F) NIL))))
       (T
        (PROGN
         (SETQ OPAL
                 '((LESSP . "<") (LEQ . "<=") (GREATERP . ">") (GEQ . ">=")
                   (EQUAL . "=")))
         (PRIN2 "(")
         (PRIN2 (COND ((SETQ W (ATSOC OP OPAL)) (CDR W)) (T OP)))
         (PRIN2 " ")
         (OFSF_SMT2PRINTT LHS)
         (PRIN2 " 0)")))))) 
(PUT 'OFSF_SMT2PRINTT 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_SMT2PRINTT 'DEFINED-ON-LINE '594) 
(PUT 'OFSF_SMT2PRINTT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_SMT2PRINTT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_SMT2PRINTT (U)
    (COND ((OR (NUMBERP U) (IDP U)) (PRIN2 U))
          (T (OFSF_SMT2PRINTT1 (CAR U) (CDR U))))) 
(PUT 'OFSF_SMT2PRINTT1 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_SMT2PRINTT1 'DEFINED-ON-LINE '600) 
(PUT 'OFSF_SMT2PRINTT1 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_SMT2PRINTT1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_SMT2PRINTT1 (OP ARGL)
    (COND
     ((EQ OP 'DIFFERENCE)
      (PROGN
       (PRIN2 "(- ")
       (OFSF_SMT2PRINTT (CAR ARGL))
       (PRIN2 " ")
       (OFSF_SMT2PRINTT (CADR ARGL))
       (PRIN2 ")")))
     ((EQ OP 'MINUS)
      (PROGN (PRIN2 "(- ") (OFSF_SMT2PRINTT (CAR ARGL)) (PRIN2 ")")))
     ((EQ OP 'PLUS)
      (PROGN
       (PRIN2 "(+ ")
       (PROG (RARGL)
         (SETQ RARGL ARGL)
        LAB
         (COND ((NULL RARGL) (RETURN NIL)))
         (PROGN (OFSF_SMT2PRINTT (CAR RARGL)) (COND ((CDR RARGL) (PRIN2 " "))))
         (SETQ RARGL (CDR RARGL))
         (GO LAB))
       (PRIN2 ")")))
     ((EQ OP 'TIMES)
      (PROGN
       (PRIN2 "(* ")
       (PROG (RARGL)
         (SETQ RARGL ARGL)
        LAB
         (COND ((NULL RARGL) (RETURN NIL)))
         (PROGN (OFSF_SMT2PRINTT (CAR RARGL)) (COND ((CDR RARGL) (PRIN2 " "))))
         (SETQ RARGL (CDR RARGL))
         (GO LAB))
       (PRIN2 ")")))
     ((EQ OP 'EXPT)
      (OFSF_SMT2PRINTT1 'TIMES
       (PROG (I FORALL-RESULT FORALL-ENDPTR)
         (SETQ I 1)
         (COND ((MINUSP (DIFFERENCE (CADR ARGL) I)) (RETURN NIL)))
         (SETQ FORALL-RESULT (SETQ FORALL-ENDPTR (CONS (CAR ARGL) NIL)))
        LOOPLABEL
         (SETQ I (PLUS2 I 1))
         (COND ((MINUSP (DIFFERENCE (CADR ARGL) I)) (RETURN FORALL-RESULT)))
         (RPLACD FORALL-ENDPTR (CONS (CAR ARGL) NIL))
         (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
         (GO LOOPLABEL)))))) 
(PUT 'OFSF_SMT2READAT 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_SMT2READAT 'DEFINED-ON-LINE '630) 
(PUT 'OFSF_SMT2READAT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_SMT2READAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_SMT2READAT (FORM)
    (PROG (OP W LHS RHS)
      (SETQ OP (CAR FORM))
      (SETQ W
              (ATSOC OP
                     '((>= . GEQ) (<= . LEQ) (< . LESSP) (> . GREATERP)
                       (= . EQUAL))))
      (COND
       ((NOT W)
        (ERROR 99
               (LTO_SCONCAT2 "expecting logic symbol but found "
                             (ID2STRING OP)))))
      (SETQ OP (CDR W))
      (SETQ LHS (OFSF_SMT2READTERM (CADR FORM)))
      (SETQ RHS (OFSF_SMT2READTERM (CADDR FORM)))
      (RETURN (LIST OP (CAR (ADDSQ LHS (NEGSQ RHS))) NIL)))) 
(PUT 'OFSF_SMT2READTERM 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_SMT2READTERM 'DEFINED-ON-LINE '644) 
(PUT 'OFSF_SMT2READTERM 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_SMT2READTERM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_SMT2READTERM (U) (SIMP (OFSF_SMT2READTERM1 U))) 
(PUT 'OFSF_SMT2READTERM1 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_SMT2READTERM1 'DEFINED-ON-LINE '647) 
(PUT 'OFSF_SMT2READTERM1 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_SMT2READTERM1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_SMT2READTERM1 (U)
    (PROG (OP W)
      (COND ((OR (ATOM U) (EQCAR U '|:DN:|) (EQCAR U '_)) (RETURN U)))
      (SETQ OP (CAR U))
      (SETQ W (ATSOC OP '((+ . PLUS) (- . MINUS) (* . TIMES) (/ . QUOTIENT))))
      (COND
       ((NOT W)
        (ERROR 99
               (LTO_SCONCAT2 "expecting arithmetic symbol but found "
                             (ID2STRING OP)))))
      (SETQ OP (CDR W))
      (COND ((AND (EQ OP 'MINUS) (CDDR U)) (SETQ OP 'DIFFERENCE)))
      (RETURN
       (CONS OP
             (PROG (ARG FORALL-RESULT FORALL-ENDPTR)
               (SETQ ARG (CDR U))
               (COND ((NULL ARG) (RETURN NIL)))
               (SETQ FORALL-RESULT
                       (SETQ FORALL-ENDPTR
                               (CONS
                                ((LAMBDA (ARG) (OFSF_SMT2READTERM1 ARG))
                                 (CAR ARG))
                                NIL)))
              LOOPLABEL
               (SETQ ARG (CDR ARG))
               (COND ((NULL ARG) (RETURN FORALL-RESULT)))
               (RPLACD FORALL-ENDPTR
                       (CONS
                        ((LAMBDA (ARG) (OFSF_SMT2READTERM1 ARG)) (CAR ARG))
                        NIL))
               (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
               (GO LOOPLABEL)))))) 
(PUT 'OFSF_FLOAT2DN 'NUMBER-OF-ARGS 1) 
(PUT 'OFSF_FLOAT2DN 'DEFINED-ON-LINE '662) 
(PUT 'OFSF_FLOAT2DN 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_FLOAT2DN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OFSF_FLOAT2DN (X)
    (PROG (W DOTPOS)
      (SETQ DOTPOS 0)
      (SETQ W (EXPLODE X))
      (SETQ DOTPOS (LENGTH (MEMQ '|.| W)))
      (PRIN2T W)
      (RETURN
       (CONS '|:DN:|
             (CONS
              (COMPRESS
               (PROG (D FORALL-RESULT FORALL-ENDPTR)
                 (SETQ D W)
                STARTOVER
                 (COND ((NULL D) (RETURN NIL)))
                 (SETQ FORALL-RESULT
                         ((LAMBDA (D) (COND ((NOT (EQ D '|.|)) (LIST D))))
                          (CAR D)))
                 (SETQ FORALL-ENDPTR (LASTPAIR FORALL-RESULT))
                 (SETQ D (CDR D))
                 (COND ((ATOM FORALL-ENDPTR) (GO STARTOVER)))
                LOOPLABEL
                 (COND ((NULL D) (RETURN FORALL-RESULT)))
                 (RPLACD FORALL-ENDPTR
                         ((LAMBDA (D) (COND ((NOT (EQ D '|.|)) (LIST D))))
                          (CAR D)))
                 (SETQ FORALL-ENDPTR (LASTPAIR FORALL-ENDPTR))
                 (SETQ D (CDR D))
                 (GO LOOPLABEL)))
              (MINUS DOTPOS)))))) 
(RL_PROVIDESERVICE 'RL_DIMA 'OFSF_DIMA NIL) 
(PUT 'OFSF_DIMA 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_DIMA 'DEFINED-ON-LINE '672) 
(PUT 'OFSF_DIMA 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_DIMA 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_DIMA (QL P)
    (PROG (W XL YL PT QTL PTT SYS SL0 SL K N)
      (SETQ K 0)
      (SETQ N 0)
      (PROG (Q)
        (SETQ Q QL)
       LAB
        (COND ((NULL Q) (RETURN NIL)))
        ((LAMBDA (Q) (SETQ XL (UNION (KERNELS Q) XL))) (CAR Q))
        (SETQ Q (CDR Q))
        (GO LAB))
      (SETQ XL (SORT XL 'ORDP))
      (SETQ N (LENGTH XL))
      (SETQ YL (KERNELS P))
      (SETQ K (LENGTH YL))
      (COND
       ((NEQ K (LENGTH QL))
        (REDERR
         (LIST "size of Q does not match number of vars in P" K (LENGTH YL)))))
      (COND
       ((SETQ W (INTERSECTION XL YL))
        (REDERR (LIST W "occur in both Q and P"))))
      (PROG (G272 G273)
        (SETQ G272 (OFSF_DIMA-P1 XL QL YL P))
        (SETQ G273 G272)
        (SETQ XL (CAR G272))
        (SETQ G272 (CDR G272))
        (SETQ QL (CAR G272))
        (SETQ G272 (CDR G272))
        (SETQ YL (CAR G272))
        (SETQ G272 (CDR G272))
        (SETQ PT (CAR G272))
        (SETQ G272 (CDR G272))
        (RETURN G273))
      (SETQ QTL (OFSF_DIMA-P2 XL QL K))
      (SETQ PTT (OFSF_DIMA-SUBF PT YL QTL))
      (SETQ PTT (ADDF PTT (NEGF (LIST (CONS (CONS 'EPSILON1 1) 1)))))
      (SETQ SYS (OFSF_DIMA-MKSYS XL QTL YL PT))
      (SETQ SL0 (OFSF_DIMA-PGAUSS SYS XL))
      (SETQ SL (OFSF-DIMA-SOL2FORMULAS PTT SL0 YL))
      (RETURN SL))) 
(PUT 'OFSF_DIMA-SUBF 'NUMBER-OF-ARGS 3) 
(PUT 'OFSF_DIMA-SUBF 'DEFINED-ON-LINE '699) 
(PUT 'OFSF_DIMA-SUBF 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_DIMA-SUBF 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE OFSF_DIMA-SUBF (F VL FL)
    (PROG (AL V F1)
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND VL FL)) (RETURN NIL)))
        (PROGN
         (SETQ V (PROG1 (CAR VL) (SETQ VL (CDR VL))))
         (SETQ F1 (CONS (PROG1 (CAR FL) (SETQ FL (CDR FL))) 1))
         (SETQ AL (CONS (CONS V F1) AL)))
        (GO WHILELABEL))
      (COND (NIL NIL))
      (RETURN (CAR (OFSF_SIATSUBF F AL))))) 
(PUT 'OFSF_DIMA-P1 'NUMBER-OF-ARGS 4) 
(PUT 'OFSF_DIMA-P1 'DEFINED-ON-LINE '710) 
(PUT 'OFSF_DIMA-P1 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_DIMA-P1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE OFSF_DIMA-P1 (XL QL YL P)
    (PROG (Y0 X0 PT Q0 S)
      (SETQ Y0 '|_Y0|)
      (SETQ YL (CONS Y0 YL))
      (SETQ PT (ADDF (EXPTF (LIST (CONS (CONS Y0 1) 1)) 2) P))
      (SETQ X0 '|_X0|)
      (SETQ XL (CONS X0 XL))
      (SETQ S
              (OFSF_DIMA-SIGMA
               (PROG (X FORALL-RESULT FORALL-ENDPTR)
                 (SETQ X XL)
                 (COND ((NULL X) (RETURN NIL)))
                 (SETQ FORALL-RESULT
                         (SETQ FORALL-ENDPTR
                                 (CONS ((LAMBDA (X) 1) (CAR X)) NIL)))
                LOOPLABEL
                 (SETQ X (CDR X))
                 (COND ((NULL X) (RETURN FORALL-RESULT)))
                 (RPLACD FORALL-ENDPTR (CONS ((LAMBDA (X) 1) (CAR X)) NIL))
                 (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                 (GO LOOPLABEL))
               XL))
      (SETQ Q0
              (ADDF 1
                    (NEGF
                     ((LAMBDA (G274)
                        (COND (*PHYSOP-LOADED (PHYSOP-MULTF G274 S))
                              (T (POLY-MULTF G274 S))))
                      (EXPTF (LIST (CONS (CONS 'EPSILON0 1) 1)) 2)))))
      (SETQ QL (CONS Q0 QL))
      (RETURN (LIST XL QL YL PT)))) 
(PUT 'OFSF_DIMA-SIGMA 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_DIMA-SIGMA 'DEFINED-ON-LINE '723) 
(PUT 'OFSF_DIMA-SIGMA 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_DIMA-SIGMA 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_DIMA-SIGMA (CL XL)
    (PROG (XSQL S)
      (SETQ XSQL
              (PROG (X FORALL-RESULT FORALL-ENDPTR)
                (SETQ X XL)
                (COND ((NULL X) (RETURN NIL)))
                (SETQ FORALL-RESULT
                        (SETQ FORALL-ENDPTR
                                (CONS
                                 ((LAMBDA (X)
                                    (EXPTF (LIST (CONS (CONS X 1) 1)) 2))
                                  (CAR X))
                                 NIL)))
               LOOPLABEL
                (SETQ X (CDR X))
                (COND ((NULL X) (RETURN FORALL-RESULT)))
                (RPLACD FORALL-ENDPTR
                        (CONS
                         ((LAMBDA (X) (EXPTF (LIST (CONS (CONS X 1) 1)) 2))
                          (CAR X))
                         NIL))
                (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                (GO LOOPLABEL)))
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND CL XSQL)) (RETURN NIL)))
        (SETQ S
                (ADDF S
                      ((LAMBDA (G276 G277)
                         (COND (*PHYSOP-LOADED (PHYSOP-MULTF G276 G277))
                               (T (POLY-MULTF G276 G277))))
                       (PROG1 (CAR CL) (SETQ CL (CDR CL)))
                       (PROG1 (CAR XSQL) (SETQ XSQL (CDR XSQL))))))
        (GO WHILELABEL))
      (COND (NIL NIL))
      (RETURN S))) 
(PUT 'OFSF_DIMA-P2 'NUMBER-OF-ARGS 3) 
(PUT 'OFSF_DIMA-P2 'DEFINED-ON-LINE '732) 
(PUT 'OFSF_DIMA-P2 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_DIMA-P2 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE OFSF_DIMA-P2 (XL QL K)
    (PROG (QTL CL J TN)
      (SETQ J 0)
      (SETQ TN 0)
      (SETQ TN (LENGTH XL))
      (SETQ QTL
              (PROG (J FORALL-RESULT FORALL-ENDPTR)
                (SETQ J 0)
                (COND ((MINUSP (DIFFERENCE K J)) (RETURN NIL)))
                (SETQ FORALL-RESULT
                        (SETQ FORALL-ENDPTR
                                (CONS
                                 (PROGN
                                  (SETQ CL
                                          (PROG (I FORALL-RESULT FORALL-ENDPTR)
                                            (SETQ I 1)
                                            (COND
                                             ((MINUSP (DIFFERENCE TN I))
                                              (RETURN NIL)))
                                            (SETQ FORALL-RESULT
                                                    (SETQ FORALL-ENDPTR
                                                            (CONS (EXPT I J)
                                                                  NIL)))
                                           LOOPLABEL
                                            (SETQ I (PLUS2 I 1))
                                            (COND
                                             ((MINUSP (DIFFERENCE TN I))
                                              (RETURN FORALL-RESULT)))
                                            (RPLACD FORALL-ENDPTR
                                                    (CONS (EXPT I J) NIL))
                                            (SETQ FORALL-ENDPTR
                                                    (CDR FORALL-ENDPTR))
                                            (GO LOOPLABEL)))
                                  (ADDF (PROG1 (CAR QL) (SETQ QL (CDR QL)))
                                        ((LAMBDA (G278 G279)
                                           (COND
                                            (*PHYSOP-LOADED
                                             (PHYSOP-MULTF G278 G279))
                                            (T (POLY-MULTF G278 G279))))
                                         (LIST (CONS (CONS 'EPSILON2 1) 1))
                                         (OFSF_DIMA-SIGMA CL XL))))
                                 NIL)))
               LOOPLABEL
                (SETQ J (PLUS2 J 1))
                (COND ((MINUSP (DIFFERENCE K J)) (RETURN FORALL-RESULT)))
                (RPLACD FORALL-ENDPTR
                        (CONS
                         (PROGN
                          (SETQ CL
                                  (PROG (I FORALL-RESULT FORALL-ENDPTR)
                                    (SETQ I 1)
                                    (COND
                                     ((MINUSP (DIFFERENCE TN I)) (RETURN NIL)))
                                    (SETQ FORALL-RESULT
                                            (SETQ FORALL-ENDPTR
                                                    (CONS (EXPT I J) NIL)))
                                   LOOPLABEL
                                    (SETQ I (PLUS2 I 1))
                                    (COND
                                     ((MINUSP (DIFFERENCE TN I))
                                      (RETURN FORALL-RESULT)))
                                    (RPLACD FORALL-ENDPTR
                                            (CONS (EXPT I J) NIL))
                                    (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                                    (GO LOOPLABEL)))
                          (ADDF (PROG1 (CAR QL) (SETQ QL (CDR QL)))
                                ((LAMBDA (G278 G279)
                                   (COND
                                    (*PHYSOP-LOADED (PHYSOP-MULTF G278 G279))
                                    (T (POLY-MULTF G278 G279))))
                                 (LIST (CONS (CONS 'EPSILON2 1) 1))
                                 (OFSF_DIMA-SIGMA CL XL))))
                         NIL))
                (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                (GO LOOPLABEL)))
      (COND (NIL NIL))
      (RETURN QTL))) 
(SWITCH (LIST 'RLDIMAINCLUDEFIRST)) 
(PUT 'OFSF_DIMA-MKSYS 'NUMBER-OF-ARGS 4) 
(PUT 'OFSF_DIMA-MKSYS 'DEFINED-ON-LINE '745) 
(PUT 'OFSF_DIMA-MKSYS 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_DIMA-MKSYS 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE OFSF_DIMA-MKSYS (XL QTL YL PT)
    (PROG (NABLAQTL NABLAPT SYS0 SYS LLAMBDA)
      (SETQ NABLAPT (OFSF_DIMA-GRADIENT PT YL))
      (SETQ NABLAQTL
              (PROG (X FORALL-RESULT FORALL-ENDPTR)
                (SETQ X XL)
                (COND ((NULL X) (RETURN NIL)))
                (SETQ FORALL-RESULT
                        (SETQ FORALL-ENDPTR
                                (CONS
                                 ((LAMBDA (X) (OFSF_DIMA-PARTIALL QTL X))
                                  (CAR X))
                                 NIL)))
               LOOPLABEL
                (SETQ X (CDR X))
                (COND ((NULL X) (RETURN FORALL-RESULT)))
                (RPLACD FORALL-ENDPTR
                        (CONS ((LAMBDA (X) (OFSF_DIMA-PARTIALL QTL X)) (CAR X))
                              NIL))
                (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                (GO LOOPLABEL)))
      (SETQ SYS0
              (PROG (PVEC FORALL-RESULT FORALL-ENDPTR)
                (SETQ PVEC NABLAQTL)
                (COND ((NULL PVEC) (RETURN NIL)))
                (SETQ FORALL-RESULT
                        (SETQ FORALL-ENDPTR
                                (CONS
                                 ((LAMBDA (PVEC)
                                    (OFSF_DIMA-SPROD NABLAPT PVEC))
                                  (CAR PVEC))
                                 NIL)))
               LOOPLABEL
                (SETQ PVEC (CDR PVEC))
                (COND ((NULL PVEC) (RETURN FORALL-RESULT)))
                (RPLACD FORALL-ENDPTR
                        (CONS
                         ((LAMBDA (PVEC) (OFSF_DIMA-SPROD NABLAPT PVEC))
                          (CAR PVEC))
                         NIL))
                (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                (GO LOOPLABEL)))
      (SETQ SYS
              (PROG (F FORALL-RESULT FORALL-ENDPTR)
                (SETQ F (CDR SYS0))
                (COND ((NULL F) (RETURN NIL)))
                (SETQ FORALL-RESULT
                        (SETQ FORALL-ENDPTR
                                (CONS
                                 ((LAMBDA (F) (LIST 'EQUAL F NIL)) (CAR F))
                                 NIL)))
               LOOPLABEL
                (SETQ F (CDR F))
                (COND ((NULL F) (RETURN FORALL-RESULT)))
                (RPLACD FORALL-ENDPTR
                        (CONS ((LAMBDA (F) (LIST 'EQUAL F NIL)) (CAR F)) NIL))
                (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                (GO LOOPLABEL)))
      (COND
       (*RLDIMAINCLUDEFIRST
        (PROGN
         (SETQ LLAMBDA (LIST (CONS (CONS (INTERN (GENSYM)) 1) 1)))
         (SETQ SYS
                 (CONS (LIST 'EQUAL (ADDF (CAR SYS0) (NEGF LLAMBDA)) NIL)
                       SYS)))))
      (RETURN SYS))) 
(PUT 'OFSF_DIMA-GRADIENT 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_DIMA-GRADIENT 'DEFINED-ON-LINE '761) 
(PUT 'OFSF_DIMA-GRADIENT 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_DIMA-GRADIENT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_DIMA-GRADIENT (P VL)
    (PROG (V FORALL-RESULT FORALL-ENDPTR)
      (SETQ V VL)
      (COND ((NULL V) (RETURN NIL)))
      (SETQ FORALL-RESULT
              (SETQ FORALL-ENDPTR
                      (CONS ((LAMBDA (V) (DIFF P V)) (CAR V)) NIL)))
     LOOPLABEL
      (SETQ V (CDR V))
      (COND ((NULL V) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR (CONS ((LAMBDA (V) (DIFF P V)) (CAR V)) NIL))
      (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
      (GO LOOPLABEL))) 
(PUT 'OFSF_DIMA-PARTIALL 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_DIMA-PARTIALL 'DEFINED-ON-LINE '764) 
(PUT 'OFSF_DIMA-PARTIALL 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_DIMA-PARTIALL 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_DIMA-PARTIALL (PL V)
    (PROG (P FORALL-RESULT FORALL-ENDPTR)
      (SETQ P PL)
      (COND ((NULL P) (RETURN NIL)))
      (SETQ FORALL-RESULT
              (SETQ FORALL-ENDPTR
                      (CONS ((LAMBDA (P) (DIFF P V)) (CAR P)) NIL)))
     LOOPLABEL
      (SETQ P (CDR P))
      (COND ((NULL P) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR (CONS ((LAMBDA (P) (DIFF P V)) (CAR P)) NIL))
      (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
      (GO LOOPLABEL))) 
(PUT 'OFSF_DIMA-SPROD 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_DIMA-SPROD 'DEFINED-ON-LINE '767) 
(PUT 'OFSF_DIMA-SPROD 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_DIMA-SPROD 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_DIMA-SPROD (L1 L2)
    (PROG (SP)
      (PROG (P)
        (SETQ P (LTO_ZIP L1 L2 (FUNCTION MULTF)))
       LAB
        (COND ((NULL P) (RETURN NIL)))
        ((LAMBDA (P) (SETQ SP (ADDF SP P))) (CAR P))
        (SETQ P (CDR P))
        (GO LAB))
      (RETURN SP))) 
(PUT 'OFSF_DIMA-PGAUSS 'NUMBER-OF-ARGS 2) 
(PUT 'OFSF_DIMA-PGAUSS 'DEFINED-ON-LINE '774) 
(PUT 'OFSF_DIMA-PGAUSS 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF_DIMA-PGAUSS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OFSF_DIMA-PGAUSS (EQL VL)
    (PROG (*PGSPSIMPL *PGNOARBCOMPLEX)
      (SETQ *PGSPSIMPL T)
      (SETQ *PGNOARBCOMPLEX T)
      (RETURN
       (PG_GAUSS-SYM
        (PROG (EQ FORALL-RESULT FORALL-ENDPTR)
          (SETQ EQ EQL)
          (COND ((NULL EQ) (RETURN NIL)))
          (SETQ FORALL-RESULT
                  (SETQ FORALL-ENDPTR
                          (CONS ((LAMBDA (EQ) (RL_PREPFOF EQ)) (CAR EQ)) NIL)))
         LOOPLABEL
          (SETQ EQ (CDR EQ))
          (COND ((NULL EQ) (RETURN FORALL-RESULT)))
          (RPLACD FORALL-ENDPTR
                  (CONS ((LAMBDA (EQ) (RL_PREPFOF EQ)) (CAR EQ)) NIL))
          (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
          (GO LOOPLABEL))
        VL)))) 
(PUT 'OFSF-DIMA-SOL2FORMULAS 'NUMBER-OF-ARGS 3) 
(PUT 'OFSF-DIMA-SOL2FORMULAS 'DEFINED-ON-LINE '782) 
(PUT 'OFSF-DIMA-SOL2FORMULAS 'DEFINED-IN-FILE 'REDLOG/OFSF/OFSFMISC.RED) 
(PUT 'OFSF-DIMA-SOL2FORMULAS 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE OFSF-DIMA-SOL2FORMULAS (PTT SL0 YL)
    (PROG (PHI XL VL SL W)
      (SETQ SL
              (PROG (S FORALL-RESULT FORALL-ENDPTR)
                (SETQ S SL0)
                (COND ((NULL S) (RETURN NIL)))
                (SETQ FORALL-RESULT
                        (SETQ FORALL-ENDPTR
                                (CONS
                                 ((LAMBDA (S)
                                    (PROGN
                                     (SETQ W (CAR (OFSF_SIATSUBF PTT (CDR S))))
                                     (SETQ PHI
                                             ((LAMBDA (G281)
                                                (COND
                                                 ((AND G281 (CDR G281))
                                                  (CONS 'AND G281))
                                                 ((NULL G281)
                                                  (COND ((EQ 'AND 'AND) 'TRUE)
                                                        (T 'FALSE)))
                                                 (T (CAR G281))))
                                              (REVERSE
                                               (CONS (LIST 'EQUAL W NIL)
                                                     (CAR S)))))
                                     (RL_EX PHI
                                            '(EPSILON0 EPSILON1 EPSILON2))))
                                  (CAR S))
                                 NIL)))
               LOOPLABEL
                (SETQ S (CDR S))
                (COND ((NULL S) (RETURN FORALL-RESULT)))
                (RPLACD FORALL-ENDPTR
                        (CONS
                         ((LAMBDA (S)
                            (PROGN
                             (SETQ W (CAR (OFSF_SIATSUBF PTT (CDR S))))
                             (SETQ PHI
                                     ((LAMBDA (G281)
                                        (COND
                                         ((AND G281 (CDR G281))
                                          (CONS 'AND G281))
                                         ((NULL G281)
                                          (COND ((EQ 'AND 'AND) 'TRUE)
                                                (T 'FALSE)))
                                         (T (CAR G281))))
                                      (REVERSE
                                       (CONS (LIST 'EQUAL W NIL) (CAR S)))))
                             (RL_EX PHI '(EPSILON0 EPSILON1 EPSILON2))))
                          (CAR S))
                         NIL))
                (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                (GO LOOPLABEL)))
      (RETURN SL))) 
(PUT 'OFSF_SYMBOLIFY 'NUMBER-OF-ARGS 1) 
(DE OFSF_SYMBOLIFY (F)
    (PROG (W)
      (SETQ W (OFSF_SYMBOLIFY1 F 0 NIL))
      (RETURN (CONS (CAR W) (REVERSIP (CADDR W)))))) 
(PUT 'OFSF_SYMBOLIFY1 'NUMBER-OF-ARGS 3) 
(DE OFSF_SYMBOLIFY1 (F C SUBL)
    (PROG (OP W NARGL)
      (SETQ OP (COND ((ATOM F) F) (T (CAR F))))
      (COND ((OR (EQ OP 'TRUE) (EQ OP 'FALSE)) (RETURN (LIST F C SUBL))))
      (COND
       ((OR (EQ OP 'EX) (EQ OP 'ALL))
        (PROGN
         (PROG (G282 G283)
           (SETQ G282 (OFSF_SYMBOLIFY1 (CADDR F) C SUBL))
           (SETQ G283 G282)
           (SETQ W (CAR G282))
           (SETQ G282 (CDR G282))
           (SETQ C (CAR G282))
           (SETQ G282 (CDR G282))
           (SETQ SUBL (CAR G282))
           (SETQ G282 (CDR G282))
           (RETURN G283))
         (RETURN (LIST (LIST OP (CADR F) W) C SUBL)))))
      (COND
       ((OR (OR (OR (EQ OP 'OR) (EQ OP 'AND)) (EQ OP 'NOT))
            (OR (EQ OP 'IMPL) (EQ OP 'REPL) (EQ OP 'EQUIV)))
        (PROGN
         (SETQ NARGL
                 (PROG (ARG FORALL-RESULT FORALL-ENDPTR)
                   (SETQ ARG (CDR F))
                   (COND ((NULL ARG) (RETURN NIL)))
                   (SETQ FORALL-RESULT
                           (SETQ FORALL-ENDPTR
                                   (CONS
                                    ((LAMBDA (ARG)
                                       (PROGN
                                        (PROG (G284 G285)
                                          (SETQ G284
                                                  (OFSF_SYMBOLIFY1 ARG C SUBL))
                                          (SETQ G285 G284)
                                          (SETQ W (CAR G284))
                                          (SETQ G284 (CDR G284))
                                          (SETQ C (CAR G284))
                                          (SETQ G284 (CDR G284))
                                          (SETQ SUBL (CAR G284))
                                          (SETQ G284 (CDR G284))
                                          (RETURN G285))
                                        W))
                                     (CAR ARG))
                                    NIL)))
                  LOOPLABEL
                   (SETQ ARG (CDR ARG))
                   (COND ((NULL ARG) (RETURN FORALL-RESULT)))
                   (RPLACD FORALL-ENDPTR
                           (CONS
                            ((LAMBDA (ARG)
                               (PROGN
                                (PROG (G284 G285)
                                  (SETQ G284 (OFSF_SYMBOLIFY1 ARG C SUBL))
                                  (SETQ G285 G284)
                                  (SETQ W (CAR G284))
                                  (SETQ G284 (CDR G284))
                                  (SETQ C (CAR G284))
                                  (SETQ G284 (CDR G284))
                                  (SETQ SUBL (CAR G284))
                                  (SETQ G284 (CDR G284))
                                  (RETURN G285))
                                W))
                             (CAR ARG))
                            NIL))
                   (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                   (GO LOOPLABEL)))
         (RETURN (LIST (CONS OP NARGL) C SUBL)))))
      (PROG (G286 G287)
        (SETQ G286 (SFTO_SYMBOLIFY1 (CADR F) 'I C SUBL))
        (SETQ G287 G286)
        (SETQ W (CAR G286))
        (SETQ G286 (CDR G286))
        (SETQ C (CAR G286))
        (SETQ G286 (CDR G286))
        (SETQ SUBL (CAR G286))
        (SETQ G286 (CDR G286))
        (RETURN G287))
      (RETURN (LIST (LIST OP W NIL) C SUBL)))) 
(RL_PROVIDESERVICE 'RL_DUMP 'OFSF_DUMP NIL) 
(PUT 'OFSF_DUMP 'NUMBER-OF-ARGS 3) 
(DE OFSF_DUMP (F FORMAT FN)
    (COND ((EQ FORMAT 'QEPCAD) (QEPCAD_DUMP F FN (FUNCTION QEPCAD_PRINTER)))
          ((EQ FORMAT 'SLFQ)
           (QEPCAD_DUMP F FN
            (FUNCTION (LAMBDA (X) (MATHPRINT (RL_PREPFOF X))))))
          ((EQ FORMAT 'MATHEMATICA) (QEPCAD_DUMP F FN (FUNCTION MMA_PRINTER)))
          ((EQ FORMAT 'DFG) (CL_DFGPRINT F FN))
          ((EQ FORMAT 'SMT2) (CL_SMT2PRINT F FN NIL))
          (T
           (REDERR
            (LIST "rl_dump: format" FORMAT "not known for domain real"))))) 
(ENDMODULE) 