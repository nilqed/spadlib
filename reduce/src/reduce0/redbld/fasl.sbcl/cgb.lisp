(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(FLUID '(CGB_RCSID* CGB_COPYRIGHT*)) 
(SETQ CGB_RCSID* "$Id: cgb.red 5872 2021-07-29 14:53:49Z arthurcnorman $") 
(SETQ CGB_COPYRIGHT* "Copyright (c) 1999-2009 A. Dolzmann and T. Sturm") 
(MODULE (LIST 'CGB)) 
(CREATE-PACKAGE '(CGB GB DP GBSC) NIL) 
(LOADTIME (LOAD-PACKAGE 'EZGCD)) 
(LOADTIME (LOAD-PACKAGE 'GROEBNER)) 
(LOAD-PACKAGE 'REDLOG) 
(SWITCH
 (LIST 'CGBSTAT 'CGBFULLRED 'CGBVERBOSE 'CGBCONTRED 'CGBGS 'CGBREAL 'CGBSGREEN
       'CGBFAITHFUL)) 
(FLUID
 '(*CGBSTAT *CGBFULLRED *CGBVERBOSE *CGBCONTRED *CGBGS *CGBREAL *CGBGEN
   *CGBSLOPPY *CGBCDSIMPL *CGBFAITHFUL)) 
(OFF1 'CGBSTAT) 
(ON1 'CGBFULLRED) 
(OFF1 'CGBVERBOSE) 
(OFF1 'CGBCONTRED) 
(OFF1 'CGBGS) 
(OFF1 'CGBREAL) 
(OFF1 'CGBSGREEN) 
(OFF1 'CGBFAITHFUL) 
(SETQ *CGBSLOPPY T) 
(SETQ *CGBCDSIMPL T) 
(FLUID '(*CGBGREEN)) 
(FLUID '(*GCD *EZGCD *FACTOR *EXP DMODE* *MSG *BACKTRACE)) 
(FLUID '(CGP_PCOUNT* CGB_HASHSIZE*)) 
(SETQ CGB_HASHSIZE* 65521) 
(FLUID
 '(CGB_HCOUNT* CGB_HZEROCOUNT* CGB_TR1COUNT* CGB_TR2COUNT* CGB_TR3COUNT*
   CGB_B4COUNT* CGB_STRANGECOUNT* CGB_PAIRCOUNT* CGB_GCOUNT* CGB_GBCOUNT*)) 
(FLUID '(CGB_CD* CGB_MINCONTRED* CGB_CONTCOUNT*)) 
(SETQ CGB_MINCONTRED* 20) 
(FLUID '(*RLGSVB *RLSPGS *RLSITHOK *RLSIEXPLA)) 
(PUT 'CGB_MKINTERFACE 'DEFINED-ON-LINE '121) 
(PUT 'CGB_MKINTERFACE 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_MKINTERFACE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DM CGB_MKINTERFACE (ARGL)
    (PROG (A2SL1 A2SL2 DEFL XVFN S2A S2S S ARGS BNAME LEN SM PRGN AMI SMI PSVAL
           POSTFIX MODES)
      (SETQ BNAME (EVAL (NTH ARGL 2)))
      (SETQ A2SL1 (EVAL (NTH ARGL 3)))
      (SETQ A2SL2 (EVAL (NTH ARGL 4)))
      (SETQ DEFL (EVAL (NTH ARGL 5)))
      (SETQ XVFN (EVAL (NTH ARGL 6)))
      (SETQ S2A (EVAL (NTH ARGL 7)))
      (SETQ S2S (EVAL (NTH ARGL 8)))
      (SETQ S (EVAL (NTH ARGL 9)))
      (SETQ POSTFIX (EVAL (NTH ARGL 10)))
      (SETQ MODES (EVAL (NTH ARGL 11)))
      (SETQ LEN (LENGTH A2SL1))
      (SETQ ARGS
              (PROG (I FORALL-RESULT FORALL-ENDPTR)
                (SETQ I 1)
                (COND ((MINUSP (DIFFERENCE (PLUS LEN 3) I)) (RETURN NIL)))
                (SETQ FORALL-RESULT
                        (SETQ FORALL-ENDPTR (CONS (MKID 'A I) NIL)))
               LOOPLABEL
                (SETQ I (PLUS2 I 1))
                (COND
                 ((MINUSP (DIFFERENCE (PLUS LEN 3) I)) (RETURN FORALL-RESULT)))
                (RPLACD FORALL-ENDPTR (CONS (MKID 'A I) NIL))
                (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                (GO LOOPLABEL)))
      (COND
       ((OR (NULL MODES) (EQ MODES 'SM))
        (PROGN
         (SETQ SM (INTERN (COMPRESS (APPEND '(C G B _) (EXPLODE BNAME)))))
         (SETQ SMI (INTERN (COMPRESS (NCONC (EXPLODE SM) (EXPLODE POSTFIX)))))
         (SETQ PRGN
                 (CONS (LIST 'PUT (MKQUOTE SMI) ''NUMBER-OF-ARGS (PLUS LEN 3))
                       PRGN))
         (SETQ PRGN
                 (CONS
                  (LIST 'DE SMI ARGS
                        (LIST 'CGB_INTERFACE$ (MKQUOTE SM) (MKQUOTE A2SL1)
                              (MKQUOTE A2SL2) (MKQUOTE DEFL) (MKQUOTE XVFN)
                              (MKQUOTE S2A) (MKQUOTE S2S) (MKQUOTE S) T
                              (CONS 'LIST ARGS)))
                  PRGN)))))
      (COND
       ((OR (NULL MODES) (EQ MODES 'AM))
        (PROGN
         (SETQ AMI BNAME)
         (SETQ PSVAL (INTERN (COMPRESS (NCONC (EXPLODE AMI) '(! $)))))
         (SETQ PRGN
                 (CONS (LIST 'PUT (MKQUOTE AMI) ''PSOPFN (MKQUOTE PSVAL))
                       PRGN))
         (SETQ PRGN (CONS (LIST 'PUT (MKQUOTE PSVAL) ''NUMBER-OF-ARGS 1) PRGN))
         (SETQ PRGN
                 (CONS
                  (LIST 'DE PSVAL '(FORMALARGL)
                        (LIST 'CGB_INTERFACE$ (MKQUOTE SM) (MKQUOTE A2SL1)
                              (MKQUOTE A2SL2) (MKQUOTE DEFL) (MKQUOTE XVFN)
                              (MKQUOTE S2A) (MKQUOTE S2S) (MKQUOTE S) NIL
                              'FORMALARGL))
                  PRGN))
         NIL)))
      (RETURN (CONS 'PROGN PRGN)))) 
(DE CGB$ (FORMALARGL)
    (CGB_INTERFACE$ 'CGB_CGB '(CGB_A2S-PSYS CGB_A2S-CD)
     '(CGB_A2S2-PSYS CGB_A2S2-CD) '(TRUE) 'CGB_XVARS-PSYS2 'CGB_S2A-CGB
     'CGB_S2S-CGB 'T NIL FORMALARGL)) 
(PUT 'CGB$ 'NUMBER-OF-ARGS 1) 
(PUT 'CGB 'PSOPFN 'CGB$) 
(DE CGB_CGBF (A1 A2 A3 A4 A5)
    (CGB_INTERFACE$ 'CGB_CGB '(CGB_A2S-PSYS CGB_A2S-CD)
     '(CGB_A2S2-PSYS CGB_A2S2-CD) '(TRUE) 'CGB_XVARS-PSYS2 'CGB_S2A-CGB
     'CGB_S2S-CGB 'T T (LIST A1 A2 A3 A4 A5))) 
(PUT 'CGB_CGBF 'NUMBER-OF-ARGS 5) 
(DE GSYS$ (FORMALARGL)
    (CGB_INTERFACE$ 'CGB_GSYS '(CGB_A2S-PSYS CGB_A2S-CD)
     '(CGB_A2S2-PSYS CGB_A2S2-CD) '(TRUE) 'CGB_XVARS-PSYS2 'CGB_S2A-GSYS
     'CGB_S2S-GSYS 'T NIL FORMALARGL)) 
(PUT 'GSYS$ 'NUMBER-OF-ARGS 1) 
(PUT 'GSYS 'PSOPFN 'GSYS$) 
(DE CGB_GSYSF (A1 A2 A3 A4 A5)
    (CGB_INTERFACE$ 'CGB_GSYS '(CGB_A2S-PSYS CGB_A2S-CD)
     '(CGB_A2S2-PSYS CGB_A2S2-CD) '(TRUE) 'CGB_XVARS-PSYS2 'CGB_S2A-GSYS
     'CGB_S2S-GSYS 'T T (LIST A1 A2 A3 A4 A5))) 
(PUT 'CGB_GSYSF 'NUMBER-OF-ARGS 5) 
(DE GGSYS$ (FORMALARGL)
    (CGB_INTERFACE$ 'CGB_GGSYS '(CGB_A2S-PSYS CGB_A2S-CD CGB_A2S-VARL)
     '(CGB_A2S2-PSYS CGB_A2S2-CD CGB_A2S2-VARL) '(TRUE (LIST)) 'CGB_XVARS-PSYS3
     'CGB_S2A-GSYS 'CGB_S2S-GSYS 'T NIL FORMALARGL)) 
(PUT 'GGSYS$ 'NUMBER-OF-ARGS 1) 
(PUT 'GGSYS 'PSOPFN 'GGSYS$) 
(DE CGB_GGSYSF (A1 A2 A3 A4 A5 A6)
    (CGB_INTERFACE$ 'CGB_GGSYS '(CGB_A2S-PSYS CGB_A2S-CD CGB_A2S-VARL)
     '(CGB_A2S2-PSYS CGB_A2S2-CD CGB_A2S2-VARL) '(TRUE (LIST)) 'CGB_XVARS-PSYS3
     'CGB_S2A-GSYS 'CGB_S2S-GSYS 'T T (LIST A1 A2 A3 A4 A5 A6))) 
(PUT 'CGB_GGSYSF 'NUMBER-OF-ARGS 6) 
(DE GSYS2CGB$ (FORMALARGL)
    (CGB_INTERFACE$ 'CGB_GSYS2CGB '(CGB_A2S-GSYS) '(CGB_A2S2-GSYS) 'NIL
     'CGB_XVARS-GSYS 'CGB_S2A-CGB 'CGB_S2S-CGB 'T NIL FORMALARGL)) 
(PUT 'GSYS2CGB$ 'NUMBER-OF-ARGS 1) 
(PUT 'GSYS2CGB 'PSOPFN 'GSYS2CGB$) 
(DE CGB_GSYS2CGBF (A1 A2 A3 A4)
    (CGB_INTERFACE$ 'CGB_GSYS2CGB '(CGB_A2S-GSYS) '(CGB_A2S2-GSYS) 'NIL
     'CGB_XVARS-GSYS 'CGB_S2A-CGB 'CGB_S2S-CGB 'T T (LIST A1 A2 A3 A4))) 
(PUT 'CGB_GSYS2CGBF 'NUMBER-OF-ARGS 4) 
(PUT 'CGB_CGB 'GB_WRAPPER
     (LIST 'GB_GB0 '(GB_A2S-PSYS GB_DUMMY1) '(GB_A2S2-PSYS GB_DUMMY1)
           (LIST 'DUMMY) 'GB_XVARS-PSYS2 'GB_S2A-GBX 'GB_S2S-GB T)) 
(PUT 'CGB_GSYS 'GB_WRAPPER
     (LIST 'GB_GBGSYS0 '(GB_A2S-PSYS GB_DUMMY1) '(GB_A2S2-PSYS GB_DUMMY1)
           (LIST 'DUMMY) 'GB_XVARS-PSYS2 'GB_S2A-GSYS 'GB_S2S-GSYS T)) 
(PUT 'CGB_GGSYS 'GB_WRAPPER
     (LIST 'GB_GBGGSYS0 '(GB_A2S-PSYS GB_DUMMY1 GB_DUMMY1)
           '(GB_A2S2-PSYS GB_DUMMY1 GB_DUMMY1) (LIST 'DUMMY 'DUMMY)
           'GB_XVARS-PSYS3 'GB_S2A-GSYS 'GB_S2S-GSYS T)) 
(PUT 'CGB_A2S-PSYS 'NUMBER-OF-ARGS 1) 
(PUT 'CGB_A2S-PSYS 'DEFINED-ON-LINE '197) 
(PUT 'CGB_A2S-PSYS 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_A2S-PSYS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGB_A2S-PSYS (L)
    (PROG (W RESL)
      (PROG (J)
        (SETQ J (GETRLIST (REVAL1 L T)))
       LAB
        (COND ((NULL J) (RETURN NIL)))
        ((LAMBDA (J)
           (PROGN
            (SETQ W (CAR (SIMP J)))
            (COND ((AND W (NOT (MEMBER W RESL))) (SETQ RESL (CONS W RESL))))))
         (CAR J))
        (SETQ J (CDR J))
        (GO LAB))
      (RETURN (SORT RESL 'ORDP)))) 
(PUT 'CGB_A2S2-PSYS 'NUMBER-OF-ARGS 1) 
(PUT 'CGB_A2S2-PSYS 'DEFINED-ON-LINE '209) 
(PUT 'CGB_A2S2-PSYS 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_A2S2-PSYS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGB_A2S2-PSYS (FL)
    (PROG (X FORALL-RESULT FORALL-ENDPTR)
      (SETQ X FL)
      (COND ((NULL X) (RETURN NIL)))
      (SETQ FORALL-RESULT
              (SETQ FORALL-ENDPTR
                      (CONS ((LAMBDA (X) (CGP_F2CGP X)) (CAR X)) NIL)))
     LOOPLABEL
      (SETQ X (CDR X))
      (COND ((NULL X) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR (CONS ((LAMBDA (X) (CGP_F2CGP X)) (CAR X)) NIL))
      (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
      (GO LOOPLABEL))) 
(DE CGB_XVARS-PSYS (L VL) (CGB_VARS L VL)) 
(PUT 'CGB_XVARS-PSYS 'NUMBER-OF-ARGS 2) 
(PUT 'CGB_XVARS-PSYS 'DEFINED-ON-LINE '212) 
(PUT 'CGB_XVARS-PSYS 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_XVARS-PSYS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(PUTC 'CGB_XVARS-PSYS 'INLINE '(LAMBDA (L VL) (CGB_VARS L VL))) 
(DE CGB_XVARS-PSYS2 (L CD VL) (CGB_VARS L VL)) 
(PUT 'CGB_XVARS-PSYS2 'NUMBER-OF-ARGS 3) 
(PUT 'CGB_XVARS-PSYS2 'DEFINED-ON-LINE '215) 
(PUT 'CGB_XVARS-PSYS2 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_XVARS-PSYS2 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(PUTC 'CGB_XVARS-PSYS2 'INLINE '(LAMBDA (L CD VL) (CGB_VARS L VL))) 
(DE CGB_XVARS-PSYS3 (L CD XVL VL) (CGB_VARS L VL)) 
(PUT 'CGB_XVARS-PSYS3 'NUMBER-OF-ARGS 4) 
(PUT 'CGB_XVARS-PSYS3 'DEFINED-ON-LINE '218) 
(PUT 'CGB_XVARS-PSYS3 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_XVARS-PSYS3 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(PUTC 'CGB_XVARS-PSYS3 'INLINE '(LAMBDA (L CD XVL VL) (CGB_VARS L VL))) 
(PUT 'CGB_S2A-CGB 'NUMBER-OF-ARGS 1) 
(PUT 'CGB_S2A-CGB 'DEFINED-ON-LINE '221) 
(PUT 'CGB_S2A-CGB 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_S2A-CGB 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGB_S2A-CGB (U)
    (CONS 'LIST
          (PROG (X FORALL-RESULT FORALL-ENDPTR)
            (SETQ X U)
            (COND ((NULL X) (RETURN NIL)))
            (SETQ FORALL-RESULT
                    (SETQ FORALL-ENDPTR
                            (CONS ((LAMBDA (X) (CGP_2A X)) (CAR X)) NIL)))
           LOOPLABEL
            (SETQ X (CDR X))
            (COND ((NULL X) (RETURN FORALL-RESULT)))
            (RPLACD FORALL-ENDPTR (CONS ((LAMBDA (X) (CGP_2A X)) (CAR X)) NIL))
            (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
            (GO LOOPLABEL)))) 
(DE CGB_S2S-CGB (L) (CGB_CGB-SFL L)) 
(PUT 'CGB_S2S-CGB 'NUMBER-OF-ARGS 1) 
(PUT 'CGB_S2S-CGB 'DEFINED-ON-LINE '226) 
(PUT 'CGB_S2S-CGB 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_S2S-CGB 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGB_S2S-CGB 'INLINE '(LAMBDA (L) (CGB_CGB-SFL L))) 
(PUT 'CGB_S2A-GSYS 'NUMBER-OF-ARGS 1) 
(PUT 'CGB_S2A-GSYS 'DEFINED-ON-LINE '229) 
(PUT 'CGB_S2A-GSYS 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_S2A-GSYS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGB_S2A-GSYS (U)
    (CONS 'LIST
          (PROG (BRA FORALL-RESULT FORALL-ENDPTR)
            (SETQ BRA U)
            (COND ((NULL BRA) (RETURN NIL)))
            (SETQ FORALL-RESULT
                    (SETQ FORALL-ENDPTR
                            (CONS ((LAMBDA (BRA) (CGB_S2A-BRA BRA)) (CAR BRA))
                                  NIL)))
           LOOPLABEL
            (SETQ BRA (CDR BRA))
            (COND ((NULL BRA) (RETURN FORALL-RESULT)))
            (RPLACD FORALL-ENDPTR
                    (CONS ((LAMBDA (BRA) (CGB_S2A-BRA BRA)) (CAR BRA)) NIL))
            (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
            (GO LOOPLABEL)))) 
(PUT 'CGB_S2A-BRA 'NUMBER-OF-ARGS 1) 
(PUT 'CGB_S2A-BRA 'DEFINED-ON-LINE '234) 
(PUT 'CGB_S2A-BRA 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_S2A-BRA 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGB_S2A-BRA (BRA)
    (LIST 'LIST
          (RL_MK*FOF
           ((LAMBDA (G130)
              (COND ((AND G130 (CDR G130)) (CONS 'AND G130))
                    ((NULL G130) (COND ((EQ 'AND 'AND) 'TRUE) (T 'FALSE)))
                    (T (CAR G130))))
            (BRA_CD BRA)))
          (CONS 'LIST
                (PROG (X FORALL-RESULT FORALL-ENDPTR)
                  (SETQ X (BRA_SYSTEM BRA))
                  (COND ((NULL X) (RETURN NIL)))
                  (SETQ FORALL-RESULT
                          (SETQ FORALL-ENDPTR
                                  (CONS ((LAMBDA (X) (CGP_2A X)) (CAR X))
                                        NIL)))
                 LOOPLABEL
                  (SETQ X (CDR X))
                  (COND ((NULL X) (RETURN FORALL-RESULT)))
                  (RPLACD FORALL-ENDPTR
                          (CONS ((LAMBDA (X) (CGP_2A X)) (CAR X)) NIL))
                  (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                  (GO LOOPLABEL))))) 
(PUT 'CGB_S2S-GSYS 'NUMBER-OF-ARGS 1) 
(PUT 'CGB_S2S-GSYS 'DEFINED-ON-LINE '240) 
(PUT 'CGB_S2S-GSYS 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_S2S-GSYS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGB_S2S-GSYS (U)
    (PROG (BRA FORALL-RESULT FORALL-ENDPTR)
      (SETQ BRA U)
      (COND ((NULL BRA) (RETURN NIL)))
      (SETQ FORALL-RESULT
              (SETQ FORALL-ENDPTR
                      (CONS ((LAMBDA (BRA) (CGB_S2S-BRA BRA)) (CAR BRA)) NIL)))
     LOOPLABEL
      (SETQ BRA (CDR BRA))
      (COND ((NULL BRA) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR
              (CONS ((LAMBDA (BRA) (CGB_S2S-BRA BRA)) (CAR BRA)) NIL))
      (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
      (GO LOOPLABEL))) 
(DE CGB_S2S-BRA (BRA) (LIST (BRA_CD BRA) (CGB_CGB-SFL (BRA_SYSTEM BRA)))) 
(PUT 'CGB_S2S-BRA 'NUMBER-OF-ARGS 1) 
(PUT 'CGB_S2S-BRA 'DEFINED-ON-LINE '243) 
(PUT 'CGB_S2S-BRA 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_S2S-BRA 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGB_S2S-BRA 'INLINE
      '(LAMBDA (BRA) (LIST (BRA_CD BRA) (CGB_CGB-SFL (BRA_SYSTEM BRA))))) 
(PUT 'CGB_A2S-GSYS 'NUMBER-OF-ARGS 1) 
(PUT 'CGB_A2S-GSYS 'DEFINED-ON-LINE '246) 
(PUT 'CGB_A2S-GSYS 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_A2S-GSYS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGB_A2S-GSYS (U)
    (PROG (SYS W)
      (SETQ SYS (GETRLIST (REVAL1 U T)))
      (RETURN
       (PROG (BRA FORALL-RESULT FORALL-ENDPTR)
         (SETQ BRA SYS)
         (COND ((NULL BRA) (RETURN NIL)))
         (SETQ FORALL-RESULT
                 (SETQ FORALL-ENDPTR
                         (CONS
                          ((LAMBDA (BRA)
                             (PROGN
                              (SETQ W (GETRLIST BRA))
                              (BRA_MK (CD_FOR2CD (RL_SIMP (CAR W)))
                               (CGB_A2S-PSYS (CADR W)) NIL)))
                           (CAR BRA))
                          NIL)))
        LOOPLABEL
         (SETQ BRA (CDR BRA))
         (COND ((NULL BRA) (RETURN FORALL-RESULT)))
         (RPLACD FORALL-ENDPTR
                 (CONS
                  ((LAMBDA (BRA)
                     (PROGN
                      (SETQ W (GETRLIST BRA))
                      (BRA_MK (CD_FOR2CD (RL_SIMP (CAR W)))
                       (CGB_A2S-PSYS (CADR W)) NIL)))
                   (CAR BRA))
                  NIL))
         (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
         (GO LOOPLABEL))))) 
(PUT 'CGB_A2S2-GSYS 'NUMBER-OF-ARGS 1) 
(PUT 'CGB_A2S2-GSYS 'DEFINED-ON-LINE '257) 
(PUT 'CGB_A2S2-GSYS 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_A2S2-GSYS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGB_A2S2-GSYS (SYS)
    (PROG (BRA FORALL-RESULT FORALL-ENDPTR)
      (SETQ BRA SYS)
      (COND ((NULL BRA) (RETURN NIL)))
      (SETQ FORALL-RESULT
              (SETQ FORALL-ENDPTR
                      (CONS
                       ((LAMBDA (BRA)
                          (BRA_MK (CAR BRA) (CGB_A2S2-PSYS (CADR BRA)) NIL))
                        (CAR BRA))
                       NIL)))
     LOOPLABEL
      (SETQ BRA (CDR BRA))
      (COND ((NULL BRA) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR
              (CONS
               ((LAMBDA (BRA)
                  (BRA_MK (CAR BRA) (CGB_A2S2-PSYS (CADR BRA)) NIL))
                (CAR BRA))
               NIL))
      (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
      (GO LOOPLABEL))) 
(PUT 'CGB_XVARS-GSYS 'NUMBER-OF-ARGS 2) 
(PUT 'CGB_XVARS-GSYS 'DEFINED-ON-LINE '261) 
(PUT 'CGB_XVARS-GSYS 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_XVARS-GSYS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CGB_XVARS-GSYS (SYS VL)
    (PROG (W)
      (SETQ W
              (PROG (BRA FORALL-RESULT FORALL-ENDPTR)
                (SETQ BRA SYS)
               STARTOVER
                (COND ((NULL BRA) (RETURN NIL)))
                (SETQ FORALL-RESULT
                        ((LAMBDA (BRA) (BRA_SYSTEM BRA)) (CAR BRA)))
                (SETQ FORALL-ENDPTR (LASTPAIR FORALL-RESULT))
                (SETQ BRA (CDR BRA))
                (COND ((ATOM FORALL-ENDPTR) (GO STARTOVER)))
               LOOPLABEL
                (COND ((NULL BRA) (RETURN FORALL-RESULT)))
                (RPLACD FORALL-ENDPTR
                        ((LAMBDA (BRA) (BRA_SYSTEM BRA)) (CAR BRA)))
                (SETQ FORALL-ENDPTR (LASTPAIR FORALL-ENDPTR))
                (SETQ BRA (CDR BRA))
                (GO LOOPLABEL)))
      (RETURN (CGB_VARS W VL)))) 
(PUT 'CGB_A2S-CD 'NUMBER-OF-ARGS 1) 
(PUT 'CGB_A2S-CD 'DEFINED-ON-LINE '268) 
(PUT 'CGB_A2S-CD 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_A2S-CD 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGB_A2S-CD (CD)
    (PROG (W *RLSIEXPLA)
      (SETQ W (RL_SIMPL (RL_SIMP (REVAL1 CD T)) NIL (MINUS 1)))
      (COND
       ((NOT (CGB_CDP W))
        (REDERR
         "CGB theory must be truth value or (conjunction of) atomic formulas")))
      (RETURN (CD_FOR2CD W)))) 
(PUT 'CGB_CDP 'NUMBER-OF-ARGS 1) 
(PUT 'CGB_CDP 'DEFINED-ON-LINE '277) 
(PUT 'CGB_CDP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_CDP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGB_CDP (CD)
    (PROG (ERR)
      (COND
       ((OR (OR (EQ CD 'TRUE) (EQ CD 'FALSE))
            (NOT
             ((LAMBDA (X)
                (OR (OR (EQ X 'TRUE) (EQ X 'FALSE))
                    (OR (OR (OR (EQ X 'OR) (EQ X 'AND)) (EQ X 'NOT))
                        (OR (EQ X 'IMPL) (EQ X 'REPL) (EQ X 'EQUIV)))
                    (OR (EQ X 'EX) (EQ X 'ALL)) (OR (EQ X 'BEX) (EQ X 'BALL))))
              (COND ((ATOM CD) CD) (T (CAR CD))))))
        (RETURN T)))
      (COND ((NEQ (COND ((ATOM CD) CD) (T (CAR CD))) 'AND) (RETURN NIL)))
      (SETQ CD (CDR CD))
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND (NOT ERR) CD)) (RETURN NIL)))
        (COND
         ((AND (NOT (OR (EQ (CAR CD) 'TRUE) (EQ (CAR CD) 'FALSE)))
               ((LAMBDA (X)
                  (OR (OR (EQ X 'TRUE) (EQ X 'FALSE))
                      (OR (OR (OR (EQ X 'OR) (EQ X 'AND)) (EQ X 'NOT))
                          (OR (EQ X 'IMPL) (EQ X 'REPL) (EQ X 'EQUIV)))
                      (OR (EQ X 'EX) (EQ X 'ALL))
                      (OR (EQ X 'BEX) (EQ X 'BALL))))
                (COND ((ATOM (CAR CD)) (CAR CD)) (T (CAR (CAR CD))))))
          (SETQ ERR T))
         (T (SETQ CD (CDR CD))))
        (GO WHILELABEL))
      (RETURN (NOT ERR)))) 
(DE CGB_A2S2-CD (CD) CD) 
(PUT 'CGB_A2S2-CD 'NUMBER-OF-ARGS 1) 
(PUT 'CGB_A2S2-CD 'DEFINED-ON-LINE '292) 
(PUT 'CGB_A2S2-CD 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_A2S2-CD 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGB_A2S2-CD 'INLINE '(LAMBDA (CD) CD)) 
(DE CGB_A2S-VARL (VARL) (CDR VARL)) 
(PUT 'CGB_A2S-VARL 'NUMBER-OF-ARGS 1) 
(PUT 'CGB_A2S-VARL 'DEFINED-ON-LINE '295) 
(PUT 'CGB_A2S-VARL 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_A2S-VARL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGB_A2S-VARL 'INLINE '(LAMBDA (VARL) (CDR VARL))) 
(DE CGB_A2S2-VARL (VARL) VARL) 
(PUT 'CGB_A2S2-VARL 'NUMBER-OF-ARGS 1) 
(PUT 'CGB_A2S2-VARL 'DEFINED-ON-LINE '298) 
(PUT 'CGB_A2S2-VARL 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_A2S2-VARL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGB_A2S2-VARL 'INLINE '(LAMBDA (VARL) VARL)) 
(DE CGB_CLEANUP (U V) U) 
(PUT 'CGB_CLEANUP 'NUMBER-OF-ARGS 2) 
(PUT 'CGB_CLEANUP 'DEFINED-ON-LINE '301) 
(PUT 'CGB_CLEANUP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_CLEANUP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(PUTC 'CGB_CLEANUP 'INLINE '(LAMBDA (U V) U)) 
(PUT 'CGB_INTERFACE$ 'NUMBER-OF-ARGS 10) 
(PUT 'CGB_INTERFACE$ 'DEFINED-ON-LINE '304) 
(PUT 'CGB_INTERFACE$ 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_INTERFACE$ 'PROCEDURE_TYPE
     '(ARROW
       (TIMES GENERAL GENERAL GENERAL GENERAL GENERAL GENERAL GENERAL GENERAL
              GENERAL GENERAL)
       GENERAL)) 
(DE CGB_INTERFACE$ (FNAME A2SL1 A2SL2 DEFL XVFN S2A S2S S SMP ARGL)
    (PROG (W VL NARGL OENV OCDENV M C X)
      (SETQ OCDENV (CD_INIT))
      (COND
       ((NOT SMP)
        (PROGN
         (SETQ NARGL (CGB_AM-PARGL FNAME A2SL1 ARGL DEFL))
         (SETQ VL (APPLY XVFN (APPEND NARGL (LIST (TD_VARS)))))
         (COND
          ((AND (NULL (CDR VL)) (SETQ W (GET FNAME 'GB_WRAPPER)))
           (PROGN
            (CD_CLEANUP OCDENV)
            (RETURN (APPLY 'GB_INTERFACE$ (APPEND W (LIST SMP ARGL)))))))
         (SETQ OENV (CGP_INIT (CAR VL) (TD_SORTMODE) (TD_SORTEXTENSION)))
         NIL))
       (T
        (PROGN
         (SETQ W (CGB_SM-PARGL ARGL))
         (SETQ NARGL (CAR W))
         (SETQ M (CADR W))
         (SETQ C (CADDR W))
         (SETQ X (CADDDR W))
         (SETQ VL (APPLY XVFN (APPEND NARGL (LIST M))))
         (COND
          ((AND (NULL (CDR VL)) (SETQ W (GET FNAME 'GB_WRAPPER)))
           (PROGN
            (CD_CLEANUP OCDENV)
            (RETURN (APPLY 'GB_INTERFACE$ (APPEND W (LIST SMP ARGL)))))))
         (SETQ OENV (CGP_INIT (CAR VL) C X))
         NIL)))
      (SETQ W
              (ERRORSET
               (LIST 'CGB_INTERFACE1$ (MKQUOTE FNAME) (MKQUOTE A2SL2)
                     (MKQUOTE S2A) (MKQUOTE S2S) (MKQUOTE S) (MKQUOTE SMP)
                     (MKQUOTE ARGL) (MKQUOTE NARGL) (MKQUOTE (CAR VL))
                     (MKQUOTE (CDR VL)))
               T *BACKTRACE))
      (CD_CLEANUP OCDENV)
      (CGP_CLEANUP OENV)
      (COND ((ERRORP W) (REDERR (LIST "error during errorset() on" FNAME))))
      (RETURN (CAR W)))) 
(PUT 'CGB_SM-PARGL 'NUMBER-OF-ARGS 1) 
(PUT 'CGB_SM-PARGL 'DEFINED-ON-LINE '348) 
(PUT 'CGB_SM-PARGL 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_SM-PARGL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGB_SM-PARGL (ARGL)
    (PROG (NARGL M C X)
      (SETQ NARGL (REVERSE ARGL))
      (SETQ X (CAR NARGL))
      (SETQ NARGL (CDR NARGL))
      (SETQ C (CAR NARGL))
      (SETQ NARGL (CDR NARGL))
      (SETQ M (CAR NARGL))
      (SETQ NARGL (CDR NARGL))
      (SETQ NARGL (REVERSIP NARGL))
      (RETURN (LIST NARGL M C X)))) 
(PUT 'CGB_AM-PARGL 'NUMBER-OF-ARGS 4) 
(PUT 'CGB_AM-PARGL 'DEFINED-ON-LINE '361) 
(PUT 'CGB_AM-PARGL 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_AM-PARGL 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE CGB_AM-PARGL (FNAME A2SL1 ARGL DEFL)
    (PROG (L1 L2 L3 NOA W NARGL SCARGL SCDEFL)
      (SETQ L1 0)
      (SETQ L2 0)
      (SETQ L3 0)
      (SETQ NOA 0)
      (SETQ L1 (LENGTH ARGL))
      (SETQ L2 (LENGTH A2SL1))
      (SETQ L3 (DIFFERENCE L2 (LENGTH DEFL)))
      (COND
       ((OR (LESSP L1 L3) (GREATERP L1 L2))
        (REDERR
         (LIST FNAME "called with" L1 "arguments instead of" L3 "-" L2))))
      (SETQ SCARGL ARGL)
      (SETQ SCDEFL DEFL)
      (SETQ NOA 1)
      (SETQ NARGL
              (PROG (X FORALL-RESULT FORALL-ENDPTR)
                (SETQ X A2SL1)
                (COND ((NULL X) (RETURN NIL)))
                (SETQ FORALL-RESULT
                        (SETQ FORALL-ENDPTR
                                (CONS
                                 ((LAMBDA (X)
                                    (PROGN
                                     (COND
                                      (SCARGL
                                       (PROGN
                                        (SETQ W (CAR SCARGL))
                                        (SETQ SCARGL (CDR SCARGL))))
                                      (T (PROGN (SETQ W (CAR SCDEFL)) NIL)))
                                     (COND
                                      ((GREATERP NOA L3)
                                       (SETQ SCDEFL (CDR SCDEFL))))
                                     (SETQ NOA (PLUS NOA 1))
                                     (APPLY X (LIST W))))
                                  (CAR X))
                                 NIL)))
               LOOPLABEL
                (SETQ X (CDR X))
                (COND ((NULL X) (RETURN FORALL-RESULT)))
                (RPLACD FORALL-ENDPTR
                        (CONS
                         ((LAMBDA (X)
                            (PROGN
                             (COND
                              (SCARGL
                               (PROGN
                                (SETQ W (CAR SCARGL))
                                (SETQ SCARGL (CDR SCARGL))))
                              (T (PROGN (SETQ W (CAR SCDEFL)) NIL)))
                             (COND
                              ((GREATERP NOA L3) (SETQ SCDEFL (CDR SCDEFL))))
                             (SETQ NOA (PLUS NOA 1))
                             (APPLY X (LIST W))))
                          (CAR X))
                         NIL))
                (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                (GO LOOPLABEL)))
      (RETURN NARGL))) 
(PUT 'CGB_INTERFACE1$ 'NUMBER-OF-ARGS 10) 
(PUT 'CGB_INTERFACE1$ 'DEFINED-ON-LINE '387) 
(PUT 'CGB_INTERFACE1$ 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_INTERFACE1$ 'PROCEDURE_TYPE
     '(ARROW
       (TIMES GENERAL GENERAL GENERAL GENERAL GENERAL GENERAL GENERAL GENERAL
              GENERAL GENERAL)
       GENERAL)) 
(DE CGB_INTERFACE1$ (FNAME A2SL2 S2A S2S S SMP ARGL NARGL M P)
    (PROG (W PL)
      (SETQ PL (COND (S NARGL) (T ARGL)))
      (SETQ ARGL
              (PROG (X FORALL-RESULT FORALL-ENDPTR)
                (SETQ X A2SL2)
                (COND ((NULL X) (RETURN NIL)))
                (SETQ FORALL-RESULT
                        (SETQ FORALL-ENDPTR
                                (CONS
                                 ((LAMBDA (X)
                                    (PROGN
                                     (SETQ W (CAR PL))
                                     (SETQ PL (CDR PL))
                                     (APPLY X (LIST W))))
                                  (CAR X))
                                 NIL)))
               LOOPLABEL
                (SETQ X (CDR X))
                (COND ((NULL X) (RETURN FORALL-RESULT)))
                (RPLACD FORALL-ENDPTR
                        (CONS
                         ((LAMBDA (X)
                            (PROGN
                             (SETQ W (CAR PL))
                             (SETQ PL (CDR PL))
                             (APPLY X (LIST W))))
                          (CAR X))
                         NIL))
                (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                (GO LOOPLABEL)))
      (SETQ W (APPLY FNAME ARGL))
      (SETQ W (COND (SMP (APPLY S2S (LIST W))) (T (APPLY S2A (LIST W)))))
      (RETURN W))) 
(PUT 'CGB_GREENGSYSF 'NUMBER-OF-ARGS 6) 
(PUT 'CGB_GREENGSYSF 'DEFINED-ON-LINE '404) 
(PUT 'CGB_GREENGSYSF 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_GREENGSYSF 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE CGB_GREENGSYSF (U M SM SX THEO XVARL) (CGB_GGSYSF U M SM SX THEO XVARL)) 
(PUT 'CGB_GSYS2GREEN 'NUMBER-OF-ARGS 2) 
(PUT 'CGB_GSYS2GREEN 'DEFINED-ON-LINE '407) 
(PUT 'CGB_GSYS2GREEN 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_GSYS2GREEN 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CGB_GSYS2GREEN (U THEO)
    (PROG (BRA FORALL-RESULT FORALL-ENDPTR)
      (SETQ BRA U)
      (COND ((NULL BRA) (RETURN NIL)))
      (SETQ FORALL-RESULT
              (SETQ FORALL-ENDPTR
                      (CONS
                       ((LAMBDA (BRA)
                          (BRA_MK (BRA_CD BRA)
                           (CGB_CGPL2GREEN (BRA_SYSTEM BRA)
                            (APPEND THEO (BRA_CD BRA)))
                           (BRA_CPRL BRA)))
                        (CAR BRA))
                       NIL)))
     LOOPLABEL
      (SETQ BRA (CDR BRA))
      (COND ((NULL BRA) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR
              (CONS
               ((LAMBDA (BRA)
                  (BRA_MK (BRA_CD BRA)
                   (CGB_CGPL2GREEN (BRA_SYSTEM BRA) (APPEND THEO (BRA_CD BRA)))
                   (BRA_CPRL BRA)))
                (CAR BRA))
               NIL))
      (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
      (GO LOOPLABEL))) 
(PUT 'CGB_CGPL2GREEN 'NUMBER-OF-ARGS 2) 
(PUT 'CGB_CGPL2GREEN 'DEFINED-ON-LINE '416) 
(PUT 'CGB_CGPL2GREEN 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_CGPL2GREEN 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CGB_CGPL2GREEN (L THEO)
    (PROG (CGP FORALL-RESULT FORALL-ENDPTR)
      (SETQ CGP L)
      (COND ((NULL CGP) (RETURN NIL)))
      (SETQ FORALL-RESULT
              (SETQ FORALL-ENDPTR
                      (CONS ((LAMBDA (CGP) (CGP_GREEN CGP)) (CAR CGP)) NIL)))
     LOOPLABEL
      (SETQ CGP (CDR CGP))
      (COND ((NULL CGP) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR
              (CONS ((LAMBDA (CGP) (CGP_GREEN CGP)) (CAR CGP)) NIL))
      (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
      (GO LOOPLABEL))) 
(PUT 'CGB_DOMAINCHK 'NUMBER-OF-ARGS 0) 
(PUT 'CGB_DOMAINCHK 'DEFINED-ON-LINE '424) 
(PUT 'CGB_DOMAINCHK 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_DOMAINCHK 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE CGB_DOMAINCHK NIL
    (COND
     ((NOT (MEMQ DMODE* '(NIL)))
      (REDERR
       (BLDMSG_INTERNAL "cgb does not support domain: %w"
                        (LIST (GET DMODE* 'DNAME))))))) 
(PUT 'CGB_VARS 'NUMBER-OF-ARGS 2) 
(PUT 'CGB_VARS 'DEFINED-ON-LINE '431) 
(PUT 'CGB_VARS 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_VARS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CGB_VARS (L VL)
    (PROG (W M P)
      (PROG (F)
        (SETQ F L)
       LAB
        (COND ((NULL F) (RETURN NIL)))
        ((LAMBDA (F) (SETQ W (UNION W (KERNELS F)))) (CAR F))
        (SETQ F (CDR F))
        (GO LAB))
      (COND
       (VL (PROGN (SETQ M (CGB_INTERSECTION VL W)) (SETQ P (SETDIFF W VL))))
       (T (SETQ M W)))
      (RETURN (CONS M P)))) 
(PUT 'CGB_VARSGSYS 'NUMBER-OF-ARGS 2) 
(PUT 'CGB_VARSGSYS 'DEFINED-ON-LINE '447) 
(PUT 'CGB_VARSGSYS 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_VARSGSYS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CGB_VARSGSYS (GSYS VL)
    (PROG (W M P)
      (PROG (BRA)
        (SETQ BRA GSYS)
       LAB
        (COND ((NULL BRA) (RETURN NIL)))
        ((LAMBDA (BRA)
           (PROG (F)
             (SETQ F (BRA_SYSTEM BRA))
            LAB
             (COND ((NULL F) (RETURN NIL)))
             ((LAMBDA (F) (SETQ W (UNION W (KERNELS F)))) (CAR F))
             (SETQ F (CDR F))
             (GO LAB)))
         (CAR BRA))
        (SETQ BRA (CDR BRA))
        (GO LAB))
      (SETQ M (CGB_INTERSECTION VL W))
      (SETQ P (SETDIFF W VL))
      (RETURN (CONS M P)))) 
(PUT 'CGB_INTERSECTION 'NUMBER-OF-ARGS 2) 
(PUT 'CGB_INTERSECTION 'DEFINED-ON-LINE '462) 
(PUT 'CGB_INTERSECTION 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_INTERSECTION 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CGB_INTERSECTION (A B)
    (PROG (X FORALL-RESULT FORALL-ENDPTR)
      (SETQ X A)
     STARTOVER
      (COND ((NULL X) (RETURN NIL)))
      (SETQ FORALL-RESULT
              ((LAMBDA (X) (COND ((MEMBER X B) (LIST X)))) (CAR X)))
      (SETQ FORALL-ENDPTR (LASTPAIR FORALL-RESULT))
      (SETQ X (CDR X))
      (COND ((ATOM FORALL-ENDPTR) (GO STARTOVER)))
     LOOPLABEL
      (COND ((NULL X) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR
              ((LAMBDA (X) (COND ((MEMBER X B) (LIST X)))) (CAR X)))
      (SETQ FORALL-ENDPTR (LASTPAIR FORALL-ENDPTR))
      (SETQ X (CDR X))
      (GO LOOPLABEL))) 
(PUT 'CGB_CGB 'NUMBER-OF-ARGS 2) 
(PUT 'CGB_CGB 'DEFINED-ON-LINE '471) 
(PUT 'CGB_CGB 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_CGB 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CGB_CGB (U THEO)
    ((LAMBDA (*CGBFAITHFUL) (CGB_GSYS2CGB (CGB_GSYS U THEO))) T)) 
(PUT 'CGB_GSYS2CGB 'NUMBER-OF-ARGS 1) 
(PUT 'CGB_GSYS2CGB 'DEFINED-ON-LINE '476) 
(PUT 'CGB_GSYS2CGB 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_GSYS2CGB 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGB_GSYS2CGB (U)
    (PROG (CGBASE)
      (PROG (BRA)
        (SETQ BRA U)
       LAB
        (COND ((NULL BRA) (RETURN NIL)))
        ((LAMBDA (BRA)
           (PROG (P)
             (SETQ P (BRA_SYSTEM BRA))
            LAB
             (COND ((NULL P) (RETURN NIL)))
             ((LAMBDA (P)
                (COND ((NOT (MEMBER P CGBASE)) (SETQ CGBASE (CONS P CGBASE)))))
              (CAR P))
             (SETQ P (CDR P))
             (GO LAB)))
         (CAR BRA))
        (SETQ BRA (CDR BRA))
        (GO LAB))
      (RETURN (CGP_LSORT CGBASE)))) 
(PUT 'CGB_CGB-SFL 'NUMBER-OF-ARGS 1) 
(PUT 'CGB_CGB-SFL 'DEFINED-ON-LINE '487) 
(PUT 'CGB_CGB-SFL 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_CGB-SFL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGB_CGB-SFL (U)
    (PROG (P FORALL-RESULT FORALL-ENDPTR)
      (SETQ P U)
      (COND ((NULL P) (RETURN NIL)))
      (SETQ FORALL-RESULT
              (SETQ FORALL-ENDPTR
                      (CONS ((LAMBDA (P) (CGP_2F P)) (CAR P)) NIL)))
     LOOPLABEL
      (SETQ P (CDR P))
      (COND ((NULL P) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR (CONS ((LAMBDA (P) (CGP_2F P)) (CAR P)) NIL))
      (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
      (GO LOOPLABEL))) 
(DE CGB_TT (S1 S2) (EV_LCM (CGP_EVLMON S1) (CGP_EVLMON S2))) 
(PUT 'CGB_TT 'NUMBER-OF-ARGS 2) 
(PUT 'CGB_TT 'DEFINED-ON-LINE '492) 
(PUT 'CGB_TT 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_TT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(PUTC 'CGB_TT 'INLINE
      '(LAMBDA (S1 S2) (EV_LCM (CGP_EVLMON S1) (CGP_EVLMON S2)))) 
(PUT 'CGB_GSYS 'NUMBER-OF-ARGS 2) 
(PUT 'CGB_GSYS 'DEFINED-ON-LINE '511) 
(PUT 'CGB_GSYS 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_GSYS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CGB_GSYS (U THEO)
    (COND
     (*CGBFAITHFUL
      ((LAMBDA (*CGBGEN *CGBGREEN)
         (GSY_NORMALIZE (CGB_GSYS1 (CGP_LSORT U) THEO NIL)))
       NIL NIL))
     (T ((LAMBDA (*CGBGEN) (CGB_NONFAITHFULGSYS U THEO NIL)) NIL)))) 
(PUT 'CGB_GGSYS 'NUMBER-OF-ARGS 3) 
(PUT 'CGB_GGSYS 'DEFINED-ON-LINE '521) 
(PUT 'CGB_GGSYS 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_GGSYS 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE CGB_GGSYS (U THEO XVARL)
    (COND
     (*CGBFAITHFUL
      ((LAMBDA (*CGBGEN *CGBGREEN)
         (GSY_NORMALIZE (CGB_GSYS1 (CGP_LSORT U) THEO XVARL)))
       T NIL))
     (T ((LAMBDA (*CGBGEN) (CGB_NONFAITHFULGSYS U THEO XVARL)) T)))) 
(PUT 'CGB_NONFAITHFULGSYS 'NUMBER-OF-ARGS 3) 
(PUT 'CGB_NONFAITHFULGSYS 'DEFINED-ON-LINE '531) 
(PUT 'CGB_NONFAITHFULGSYS 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_NONFAITHFULGSYS 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE CGB_NONFAITHFULGSYS (U THEO XVARL)
    (COND
     (*CGBSGREEN
      ((LAMBDA (*CGBGREEN)
         (GSY_NORMALIZE
          (CGB_GSYS2GREEN (CGB_GSYS1 (CGP_LSORT U) THEO XVARL) THEO)))
       NIL))
     (T
      ((LAMBDA (*CGBGREEN)
         (GSY_NORMALIZE (CGB_GSYS1 (CGP_LSORT U) THEO XVARL)))
       T)))) 
(PUT 'CGB_GSYS1 'NUMBER-OF-ARGS 3) 
(PUT 'CGB_GSYS1 'DEFINED-ON-LINE '541) 
(PUT 'CGB_GSYS1 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_GSYS1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE CGB_GSYS1 (U THEO XVARL)
    (PROG (SPAC STIME P1 *FACTOR *EXP *GCD *EZGCD CGB_CD* *CGBVERBOSE
           CGP_PCOUNT* CGB_CONTCOUNT* CGB_HCOUNT* CGB_HZEROCOUNT* CGB_TR1COUNT*
           CGB_TR2COUNT* CGB_TR3COUNT* CGB_B4COUNT* CGB_STRANGECOUNT*
           CGB_PAIRCOUNT* CGB_GBCOUNT*)
      (SETQ CGP_PCOUNT* 0)
      (SETQ CGB_CONTCOUNT* 0)
      (SETQ CGB_HCOUNT* 0)
      (SETQ CGB_HZEROCOUNT* 0)
      (SETQ CGB_TR1COUNT* 0)
      (SETQ CGB_TR2COUNT* 0)
      (SETQ CGB_TR3COUNT* 0)
      (SETQ CGB_B4COUNT* 0)
      (SETQ CGB_STRANGECOUNT* 0)
      (SETQ CGB_PAIRCOUNT* 0)
      (SETQ CGB_GBCOUNT* 0)
      (COND ((EQUAL THEO '(FALSE)) (REDERR "cgb_gsys1: inconsistent theory")))
      (SETQ *EXP (SETQ *GCD (SETQ *EZGCD T)))
      (SETQ CGB_CONTCOUNT* CGB_MINCONTRED*)
      (COND (*CGBSTAT (PROGN (SETQ SPAC (GCTIME)) (SETQ STIME (TIME)))))
      (SETQ P1 (CGB_TRAVERSO U THEO XVARL))
      (COND
       (*CGBSTAT
        (PROGN
         (IOTO_TPRIN2T "Statistics for GB computation:")
         (IOTO_PRIN2T
          (LIST "Time: " (DIFFERENCE (TIME) STIME) " ms plus GC time: "
                (DIFFERENCE (GCTIME) SPAC) " ms"))
         (IOTO_PRIN2T (LIST "H-polynomials total: " CGB_HCOUNT*))
         (IOTO_PRIN2T (LIST "H-polynomials zero: " CGB_HZEROCOUNT*))
         (IOTO_PRIN2T (LIST "Crit Tr1 hits: " CGB_TR1COUNT*))
         (IOTO_PRIN2T (LIST "Crit B4 hits: " CGB_B4COUNT* " (Buchberger 1)"))
         (IOTO_PRIN2T (LIST "Crit Tr2 hits: " CGB_TR2COUNT*))
         (IOTO_PRIN2T (LIST "Crit Tr3 hits: " CGB_TR3COUNT*))
         NIL)))
      (RETURN P1))) 
(PUT 'CGB_TRAVERSO 'NUMBER-OF-ARGS 3) 
(PUT 'CGB_TRAVERSO 'DEFINED-ON-LINE '574) 
(PUT 'CGB_TRAVERSO 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_TRAVERSO 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE CGB_TRAVERSO (G0 THEO XVARS)
    (PROG (BRA GSYS RESL BRAL)
      (SETQ G0
              (PROG (FJ FORALL-RESULT FORALL-ENDPTR)
                (SETQ FJ G0)
                (COND ((NULL FJ) (RETURN NIL)))
                (SETQ FORALL-RESULT
                        (SETQ FORALL-ENDPTR
                                (CONS
                                 ((LAMBDA (FJ) (CGP_SIMPDCONT FJ)) (CAR FJ))
                                 NIL)))
               LOOPLABEL
                (SETQ FJ (CDR FJ))
                (COND ((NULL FJ) (RETURN FORALL-RESULT)))
                (RPLACD FORALL-ENDPTR
                        (CONS ((LAMBDA (FJ) (CGP_SIMPDCONT FJ)) (CAR FJ)) NIL))
                (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                (GO LOOPLABEL)))
      (SETQ GSYS (GSY_INIT G0 THEO XVARS))
      (PROG ()
       WHILELABEL
        (COND ((NOT GSYS) (RETURN NIL)))
        (PROGN
         (SETQ BRA (CAR GSYS))
         (SETQ GSYS (CDR GSYS))
         (COND
          ((OR (EQ (BRA_CPRL BRA) 'FINAL) (NULL (BRA_CPRL BRA)))
           (SETQ RESL (CONS BRA RESL)))
          (T
           (PROGN
            (SETQ BRAL (CGB_TRAVERSO1 BRA XVARS))
            (SETQ GSYS (NCONC BRAL GSYS))))))
        (GO WHILELABEL))
      (RETURN RESL))) 
(PUT 'CGB_TRAVERSO1 'NUMBER-OF-ARGS 2) 
(PUT 'CGB_TRAVERSO1 'DEFINED-ON-LINE '594) 
(PUT 'CGB_TRAVERSO1 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_TRAVERSO1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CGB_TRAVERSO1 (BRA XVARS)
    (PROG (G D S H P)
      (SETQ CGB_CD* (BRA_CD BRA))
      (SETQ G (BRA_SYSTEM BRA))
      (SETQ D (BRA_CPRL BRA))
      (COND
       (*CGBVERBOSE
        (PROGN
         (IOTO_PRIN2 (LIST "[" CGB_PAIRCOUNT* "] "))
         (SETQ CGB_PAIRCOUNT* (IDIFFERENCE CGB_PAIRCOUNT* 1)))))
      (SETQ P (CAR D))
      (SETQ D (CDR D))
      (SETQ S (CGB_SPOLYNOMIAL P))
      (SETQ H (CGB_NORMALFORM S G XVARS))
      (SETQ H (CGP_SIMPDCONT H))
      (COND (*CGBSTAT (SETQ CGB_HCOUNT* (IPLUS2 CGB_HCOUNT* 1))))
      (COND ((CGP_ZEROP H) (SETQ CGB_HZEROCOUNT* (IPLUS2 CGB_HZEROCOUNT* 1))))
      (RETURN (BRA_SPLIT (BRA_MK CGB_CD* G D) H XVARS)))) 
(PUT 'CGB_SPOLYNOMIAL 'NUMBER-OF-ARGS 1) 
(PUT 'CGB_SPOLYNOMIAL 'DEFINED-ON-LINE '617) 
(PUT 'CGB_SPOLYNOMIAL 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_SPOLYNOMIAL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGB_SPOLYNOMIAL (PR) (PROG (S) (SETQ S (CGB_SPOLYNOMIAL1 PR)) (RETURN S))) 
(PUT 'CGB_SPOLYNOMIAL1 'NUMBER-OF-ARGS 1) 
(PUT 'CGB_SPOLYNOMIAL1 'DEFINED-ON-LINE '626) 
(PUT 'CGB_SPOLYNOMIAL1 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_SPOLYNOMIAL1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGB_SPOLYNOMIAL1 (PR)
    (PROG (P1 P2 EP EP1 EP2 RP1 RP2 DB1 DB2 X SPOL)
      (SETQ P1 (CPR_P1 PR))
      (SETQ P2 (CPR_P2 PR))
      (SETQ EP (CPR_LCM PR))
      (SETQ EP1 (CGP_EVLMON P1))
      (SETQ EP2 (CGP_EVLMON P2))
      (SETQ RP1 (CGP_MRED P1))
      (SETQ RP2 (CGP_MRED P2))
      (COND ((AND (CGP_GREENP RP1) (CGP_GREENP RP2)) (RETURN (CGP_ZERO))))
      (SETQ DB1 (CGP_LBC P1))
      (SETQ DB2 (CGP_LBC P2))
      (SETQ X (BC_GCD DB1 DB2))
      (SETQ DB1 (BC_QUOT DB1 X))
      (SETQ DB2 (BC_QUOT DB2 X))
      (SETQ SPOL
              (CGP_ILCOMB RP1 DB2 (EV_DIF EP EP1) RP2 (BC_NEG DB1)
               (EV_DIF EP EP2)))
      (COND ((CGP_GREENP SPOL) (RETURN (CGP_ZERO))))
      (RETURN SPOL))) 
(PUT 'CGB_NORMALFORM 'NUMBER-OF-ARGS 3) 
(PUT 'CGB_NORMALFORM 'DEFINED-ON-LINE '650) 
(PUT 'CGB_NORMALFORM 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_NORMALFORM 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE CGB_NORMALFORM (F G XVARS)
    (PROG (FOLD C TAI DIVISOR)
      (COND ((NULL G) (RETURN F)))
      (COND ((CGP_GREENP F) (RETURN (CGP_ZERO))))
      (SETQ FOLD F)
      (SETQ F (CGP_HPCP F))
      (SETQ F (CGP_SHIFT F XVARS))
      (SETQ C T)
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND C (CGP_RP F))) (RETURN NIL)))
        (PROGN
         (SETQ DIVISOR (CGB_SEARCHINLIST (CGP_EVLMON F) G))
         (COND (DIVISOR (PROGN (SETQ TAI T) (SETQ F (CGB_REDUCE F DIVISOR))))
               (*CGBFULLRED (SETQ F (CGP_SHIFTWHITE F))) (T (SETQ C NIL)))
         (COND (C (SETQ F (CGP_SHIFT F XVARS)))))
        (GO WHILELABEL))
      (COND ((NOT TAI) (RETURN FOLD)))
      (RETURN (CGP_BACKSHIFT F)))) 
(PUT 'CGB_SEARCHINLIST 'NUMBER-OF-ARGS 2) 
(PUT 'CGB_SEARCHINLIST 'DEFINED-ON-LINE '680) 
(PUT 'CGB_SEARCHINLIST 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_SEARCHINLIST 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CGB_SEARCHINLIST (VEV G)
    (COND ((NULL G) NIL)
          ((CGB_BUCH-EV_DIVIDES? (CGP_EVLMON (CAR G)) VEV) (CAR G))
          (T (CGB_SEARCHINLIST VEV (CDR G))))) 
(PUT 'CGB_BUCH-EV_DIVIDES? 'NUMBER-OF-ARGS 2) 
(PUT 'CGB_BUCH-EV_DIVIDES? 'DEFINED-ON-LINE '691) 
(PUT 'CGB_BUCH-EV_DIVIDES? 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_BUCH-EV_DIVIDES? 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CGB_BUCH-EV_DIVIDES? (VEV1 VEV2) (EV_MTEST? VEV2 VEV1)) 
(PUT 'CGB_REDUCE 'NUMBER-OF-ARGS 2) 
(PUT 'CGB_REDUCE 'DEFINED-ON-LINE '697) 
(PUT 'CGB_REDUCE 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_REDUCE 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CGB_REDUCE (F G1)
    (COND
     ((CGP_MONP G1)
      (CGP_CANCELMEV (CGP_BCPROD F (CGP_LBC G1)) (CGP_EVLMON G1)))
     (T (CGB_REDUCEONESTEP F G1)))) 
(PUT 'CGB_REDUCEONESTEP 'NUMBER-OF-ARGS 2) 
(PUT 'CGB_REDUCEONESTEP 'DEFINED-ON-LINE '706) 
(PUT 'CGB_REDUCEONESTEP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGB_REDUCEONESTEP 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CGB_REDUCEONESTEP (F G)
    (PROG (COT HCF HCG X A B)
      (SETQ COT (EV_DIF (CGP_EVLMON F) (CGP_EVLMON G)))
      (SETQ HCF (CGP_LBC F))
      (SETQ HCG (CGP_LBC G))
      (SETQ X (BC_GCD HCF HCG))
      (SETQ A (BC_QUOT HCG X))
      (SETQ B (BC_QUOT HCF X))
      (RETURN (CGP_SETCI (CGP_ILCOMBR F A G (BC_NEG B) COT) (CGP_CI F))))) 
(ENDMODULE) 
(MODULE (LIST 'CD)) 
(PUT 'CD_INIT 'NUMBER-OF-ARGS 0) 
(PUT 'CD_INIT 'DEFINED-ON-LINE '730) 
(PUT 'CD_INIT 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CD_INIT 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE CD_INIT NIL
    ((LAMBDA (*MSG) (COND (*CGBREAL (RL_SET '(OFSF))) (T (RL_SET '(ACFSF)))))
     NIL)) 
(PUT 'CD_CLEANUP 'NUMBER-OF-ARGS 1) 
(PUT 'CD_CLEANUP 'DEFINED-ON-LINE '736) 
(PUT 'CD_CLEANUP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CD_CLEANUP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CD_CLEANUP (OC) ((LAMBDA (*MSG) (RL_SET OC)) NIL)) 
(DE CD_FALSEP (CD) (EQCAR CD 'FALSE)) 
(PUT 'CD_FALSEP 'NUMBER-OF-ARGS 1) 
(PUT 'CD_FALSEP 'DEFINED-ON-LINE '741) 
(PUT 'CD_FALSEP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CD_FALSEP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CD_FALSEP 'INLINE '(LAMBDA (CD) (EQCAR CD 'FALSE))) 
(PUT 'CD_SIADD 'NUMBER-OF-ARGS 2) 
(PUT 'CD_SIADD 'DEFINED-ON-LINE '746) 
(PUT 'CD_SIADD 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CD_SIADD 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CD_SIADD (ATL SICD)
    (PROG (W)
      (COND ((NOT *CGBCDSIMPL) (RETURN (NCONC ATL SICD))))
      (SETQ W
              (COND
               (*CGBGS
                (CD_GSD
                 ((LAMBDA (G132)
                    (COND ((AND G132 (CDR G132)) (CONS 'AND G132))
                          ((NULL G132)
                           (COND ((EQ 'AND 'AND) 'TRUE) (T 'FALSE)))
                          (T (CAR G132))))
                  (NCONC ATL SICD))
                 NIL))
               (T
                (RL_SIADDATL ATL
                             (COND ((AND SICD (CDR SICD)) (CONS 'AND SICD))
                                   ((NULL SICD)
                                    (COND ((EQ 'AND 'AND) 'TRUE) (T 'FALSE)))
                                   (T (CAR SICD)))))))
      (RETURN (CD_FOR2CD W)))) 
(PUT 'CD_FOR2CD 'NUMBER-OF-ARGS 1) 
(PUT 'CD_FOR2CD 'DEFINED-ON-LINE '759) 
(PUT 'CD_FOR2CD 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CD_FOR2CD 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CD_FOR2CD (F)
    (COND ((EQ F 'TRUE) NIL) ((EQ F 'FALSE) '(FALSE)) ((CL_CXFP F) (CDR F))
          (T (LIST F)))) 
(PUT 'CD_SUREP 'NUMBER-OF-ARGS 2) 
(PUT 'CD_SUREP 'DEFINED-ON-LINE '772) 
(PUT 'CD_SUREP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CD_SUREP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CD_SUREP (F CD)
    (PROG (*RLGSVB)
      (RETURN ((LAMBDA (*RLSPGS *RLSITHOK) (RL_SUREP F CD)) *CGBGS T)))) 
(PUT 'CD_GSD 'NUMBER-OF-ARGS 2) 
(PUT 'CD_GSD 'DEFINED-ON-LINE '779) 
(PUT 'CD_GSD 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CD_GSD 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CD_GSD (F CD) (PROG (*RLGSVB) (RETURN (RL_GSN F CD 'DNF)))) 
(PUT 'CD_ORDP 'NUMBER-OF-ARGS 2) 
(PUT 'CD_ORDP 'DEFINED-ON-LINE '786) 
(PUT 'CD_ORDP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CD_ORDP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CD_ORDP (CD1 CD2)
    (COND ((NULL CD1) T) ((NULL CD2) NIL)
          ((NEQ (CAR CD1) (CAR CD2)) (CD_ORDATP (CAR CD1) (CAR CD2)))
          (T (CD_ORDP (CDR CD1) (CDR CD2))))) 
(PUT 'CD_ORDATP 'NUMBER-OF-ARGS 2) 
(PUT 'CD_ORDATP 'DEFINED-ON-LINE '798) 
(PUT 'CD_ORDATP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CD_ORDATP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CD_ORDATP (A1 A2)
    (COND ((AND (EQ (CAR A1) 'NEQ) (EQ (CAR A2) 'EQUAL)) T)
          ((AND (EQ (CAR A1) 'EQUAL) (EQ (CAR A2) 'NEQ)) NIL)
          (T (ORDP (CADR A1) (CADR A2))))) 
(ENDMODULE) 
(MODULE (LIST 'CPR)) 
(PUT 'CPR_MK 'NUMBER-OF-ARGS 2) 
(PUT 'CPR_MK 'DEFINED-ON-LINE '818) 
(PUT 'CPR_MK 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CPR_MK 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CPR_MK (F H)
    (PROG (TTT SF SH)
      (SETQ TTT (EV_LCM (CGP_EVLMON F) (CGP_EVLMON H)))
      (SETQ SF (IPLUS2 (CGP_SUGAR F) (EV_TDEG (EV_DIF TTT (CGP_EVLMON F)))))
      (SETQ SH (IPLUS2 (CGP_SUGAR H) (EV_TDEG (EV_DIF TTT (CGP_EVLMON H)))))
      (RETURN (CPR_MK1 TTT F H (|EV_MAX#| SF SH))))) 
(DE CPR_MK1 (LCM P1 P2 SUGAR) (LIST LCM P1 P2 SUGAR)) 
(PUT 'CPR_MK1 'NUMBER-OF-ARGS 4) 
(PUT 'CPR_MK1 'DEFINED-ON-LINE '828) 
(PUT 'CPR_MK1 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CPR_MK1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(PUTC 'CPR_MK1 'INLINE '(LAMBDA (LCM P1 P2 SUGAR) (LIST LCM P1 P2 SUGAR))) 
(DE CPR_LCM (CPR) (CAR CPR)) 
(PUT 'CPR_LCM 'NUMBER-OF-ARGS 1) 
(PUT 'CPR_LCM 'DEFINED-ON-LINE '835) 
(PUT 'CPR_LCM 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CPR_LCM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CPR_LCM 'INLINE '(LAMBDA (CPR) (CAR CPR))) 
(DE CPR_P1 (CPR) (CADR CPR)) 
(PUT 'CPR_P1 'NUMBER-OF-ARGS 1) 
(PUT 'CPR_P1 'DEFINED-ON-LINE '840) 
(PUT 'CPR_P1 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CPR_P1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CPR_P1 'INLINE '(LAMBDA (CPR) (CADR CPR))) 
(DE CPR_P2 (CPR) (CADDR CPR)) 
(PUT 'CPR_P2 'NUMBER-OF-ARGS 1) 
(PUT 'CPR_P2 'DEFINED-ON-LINE '845) 
(PUT 'CPR_P2 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CPR_P2 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CPR_P2 'INLINE '(LAMBDA (CPR) (CADDR CPR))) 
(DE CPR_SUGAR (CPR) (CADDDR CPR)) 
(PUT 'CPR_SUGAR 'NUMBER-OF-ARGS 1) 
(PUT 'CPR_SUGAR 'DEFINED-ON-LINE '850) 
(PUT 'CPR_SUGAR 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CPR_SUGAR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CPR_SUGAR 'INLINE '(LAMBDA (CPR) (CADDDR CPR))) 
(PUT 'CPR_TRAVERSO-PAIRLIST 'NUMBER-OF-ARGS 3) 
(PUT 'CPR_TRAVERSO-PAIRLIST 'DEFINED-ON-LINE '855) 
(PUT 'CPR_TRAVERSO-PAIRLIST 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CPR_TRAVERSO-PAIRLIST 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE CPR_TRAVERSO-PAIRLIST (GK G D)
    (PROG (EV R N)
      (SETQ D (CPR_TRAVERSO-PAIRS-DISCARD1 GK D))
      (SETQ EV (CGP_EVLMON GK))
      (PROG (P)
        (SETQ P G)
       LAB
        (COND ((NULL P) (RETURN NIL)))
        ((LAMBDA (P)
           (COND
            ((NOT (CPR_BUCHCRIT4T EV (CGP_EVLMON P)))
             (PROGN
              (COND (*CGBSTAT (SETQ CGB_B4COUNT* (IPLUS2 CGB_B4COUNT* 1))))
              (SETQ R (CONS (EV_LCM EV (CGP_EVLMON P)) R))))
            (T (SETQ N (CONS (CPR_MK P GK) N)))))
         (CAR P))
        (SETQ P (CDR P))
        (GO LAB))
      (SETQ N (CPR_TR2CRIT N R))
      (SETQ N (CPR_LISTSORT N *CGBSLOPPY))
      (SETQ N (CPR_TR3CRIT N))
      (COND
       ((AND *CGBVERBOSE N)
        (PROGN
         (SETQ CGB_PAIRCOUNT* (IPLUS2 CGB_PAIRCOUNT* (LENGTH N)))
         (IOTO_CTERPRI)
         (IOTO_PRIN2 (LIST "(" CGB_GBCOUNT* ") ")))))
      (RETURN (CPR_LISTMERGE D (REVERSIP N))))) 
(PUT 'CPR_TR2CRIT 'NUMBER-OF-ARGS 2) 
(PUT 'CPR_TR2CRIT 'DEFINED-ON-LINE '883) 
(PUT 'CPR_TR2CRIT 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CPR_TR2CRIT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CPR_TR2CRIT (N R)
    (PROG (P FORALL-RESULT FORALL-ENDPTR)
      (SETQ P N)
     STARTOVER
      (COND ((NULL P) (RETURN NIL)))
      (SETQ FORALL-RESULT
              ((LAMBDA (P)
                 (COND
                  ((EV_MEMBER (CAR P) R)
                   (PROGN
                    (COND
                     (*CGBSTAT (SETQ CGB_TR2COUNT* (IPLUS2 CGB_TR2COUNT* 1))))
                    NIL))
                  (T (LIST P))))
               (CAR P)))
      (SETQ FORALL-ENDPTR (LASTPAIR FORALL-RESULT))
      (SETQ P (CDR P))
      (COND ((ATOM FORALL-ENDPTR) (GO STARTOVER)))
     LOOPLABEL
      (COND ((NULL P) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR
              ((LAMBDA (P)
                 (COND
                  ((EV_MEMBER (CAR P) R)
                   (PROGN
                    (COND
                     (*CGBSTAT (SETQ CGB_TR2COUNT* (IPLUS2 CGB_TR2COUNT* 1))))
                    NIL))
                  (T (LIST P))))
               (CAR P)))
      (SETQ FORALL-ENDPTR (LASTPAIR FORALL-ENDPTR))
      (SETQ P (CDR P))
      (GO LOOPLABEL))) 
(PUT 'CPR_TR3CRIT 'NUMBER-OF-ARGS 1) 
(PUT 'CPR_TR3CRIT 'DEFINED-ON-LINE '895) 
(PUT 'CPR_TR3CRIT 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CPR_TR3CRIT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CPR_TR3CRIT (N)
    (PROG (NEWN SCANNEWN Q)
      (PROG (P)
        (SETQ P N)
       LAB
        (COND ((NULL P) (RETURN NIL)))
        ((LAMBDA (P)
           (PROGN
            (SETQ SCANNEWN NEWN)
            (SETQ Q NIL)
            (PROG ()
             WHILELABEL
              (COND ((NOT SCANNEWN) (RETURN NIL)))
              (COND
               ((EV_DIVIDES? (CAR (CAR SCANNEWN)) (CAR P))
                (PROGN
                 (SETQ Q T)
                 (SETQ SCANNEWN NIL)
                 (COND
                  (*CGBSTAT (SETQ CGB_TR3COUNT* (IPLUS2 CGB_TR3COUNT* 1))))))
               (T (SETQ SCANNEWN (CDR SCANNEWN))))
              (GO WHILELABEL))
            (COND ((NOT Q) (SETQ NEWN (CPR_LISTSORTIN P NEWN NIL))))))
         (CAR P))
        (SETQ P (CDR P))
        (GO LAB))
      (RETURN NEWN))) 
(PUT 'CPR_TRAVERSO-PAIRS-DISCARD1 'NUMBER-OF-ARGS 2) 
(PUT 'CPR_TRAVERSO-PAIRS-DISCARD1 'DEFINED-ON-LINE '916) 
(PUT 'CPR_TRAVERSO-PAIRS-DISCARD1 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CPR_TRAVERSO-PAIRS-DISCARD1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CPR_TRAVERSO-PAIRS-DISCARD1 (GK D)
    (PROG (PIJ FORALL-RESULT FORALL-ENDPTR)
      (SETQ PIJ D)
     STARTOVER
      (COND ((NULL PIJ) (RETURN NIL)))
      (SETQ FORALL-RESULT
              ((LAMBDA (PIJ)
                 (COND
                  ((CPR_TRAVERSO-TRIANGLEP (CADR PIJ) (CADDR PIJ) GK (CAR PIJ))
                   (PROGN
                    (COND
                     (*CGBSTAT (SETQ CGB_TR1COUNT* (IPLUS2 CGB_TR1COUNT* 1))))
                    (COND
                     (*CGBVERBOSE
                      (SETQ CGB_PAIRCOUNT* (IDIFFERENCE CGB_PAIRCOUNT* 1))))
                    NIL))
                  (T (LIST PIJ))))
               (CAR PIJ)))
      (SETQ FORALL-ENDPTR (LASTPAIR FORALL-RESULT))
      (SETQ PIJ (CDR PIJ))
      (COND ((ATOM FORALL-ENDPTR) (GO STARTOVER)))
     LOOPLABEL
      (COND ((NULL PIJ) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR
              ((LAMBDA (PIJ)
                 (COND
                  ((CPR_TRAVERSO-TRIANGLEP (CADR PIJ) (CADDR PIJ) GK (CAR PIJ))
                   (PROGN
                    (COND
                     (*CGBSTAT (SETQ CGB_TR1COUNT* (IPLUS2 CGB_TR1COUNT* 1))))
                    (COND
                     (*CGBVERBOSE
                      (SETQ CGB_PAIRCOUNT* (IDIFFERENCE CGB_PAIRCOUNT* 1))))
                    NIL))
                  (T (LIST PIJ))))
               (CAR PIJ)))
      (SETQ FORALL-ENDPTR (LASTPAIR FORALL-ENDPTR))
      (SETQ PIJ (CDR PIJ))
      (GO LOOPLABEL))) 
(PUT 'CPR_TRAVERSO-TRIANGLEP 'NUMBER-OF-ARGS 4) 
(PUT 'CPR_TRAVERSO-TRIANGLEP 'DEFINED-ON-LINE '930) 
(PUT 'CPR_TRAVERSO-TRIANGLEP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CPR_TRAVERSO-TRIANGLEP 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE CPR_TRAVERSO-TRIANGLEP (GI GJ GK TIJ)
    (AND (EV_SDIVP (EV_LCM (CGP_EVLMON GI) (CGP_EVLMON GK)) TIJ)
         (EV_SDIVP (EV_LCM (CGP_EVLMON GJ) (CGP_EVLMON GK)) TIJ))) 
(PUT 'CPR_BUCHCRIT4T 'NUMBER-OF-ARGS 2) 
(PUT 'CPR_BUCHCRIT4T 'DEFINED-ON-LINE '935) 
(PUT 'CPR_BUCHCRIT4T 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CPR_BUCHCRIT4T 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CPR_BUCHCRIT4T (E1 E2) (NOT (EV_DISJOINTP E1 E2))) 
(PUT 'CPR_LISTSORT 'NUMBER-OF-ARGS 2) 
(PUT 'CPR_LISTSORT 'DEFINED-ON-LINE '940) 
(PUT 'CPR_LISTSORT 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CPR_LISTSORT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CPR_LISTSORT (G SLOPPY)
    (PROG (GG)
      (PROG (P)
        (SETQ P G)
       LAB
        (COND ((NULL P) (RETURN NIL)))
        ((LAMBDA (P) (SETQ GG (CPR_LISTSORTIN P GG SLOPPY))) (CAR P))
        (SETQ P (CDR P))
        (GO LAB))
      (RETURN GG))) 
(PUT 'CPR_LISTSORTIN 'NUMBER-OF-ARGS 3) 
(PUT 'CPR_LISTSORTIN 'DEFINED-ON-LINE '949) 
(PUT 'CPR_LISTSORTIN 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CPR_LISTSORTIN 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE CPR_LISTSORTIN (P PL SLOPPY)
    (COND ((NULL PL) (LIST P)) (T (PROGN (CPR_LISTSORTIN1 P PL SLOPPY) PL)))) 
(PUT 'CPR_LISTSORTIN1 'NUMBER-OF-ARGS 3) 
(PUT 'CPR_LISTSORTIN1 'DEFINED-ON-LINE '959) 
(PUT 'CPR_LISTSORTIN1 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CPR_LISTSORTIN1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE CPR_LISTSORTIN1 (P PL SLOPPY)
    (COND
     ((NOT (CPR_LESSP (CAR PL) P SLOPPY))
      (PROGN (RPLACD PL (CONS (CAR PL) (CDR PL))) (RPLACA PL P)))
     ((NULL (CDR PL)) (RPLACD PL (LIST P)))
     (T (CPR_LISTSORTIN1 P (CDR PL) SLOPPY)))) 
(PUT 'CPR_LESSP 'NUMBER-OF-ARGS 3) 
(PUT 'CPR_LESSP 'DEFINED-ON-LINE '971) 
(PUT 'CPR_LESSP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CPR_LESSP 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE CPR_LESSP (PR1 PR2 SLOPPY)
    (COND (SLOPPY (EV_COMPLESS? (CAR PR1) (CAR PR2)))
          (T
           (CPR_LESSP1 PR1 PR2 (IDIFFERENCE (CADDDR PR1) (CADDDR PR2))
            (EV_COMP (CAR PR1) (CAR PR2)))))) 
(PUT 'CPR_LESSP1 'NUMBER-OF-ARGS 4) 
(PUT 'CPR_LESSP1 'DEFINED-ON-LINE '981) 
(PUT 'CPR_LESSP1 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CPR_LESSP1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE CPR_LESSP1 (PR1 PR2 D Q)
    (COND ((NOT (IEQUAL D 0)) (ILESSP D 0)) ((NOT (IEQUAL Q 0)) (ILESSP Q 0))
          (T (ILESSP (CGP_NUMBER (CADDR PR1)) (CGP_NUMBER (CADDR PR2)))))) 
(PUT 'CPR_LISTMERGE 'NUMBER-OF-ARGS 2) 
(PUT 'CPR_LISTMERGE 'DEFINED-ON-LINE '992) 
(PUT 'CPR_LISTMERGE 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CPR_LISTMERGE 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CPR_LISTMERGE (PL1 PL2)
    (PROG (CPL1 CPL2)
      (COND ((NULL PL1) (RETURN PL2)))
      (COND ((NULL PL2) (RETURN PL1)))
      (SETQ CPL1 (CAR PL1))
      (SETQ CPL2 (CAR PL2))
      (RETURN
       (COND
        ((CPR_LESSP CPL1 CPL2 NIL) (CONS CPL1 (CPR_LISTMERGE (CDR PL1) PL2)))
        (T (CONS CPL2 (CPR_LISTMERGE PL1 (CDR PL2)))))))) 
(ENDMODULE) 
(MODULE (LIST 'BRA)) 
(DE BRA_CD (BR) (CAR BR)) 
(PUT 'BRA_CD 'NUMBER-OF-ARGS 1) 
(PUT 'BRA_CD 'DEFINED-ON-LINE '1017) 
(PUT 'BRA_CD 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'BRA_CD 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'BRA_CD 'INLINE '(LAMBDA (BR) (CAR BR))) 
(DE BRA_SYSTEM (BR) (CADR BR)) 
(PUT 'BRA_SYSTEM 'NUMBER-OF-ARGS 1) 
(PUT 'BRA_SYSTEM 'DEFINED-ON-LINE '1022) 
(PUT 'BRA_SYSTEM 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'BRA_SYSTEM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'BRA_SYSTEM 'INLINE '(LAMBDA (BR) (CADR BR))) 
(DE BRA_CPRL (BR) (CADDR BR)) 
(PUT 'BRA_CPRL 'NUMBER-OF-ARGS 1) 
(PUT 'BRA_CPRL 'DEFINED-ON-LINE '1027) 
(PUT 'BRA_CPRL 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'BRA_CPRL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'BRA_CPRL 'INLINE '(LAMBDA (BR) (CADDR BR))) 
(DE BRA_MK (CD SYSTEM CPRL) (LIST CD SYSTEM CPRL)) 
(PUT 'BRA_MK 'NUMBER-OF-ARGS 3) 
(PUT 'BRA_MK 'DEFINED-ON-LINE '1032) 
(PUT 'BRA_MK 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'BRA_MK 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(PUTC 'BRA_MK 'INLINE '(LAMBDA (CD SYSTEM CPRL) (LIST CD SYSTEM CPRL))) 
(PUT 'BRA_SPLIT 'NUMBER-OF-ARGS 3) 
(PUT 'BRA_SPLIT 'DEFINED-ON-LINE '1037) 
(PUT 'BRA_SPLIT 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'BRA_SPLIT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE BRA_SPLIT (BRA P XVARS)
    (COND ((CGP_GREENP P) (LIST BRA)) ((EQ (CADDR BRA) 'FINAL) (LIST BRA))
          (T (BRA_SPLIT1 BRA (CGP_ENUMERATE (CGP_CONDENSE P)) XVARS)))) 
(PUT 'BRA_SPLIT1 'NUMBER-OF-ARGS 3) 
(PUT 'BRA_SPLIT1 'DEFINED-ON-LINE '1046) 
(PUT 'BRA_SPLIT1 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'BRA_SPLIT1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE BRA_SPLIT1 (BRA P XVARS)
    (PROG (PR FORALL-RESULT FORALL-ENDPTR)
      (SETQ PR (CGP_2SCPL P (CAR BRA) XVARS))
      (COND ((NULL PR) (RETURN NIL)))
      (SETQ FORALL-RESULT
              (SETQ FORALL-ENDPTR
                      (CONS
                       ((LAMBDA (PR) (BRA_EXT BRA (CAR PR) (CDR PR))) (CAR PR))
                       NIL)))
     LOOPLABEL
      (SETQ PR (CDR PR))
      (COND ((NULL PR) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR
              (CONS ((LAMBDA (PR) (BRA_EXT BRA (CAR PR) (CDR PR))) (CAR PR))
                    NIL))
      (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
      (GO LOOPLABEL))) 
(PUT 'BRA_EXT 'NUMBER-OF-ARGS 3) 
(PUT 'BRA_EXT 'DEFINED-ON-LINE '1051) 
(PUT 'BRA_EXT 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'BRA_EXT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE BRA_EXT (BRA CD SCP)
    (PROG (SY D)
      (COND ((CGP_UNITP SCP) (RETURN (LIST CD (LIST SCP) 'FINAL))))
      (SETQ SY
              (PROG (P FORALL-RESULT FORALL-ENDPTR)
                (SETQ P (CADR BRA))
                (COND ((NULL P) (RETURN NIL)))
                (SETQ FORALL-RESULT
                        (SETQ FORALL-ENDPTR
                                (CONS ((LAMBDA (P) (CGP_CP P)) (CAR P)) NIL)))
               LOOPLABEL
                (SETQ P (CDR P))
                (COND ((NULL P) (RETURN FORALL-RESULT)))
                (RPLACD FORALL-ENDPTR
                        (CONS ((LAMBDA (P) (CGP_CP P)) (CAR P)) NIL))
                (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                (GO LOOPLABEL)))
      (SETQ D
              (PROG (PR FORALL-RESULT FORALL-ENDPTR)
                (SETQ PR (CADDR BRA))
                (COND ((NULL PR) (RETURN NIL)))
                (SETQ FORALL-RESULT
                        (SETQ FORALL-ENDPTR
                                (CONS ((LAMBDA (PR) PR) (CAR PR)) NIL)))
               LOOPLABEL
                (SETQ PR (CDR PR))
                (COND ((NULL PR) (RETURN FORALL-RESULT)))
                (RPLACD FORALL-ENDPTR (CONS ((LAMBDA (PR) PR) (CAR PR)) NIL))
                (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                (GO LOOPLABEL)))
      (COND ((CGP_GREENP SCP) (RETURN (LIST CD SY D))))
      (SETQ D (CPR_TRAVERSO-PAIRLIST SCP SY D))
      (RETURN (LIST CD (NCONC SY (LIST SCP)) D)))) 
(DE BRA_ORDP (B1 B2) (CD_ORDP (CAR B1) (CAR B2))) 
(PUT 'BRA_ORDP 'NUMBER-OF-ARGS 2) 
(PUT 'BRA_ORDP 'DEFINED-ON-LINE '1065) 
(PUT 'BRA_ORDP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'BRA_ORDP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(PUTC 'BRA_ORDP 'INLINE '(LAMBDA (B1 B2) (CD_ORDP (CAR B1) (CAR B2)))) 
(ENDMODULE) 
(MODULE (LIST 'GSY)) 
(PUT 'GSY_INIT 'NUMBER-OF-ARGS 3) 
(PUT 'GSY_INIT 'DEFINED-ON-LINE '1078) 
(PUT 'GSY_INIT 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'GSY_INIT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE GSY_INIT (L THEO XVARS)
    (PROG (S)
      (SETQ S (LIST (LIST THEO NIL NIL)))
      (PROG (X)
        (SETQ X L)
       LAB
        (COND ((NULL X) (RETURN NIL)))
        ((LAMBDA (X)
           (SETQ S
                   (PROG (Y FORALL-RESULT FORALL-ENDPTR)
                     (SETQ Y S)
                    STARTOVER
                     (COND ((NULL Y) (RETURN NIL)))
                     (SETQ FORALL-RESULT
                             ((LAMBDA (Y) (BRA_SPLIT Y X XVARS)) (CAR Y)))
                     (SETQ FORALL-ENDPTR (LASTPAIR FORALL-RESULT))
                     (SETQ Y (CDR Y))
                     (COND ((ATOM FORALL-ENDPTR) (GO STARTOVER)))
                    LOOPLABEL
                     (COND ((NULL Y) (RETURN FORALL-RESULT)))
                     (RPLACD FORALL-ENDPTR
                             ((LAMBDA (Y) (BRA_SPLIT Y X XVARS)) (CAR Y)))
                     (SETQ FORALL-ENDPTR (LASTPAIR FORALL-ENDPTR))
                     (SETQ Y (CDR Y))
                     (GO LOOPLABEL))))
         (CAR X))
        (SETQ X (CDR X))
        (GO LAB))
      (RETURN S))) 
(DE GSY_NORMALIZE (L) (SORT (GSY_NORMALIZE1 L) 'BRA_ORDP)) 
(PUT 'GSY_NORMALIZE 'NUMBER-OF-ARGS 1) 
(PUT 'GSY_NORMALIZE 'DEFINED-ON-LINE '1090) 
(PUT 'GSY_NORMALIZE 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'GSY_NORMALIZE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'GSY_NORMALIZE 'INLINE '(LAMBDA (L) (SORT (GSY_NORMALIZE1 L) 'BRA_ORDP))) 
(PUT 'GSY_NORMALIZE1 'NUMBER-OF-ARGS 1) 
(PUT 'GSY_NORMALIZE1 'DEFINED-ON-LINE '1094) 
(PUT 'GSY_NORMALIZE1 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'GSY_NORMALIZE1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE GSY_NORMALIZE1 (L)
    (PROG (BRA FORALL-RESULT FORALL-ENDPTR)
      (SETQ BRA L)
      (COND ((NULL BRA) (RETURN NIL)))
      (SETQ FORALL-RESULT
              (SETQ FORALL-ENDPTR
                      (CONS
                       ((LAMBDA (BRA)
                          (LIST (SORT (CAR BRA) 'CD_ORDATP)
                                (CGP_LSORT
                                 (PROG (X FORALL-RESULT FORALL-ENDPTR)
                                   (SETQ X (CADR BRA))
                                   (COND ((NULL X) (RETURN NIL)))
                                   (SETQ FORALL-RESULT
                                           (SETQ FORALL-ENDPTR
                                                   (CONS
                                                    ((LAMBDA (X)
                                                       (CGP_NORMALIZE X))
                                                     (CAR X))
                                                    NIL)))
                                  LOOPLABEL
                                   (SETQ X (CDR X))
                                   (COND ((NULL X) (RETURN FORALL-RESULT)))
                                   (RPLACD FORALL-ENDPTR
                                           (CONS
                                            ((LAMBDA (X) (CGP_NORMALIZE X))
                                             (CAR X))
                                            NIL))
                                   (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                                   (GO LOOPLABEL)))
                                (CADDR BRA)))
                        (CAR BRA))
                       NIL)))
     LOOPLABEL
      (SETQ BRA (CDR BRA))
      (COND ((NULL BRA) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR
              (CONS
               ((LAMBDA (BRA)
                  (LIST (SORT (CAR BRA) 'CD_ORDATP)
                        (CGP_LSORT
                         (PROG (X FORALL-RESULT FORALL-ENDPTR)
                           (SETQ X (CADR BRA))
                           (COND ((NULL X) (RETURN NIL)))
                           (SETQ FORALL-RESULT
                                   (SETQ FORALL-ENDPTR
                                           (CONS
                                            ((LAMBDA (X) (CGP_NORMALIZE X))
                                             (CAR X))
                                            NIL)))
                          LOOPLABEL
                           (SETQ X (CDR X))
                           (COND ((NULL X) (RETURN FORALL-RESULT)))
                           (RPLACD FORALL-ENDPTR
                                   (CONS
                                    ((LAMBDA (X) (CGP_NORMALIZE X)) (CAR X))
                                    NIL))
                           (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                           (GO LOOPLABEL)))
                        (CADDR BRA)))
                (CAR BRA))
               NIL))
      (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
      (GO LOOPLABEL))) 
(ENDMODULE) 
(MODULE (LIST 'CGP)) 
(DE CGP_MK (HP RP SUGAR NUMBER CI) (LIST 'CGP HP RP SUGAR NUMBER CI)) 
(PUT 'CGP_MK 'NUMBER-OF-ARGS 5) 
(PUT 'CGP_MK 'DEFINED-ON-LINE '1116) 
(PUT 'CGP_MK 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_MK 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(PUTC 'CGP_MK 'INLINE
      '(LAMBDA (HP RP SUGAR NUMBER CI) (LIST 'CGP HP RP SUGAR NUMBER CI))) 
(DE CGP_HP (CGP) (CADR CGP)) 
(PUT 'CGP_HP 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_HP 'DEFINED-ON-LINE '1121) 
(PUT 'CGP_HP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_HP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGP_HP 'INLINE '(LAMBDA (CGP) (CADR CGP))) 
(DE CGP_RP (CGP) (CADDR CGP)) 
(PUT 'CGP_RP 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_RP 'DEFINED-ON-LINE '1126) 
(PUT 'CGP_RP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_RP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGP_RP 'INLINE '(LAMBDA (CGP) (CADDR CGP))) 
(DE CGP_SUGAR (CGP) (CADDDR CGP)) 
(PUT 'CGP_SUGAR 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_SUGAR 'DEFINED-ON-LINE '1131) 
(PUT 'CGP_SUGAR 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_SUGAR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGP_SUGAR 'INLINE '(LAMBDA (CGP) (CADDDR CGP))) 
(DE CGP_NUMBER (CGP) (NTH CGP 5)) 
(PUT 'CGP_NUMBER 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_NUMBER 'DEFINED-ON-LINE '1136) 
(PUT 'CGP_NUMBER 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_NUMBER 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGP_NUMBER 'INLINE '(LAMBDA (CGP) (NTH CGP 5))) 
(PUT 'CGP_CI 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_CI 'DEFINED-ON-LINE '1141) 
(PUT 'CGP_CI 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_CI 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGP_CI (CGP) (NTH CGP 6)) 
(DE CGP_INIT (VARS SM SX) (DIP_INIT VARS SM SX)) 
(PUT 'CGP_INIT 'NUMBER-OF-ARGS 3) 
(PUT 'CGP_INIT 'DEFINED-ON-LINE '1146) 
(PUT 'CGP_INIT 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_INIT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(PUTC 'CGP_INIT 'INLINE '(LAMBDA (VARS SM SX) (DIP_INIT VARS SM SX))) 
(DE CGP_CLEANUP (L) (DIP_CLEANUP L)) 
(PUT 'CGP_CLEANUP 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_CLEANUP 'DEFINED-ON-LINE '1151) 
(PUT 'CGP_CLEANUP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_CLEANUP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGP_CLEANUP 'INLINE '(LAMBDA (L) (DIP_CLEANUP L))) 
(DE CGP_LBC (U) (DIP_LBC (CADDR U))) 
(PUT 'CGP_LBC 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_LBC 'DEFINED-ON-LINE '1155) 
(PUT 'CGP_LBC 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_LBC 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGP_LBC 'INLINE '(LAMBDA (U) (DIP_LBC (CADDR U)))) 
(DE CGP_EVLMON (U) (DIP_EVLMON (CADDR U))) 
(PUT 'CGP_EVLMON 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_EVLMON 'DEFINED-ON-LINE '1160) 
(PUT 'CGP_EVLMON 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_EVLMON 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGP_EVLMON 'INLINE '(LAMBDA (U) (DIP_EVLMON (CADDR U)))) 
(DE CGP_ZEROP (U) (AND (NULL (CADR U)) (NULL (CADDR U)))) 
(PUT 'CGP_ZEROP 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_ZEROP 'DEFINED-ON-LINE '1165) 
(PUT 'CGP_ZEROP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_ZEROP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGP_ZEROP 'INLINE '(LAMBDA (U) (AND (NULL (CADR U)) (NULL (CADDR U))))) 
(DE CGP_GREENP (U) (NULL (CADDR U))) 
(PUT 'CGP_GREENP 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_GREENP 'DEFINED-ON-LINE '1170) 
(PUT 'CGP_GREENP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_GREENP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGP_GREENP 'INLINE '(LAMBDA (U) (NULL (CADDR U)))) 
(DE CGP_MONP (U) (AND (NULL (CADR U)) (DIP_MONP (CADDR U)))) 
(PUT 'CGP_MONP 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_MONP 'DEFINED-ON-LINE '1175) 
(PUT 'CGP_MONP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_MONP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGP_MONP 'INLINE
      '(LAMBDA (U) (AND (NULL (CADR U)) (DIP_MONP (CADDR U))))) 
(DE CGP_ZERO NIL (LIST 'CGP NIL NIL NIL NIL 'ZERO)) 
(PUT 'CGP_ZERO 'NUMBER-OF-ARGS 0) 
(PUT 'CGP_ZERO 'DEFINED-ON-LINE '1179) 
(PUT 'CGP_ZERO 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_ZERO 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(PUTC 'CGP_ZERO 'INLINE '(LAMBDA () (LIST 'CGP NIL NIL NIL NIL 'ZERO))) 
(DE CGP_ONE NIL (LIST 'CGP NIL (DIP_ONE) 0 NIL 'RED)) 
(PUT 'CGP_ONE 'NUMBER-OF-ARGS 0) 
(PUT 'CGP_ONE 'DEFINED-ON-LINE '1183) 
(PUT 'CGP_ONE 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_ONE 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(PUTC 'CGP_ONE 'INLINE '(LAMBDA () (LIST 'CGP NIL (DIP_ONE) 0 NIL 'RED))) 
(DE CGP_TDEG (U) (DIP_TDEG (CADDR U))) 
(PUT 'CGP_TDEG 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_TDEG 'DEFINED-ON-LINE '1188) 
(PUT 'CGP_TDEG 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_TDEG 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGP_TDEG 'INLINE '(LAMBDA (U) (DIP_TDEG (CADDR U)))) 
(DE CGP_MRED (CGP)
    (LIST 'CGP (CADR CGP) (DIP_MRED (CADDR CGP)) (CADDDR CGP) NIL 'UNKNOWN)) 
(PUT 'CGP_MRED 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_MRED 'DEFINED-ON-LINE '1193) 
(PUT 'CGP_MRED 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_MRED 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGP_MRED 'INLINE
      '(LAMBDA (CGP)
         (LIST 'CGP (CADR CGP) (DIP_MRED (CADDR CGP)) (CADDDR CGP) NIL
               'UNKNOWN))) 
(DE CGP_CP (CGP)
    (LIST 'CGP (CADR CGP) (CADDR CGP) (CADDDR CGP) (NTH CGP 5) (CGP_CI CGP))) 
(PUT 'CGP_CP 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_CP 'DEFINED-ON-LINE '1198) 
(PUT 'CGP_CP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_CP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGP_CP 'INLINE
      '(LAMBDA (CGP)
         (LIST 'CGP (CADR CGP) (CADDR CGP) (CADDDR CGP) (NTH CGP 5)
               (CGP_CI CGP)))) 
(DE CGP_F2CGP (U) (LIST 'CGP NIL (DIP_F2DIP U) NIL NIL 'UNKNOWN)) 
(PUT 'CGP_F2CGP 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_F2CGP 'DEFINED-ON-LINE '1203) 
(PUT 'CGP_F2CGP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_F2CGP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGP_F2CGP 'INLINE
      '(LAMBDA (U) (LIST 'CGP NIL (DIP_F2DIP U) NIL NIL 'UNKNOWN))) 
(DE CGP_2A (U) (DIP_2A (DIP_APPEND (CADR U) (CADDR U)))) 
(PUT 'CGP_2A 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_2A 'DEFINED-ON-LINE '1207) 
(PUT 'CGP_2A 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_2A 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGP_2A 'INLINE '(LAMBDA (U) (DIP_2A (DIP_APPEND (CADR U) (CADDR U))))) 
(DE CGP_2F (U) (DIP_2F (DIP_APPEND (CADR U) (CADDR U)))) 
(PUT 'CGP_2F 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_2F 'DEFINED-ON-LINE '1212) 
(PUT 'CGP_2F 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_2F 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGP_2F 'INLINE '(LAMBDA (U) (DIP_2F (DIP_APPEND (CADR U) (CADDR U))))) 
(DE CGP_ENUMERATE (P)
    (CGP_SETNUMBER P (SETQ CGP_PCOUNT* (IPLUS2 CGP_PCOUNT* 1)))) 
(PUT 'CGP_ENUMERATE 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_ENUMERATE 'DEFINED-ON-LINE '1217) 
(PUT 'CGP_ENUMERATE 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_ENUMERATE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGP_ENUMERATE 'INLINE
      '(LAMBDA (P) (CGP_SETNUMBER P (SETQ CGP_PCOUNT* (IPLUS2 CGP_PCOUNT* 1))))) 
(DE CGP_UNITP (P) (AND (CADDR P) (EV_ZERO? (DIP_EVLMON (CADDR P))))) 
(PUT 'CGP_UNITP 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_UNITP 'DEFINED-ON-LINE '1222) 
(PUT 'CGP_UNITP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_UNITP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGP_UNITP 'INLINE
      '(LAMBDA (P) (AND (CADDR P) (EV_ZERO? (DIP_EVLMON (CADDR P)))))) 
(DE CGP_SETNUMBER (P N) (PROGN (SETCAR (PNTH P 5) N) P)) 
(PUT 'CGP_SETNUMBER 'NUMBER-OF-ARGS 2) 
(PUT 'CGP_SETNUMBER 'DEFINED-ON-LINE '1227) 
(PUT 'CGP_SETNUMBER 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_SETNUMBER 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(PUTC 'CGP_SETNUMBER 'INLINE '(LAMBDA (P N) (PROGN (SETCAR (PNTH P 5) N) P))) 
(DE CGP_SETSUGAR (P S) (PROGN (SETCAR (PNTH P 4) S) P)) 
(PUT 'CGP_SETSUGAR 'NUMBER-OF-ARGS 2) 
(PUT 'CGP_SETSUGAR 'DEFINED-ON-LINE '1235) 
(PUT 'CGP_SETSUGAR 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_SETSUGAR 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(PUTC 'CGP_SETSUGAR 'INLINE '(LAMBDA (P S) (PROGN (SETCAR (PNTH P 4) S) P))) 
(DE CGP_SETCI (P TG) (PROGN (SETCAR (PNTH P 6) TG) P)) 
(PUT 'CGP_SETCI 'NUMBER-OF-ARGS 2) 
(PUT 'CGP_SETCI 'DEFINED-ON-LINE '1243) 
(PUT 'CGP_SETCI 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_SETCI 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(PUTC 'CGP_SETCI 'INLINE '(LAMBDA (P TG) (PROGN (SETCAR (PNTH P 6) TG) P))) 
(PUT 'CGP_CONDENSE 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_CONDENSE 'DEFINED-ON-LINE '1252) 
(PUT 'CGP_CONDENSE 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_CONDENSE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGP_CONDENSE (P) (PROGN (DIP_CONDENSE (CADR P)) (DIP_CONDENSE (CADDR P)) P)) 
(PUT 'CGP_2SCPL 'NUMBER-OF-ARGS 3) 
(PUT 'CGP_2SCPL 'DEFINED-ON-LINE '1261) 
(PUT 'CGP_2SCPL 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_2SCPL 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE CGP_2SCPL (P CD XVARS)
    (COND ((AND *CGBGEN (NULL XVARS)) (CGP_2SCPL-GEN P CD))
          (T (CGP_2SCPL1 P CD XVARS)))) 
(PUT 'CGP_2SCPL1 'NUMBER-OF-ARGS 3) 
(PUT 'CGP_2SCPL1 'DEFINED-ON-LINE '1270) 
(PUT 'CGP_2SCPL1 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_2SCPL1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE CGP_2SCPL1 (P CD XVARS)
    (PROG (HP RP S N HC HT L NCDEQ NCDNEQ)
      (SETQ HP (CADR P))
      (COND ((AND *CGBGREEN HP) (REDERR (LIST "cgp_2scpl1: Non empty hp" P))))
      (SETQ RP (CADDR P))
      (SETQ S (CADDDR P))
      (SETQ N (NTH P 5))
      (PROG ()
       WHILELABEL
        (COND ((NOT RP) (RETURN NIL)))
        (PROGN
         (SETQ HC (DIP_LBC RP))
         (SETQ HT (DIP_EVLMON RP))
         (SETQ NCDEQ (SETQ NCDNEQ NIL))
         (COND
          ((OR (CD_SUREP (BC_MKAT 'NEQ HC) CD)
               (EQCAR (SETQ NCDEQ (CD_SIADD (LIST (BC_MKAT 'EQUAL HC)) CD))
                      'FALSE))
           (PROGN
            (SETQ L
                    (CONS
                     (CONS CD (LIST 'CGP HP RP (OR S (DIP_TDEG RP)) N 'RED))
                     L))
            (SETQ HC 'BREAK)
            (SETQ RP NIL)))
          ((AND *CGBGEN (NULL (INTERSECTION XVARS (BC_VARS HC))))
           (PROGN
            (SETQ NCDNEQ (CD_SIADD (LIST (BC_MKAT 'NEQ HC)) CD))
            (SETQ L
                    (CONS
                     (CONS NCDNEQ
                           (LIST 'CGP HP RP (OR S (DIP_TDEG RP)) N 'RED))
                     L))
            (SETQ HC 'BREAK)
            (SETQ RP NIL)))
          (T
           (PROGN
            (COND
             ((NOT
               (OR (CD_SUREP (BC_MKAT 'EQUAL HC) CD)
                   (EQCAR (SETQ NCDNEQ (CD_SIADD (LIST (BC_MKAT 'NEQ HC)) CD))
                          'FALSE)))
              (PROGN
               (SETQ NCDNEQ (OR NCDNEQ (CD_SIADD (LIST (BC_MKAT 'NEQ HC)) CD)))
               (SETQ NCDEQ (OR NCDEQ (CD_SIADD (LIST (BC_MKAT 'EQUAL HC)) CD)))
               (SETQ L
                       (CONS
                        (CONS NCDNEQ
                              (LIST 'CGP HP RP (OR S (DIP_TDEG RP)) N 'RED))
                        L))
               (SETQ CD NCDEQ)
               NIL)))
            (SETQ RP (DIP_MRED RP))
            (COND ((NOT *CGBGREEN) (SETQ HP (DIP_APPENDMON HP HC HT))))
            NIL))))
        (GO WHILELABEL))
      (COND
       ((NEQ HC 'BREAK)
        (SETQ L (CONS (CONS CD (LIST 'CGP NIL NIL NIL NIL 'ZERO)) L))))
      (RETURN (REVERSIP L)))) 
(PUT 'CGP_2SCPL-GEN 'NUMBER-OF-ARGS 2) 
(PUT 'CGP_2SCPL-GEN 'DEFINED-ON-LINE '1315) 
(PUT 'CGP_2SCPL-GEN 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_2SCPL-GEN 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CGP_2SCPL-GEN (P CD)
    (PROG (HP RP)
      (SETQ HP (CADR P))
      (SETQ RP (CADDR P))
      (COND
       ((NULL RP) (RETURN (LIST (CONS CD (LIST 'CGP NIL NIL NIL NIL 'ZERO))))))
      (SETQ CD (CD_SIADD (LIST (BC_MKAT 'NEQ (DIP_LBC RP))) CD))
      (RETURN
       (LIST
        (CONS CD
              (LIST 'CGP HP RP (OR (CADDDR P) (DIP_TDEG RP)) (NTH P 5)
                    'RED)))))) 
(PUT 'CGP_ILCOMB 'NUMBER-OF-ARGS 6) 
(PUT 'CGP_ILCOMB 'DEFINED-ON-LINE '1328) 
(PUT 'CGP_ILCOMB 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_ILCOMB 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE CGP_ILCOMB (P1 C1 T1 P2 C2 T2)
    (PROG (HP RP S)
      (SETQ HP (DIP_ILCOMB (CADR P1) C1 T1 (CADR P2) C2 T2))
      (SETQ RP (DIP_ILCOMB (CADDR P1) C1 T1 (CADDR P2) C2 T2))
      (SETQ S
              (|EV_MAX#| (IPLUS2 (CADDDR P1) (EV_TDEG T1))
               (IPLUS2 (CADDDR P2) (EV_TDEG T2))))
      (RETURN (LIST 'CGP HP RP S NIL 'UNKNOWN)))) 
(PUT 'CGP_ILCOMBR 'NUMBER-OF-ARGS 5) 
(PUT 'CGP_ILCOMBR 'DEFINED-ON-LINE '1339) 
(PUT 'CGP_ILCOMBR 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_ILCOMBR 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE CGP_ILCOMBR (P1 C1 P2 C2 T2)
    (PROG (HP RP S)
      (SETQ HP (DIP_ILCOMBR (CADR P1) C1 (CADR P2) C2 T2))
      (SETQ RP (DIP_ILCOMBR (CADDR P1) C1 (CADDR P2) C2 T2))
      (SETQ S (|EV_MAX#| (CADDDR P1) (IPLUS2 (CADDDR P2) (EV_TDEG T2))))
      (RETURN (LIST 'CGP HP RP S NIL 'UNKNOWN)))) 
(PUT 'CGP_HPCP 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_HPCP 'DEFINED-ON-LINE '1350) 
(PUT 'CGP_HPCP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_HPCP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGP_HPCP (CGP)
    (LIST 'CGP (DIP_CP (CADR CGP)) (CADDR CGP) (CADDDR CGP) (NTH CGP 5)
          (CGP_CI CGP))) 
(PUT 'CGP_SHIFT 'NUMBER-OF-ARGS 2) 
(PUT 'CGP_SHIFT 'DEFINED-ON-LINE '1356) 
(PUT 'CGP_SHIFT 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_SHIFT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CGP_SHIFT (P XVARS)
    (COND ((AND *CGBGEN (NULL XVARS)) (CGP_SHIFT-GEN P))
          (T (CGP_SHIFT1 P XVARS)))) 
(PUT 'CGP_SHIFT1 'NUMBER-OF-ARGS 2) 
(PUT 'CGP_SHIFT1 'DEFINED-ON-LINE '1365) 
(PUT 'CGP_SHIFT1 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_SHIFT1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CGP_SHIFT1 (P XVARS)
    (PROG (HP RP HT HC C)
      (SETQ HP (CADR P))
      (SETQ RP (CADDR P))
      (SETQ C T)
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND C RP)) (RETURN NIL)))
        (PROGN
         (SETQ HT (DIP_EVLMON RP))
         (SETQ HC (DIP_LBC RP))
         (COND
          ((CD_SUREP (BC_MKAT 'EQUAL HC) CGB_CD*)
           (PROGN
            (COND ((NOT *CGBGREEN) (SETQ HP (DIP_NCONCMON HP HC HT))))
            (SETQ RP (DIP_MRED RP))))
          (T (SETQ C NIL))))
        (GO WHILELABEL))
      (COND
       ((AND (NULL RP) (IDP (CGP_CI P)))
        (RETURN (LIST 'CGP NIL NIL NIL NIL 'ZERO))))
      (RETURN (LIST 'CGP HP RP (CADDDR P) (NTH P 5) (CGP_CI P))))) 
(DE CGP_SHIFT-GEN (P) P) 
(PUT 'CGP_SHIFT-GEN 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_SHIFT-GEN 'DEFINED-ON-LINE '1388) 
(PUT 'CGP_SHIFT-GEN 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_SHIFT-GEN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'CGP_SHIFT-GEN 'INLINE '(LAMBDA (P) P)) 
(PUT 'CGP_SHIFTWHITE 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_SHIFTWHITE 'DEFINED-ON-LINE '1395) 
(PUT 'CGP_SHIFTWHITE 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_SHIFTWHITE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGP_SHIFTWHITE (P)
    (PROG (NHP NCI)
      (SETQ NHP
              (DIP_NCONCMON (CADR P) (DIP_LBC (CADDR P))
               (DIP_EVLMON (CADDR P))))
      (SETQ NCI (CGP_CI P))
      (SETQ NCI
              (CONS 'MIXED
                    (CONS (DIP_EVLMON (CADDR P))
                          (COND ((IDP NCI) NIL) (T (CDR NCI))))))
      (RETURN (LIST 'CGP NHP (DIP_MRED (CADDR P)) (CADDDR P) (NTH P 5) NCI)))) 
(PUT 'CGP_BACKSHIFT 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_BACKSHIFT 'DEFINED-ON-LINE '1406) 
(PUT 'CGP_BACKSHIFT 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_BACKSHIFT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGP_BACKSHIFT (P)
    (PROG (CI)
      (SETQ CI (CGP_CI P))
      (COND
       ((OR (NOT (PAIRP CI)) (AND (PAIRP CI) (NULL (CDR CI)))) (RETURN P)))
      (COND ((CADDR P) (REDERR "cgp_backshift: Rest polynomial must be zero")))
      (RETURN (CGP_BACKSHIFT1 P)))) 
(PUT 'CGP_BACKSHIFT1 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_BACKSHIFT1 'DEFINED-ON-LINE '1418) 
(PUT 'CGP_BACKSHIFT1 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_BACKSHIFT1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGP_BACKSHIFT1 (P)
    (PROG (HP WTL NHP)
      (SETQ HP (CADR P))
      (SETQ WTL (CDR (CGP_CI P)))
      (PROG ()
       WHILELABEL
        (COND
         ((NOT (AND HP (NOT (EV_MEMBER (DIP_EVLMON HP) WTL)))) (RETURN NIL)))
        (PROGN
         (SETQ NHP (DIP_NCONCMON NHP (DIP_LBC HP) (DIP_EVLMON HP)))
         (SETQ HP (DIP_MRED HP)))
        (GO WHILELABEL))
      (COND (HP (RETURN (LIST 'CGP NHP HP (CADDDR P) (NTH P 5) 'UNKNOWN))))
      (RETURN (LIST 'CGP NIL NIL NIL NIL 'ZERO)))) 
(PUT 'CGP_CANCELMEV 'NUMBER-OF-ARGS 2) 
(PUT 'CGP_CANCELMEV 'DEFINED-ON-LINE '1435) 
(PUT 'CGP_CANCELMEV 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_CANCELMEV 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CGP_CANCELMEV (P EV)
    (LIST 'CGP (CADR P) (DIP_CANCELMEV (CADDR P) EV) (CADDDR P) (NTH P 5)
          (CGP_CI P))) 
(PUT 'CGP_BCQUOT 'NUMBER-OF-ARGS 2) 
(PUT 'CGP_BCQUOT 'DEFINED-ON-LINE '1441) 
(PUT 'CGP_BCQUOT 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_BCQUOT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CGP_BCQUOT (P C)
    (LIST 'CGP (DIP_BCQUOT (CADR P) C) (DIP_BCQUOT (CADDR P) C) (CADDDR P)
          (NTH P 5) (CGP_CI P))) 
(PUT 'CGP_BCPROD 'NUMBER-OF-ARGS 2) 
(PUT 'CGP_BCPROD 'DEFINED-ON-LINE '1447) 
(PUT 'CGP_BCPROD 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_BCPROD 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CGP_BCPROD (P C)
    (LIST 'CGP (DIP_BCPROD (CADR P) C) (DIP_BCPROD (CADDR P) C) (CADDDR P)
          (NTH P 5) (CGP_CI P))) 
(PUT 'CGP_SIMPDCONT 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_SIMPDCONT 'DEFINED-ON-LINE '1453) 
(PUT 'CGP_SIMPDCONT 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_SIMPDCONT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGP_SIMPDCONT (P)
    (PROG (C)
      (COND ((AND (NULL (CADR P)) (NULL (CADDR P))) (RETURN P)))
      (SETQ C (CGP_DCONT P))
      (COND ((BC_MINUS? (CGP_RLBC P)) (SETQ C (BC_NEG C))))
      (RETURN
       (LIST 'CGP (DIP_BCQUOT (CADR P) C) (DIP_BCQUOT (CADDR P) C) (CADDDR P)
             (NTH P 5) (CGP_CI P))))) 
(PUT 'CGP_RLBC 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_RLBC 'DEFINED-ON-LINE '1467) 
(PUT 'CGP_RLBC 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_RLBC 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGP_RLBC (P)
    (COND ((AND (NULL (CADR P)) (NULL (CADDR P))) (BC_FD 0))
          ((CADR P) (DIP_LBC (CADR P))) (T (DIP_LBC (CADDR P))))) 
(PUT 'CGP_DCONT 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_DCONT 'DEFINED-ON-LINE '1478) 
(PUT 'CGP_DCONT 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_DCONT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGP_DCONT (P)
    (PROG (C)
      (SETQ C (DIP_DCONT (CADR P)))
      (COND ((BC_ONE? C) (RETURN C)))
      (RETURN (DIP_DCONT1 (CADDR P) C)))) 
(PUT 'CGP_NORMALIZE 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_NORMALIZE 'DEFINED-ON-LINE '1489) 
(PUT 'CGP_NORMALIZE 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_NORMALIZE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGP_NORMALIZE (U)
    (LIST 'CGP NIL (DIP_APPEND (CADR U) (CADDR U)) NIL NIL 'UNKNOWN)) 
(PUT 'CGP_GREEN 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_GREEN 'DEFINED-ON-LINE '1494) 
(PUT 'CGP_GREEN 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_GREEN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGP_GREEN (U) (LIST 'CGP NIL (CADDR U) NIL NIL 'GREEN_COLORED)) 
(PUT 'CGP_LSORT 'NUMBER-OF-ARGS 1) 
(PUT 'CGP_LSORT 'DEFINED-ON-LINE '1499) 
(PUT 'CGP_LSORT 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_LSORT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CGP_LSORT (PL) (SORT PL (FUNCTION CGP_COMP))) 
(DE CGP_COMP (P1 P2) (DIP_COMP (CADDR P1) (CADDR P2))) 
(PUT 'CGP_COMP 'NUMBER-OF-ARGS 2) 
(PUT 'CGP_COMP 'DEFINED-ON-LINE '1503) 
(PUT 'CGP_COMP 'DEFINED-IN-FILE 'CGB/CGB.RED) 
(PUT 'CGP_COMP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(PUTC 'CGP_COMP 'INLINE '(LAMBDA (P1 P2) (DIP_COMP (CADDR P1) (CADDR P2)))) 
(ENDMODULE) 