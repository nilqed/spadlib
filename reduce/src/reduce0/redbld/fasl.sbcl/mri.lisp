(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'MRI)) 
(REVISION 'MRI "$Id: mri.red 6019 2021-09-11 08:40:13Z thomas-sturm $") 
(COPYRIGHT 'MRI "(c) 2008-2021 T. Sturm") 
(CREATE-PACKAGE '(MRI MRIQE) NIL) 
(LOADTIME (LOAD-PACKAGE 'CL)) 
(LOAD-PACKAGE 'PASF) 
(LOAD-PACKAGE 'OFSF) 
(FLUID '(*MSG *RLVERBOSE)) 
(SWITCH (LIST 'RLMRIVB 'RLMRIVBIO 'RLSIMPLFLOOR 'RLMRIVB2)) 
(ON1 'RLMRIVB) 
(OFF1 'RLMRIVB2) 
(ON1 'RLSIMPLFLOOR) 
(FLAG '(MRI) 'RL_PACKAGE) 
(FLAG '(MRI_CHSIMPAT) 'FULL) 
(FLAG '(MRI_SIMPAT) 'FULL) 
(FLAG '(EQUAL NEQ LEQ GEQ LESSP GREATERP) 'SPACED) 
(PUT 'MRI 'RL_PARAMS
     '((RL_SIMPLAT1* . MRI_SIMPLAT1)
       (RL_SIMPLIFYBOUNDEDQUANTIFIER* . PASF_SIMPLIFYBOUNDEDQUANTIFIER)
       (RL_OP* . MRI_OP) (RL_SMUPDKNOWL* . CL_SMUPDKNOWL)
       (RL_SMRMKNOWL* . CL_SMRMKNOWL) (RL_SMCPKNOWL* . CL_SMCPKNOWL)
       (RL_SMMKATL* . CL_SMMKATL) (RL_NEGATEAT* . MRI_NEGATEAT)
       (RL_TORDP* . ORDP) (RL_ORDATP* . MRI_ORDATP) (RL_SUBAT* . MRI_SUBAT)
       (RL_SUBALCHK* . NULL) (RL_EQNRHSKERNELS* . MRI_EQNRHSKERNELS)
       (RL_BNFSIMPL* . CL_BNFSIMPL))) 
(PUT 'MRI 'RL_SERVICES
     '((RL_SIMPL* . CL_SIMPL) (RL_SIMPLBASIC* . CL_SIMPLBASIC)
       (RL_NNF* . CL_NNF) (RL_PNF* . CL_PNF) (RL_ATNUM* . CL_ATNUM)
       (RL_VARLAT* . MRI_VARLAT) (RL_ATL* . CL_ATL) (RL_SUBFOF* . CL_SUBFOF)
       (RL_EXPAND* . MRI_EXPAND) (RL_FVARL* . CL_FVARL) (RL_QE* . MRI_QE))) 
(PUT 'MRI 'RL_SIMPB 'PASF_SIMPB) 
(PUT 'MRI 'RL_RESIMPB 'PASF_RESIMPB) 
(PUT 'MRI 'RL_PREPB 'PASF_PREPB) 
(PUT 'MRI 'RL_PRIBQ 'PASF_PRIBQ) 
(PUT 'MRI 'RL_FANCY-PRIBQ 'PASF_FANCY-PRIBQ) 
(PUT 'MRI 'SIMPFNNAME 'MRI_SIMPFN) 
(PUT 'MRI 'RL_PREPAT 'MRI_PREPAT) 
(PUT 'MRI 'RL_RESIMPAT 'MRI_RESIMPAT) 
(PUT 'MRI 'RL_LENGTHAT 'MRI_LENGTHAT) 
(PUT 'MRI 'RL_PREPTERM 'PREPF) 
(PUT 'MRI 'RL_SIMPTERM 'MRI_SIMPTERM) 
(PUT 'EQUAL 'MRI_SIMPFN 'MRI_CHSIMPAT) 
(PUT 'NEQ 'MRI_SIMPFN 'MRI_CHSIMPAT) 
(PUT 'LEQ 'MRI_SIMPFN 'MRI_CHSIMPAT) 
(PUT 'GEQ 'MRI_SIMPFN 'MRI_CHSIMPAT) 
(PUT 'LESSP 'MRI_SIMPFN 'MRI_CHSIMPAT) 
(PUT 'GREATERP 'MRI_SIMPFN 'MRI_CHSIMPAT) 
(PUT 'CONG 'MRI_SIMPFN 'MRI_SIMPAT) 
(PUT 'NCONG 'MRI_SIMPFN 'MRI_SIMPAT) 
(PUT 'FLOOR 'PRIFN 'MRI_PRIFLOOR) 
(PUT 'MRIREAL 'STAT 'RLIS) 
(PUT 'MRICLEAR 'STAT 'RLIS) 
(PUT 'MRI_PRIFLOOR 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_PRIFLOOR 'DEFINED-ON-LINE '117) 
(PUT 'MRI_PRIFLOOR 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_PRIFLOOR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_PRIFLOOR (U)
    (COND ((NULL *NAT) 'FAILED)
          (T (PROGN (PRIN2* "[") (MAPRIN (CADR U)) (PRIN2* "]"))))) 
(PUT 'MRIREAL 'NUMBER-OF-ARGS 1) 
(PUT 'MRIREAL 'DEFINED-ON-LINE '126) 
(PUT 'MRIREAL 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRIREAL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRIREAL (VARL)
    (PROGN
     (PROG (V)
       (SETQ V VARL)
      LAB
       (COND ((NULL V) (RETURN NIL)))
       ((LAMBDA (V) (PUT V 'MRI_TYPE 'REAL)) (CAR V))
       (SETQ V (CDR V))
       (GO LAB))
     (RMSUBS))) 
(PUT 'MRI_PUTREAL 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_PUTREAL 'DEFINED-ON-LINE '132) 
(PUT 'MRI_PUTREAL 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_PUTREAL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_PUTREAL (V) (PROGN (PUT V 'MRI_TYPE 'REAL) (RMSUBS))) 
(PUT 'MRI_REALVARP 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_REALVARP 'DEFINED-ON-LINE '138) 
(PUT 'MRI_REALVARP 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_REALVARP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_REALVARP (ID) (AND (IDP ID) (EQ (GET ID 'MRI_TYPE) 'REAL))) 
(PUT 'MRICLEAR 'NUMBER-OF-ARGS 1) 
(PUT 'MRICLEAR 'DEFINED-ON-LINE '141) 
(PUT 'MRICLEAR 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRICLEAR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRICLEAR (VARL)
    (PROGN
     (PROG (V)
       (SETQ V VARL)
      LAB
       (COND ((NULL V) (RETURN NIL)))
       ((LAMBDA (V) (REMPROP V 'MRI_TYPE)) (CAR V))
       (SETQ V (CDR V))
       (GO LAB))
     (RMSUBS))) 
(PUT 'MRI_SIMPAT 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_SIMPAT 'DEFINED-ON-LINE '147) 
(PUT 'MRI_SIMPAT 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_SIMPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_SIMPAT (U)
    (PROG (W) (SETQ W (PASF_SIMPAT U)) (RETURN (MRI_PASF2MRIAT W NIL)))) 
(PUT 'MRI_CHSIMPAT 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_CHSIMPAT 'DEFINED-ON-LINE '153) 
(PUT 'MRI_CHSIMPAT 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_CHSIMPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_CHSIMPAT (U)
    (PROG (W) (SETQ W (PASF_CHSIMPAT U)) (RETURN (MRI_PASF2MRI W NIL)))) 
(PUT 'MRI_RESIMPAT 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_RESIMPAT 'DEFINED-ON-LINE '159) 
(PUT 'MRI_RESIMPAT 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_RESIMPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_RESIMPAT (U) (MRI_PASF2MRIAT (PASF_RESIMPAT (MRI_2PASFAT U)) NIL)) 
(PUT 'MRI_PASF2MRI 'NUMBER-OF-ARGS 2) 
(PUT 'MRI_PASF2MRI 'DEFINED-ON-LINE '162) 
(PUT 'MRI_PASF2MRI 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_PASF2MRI 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MRI_PASF2MRI (F TYPE)
    (CL_APPLY2ATS1 F (FUNCTION MRI_PASF2MRIAT) (LIST TYPE))) 
(PUT 'MRI_2PASF 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_2PASF 'DEFINED-ON-LINE '165) 
(PUT 'MRI_2PASF 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_2PASF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_2PASF (F) (CL_APPLY2ATS F (FUNCTION MRI_2PASFAT))) 
(PUT 'MRI_PASF2MRIAT 'NUMBER-OF-ARGS 2) 
(PUT 'MRI_PASF2MRIAT 'DEFINED-ON-LINE '168) 
(PUT 'MRI_PASF2MRIAT 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_PASF2MRIAT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MRI_PASF2MRIAT (AT TYPE) (MRI_0MK2 (CAR AT) (CADR AT) TYPE)) 
(PUT 'MRI_OFSF2MRI 'NUMBER-OF-ARGS 2) 
(PUT 'MRI_OFSF2MRI 'DEFINED-ON-LINE '171) 
(PUT 'MRI_OFSF2MRI 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_OFSF2MRI 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MRI_OFSF2MRI (F TYPE)
    (CL_APPLY2ATS1 F (FUNCTION MRI_OFSF2MRIAT) (LIST TYPE))) 
(PUT 'MRI_OFSF2MRIAT 'NUMBER-OF-ARGS 2) 
(PUT 'MRI_OFSF2MRIAT 'DEFINED-ON-LINE '174) 
(PUT 'MRI_OFSF2MRIAT 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_OFSF2MRIAT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MRI_OFSF2MRIAT (AT TYPE) (MRI_0MK2 (CAR AT) (CADR AT) TYPE)) 
(PUT 'MRI_PREPAT 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_PREPAT 'DEFINED-ON-LINE '177) 
(PUT 'MRI_PREPAT 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_PREPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_PREPAT (U) (PASF_PREPAT (MRI_2PASFAT U))) 
(PUT 'MRI_2PASFAT 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_2PASFAT 'DEFINED-ON-LINE '180) 
(PUT 'MRI_2PASFAT 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_2PASFAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_2PASFAT (AT) (LIST (MRI_OP AT) (MRI_ARG2L AT) NIL)) 
(PUT 'MRI_2OFSFAT 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_2OFSFAT 'DEFINED-ON-LINE '183) 
(PUT 'MRI_2OFSFAT 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_2OFSFAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_2OFSFAT (AT) (LIST (MRI_OP AT) (MRI_ARG2L AT) NIL)) 
(PUT 'MRI_OP 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_OP 'DEFINED-ON-LINE '186) 
(PUT 'MRI_OP 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_OP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_OP (ATF) (CAR ATF)) 
(PUT 'MRI_OPN 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_OPN 'DEFINED-ON-LINE '192) 
(PUT 'MRI_OPN 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_OPN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_OPN (ATF) ((LAMBDA (W) (COND ((ATOM W) W) (T (CAR W)))) (MRI_OP ATF))) 
(PUT 'MRI_M 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_M 'DEFINED-ON-LINE '195) 
(PUT 'MRI_M 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_M 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_M (ATF) (CDADR ATF)) 
(PUT 'MRI_TYPE 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_TYPE 'DEFINED-ON-LINE '200) 
(PUT 'MRI_TYPE 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_TYPE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_TYPE (ATF) (AND (CDDDR ATF) (CADDDR ATF))) 
(PUT 'MRI_ARG2L 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_ARG2L 'DEFINED-ON-LINE '205) 
(PUT 'MRI_ARG2L 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_ARG2L 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_ARG2L (ATF) (CADR ATF)) 
(PUT 'MRI_MKOP 'NUMBER-OF-ARGS 2) 
(PUT 'MRI_MKOP 'DEFINED-ON-LINE '210) 
(PUT 'MRI_MKOP 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_MKOP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MRI_MKOP (OP M) (CONS OP M)) 
(PUT 'MRI_0MK2 'NUMBER-OF-ARGS 3) 
(PUT 'MRI_0MK2 'DEFINED-ON-LINE '216) 
(PUT 'MRI_0MK2 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_0MK2 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE MRI_0MK2 (OP LHS TYPE) (LIST OP LHS NIL TYPE)) 
(PUT 'MRI_ATFP 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_ATFP 'DEFINED-ON-LINE '222) 
(PUT 'MRI_ATFP 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_ATFP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_ATFP (F)
    (MEMQ (MRI_OPN F) '(EQUAL NEQ LEQ GEQ LESSP GREATERP CONG NCONG))) 
(PUT 'MRI_CONGP 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_CONGP 'DEFINED-ON-LINE '227) 
(PUT 'MRI_CONGP 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_CONGP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_CONGP (ATF) (MEMQ (MRI_OPN ATF) '(CONG NCONG))) 
(PUT 'MRI_SIMPLAT1 'NUMBER-OF-ARGS 2) 
(PUT 'MRI_SIMPLAT1 'DEFINED-ON-LINE '232) 
(PUT 'MRI_SIMPLAT1 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_SIMPLAT1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MRI_SIMPLAT1 (AT SOP)
    (PROG (TYPE W)
      (COND
       (*RLSIMPLFLOOR
        (SETQ AT
                (MRI_0MK2 (MRI_OP AT) (MRI_SIMPLFLOOR (MRI_ARG2L AT))
                 (MRI_TYPE AT)))))
      (SETQ TYPE (OR (MRI_TYPE AT) (MRI_DETTYPE AT)))
      (COND
       ((EQ TYPE 'INT)
        (RETURN (MRI_PASF2MRI (PASF_SIMPLAT1 (MRI_2PASFAT AT) SOP) 'INT))))
      (COND
       ((NOT (MRI_CONGP AT))
        (RETURN (MRI_OFSF2MRI (OFSF_SIMPLAT1 (MRI_2OFSFAT AT) SOP) 'REAL))))
      (RETURN (MRI_0MK2 (MRI_OP AT) (MRI_ARG2L AT) TYPE)))) 
(PUT 'MRI_SIMPLFLOOR 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_SIMPLFLOOR 'DEFINED-ON-LINE '244) 
(PUT 'MRI_SIMPLFLOOR 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_SIMPLFLOOR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_SIMPLFLOOR (LHS)
    (COND ((NOT (MRI_FLOORKERNELP LHS)) LHS) (T (MRI_SIMPLFLOOR1 LHS)))) 
(PUT 'MRI_SIMPLFLOOR1 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_SIMPLFLOOR1 'DEFINED-ON-LINE '250) 
(PUT 'MRI_SIMPLFLOOR1 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_SIMPLFLOOR1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_SIMPLFLOOR1 (LHS)
    (PROG (L R W)
      (COND ((OR (ATOM LHS) (ATOM (CAR LHS))) (RETURN LHS)))
      (SETQ L (MRI_SIMPLFLOOR (CDAR LHS)))
      (SETQ R (MRI_SIMPLFLOOR (CDR LHS)))
      (SETQ W (MRI_IRSPLIT (CAAAR LHS)))
      (RETURN
       (ADDF
        ((LAMBDA (G124)
           (COND (*PHYSOP-LOADED (PHYSOP-MULTF L G124))
                 (T (POLY-MULTF L G124))))
         (EXPTF (ADDF (CAR W) (CDR W)) (CDAAR LHS)))
        R)))) 
(PUT 'MRI_IRSPLIT 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_IRSPLIT 'DEFINED-ON-LINE '260) 
(PUT 'MRI_IRSPLIT 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_IRSPLIT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_IRSPLIT (K)
    (PROG (W)
      (COND
       ((NOT (EQCAR K 'FLOOR)) (RETURN (CONS (LIST (CONS (CONS K 1) 1)) NIL))))
      (SETQ W (MRI_IRSPLIT1 (MRI_SIMPLFLOOR (CAR (SIMP (CADR K))))))
      (RETURN
       (CONS (CAR W)
             (COND
              ((CDR W)
               (LIST
                (CONS (CONS (*A2K (LIST 'FLOOR (PREPF (CDR W)))) 1) 1)))))))) 
(PUT 'MRI_IRSPLIT1 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_IRSPLIT1 'DEFINED-ON-LINE '268) 
(PUT 'MRI_IRSPLIT1 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_IRSPLIT1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_IRSPLIT1 (K)
    (PROG (L R V D)
      (SETQ D 0)
      (COND ((OR (ATOM K) (ATOM (CAR K))) (RETURN (CONS K NIL))))
      (SETQ R (MRI_IRSPLIT1 (CDR K)))
      (SETQ D (CDAAR K))
      (SETQ V (EXPTF (LIST (CONS (CONS (CAAAR K) 1) 1)) D))
      (COND
       ((MRI_REALVARP (CAAAR V))
        (RETURN
         (CONS (CAR R)
               (ADDF
                (COND (*PHYSOP-LOADED (PHYSOP-MULTF (CDAR K) V))
                      (T (POLY-MULTF (CDAR K) V)))
                (CDR R))))))
      (SETQ L (MRI_IRSPLIT1 (CDAR K)))
      (RETURN
       (CONS
        (ADDF
         (COND (*PHYSOP-LOADED (PHYSOP-MULTF (CAR L) V))
               (T (POLY-MULTF (CAR L) V)))
         (CAR R))
        (ADDF
         (COND (*PHYSOP-LOADED (PHYSOP-MULTF (CDR L) V))
               (T (POLY-MULTF (CDR L) V)))
         (CDR R)))))) 
(PUT 'MRI_FLOORKERNELP 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_FLOORKERNELP 'DEFINED-ON-LINE '281) 
(PUT 'MRI_FLOORKERNELP 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_FLOORKERNELP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_FLOORKERNELP (F) (MRI_FLOORP (KERNELS F))) 
(PUT 'MRI_FLOORP 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_FLOORP 'DEFINED-ON-LINE '284) 
(PUT 'MRI_FLOORP 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_FLOORP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_FLOORP (L) (AND L (OR (EQCAR (CAR L) 'FLOOR) (MRI_FLOORP (CDR L))))) 
(PUT 'MRI_DETTYPE 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_DETTYPE 'DEFINED-ON-LINE '287) 
(PUT 'MRI_DETTYPE 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_DETTYPE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_DETTYPE (AT)
    (PROG (VARL V C FOUNDREAL FOUNDINT)
      (SETQ VARL (KERNELS (MRI_ARG2L AT)))
      (COND ((NULL VARL) (RETURN 'INT)))
      (SETQ C T)
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND C VARL)) (RETURN NIL)))
        (PROGN
         (SETQ V (CAR VARL))
         (SETQ VARL (CDR VARL))
         (COND
          ((MRI_REALVARP V)
           (COND (FOUNDINT (SETQ C (SETQ FOUNDINT (SETQ FOUNDREAL NIL))))
                 (T (SETQ FOUNDREAL 'REAL))))
          (FOUNDREAL (SETQ C (SETQ FOUNDINT (SETQ FOUNDREAL NIL))))
          (T (SETQ FOUNDINT 'INT))))
        (GO WHILELABEL))
      (RETURN (OR FOUNDINT FOUNDREAL)))) 
(PUT 'MRI_NEGATEAT 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_NEGATEAT 'DEFINED-ON-LINE '309) 
(PUT 'MRI_NEGATEAT 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_NEGATEAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_NEGATEAT (AT)
    (MRI_PASF2MRIAT (PASF_NEGATEAT (MRI_2PASFAT AT)) (MRI_TYPE AT))) 
(PUT 'MRI_VARLAT 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_VARLAT 'DEFINED-ON-LINE '312) 
(PUT 'MRI_VARLAT 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_VARLAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_VARLAT (AT) (PASF_VARLAT (MRI_2PASFAT AT))) 
(PUT 'MRI_ORDATP 'NUMBER-OF-ARGS 2) 
(PUT 'MRI_ORDATP 'DEFINED-ON-LINE '315) 
(PUT 'MRI_ORDATP 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_ORDATP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MRI_ORDATP (AT1 AT2) (PASF_ORDATP (MRI_2PASFAT AT1) (MRI_2PASFAT AT2))) 
(PUT 'MRI_SIMPLB 'NUMBER-OF-ARGS 2) 
(PUT 'MRI_SIMPLB 'DEFINED-ON-LINE '318) 
(PUT 'MRI_SIMPLB 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_SIMPLB 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MRI_SIMPLB (F V) (PASF_SIMPLB F V)) 
(PUT 'MRI_BSATP 'NUMBER-OF-ARGS 2) 
(PUT 'MRI_BSATP 'DEFINED-ON-LINE '321) 
(PUT 'MRI_BSATP 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_BSATP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MRI_BSATP (F VAR) (EQ F 'TRUE)) 
(PUT 'MRI_SUBAT 'NUMBER-OF-ARGS 2) 
(PUT 'MRI_SUBAT 'DEFINED-ON-LINE '324) 
(PUT 'MRI_SUBAT 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_SUBAT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MRI_SUBAT (AL AT) (MRI_0MK2 (MRI_OP AT) (CAR (SUBF (MRI_ARG2L AT) AL)) NIL)) 
(PUT 'MRI_EQNRHSKERNELS 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_EQNRHSKERNELS 'DEFINED-ON-LINE '327) 
(PUT 'MRI_EQNRHSKERNELS 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_EQNRHSKERNELS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_EQNRHSKERNELS (X)
    ((LAMBDA (W) (NCONC (KERNELS (CAR W)) (KERNELS (CDR W)))) (SIMP (CDR X)))) 
(PUT 'MRI_EXPAND 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_EXPAND 'DEFINED-ON-LINE '330) 
(PUT 'MRI_EXPAND 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_EXPAND 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_EXPAND (F)
    (PROG (*RLVERBOSE W)
      ((LAMBDA (*MSG) (RL_SET '(MRI_PASF))) NIL)
      (SETQ W
              (COND
               ((MRI_BQP F) (MRI_PASF2MRI (PASF_EXPAND (MRI_2PASF F)) NIL))
               (T F)))
      ((LAMBDA (*MSG) (RL_SET '(MRI))) NIL)
      (RETURN W))) 
(PUT 'MRI_BQP 'NUMBER-OF-ARGS 1) 
(PUT 'MRI_BQP 'DEFINED-ON-LINE '338) 
(PUT 'MRI_BQP 'DEFINED-IN-FILE 'REDLOG/MRI/MRI.RED) 
(PUT 'MRI_BQP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MRI_BQP (F) (OR (SMEMQ 'BEX F) (SMEMQ 'BALL F))) 
(ENDMODULE) 