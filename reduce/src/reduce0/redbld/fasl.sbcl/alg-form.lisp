(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'ALG-FORM)) 
(GLOBAL '(INPUTBUFLIS* RESULTBUFLIS* WS)) 
(PUT 'FORMINPUT 'NUMBER-OF-ARGS 3) 
(PUT 'FORMINPUT 'DEFINED-ON-LINE '34) 
(PUT 'FORMINPUT 'DEFINED-IN-FILE 'ALG/ALG-FORM.RED) 
(PUT 'FORMINPUT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMINPUT (U VARS MODE)
    (PROG (X)
      (COND
       ((NEQ (LENGTH (CDR U)) 1)
        (RERROR 'ALG 1
                (LIST "input called with" (LENGTH (CDR U))
                      "arguments instead of 1"))))
      (SETQ U (CADR U))
      (COND ((EQCAR U '|:INT:|) (SETQ U (CADR U))))
      (COND
       ((NULL (SETQ X (ASSOC U INPUTBUFLIS*)))
        (RERROR 'ALG 1 (LIST "Entry" U "not found"))))
      (RETURN (CADDR X)))) 
(PUT 'INPUT 'FORMFN 'FORMINPUT) 
(PUT 'FORMWS 'NUMBER-OF-ARGS 3) 
(PUT 'FORMWS 'DEFINED-ON-LINE '48) 
(PUT 'FORMWS 'DEFINED-IN-FILE 'ALG/ALG-FORM.RED) 
(PUT 'FORMWS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMWS (U VARS MODE)
    (PROG (X)
      (COND
       ((NEQ (LENGTH (CDR U)) 1)
        (RERROR 'ALG 1
                (LIST "ws called with" (LENGTH (CDR U))
                      "arguments instead of 1"))))
      (SETQ U (CADR U))
      (COND ((EQCAR U '|:INT:|) (SETQ U (CADR U))))
      (COND ((SETQ X (ASSOC U RESULTBUFLIS*)) (RETURN (MKQUOTE (CDR X))))
            (T (RERROR 'ALG 2 (LIST "Entry" U "not found")))))) 
(PUT 'WS 'FORMFN 'FORMWS) 
(ENDMODULE) 