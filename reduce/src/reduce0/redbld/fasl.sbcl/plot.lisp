(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'PLOT)) 
(CREATE-PACKAGE
 '(PLOT PLOTSYNT PLOTEXP2 PLTPARA PLOTEXP3 PLOTIMP2 PLOTIMP3 PLOTNUM PARRAY
   XVECT)
 NIL) 
(GLOBAL '(PLOTDRIVER* PLOTMAX* PLOTMIN* VARIATION* PLOTOPTIONS*)) 
(FLUID '(PLOTDERIV*)) 
(PUT 'FDECLARE 'DEFINED-ON-LINE '64) 
(PUT 'FDECLARE 'DEFINED-IN-FILE 'PLOT/PLOT.RED) 
(PUT 'FDECLARE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DM FDECLARE (U) NIL) 
(PUT 'THEFLOAT 'DEFINED-ON-LINE '65) 
(PUT 'THEFLOAT 'DEFINED-IN-FILE 'PLOT/PLOT.RED) 
(PUT 'THEFLOAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DM THEFLOAT (U) (CADR U)) 
(PROG (*MSG) (NEWTOK '((|.| |.|) *INTERVAL*))) 
(PUT '*INTERVAL* 'PRTCH '| .. |) 
(COND
 ((NULL (GET '*INTERVAL* 'SIMPFN))
  (PROGN
   (PRECEDENCE (LIST '*INTERVAL* 'OR))
   (AEVAL (OPERATOR (LIST '*INTERVAL*)))))) 
(PUT 'PLOTEVAL3XYSINGULAR 'NUMBER-OF-ARGS 10) 
(PUT 'PLOTEVAL3XYSINGULAR 'DEFINED-ON-LINE '83) 
(PUT 'PLOTEVAL3XYSINGULAR 'DEFINED-IN-FILE 'PLOT/PLOT.RED) 
(PUT 'PLOTEVAL3XYSINGULAR 'PROCEDURE_TYPE
     '(ARROW
       (TIMES GENERAL GENERAL GENERAL GENERAL GENERAL GENERAL GENERAL GENERAL
              GENERAL GENERAL)
       GENERAL)) 
(DE PLOTEVAL3XYSINGULAR (FF F X XX DX Y YY DY ZHI ZLO)
    (PROGN
     (SETQ DX (QUOTIENT DX 4))
     (SETQ DY (QUOTIENT DY 4))
     (PLOTEVAL3XYSINGULAR1 FF F X XX DX Y YY DY ZHI ZLO
      (PLOTEVALFORM FF F (LIST (CONS X (PLUS XX DX)) (CONS Y (PLUS YY DY))))
      0))) 
(PUT 'PLOTEVAL3XYSINGULAR1 'NUMBER-OF-ARGS 12) 
(PUT 'PLOTEVAL3XYSINGULAR1 'DEFINED-ON-LINE '90) 
(PUT 'PLOTEVAL3XYSINGULAR1 'DEFINED-IN-FILE 'PLOT/PLOT.RED) 
(PUT 'PLOTEVAL3XYSINGULAR1 'PROCEDURE_TYPE
     '(ARROW
       (TIMES GENERAL GENERAL GENERAL GENERAL GENERAL GENERAL GENERAL GENERAL
              GENERAL GENERAL GENERAL GENERAL)
       GENERAL)) 
(DE PLOTEVAL3XYSINGULAR1 (FF F X XX DX Y YY DY ZHI ZLO W C)
    (COND ((NULL W) NIL) ((GREATERP C 8) NIL) ((GREATERP W ZHI) ZHI)
          ((LESSP W ZLO) ZLO)
          (T
           (PROG (WNEW)
             (SETQ DX (QUOTIENT DX 2))
             (SETQ DY (QUOTIENT DY 2))
             (SETQ WNEW
                     (PLOTEVALFORM FF F
                      (LIST (CONS X (PLUS XX DX)) (CONS Y (PLUS YY DY)))))
             (RETURN
              (COND ((NULL WNEW) NIL)
                    ((LESSP (ABS (DIFFERENCE WNEW W)) (QUOTIENT (ABS WNEW) 20))
                     WNEW)
                    (T
                     (PLOTEVAL3XYSINGULAR1 FF F X XX DX Y YY DY ZHI ZLO WNEW
                      (PLUS C 1))))))))) 
(PUT 'PLOTDRIVER 'DEFINED-ON-LINE '105) 
(PUT 'PLOTDRIVER 'DEFINED-IN-FILE 'PLOT/PLOT.RED) 
(PUT 'PLOTDRIVER 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DM PLOTDRIVER (U)
    (LIST 'APPLY (LIST 'GET 'PLOTDRIVER* (MKQUOTE (CADR U)))
          (CONS 'LIST (CDDR U)))) 
(ENDMODULE) 