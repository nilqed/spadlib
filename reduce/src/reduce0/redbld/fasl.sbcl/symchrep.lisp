(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'SYMCHREP)) 
(PUT 'MK_INTERNAL 'NUMBER-OF-ARGS 1) 
(PUT 'MK_INTERNAL 'DEFINED-ON-LINE '47) 
(PUT 'MK_INTERNAL 'DEFINED-IN-FILE 'SYMMETRY/SYMCHREP.RED) 
(PUT 'MK_INTERNAL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MK_INTERNAL (REPRESENTATION)
    (PROG (GROUP ELEMS GENERATORS REPGENERATORS G RES)
      (SETQ GROUP (GET_GROUP_OUT REPRESENTATION))
      (SETQ ELEMS (GET*ELEMENTS GROUP))
      (SETQ GENERATORS (GET*GENERATORS GROUP))
      (SETQ REPGENERATORS (MK_REP_RELATION REPRESENTATION GENERATORS))
      (COND
       ((NOT (HARD_REPRESENTATION_CHECK_P GROUP REPGENERATORS))
        (REDERR "this is no representation")))
      (SETQ RES
              (PROG (G FORALL-RESULT FORALL-ENDPTR)
                (SETQ G ELEMS)
                (COND ((NULL G) (RETURN NIL)))
                (SETQ FORALL-RESULT
                        (SETQ FORALL-ENDPTR
                                (CONS
                                 ((LAMBDA (G)
                                    (LIST G
                                          (MK_REP_MAT
                                           (GET*ELEM*IN*GENERATORS GROUP G)
                                           REPGENERATORS)))
                                  (CAR G))
                                 NIL)))
               LOOPLABEL
                (SETQ G (CDR G))
                (COND ((NULL G) (RETURN FORALL-RESULT)))
                (RPLACD FORALL-ENDPTR
                        (CONS
                         ((LAMBDA (G)
                            (LIST G
                                  (MK_REP_MAT (GET*ELEM*IN*GENERATORS GROUP G)
                                   REPGENERATORS)))
                          (CAR G))
                         NIL))
                (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                (GO LOOPLABEL)))
      (RETURN (APPEND (LIST GROUP) RES)))) 
(PUT 'HARD_REPRESENTATION_CHECK_P 'NUMBER-OF-ARGS 2) 
(PUT 'HARD_REPRESENTATION_CHECK_P 'DEFINED-ON-LINE '67) 
(PUT 'HARD_REPRESENTATION_CHECK_P 'DEFINED-IN-FILE 'SYMMETRY/SYMCHREP.RED) 
(PUT 'HARD_REPRESENTATION_CHECK_P 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE HARD_REPRESENTATION_CHECK_P (GROUP REPGENERATORS)
    (PROG (CHECKP)
      (SETQ CHECKP T)
      (PROG (RELATION)
        (SETQ RELATION (GET*GENERATOR*RELATIONS GROUP))
       LAB
        (COND ((NULL RELATION) (RETURN NIL)))
        ((LAMBDA (RELATION)
           (COND
            ((NOT (RELATION_CHECK_P RELATION REPGENERATORS))
             (SETQ CHECKP NIL))))
         (CAR RELATION))
        (SETQ RELATION (CDR RELATION))
        (GO LAB))
      (RETURN CHECKP))) 
(PUT 'RELATION_CHECK_P 'NUMBER-OF-ARGS 2) 
(PUT 'RELATION_CHECK_P 'DEFINED-ON-LINE '78) 
(PUT 'RELATION_CHECK_P 'DEFINED-IN-FILE 'SYMMETRY/SYMCHREP.RED) 
(PUT 'RELATION_CHECK_P 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE RELATION_CHECK_P (RELATION REPGENERATORS)
    (PROG (MAT1 MAT2)
      (SETQ MAT1 (MK_RELATION_MAT (CAR RELATION) REPGENERATORS))
      (SETQ MAT2 (MK_RELATION_MAT (CADR RELATION) REPGENERATORS))
      (RETURN (EQUAL+MATRICES+P MAT1 MAT2)))) 
(PUT 'MK_RELATION_MAT 'NUMBER-OF-ARGS 2) 
(PUT 'MK_RELATION_MAT 'DEFINED-ON-LINE '86) 
(PUT 'MK_RELATION_MAT 'DEFINED-IN-FILE 'SYMMETRY/SYMCHREP.RED) 
(PUT 'MK_RELATION_MAT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MK_RELATION_MAT (RELATIONPART REPGENERATORS)
    (PROG (MAT1 G)
      (SETQ MAT1 (MK+UNIT+MAT (GET+ROW+NR (CADR (CAR REPGENERATORS)))))
      (PROG (G)
        (SETQ G RELATIONPART)
       LAB
        (COND ((NULL G) (RETURN NIL)))
        ((LAMBDA (G)
           (SETQ MAT1 (MK+MAT+MULT+MAT MAT1 (GET_MAT G REPGENERATORS))))
         (CAR G))
        (SETQ G (CDR G))
        (GO LAB))
      (RETURN MAT1))) 
(PUT 'GET_MAT 'NUMBER-OF-ARGS 2) 
(PUT 'GET_MAT 'DEFINED-ON-LINE '95) 
(PUT 'GET_MAT 'DEFINED-IN-FILE 'SYMMETRY/SYMCHREP.RED) 
(PUT 'GET_MAT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE GET_MAT (ELEM REPGENERATORS)
    (PROG (FOUND RES)
      (COND
       ((EQUAL ELEM 'ID)
        (RETURN (MK+UNIT+MAT (GET+ROW+NR (CADR (CAR REPGENERATORS)))))))
      (SETQ FOUND NIL)
      (PROG ()
       WHILELABEL
        (COND
         ((NOT (AND (GREATERP (LENGTH REPGENERATORS) 0) (NULL FOUND)))
          (RETURN NIL)))
        (PROGN
         (COND
          ((EQUAL ELEM (CAAR REPGENERATORS))
           (PROGN (SETQ RES (CADR (CAR REPGENERATORS))) (SETQ FOUND T) NIL)))
         (SETQ REPGENERATORS (CDR REPGENERATORS))
         NIL)
        (GO WHILELABEL))
      (COND (FOUND (RETURN RES)) (T (REDERR "error in get_mat"))))) 
(PUT 'MK_REP_MAT 'NUMBER-OF-ARGS 2) 
(PUT 'MK_REP_MAT 'DEFINED-ON-LINE '114) 
(PUT 'MK_REP_MAT 'DEFINED-IN-FILE 'SYMMETRY/SYMCHREP.RED) 
(PUT 'MK_REP_MAT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MK_REP_MAT (GENERATORL REPGENERATORS)
    (PROG (MAT1)
      (SETQ MAT1 (MK+UNIT+MAT (GET+ROW+NR (CADR (CAR REPGENERATORS)))))
      (PROG (GENERATOR)
        (SETQ GENERATOR GENERATORL)
       LAB
        (COND ((NULL GENERATOR) (RETURN NIL)))
        ((LAMBDA (GENERATOR)
           (SETQ MAT1
                   (MK+MAT+MULT+MAT MAT1
                    (GET_REP_OF_GENERATOR GENERATOR REPGENERATORS))))
         (CAR GENERATOR))
        (SETQ GENERATOR (CDR GENERATOR))
        (GO LAB))
      (RETURN MAT1))) 
(PUT 'GET_REP_OF_GENERATOR 'NUMBER-OF-ARGS 2) 
(PUT 'GET_REP_OF_GENERATOR 'DEFINED-ON-LINE '128) 
(PUT 'GET_REP_OF_GENERATOR 'DEFINED-IN-FILE 'SYMMETRY/SYMCHREP.RED) 
(PUT 'GET_REP_OF_GENERATOR 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE GET_REP_OF_GENERATOR (GENERATOR REPGENERATORS)
    (PROG (FOUND MATE LL)
      (COND
       ((EQUAL GENERATOR 'ID)
        (RETURN (MK+UNIT+MAT (GET+ROW+NR (CADR (CAR REPGENERATORS)))))))
      (SETQ FOUND NIL)
      (SETQ LL REPGENERATORS)
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND (NOT FOUND) (GREATERP (LENGTH LL) 0))) (RETURN NIL)))
        (PROGN
         (COND
          ((EQUAL (CAAR LL) GENERATOR)
           (PROGN (SETQ FOUND T) (SETQ MATE (CADR (CAR LL))) NIL)))
         (SETQ LL (CDR LL))
         NIL)
        (GO WHILELABEL))
      (COND (FOUND (RETURN MATE))
            (T (REDERR " error in get rep of generators"))))) 
(PUT 'GET_GROUP_IN 'NUMBER-OF-ARGS 1) 
(PUT 'GET_GROUP_IN 'DEFINED-ON-LINE '150) 
(PUT 'GET_GROUP_IN 'DEFINED-IN-FILE 'SYMMETRY/SYMCHREP.RED) 
(PUT 'GET_GROUP_IN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE GET_GROUP_IN (REPRESENTATION) (PROG () (RETURN (CAR REPRESENTATION)))) 
(PUT 'ELI_GROUP_IN 'NUMBER-OF-ARGS 1) 
(PUT 'ELI_GROUP_IN 'DEFINED-ON-LINE '156) 
(PUT 'ELI_GROUP_IN 'DEFINED-IN-FILE 'SYMMETRY/SYMCHREP.RED) 
(PUT 'ELI_GROUP_IN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ELI_GROUP_IN (REPRESENTATION) (PROG () (RETURN (CDR REPRESENTATION)))) 
(PUT 'GET_REP_MATRIX_IN 'NUMBER-OF-ARGS 2) 
(PUT 'GET_REP_MATRIX_IN 'DEFINED-ON-LINE '162) 
(PUT 'GET_REP_MATRIX_IN 'DEFINED-IN-FILE 'SYMMETRY/SYMCHREP.RED) 
(PUT 'GET_REP_MATRIX_IN 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE GET_REP_MATRIX_IN (ELEM REPRESENTATION)
    (PROG (FOUND MATE REPLIST)
      (SETQ FOUND NIL)
      (SETQ REPLIST (CDR REPRESENTATION))
      (PROG ()
       WHILELABEL
        (COND
         ((NOT (AND (NULL FOUND) (GREATERP (LENGTH REPLIST) 0))) (RETURN NIL)))
        (PROGN
         (COND
          ((EQUAL (CAAR REPLIST) ELEM)
           (PROGN (SETQ MATE (CADR (CAR REPLIST))) (SETQ FOUND T) NIL)))
         (SETQ REPLIST (CDR REPLIST))
         NIL)
        (GO WHILELABEL))
      (COND (FOUND (RETURN MATE))
            (T (REDERR "error in get representation matrix"))))) 
(PUT 'GET_DIMENSION_IN 'NUMBER-OF-ARGS 1) 
(PUT 'GET_DIMENSION_IN 'DEFINED-ON-LINE '181) 
(PUT 'GET_DIMENSION_IN 'DEFINED-IN-FILE 'SYMMETRY/SYMCHREP.RED) 
(PUT 'GET_DIMENSION_IN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE GET_DIMENSION_IN (REPRESENTATION)
    (PROG ()
      (RETURN
       (CHANGE+SQ+TO+INT (MK+TRACE (GET_REP_MATRIX_IN 'ID REPRESENTATION)))))) 
(PUT 'GET_REP_MATRIX_ENTRY 'NUMBER-OF-ARGS 4) 
(PUT 'GET_REP_MATRIX_ENTRY 'DEFINED-ON-LINE '189) 
(PUT 'GET_REP_MATRIX_ENTRY 'DEFINED-IN-FILE 'SYMMETRY/SYMCHREP.RED) 
(PUT 'GET_REP_MATRIX_ENTRY 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE GET_REP_MATRIX_ENTRY (REPRESENTATION ELEM Z S)
    (PROG ()
      (RETURN (GET+MAT+ENTRY (GET_REP_MATRIX_IN ELEM REPRESENTATION) Z S)))) 
(PUT 'MK_RESIMP_REP 'NUMBER-OF-ARGS 1) 
(PUT 'MK_RESIMP_REP 'DEFINED-ON-LINE '200) 
(PUT 'MK_RESIMP_REP 'DEFINED-IN-FILE 'SYMMETRY/SYMCHREP.RED) 
(PUT 'MK_RESIMP_REP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MK_RESIMP_REP (REPRESENTATION)
    (PROG (GROUP ELEM RES)
      (SETQ GROUP (GET_GROUP_IN REPRESENTATION))
      (SETQ RES
              (PROG (ELEM FORALL-RESULT FORALL-ENDPTR)
                (SETQ ELEM (GET*ELEMENTS GROUP))
                (COND ((NULL ELEM) (RETURN NIL)))
                (SETQ FORALL-RESULT
                        (SETQ FORALL-ENDPTR
                                (CONS
                                 ((LAMBDA (ELEM)
                                    (LIST ELEM
                                          (MK+RESIMP+MAT
                                           (GET_REP_MATRIX_IN ELEM
                                            REPRESENTATION))))
                                  (CAR ELEM))
                                 NIL)))
               LOOPLABEL
                (SETQ ELEM (CDR ELEM))
                (COND ((NULL ELEM) (RETURN FORALL-RESULT)))
                (RPLACD FORALL-ENDPTR
                        (CONS
                         ((LAMBDA (ELEM)
                            (LIST ELEM
                                  (MK+RESIMP+MAT
                                   (GET_REP_MATRIX_IN ELEM REPRESENTATION))))
                          (CAR ELEM))
                         NIL))
                (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                (GO LOOPLABEL)))
      (RETURN (APPEND (LIST GROUP) RES)))) 
(PUT 'GET_CHAR_GROUP 'NUMBER-OF-ARGS 1) 
(PUT 'GET_CHAR_GROUP 'DEFINED-ON-LINE '215) 
(PUT 'GET_CHAR_GROUP 'DEFINED-IN-FILE 'SYMMETRY/SYMCHREP.RED) 
(PUT 'GET_CHAR_GROUP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE GET_CHAR_GROUP (CHAR1) (PROG () (RETURN (CAR CHAR1)))) 
(PUT 'GET_CHAR_DIM 'NUMBER-OF-ARGS 1) 
(PUT 'GET_CHAR_DIM 'DEFINED-ON-LINE '221) 
(PUT 'GET_CHAR_DIM 'DEFINED-IN-FILE 'SYMMETRY/SYMCHREP.RED) 
(PUT 'GET_CHAR_DIM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE GET_CHAR_DIM (CHAR1)
    (PROG () (RETURN (CHANGE+SQ+TO+INT (GET_CHAR_VALUE CHAR1 'ID))))) 
(PUT 'GET_CHAR_VALUE 'NUMBER-OF-ARGS 2) 
(PUT 'GET_CHAR_VALUE 'DEFINED-ON-LINE '228) 
(PUT 'GET_CHAR_VALUE 'DEFINED-IN-FILE 'SYMMETRY/SYMCHREP.RED) 
(PUT 'GET_CHAR_VALUE 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE GET_CHAR_VALUE (CHAR1 ELEM)
    (PROG (FOUND VALUE CHARLIST)
      (SETQ FOUND NIL)
      (SETQ CHARLIST (CDR CHAR1))
      (PROG ()
       WHILELABEL
        (COND
         ((NOT (AND (NULL FOUND) (GREATERP (LENGTH CHARLIST) 0)))
          (RETURN NIL)))
        (PROGN
         (COND
          ((EQUAL (CAAR CHARLIST) ELEM)
           (PROGN (SETQ VALUE (CADR (CAR CHARLIST))) (SETQ FOUND T) NIL)))
         (SETQ CHARLIST (CDR CHARLIST))
         NIL)
        (GO WHILELABEL))
      (COND (FOUND (RETURN VALUE))
            (T (REDERR "error in get character element"))))) 
(ENDMODULE) 