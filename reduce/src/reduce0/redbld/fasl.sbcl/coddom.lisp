(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'CODDOM)) 
(NULL (SETQ *MODE 'SYMBOLIC)) 
(FLUID '(|:PREC:|)) 
(FLUID '(PLINE* POSN* ORIG* YCOORD* YMAX* YMIN*)) 
(PUT 'ZEROPP 'NUMBER-OF-ARGS 1) 
(PUT 'ZEROPP 'DEFINED-ON-LINE '39) 
(PUT 'ZEROPP 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'ZEROPP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ZEROPP (U)
    (COND ((ATOM U) (ZEROP U)) ((EQ (CAR U) '|:RD:|) (|RD:ZEROP| U)) (T NIL))) 
(PUT 'CONSTP 'NUMBER-OF-ARGS 1) 
(PUT 'CONSTP 'DEFINED-ON-LINE '46) 
(PUT 'CONSTP 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'CONSTP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CONSTP (C) (OR (NUMBERP C) (AND (PAIRP C) (MEMQ (CAR C) DOMAINLIST*)))) 
(PUT 'INTEGERP 'NUMBER-OF-ARGS 1) 
(PUT 'INTEGERP 'DEFINED-ON-LINE '50) 
(PUT 'INTEGERP 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'INTEGERP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE INTEGERP (I) (AND (NUMBERP I) (NOT (FLOATP I)))) 
(PUT 'FLOATPROP 'NUMBER-OF-ARGS 1) 
(PUT 'FLOATPROP 'DEFINED-ON-LINE '54) 
(PUT 'FLOATPROP 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'FLOATPROP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE FLOATPROP (F) (OR (FLOATP F) (EQCAR F '|:RD:|))) 
(PUT 'DOMPROP 'NUMBER-OF-ARGS 1) 
(PUT 'DOMPROP 'DEFINED-ON-LINE '58) 
(PUT 'DOMPROP 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'DOMPROP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DOMPROP (D) (AND (PAIRP D) (MEMQ (CAR D) DOMAINLIST*))) 
(PUT 'DOUBLEP 'NUMBER-OF-ARGS 1) 
(PUT 'DOUBLEP 'DEFINED-ON-LINE '62) 
(PUT 'DOUBLEP 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'DOUBLEP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DOUBLEP (D) (AND (EQCAR D '|:RD:|) (PAIRP (CDR D)))) 
(DE NIL2ZERO (U) (COND ((NULL U) 0) (T U))) 
(PUT 'NIL2ZERO 'NUMBER-OF-ARGS 1) 
(PUT 'NIL2ZERO 'DEFINED-ON-LINE '66) 
(PUT 'NIL2ZERO 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'NIL2ZERO 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'NIL2ZERO 'INLINE '(LAMBDA (U) (COND ((NULL U) 0) (T U)))) 
(PUT 'ZERO2NIL 'NUMBER-OF-ARGS 1) 
(PUT 'ZERO2NIL 'DEFINED-ON-LINE '70) 
(PUT 'ZERO2NIL 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'ZERO2NIL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ZERO2NIL (U) (COND ((|:ZEROP| U) NIL) (T U))) 
(PUT 'DM-PLUS 'NUMBER-OF-ARGS 2) 
(PUT 'DM-PLUS 'DEFINED-ON-LINE '74) 
(PUT 'DM-PLUS 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'DM-PLUS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DM-PLUS (U V)
    ((LAMBDA (U) (COND ((NULL U) 0) (T U)))
     (|:PLUS| (ZERO2NIL U) (ZERO2NIL V)))) 
(PUT 'DM-DIFFERENCE 'NUMBER-OF-ARGS 2) 
(PUT 'DM-DIFFERENCE 'DEFINED-ON-LINE '77) 
(PUT 'DM-DIFFERENCE 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'DM-DIFFERENCE 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DM-DIFFERENCE (U V)
    ((LAMBDA (U) (COND ((NULL U) 0) (T U))) (|:DIFFERENCE| (ZERO2NIL U) V))) 
(PUT 'DM-MINUS 'NUMBER-OF-ARGS 1) 
(PUT 'DM-MINUS 'DEFINED-ON-LINE '80) 
(PUT 'DM-MINUS 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'DM-MINUS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DM-MINUS (U) ((LAMBDA (U) (COND ((NULL U) 0) (T U))) (|:MINUS| U))) 
(PUT 'DM-ABS 'NUMBER-OF-ARGS 1) 
(PUT 'DM-ABS 'DEFINED-ON-LINE '83) 
(PUT 'DM-ABS 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'DM-ABS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DM-ABS (U) (COND ((|:MINUSP| U) (DM-MINUS U)) (T U))) 
(PUT 'DM-MIN 'NUMBER-OF-ARGS 2) 
(PUT 'DM-MIN 'DEFINED-ON-LINE '86) 
(PUT 'DM-MIN 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'DM-MIN 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DM-MIN (U V) (COND ((DM-GT U V) V) (T U))) 
(PUT 'DM-MAX 'NUMBER-OF-ARGS 2) 
(PUT 'DM-MAX 'DEFINED-ON-LINE '90) 
(PUT 'DM-MAX 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'DM-MAX 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DM-MAX (U V) (COND ((DM-GT U V) U) (T V))) 
(PUT 'DM-TIMES 'NUMBER-OF-ARGS 2) 
(PUT 'DM-TIMES 'DEFINED-ON-LINE '94) 
(PUT 'DM-TIMES 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'DM-TIMES 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DM-TIMES (U V)
    ((LAMBDA (U) (COND ((NULL U) 0) (T U)))
     (|:TIMES| (ZERO2NIL U) (ZERO2NIL V)))) 
(PUT 'DM-MKFLOAT 'NUMBER-OF-ARGS 1) 
(PUT 'DM-MKFLOAT 'DEFINED-ON-LINE '97) 
(PUT 'DM-MKFLOAT 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'DM-MKFLOAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DM-MKFLOAT (U) (COND ((INTEGERP U) (APPLY1 (GET '|:RD:| 'I2D) U)) (T U))) 
(PUT 'DM-QUOTIENT 'NUMBER-OF-ARGS 2) 
(PUT 'DM-QUOTIENT 'DEFINED-ON-LINE '105) 
(PUT 'DM-QUOTIENT 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'DM-QUOTIENT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DM-QUOTIENT (U V)
    (PROG (NOEQUIV)
      (SETQ NOEQUIV *NOEQUIV)
      (SETQ *NOEQUIV NIL)
      (RETURN
       ((LAMBDA (U) (COND ((NULL U) 0) (T U)))
        (|:QUOTIENT| (DM-MKFLOAT U) (DM-MKFLOAT V))))
      (SETQ *NOEQUIV NOEQUIV))) 
(PUT 'DM-EXPT 'NUMBER-OF-ARGS 2) 
(PUT 'DM-EXPT 'DEFINED-ON-LINE '118) 
(PUT 'DM-EXPT 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'DM-EXPT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DM-EXPT (U N)
    ((LAMBDA (U) (COND ((NULL U) 0) (T U))) (|:EXPT| (ZERO2NIL U) N))) 
(PUT 'DM-GT 'NUMBER-OF-ARGS 2) 
(PUT 'DM-GT 'DEFINED-ON-LINE '121) 
(PUT 'DM-GT 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'DM-GT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DM-GT (U V) (|:MINUSP| (DM-DIFFERENCE V U))) 
(PUT 'DM-EQ 'NUMBER-OF-ARGS 2) 
(PUT 'DM-EQ 'DEFINED-ON-LINE '125) 
(PUT 'DM-EQ 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'DM-EQ 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DM-EQ (U V) (|:ZEROP| (DM-DIFFERENCE U V))) 
(PUT 'DM-LT 'NUMBER-OF-ARGS 2) 
(PUT 'DM-LT 'DEFINED-ON-LINE '129) 
(PUT 'DM-LT 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'DM-LT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DM-LT (U V) (|:MINUSP| (DM-DIFFERENCE U V))) 
(PUT 'DM-PRINT 'NUMBER-OF-ARGS 1) 
(PUT 'DM-PRINT 'DEFINED-ON-LINE '133) 
(PUT 'DM-PRINT 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'DM-PRINT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DM-PRINT (P)
    (PROG ()
      (TERPRI* NIL)
      (MAPRINT P 0)
      (SETQ PLINE* (REVERSE PLINE*))
      (SCPRINT PLINE* YMAX*)
      (SETQ PLINE* NIL)
      (SETQ POSN* ORIG*)
      (SETQ YCOORD* (SETQ YMAX* (SETQ YMIN* 0))))) 
(PUT '|RD:ZEROP:| 'NUMBER-OF-ARGS 1) 
(PUT '|RD:ZEROP:| 'DEFINED-ON-LINE '149) 
(PUT '|RD:ZEROP:| 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT '|RD:ZEROP:| 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE |RD:ZEROP:| (U)
    (COND ((ATOM (CDR U)) (|FT:ZEROP| (CDR U))) (T (|BFZEROP:| (ROUND* U))))) 
(PUT '|FT:ZEROP| 'NUMBER-OF-ARGS 1) 
(PUT '|FT:ZEROP| 'DEFINED-ON-LINE '168) 
(PUT '|FT:ZEROP| 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT '|FT:ZEROP| 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE |FT:ZEROP| (U)
    (PROG (X)
      (RETURN
       (PROGN
        (SETQ X (TIMES U (EXPT 10 |:PREC:|)))
        (AND (GREATERP X (MINUS 50)) (LESSP X 50)))))) 
(PUT 'FTINTEQUIV 'NUMBER-OF-ARGS 1) 
(PUT 'FTINTEQUIV 'DEFINED-ON-LINE '176) 
(PUT 'FTINTEQUIV 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'FTINTEQUIV 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE FTINTEQUIV (U)
    (PROG (X)
      (RETURN (COND ((|FT:ZEROP| (DIFFERENCE U (SETQ X (FIX U)))) X) (T NIL))))) 
(PUT 'DM-FIXP 'NUMBER-OF-ARGS 1) 
(PUT 'DM-FIXP 'DEFINED-ON-LINE '182) 
(PUT 'DM-FIXP 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'DM-FIXP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DM-FIXP (U)
    (PROG (R FP)
      (SETQ R (REVERSE (EXPLODE (CAR U))))
      (SETQ FP 'T)
      (COND
       ((GEQ (CDR U) 0)
        (PROG (I)
          (SETQ I 1)
         LAB
          (COND ((MINUSP (DIFFERENCE (CDR U) I)) (RETURN NIL)))
          (SETQ R (CONS '|0| R))
          (SETQ I (PLUS2 I 1))
          (GO LAB)))
       ((SETQ FP (GREATERP (LENGTH R) (MINUS (CDR U))))
        (PROG (I)
          (SETQ I 1)
         LAB
          (COND ((MINUSP (DIFFERENCE (MINUS (CDR U)) I)) (RETURN NIL)))
          (PROGN (SETQ FP (AND FP (EQ (CAR R) '|0|))) (SETQ R (CDR R)))
          (SETQ I (PLUS2 I 1))
          (GO LAB)))
       (T (SETQ R (LIST '|0|))))
      (RETURN (COND (FP (COMPRESS (REVERSE R))) (T NIL))))) 
(PUT 'BFINTEQUIV 'NUMBER-OF-ARGS 1) 
(PUT 'BFINTEQUIV 'DEFINED-ON-LINE '200) 
(PUT 'BFINTEQUIV 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'BFINTEQUIV 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BFINTEQUIV (U)
    (PROG (I)
      (SETQ I (DM-FIXP (INTERNAL2DECIMAL U |:PREC:|)))
      (RETURN (COND (I I) (T U))))) 
(PUT 'RDINTEQUIV 'NUMBER-OF-ARGS 1) 
(PUT 'RDINTEQUIV 'DEFINED-ON-LINE '211) 
(PUT 'RDINTEQUIV 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'RDINTEQUIV 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE RDINTEQUIV (U)
    (COND ((ATOM (CDR U)) (FTINTEQUIV (CDR U))) (T (BFINTEQUIV U)))) 
(PUT '|:RD:| 'INTEQUIVFN 'RDINTEQUIV) 
(PUT 'COMPLEXP 'NUMBER-OF-ARGS 1) 
(PUT 'COMPLEXP 'DEFINED-ON-LINE '220) 
(PUT 'COMPLEXP 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'COMPLEXP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE COMPLEXP (V)
    (OR (MEMBER 'COMPLEX (GETDEC (CAR V)))
        (AND *COMPLEX (NOT (FREEOF (CDR V) 'I))))) 
(PUT 'MYPREPSQ 'NUMBER-OF-ARGS 1) 
(PUT 'MYPREPSQ 'DEFINED-ON-LINE '225) 
(PUT 'MYPREPSQ 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'MYPREPSQ 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MYPREPSQ (U) (COND ((NULL (CAR U)) 0) (T (SQFORM U (FUNCTION MYPREPF))))) 
(PUT 'MYPREPF 'NUMBER-OF-ARGS 1) 
(PUT 'MYPREPF 'DEFINED-ON-LINE '228) 
(PUT 'MYPREPF 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'MYPREPF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MYPREPF (U)
    ((LAMBDA (X) (COND ((NULL X) 0) (T (REPLUS X)))) (MYPREPF1 U NIL))) 
(PUT 'MYPREPF1 'NUMBER-OF-ARGS 2) 
(PUT 'MYPREPF1 'DEFINED-ON-LINE '231) 
(PUT 'MYPREPF1 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'MYPREPF1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MYPREPF1 (U V)
    (COND ((NULL U) NIL)
          ((OR (ATOM U) (ATOM (CAR U))) (LIST (RETIMES (CONS U (EXCHK V)))))
          (T
           (NCONC*
            (MYPREPF1 (CDAR U)
             (COND ((EQ (CAAAR U) 'K*) V) (T (CONS (CAAR U) V))))
            (MYPREPF1 (CDR U) V))))) 
(PUT 'CIREVAL 'NUMBER-OF-ARGS 1) 
(PUT 'CIREVAL 'DEFINED-ON-LINE '238) 
(PUT 'CIREVAL 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'CIREVAL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CIREVAL (U)
    (PROG (OCMPLX RES)
      (SETQ OCMPLX *COMPLEX)
      (SETQ *COMPLEX 'T)
      (SETQ RES
              (COND ((FREEOF U 'I) U)
                    (T (MYPREPSQ (CADR (REVAL1 (IREVAL U) NIL))))))
      (SETQ *COMPLEX OCMPLX)
      (RETURN RES))) 
(PUT 'REMCOMPLEX 'NUMBER-OF-ARGS 1) 
(PUT 'REMCOMPLEX 'DEFINED-ON-LINE '250) 
(PUT 'REMCOMPLEX 'DEFINED-IN-FILE 'SCOPE/CODDOM.RED) 
(PUT 'REMCOMPLEX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE REMCOMPLEX (U)
    (COND ((ATOM U) U)
          ((MEMBER (CAR U) '(|:CR:| |:CRN:| |:GI:|))
           (COND
            ((EQCAR U '|:GI:|) (LIST 'PLUS (CADR U) (LIST 'TIMES (CDDR U) 'I)))
            (T (PREPSQ (|CR:SIMP| U)))))
          ((NOT (CONSTP U))
           (CONS (CAR U)
                 (PROG (EL FORALL-RESULT FORALL-ENDPTR)
                   (SETQ EL (CDR U))
                   (COND ((NULL EL) (RETURN NIL)))
                   (SETQ FORALL-RESULT
                           (SETQ FORALL-ENDPTR
                                   (CONS
                                    ((LAMBDA (EL) (REMCOMPLEX EL)) (CAR EL))
                                    NIL)))
                  LOOPLABEL
                   (SETQ EL (CDR EL))
                   (COND ((NULL EL) (RETURN FORALL-RESULT)))
                   (RPLACD FORALL-ENDPTR
                           (CONS ((LAMBDA (EL) (REMCOMPLEX EL)) (CAR EL)) NIL))
                   (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                   (GO LOOPLABEL))))
          (T U))) 
(ENDMODULE) 