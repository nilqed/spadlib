(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'DVFSFMISC)) 
(REVISION 'DVFSFMISC
          "$Id: dvfsfmisc.red 5986 2021-08-28 13:35:27Z thomas-sturm $") 
(COPYRIGHT 'DVFSFMISC "(c) 1995-2009 A. Dolzmann, T. Sturm, 2017 T. Sturm") 
(PUT 'DVFSF_ORDATP 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_ORDATP 'DEFINED-ON-LINE '32) 
(PUT 'DVFSF_ORDATP 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_ORDATP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DVFSF_ORDATP (A1 A2)
    (PROG (W1 W2)
      (SETQ W1 (DVFSF_ARG2L A1))
      (SETQ W2 (DVFSF_ARG2L A2))
      (COND ((NEQ W1 W2) (RETURN (ORDP W1 W2))))
      (SETQ W1 (DVFSF_ARG2R A1))
      (SETQ W2 (DVFSF_ARG2R A2))
      (COND ((NEQ W1 W2) (RETURN (ORDP W1 W2))))
      (RETURN (DVFSF_ORDRELP (DVFSF_OP A1) (DVFSF_OP A2))))) 
(PUT 'DVFSF_ORDRELP 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_ORDRELP 'DEFINED-ON-LINE '46) 
(PUT 'DVFSF_ORDRELP 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_ORDRELP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DVFSF_ORDRELP (R1 R2)
    (NOT (NOT (MEMQ R2 (MEMQ R1 '(EQUAL NEQ DIV SDIV ASSOC)))))) 
(PUT 'DVFSF_VARLAT 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_VARLAT 'DEFINED-ON-LINE '52) 
(PUT 'DVFSF_VARLAT 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_VARLAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_VARLAT (ATF)
    (LTO_DELQIP 'P
                (UNION (KERNELS (DVFSF_ARG2L ATF))
                       (KERNELS (DVFSF_ARG2R ATF))))) 
(PUT 'DVFSF_VARSUBSTAT 'NUMBER-OF-ARGS 3) 
(PUT 'DVFSF_VARSUBSTAT 'DEFINED-ON-LINE '59) 
(PUT 'DVFSF_VARSUBSTAT 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_VARSUBSTAT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_VARSUBSTAT (ATF NEW OLD)
    (DVFSF_MK2 (DVFSF_OP ATF)
               (CAR (SUBF (DVFSF_ARG2L ATF) (LIST (CONS OLD NEW))))
               (CAR (SUBF (DVFSF_ARG2R ATF) (LIST (CONS OLD NEW)))))) 
(PUT 'DVFSF_NEGATEAT 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_NEGATEAT 'DEFINED-ON-LINE '67) 
(PUT 'DVFSF_NEGATEAT 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_NEGATEAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_NEGATEAT (ATF)
    (PROG (OP)
      (SETQ OP (DVFSF_OP ATF))
      (COND ((EQ OP 'EQUAL) (RETURN (DVFSF_MKN 'NEQ (DVFSF_ARGN ATF)))))
      (COND ((EQ OP 'NEQ) (RETURN (DVFSF_MKN 'EQUAL (DVFSF_ARGN ATF)))))
      (COND
       ((EQ OP 'DIV)
        (RETURN (DVFSF_MK2 'SDIV (DVFSF_ARG2R ATF) (DVFSF_ARG2L ATF)))))
      (COND
       ((EQ OP 'SDIV)
        (RETURN (DVFSF_MK2 'DIV (DVFSF_ARG2R ATF) (DVFSF_ARG2L ATF)))))
      (COND
       ((EQ OP 'ASSOC)
        (RETURN (DVFSF_MK2 'NASSOC (DVFSF_ARG2L ATF) (DVFSF_ARG2R ATF)))))
      (COND
       ((EQ OP 'NASSOC)
        (RETURN (DVFSF_MK2 'ASSOC (DVFSF_ARG2L ATF) (DVFSF_ARG2R ATF))))))) 
(PUT 'DVFSF_FCTRAT 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_FCTRAT 'DEFINED-ON-LINE '87) 
(PUT 'DVFSF_FCTRAT 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_FCTRAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_FCTRAT (AT)
    (PROG (W1 W2)
      (SETQ W1 (CDR (FCTRF (DVFSF_ARG2L AT))))
      (SETQ W2 (CDR (FCTRF (DVFSF_ARG2R AT))))
      (RETURN (LTO_ALMERGE (LIST W1 W2) 'PLUS2)))) 
(PUT 'DVFSF_V 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_V 'DEFINED-ON-LINE '99) 
(PUT 'DVFSF_V 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_V 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_V (Z)
    ((LAMBDA (QRM)
       (COND ((NULL (CDR QRM)) (PLUS 1 (DVFSF_V (CAR QRM)))) (T 0)))
     (QREMF Z DVFSF_P*))) 
(PUT 'DVFSF_DNF 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_DNF 'DEFINED-ON-LINE '106) 
(PUT 'DVFSF_DNF 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_DNF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_DNF (F)
    (COND (*RLBNFSAC ((LAMBDA (*RLSISO) (CL_DNF F)) T)) (T (CL_DNF F)))) 
(PUT 'DVFSF_CNF 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_CNF 'DEFINED-ON-LINE '114) 
(PUT 'DVFSF_CNF 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_CNF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_CNF (F)
    (COND (*RLBNFSAC ((LAMBDA (*RLSISO) (CL_CNF F)) T)) (T (CL_CNF F)))) 
(PUT 'DVFSF_SUBSUMPTION 'NUMBER-OF-ARGS 3) 
(PUT 'DVFSF_SUBSUMPTION 'DEFINED-ON-LINE '122) 
(PUT 'DVFSF_SUBSUMPTION 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_SUBSUMPTION 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SUBSUMPTION (L1 L2 GOR)
    (COND
     ((EQ GOR 'OR)
      (COND ((DVFSF_SUBSUMEP-AND L1 L2) 'KEEP2)
            ((DVFSF_SUBSUMEP-AND L2 L1) 'KEEP1)))
     ((DVFSF_SUBSUMEP-OR L1 L2) 'KEEP1) ((DVFSF_SUBSUMEP-OR L2 L1) 'KEEP2)
     (T NIL))) 
(PUT 'DVFSF_SUBSUMEP-AND 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_SUBSUMEP-AND 'DEFINED-ON-LINE '138) 
(PUT 'DVFSF_SUBSUMEP-AND 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_SUBSUMEP-AND 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SUBSUMEP-AND (L1 L2)
    (PROG (A)
      (PROG ()
       WHILELABEL
        (COND ((NOT L2) (RETURN NIL)))
        (PROGN
         (SETQ A (CAR L2))
         (SETQ L2 (CDR L2))
         (COND ((NEQ (CL_SIMPL A L1 (MINUS 1)) 'TRUE) (SETQ A (SETQ L2 NIL)))))
        (GO WHILELABEL))
      (RETURN A))) 
(PUT 'DVFSF_SUBSUMEP-OR 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_SUBSUMEP-OR 'DEFINED-ON-LINE '150) 
(PUT 'DVFSF_SUBSUMEP-OR 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_SUBSUMEP-OR 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SUBSUMEP-OR (L1 L2)
    (PROG (A)
      (PROG ()
       WHILELABEL
        (COND ((NOT L1) (RETURN NIL)))
        (PROGN
         (SETQ A (CAR L1))
         (SETQ L1 (CDR L1))
         (COND
          ((NEQ
            (CL_SIMPL
             (COND ((AND L2 (CDR L2)) (CONS 'OR L2))
                   ((NULL L2) (COND ((EQ 'OR 'AND) 'TRUE) (T 'FALSE)))
                   (T (CAR L2)))
             (LIST A) (MINUS 1))
            'TRUE)
           (SETQ A (SETQ L1 NIL)))))
        (GO WHILELABEL))
      (RETURN A))) 
(PUT 'DVFSF_A2CDL 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_A2CDL 'DEFINED-ON-LINE '162) 
(PUT 'DVFSF_A2CDL 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_A2CDL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_A2CDL (ATML)
    (PROG (ATF TERMLL FLAG)
      (PROG ()
       WHILELABEL
        (COND ((NOT ATML) (RETURN NIL)))
        (PROGN
         (SETQ ATF (CAAR ATML))
         (SETQ ATML (CDR ATML))
         (SETQ TERMLL (CONS (DVFSF_ARGN ATF) TERMLL))
         (COND ((NOT (MEMQ (DVFSF_OP ATF) '(EQUAL NEQ))) (SETQ FLAG T))))
        (GO WHILELABEL))
      (RETURN
       (COND
        (FLAG
         (PROG (X FORALL-RESULT FORALL-ENDPTR)
           (SETQ X TERMLL)
           (COND ((NULL X) (RETURN NIL)))
           (SETQ FORALL-RESULT
                   (SETQ FORALL-ENDPTR
                           (CONS
                            ((LAMBDA (X)
                               (LIST (DVFSF_MK2 'SDIV (CAR X) (CADR X))
                                     (DVFSF_MK2 'ASSOC (CAR X) (CADR X))
                                     (DVFSF_MK2 'SDIV (CADR X) (CAR X))))
                             (CAR X))
                            NIL)))
          LOOPLABEL
           (SETQ X (CDR X))
           (COND ((NULL X) (RETURN FORALL-RESULT)))
           (RPLACD FORALL-ENDPTR
                   (CONS
                    ((LAMBDA (X)
                       (LIST (DVFSF_MK2 'SDIV (CAR X) (CADR X))
                             (DVFSF_MK2 'ASSOC (CAR X) (CADR X))
                             (DVFSF_MK2 'SDIV (CADR X) (CAR X))))
                     (CAR X))
                    NIL))
           (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
           (GO LOOPLABEL)))
        (T
         (PROG (X FORALL-RESULT FORALL-ENDPTR)
           (SETQ X TERMLL)
           (COND ((NULL X) (RETURN NIL)))
           (SETQ FORALL-RESULT
                   (SETQ FORALL-ENDPTR
                           (CONS
                            ((LAMBDA (X)
                               (LIST (DVFSF_0MK2 'EQUAL X)
                                     (DVFSF_0MK2 'NEQ X)))
                             (CAR X))
                            NIL)))
          LOOPLABEL
           (SETQ X (CDR X))
           (COND ((NULL X) (RETURN FORALL-RESULT)))
           (RPLACD FORALL-ENDPTR
                   (CONS
                    ((LAMBDA (X)
                       (LIST (DVFSF_0MK2 'EQUAL X) (DVFSF_0MK2 'NEQ X)))
                     (CAR X))
                    NIL))
           (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
           (GO LOOPLABEL))))))) 
(PUT 'DVFSF_SUBAT 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_SUBAT 'DEFINED-ON-LINE '184) 
(PUT 'DVFSF_SUBAT 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_SUBAT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SUBAT (AL F)
    (PROG (NLHS NRHS W)
      (SETQ NLHS (SUBF (DVFSF_ARG2L F) AL))
      (SETQ NRHS (SUBF (DVFSF_ARG2R F) AL))
      (COND
       ((OR (NOT (OR (ATOM (CDR NLHS)) (ATOM (CAR (CDR NLHS)))))
            (NOT (OR (ATOM (CDR NRHS)) (ATOM (CAR (CDR NRHS))))))
        (REDERR "parametric denominator after substitution")))
      (SETQ W (LCM (CDR NLHS) (CDR NRHS)))
      (RETURN
       (DVFSF_MK2 (DVFSF_OP F) (CAR (MULTSQ NLHS (CONS W 1)))
                  (CAR (MULTSQ NRHS (CONS W 1))))))) 
(PUT 'DVFSF_SUBALCHK 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_SUBALCHK 'DEFINED-ON-LINE '198) 
(PUT 'DVFSF_SUBALCHK 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_SUBALCHK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_SUBALCHK (AL)
    (PROG (X)
      (SETQ X AL)
     LAB
      (COND ((NULL X) (RETURN NIL)))
      ((LAMBDA (X)
         (COND
          ((NOT
            ((LAMBDA (U) (OR (ATOM U) (ATOM (CAR U)))) (CDR (SIMP (CDR X)))))
           (REDERR "parametric denominator in substituted term"))))
       (CAR X))
      (SETQ X (CDR X))
      (GO LAB))) 
(PUT 'DVFSF_EQNRHSKERNELS 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_EQNRHSKERNELS 'DEFINED-ON-LINE '206) 
(PUT 'DVFSF_EQNRHSKERNELS 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_EQNRHSKERNELS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_EQNRHSKERNELS (X)
    ((LAMBDA (W) (NCONC (KERNELS (CAR W)) (KERNELS (CDR W)))) (SIMP (CDR X)))) 
(PUT 'DVFSF_STRUCTAT 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_STRUCTAT 'DEFINED-ON-LINE '212) 
(PUT 'DVFSF_STRUCTAT 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_STRUCTAT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DVFSF_STRUCTAT (AT AL)
    (PROG (LHS RHS)
      (SETQ LHS (DVFSF_ARG2L AT))
      (SETQ RHS (DVFSF_ARG2R AT))
      (COND
       ((NOT (OR (ATOM LHS) (ATOM (CAR LHS))))
        (SETQ LHS (CAR (SIMP (CDR (ASSOC LHS AL)))))))
      (COND
       ((NOT (OR (ATOM RHS) (ATOM (CAR RHS))))
        (SETQ RHS (CAR (SIMP (CDR (ASSOC RHS AL)))))))
      (RETURN (DVFSF_MK2 (DVFSF_OP AT) LHS RHS)))) 
(PUT 'DVFSF_IFSTRUCTAT 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_IFSTRUCTAT 'DEFINED-ON-LINE '230) 
(PUT 'DVFSF_IFSTRUCTAT 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_IFSTRUCTAT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DVFSF_IFSTRUCTAT (AT AL)
    (PROG (LHS RHS RL RR)
      (SETQ LHS (FCTRF (DVFSF_ARG2L AT)))
      (SETQ RHS (FCTRF (DVFSF_ARG2R AT)))
      (SETQ RL (CAR LHS))
      (PROG (X)
        (SETQ X (CDR LHS))
       LAB
        (COND ((NULL X) (RETURN NIL)))
        ((LAMBDA (X)
           (SETQ RL
                   ((LAMBDA (G134)
                      (COND (*PHYSOP-LOADED (PHYSOP-MULTF RL G134))
                            (T (POLY-MULTF RL G134))))
                    (EXPF (CAR (SIMP (CDR (ASSOC (CAR X) AL)))) (CDR X)))))
         (CAR X))
        (SETQ X (CDR X))
        (GO LAB))
      (SETQ RR (CAR RHS))
      (PROG (X)
        (SETQ X (CDR RHS))
       LAB
        (COND ((NULL X) (RETURN NIL)))
        ((LAMBDA (X)
           (SETQ RR
                   ((LAMBDA (G136)
                      (COND (*PHYSOP-LOADED (PHYSOP-MULTF RR G136))
                            (T (POLY-MULTF RR G136))))
                    (EXPF (CAR (SIMP (CDR (ASSOC (CAR X) AL)))) (CDR X)))))
         (CAR X))
        (SETQ X (CDR X))
        (GO LAB))
      (RETURN (DVFSF_MK2 (DVFSF_OP AT) RL RR)))) 
(PUT 'DVFSF_TERMMLAT 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_TERMMLAT 'DEFINED-ON-LINE '251) 
(PUT 'DVFSF_TERMMLAT 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_TERMMLAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_TERMMLAT (AT)
    (PROG (R W)
      (SETQ W (DVFSF_ARG2L AT))
      (COND (W (SETQ R (CONS (CONS W 1) R))))
      (SETQ W (DVFSF_ARG2R AT))
      (COND (W (SETQ R (CONS (CONS W 1) R))))
      (RETURN R))) 
(PUT 'DVFSF_EXPLATS 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_EXPLATS 'DEFINED-ON-LINE '265) 
(PUT 'DVFSF_EXPLATS 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_EXPLATS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_EXPLATS (F)
    (CL_SIMPL (CL_APPLY2ATS2 F 'DVFSF_EXPLODEZAT NIL NIL) NIL (MINUS 1))) 
(PUT 'DVFSF_EXPLODEZAT 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_EXPLODEZAT 'DEFINED-ON-LINE '275) 
(PUT 'DVFSF_EXPLODEZAT 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_EXPLODEZAT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DVFSF_EXPLODEZAT (AT SOP)
    (PROG (OP LHS RHS)
      (SETQ LHS (DVFSF_ARG2L AT))
      (SETQ RHS (DVFSF_ARG2R AT))
      (COND
       ((NOT (AND (OR (ATOM LHS) (ATOM (CAR LHS))) (EQUAL RHS 1)))
        (RETURN AT)))
      (SETQ OP (DVFSF_OP AT))
      (COND ((NOT (OR (EQ OP 'ASSOC) (EQ OP 'NASSOC))) (RETURN AT)))
      (COND (*RLSIEXPLA (RETURN (DVFSF_EXPLODEZAT1 OP LHS))))
      (COND
       (*RLSIEXPL
        (PROGN
         (COND
          ((AND (EQ OP 'ASSOC) (OR (EQ SOP 'AND) (NULL SOP)))
           (RETURN (DVFSF_EXPLODEZAT1 OP LHS))))
         (COND
          ((AND (EQ OP 'NASSOC) (OR (EQ SOP 'OR) (NULL SOP)))
           (RETURN (DVFSF_EXPLODEZAT1 OP LHS))))
         NIL)))
      (RETURN AT))) 
(PUT 'DVFSF_EXPLODEZAT1 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_EXPLODEZAT1 'DEFINED-ON-LINE '302) 
(PUT 'DVFSF_EXPLODEZAT1 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_EXPLODEZAT1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DVFSF_EXPLODEZAT1 (OP LHS)
    ((LAMBDA (G137 G138)
       (COND ((AND G138 (CDR G138)) (CONS G137 G138))
             ((NULL G138) (COND ((EQ G137 'AND) 'TRUE) (T 'FALSE)))
             (T (CAR G138))))
     (COND ((EQ OP 'ASSOC) 'AND) (T 'OR))
     (PROG (X FORALL-RESULT FORALL-ENDPTR)
       (SETQ X (ZFACTOR LHS))
       (COND ((NULL X) (RETURN NIL)))
       (SETQ FORALL-RESULT
               (SETQ FORALL-ENDPTR
                       (CONS
                        ((LAMBDA (X) (DVFSF_MK2 OP (CAR X) (CAR (SIMP 1))))
                         (CAR X))
                        NIL)))
      LOOPLABEL
       (SETQ X (CDR X))
       (COND ((NULL X) (RETURN FORALL-RESULT)))
       (RPLACD FORALL-ENDPTR
               (CONS
                ((LAMBDA (X) (DVFSF_MK2 OP (CAR X) (CAR (SIMP 1)))) (CAR X))
                NIL))
       (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
       (GO LOOPLABEL)))) 
(PUT 'DVFSF_MKCANONIC 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_MKCANONIC 'DEFINED-ON-LINE '309) 
(PUT 'DVFSF_MKCANONIC 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_MKCANONIC 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_MKCANONIC (F)
    (PROG (FACL U FU XL OP PR)
      (COND ((OR (EQ F 'TRUE) (EQ F 'FALSE)) (RETURN F)))
      (SETQ FACL (DVFSF_COEFFACL F))
      (COND ((NULL FACL) (RETURN (CL_SIMPL F NIL (MINUS 1)))))
      (SETQ PR (NEXTPRIME (LTO_MAX FACL)))
      ((LAMBDA (DVFSF_P*) (SETQ U (CL_SIMPL (DVFSF_SUBP F PR) NIL (MINUS 1))))
       PR)
      (SETQ FU (CL_FLIP U))
      (SETQ XL
              (PROG (FAC FORALL-RESULT FORALL-ENDPTR)
                (SETQ FAC FACL)
               STARTOVER
                (COND ((NULL FAC) (RETURN NIL)))
                (SETQ FORALL-RESULT
                        ((LAMBDA (FAC)
                           (COND
                            ((EQ
                              ((LAMBDA (DVFSF_P*)
                                 (CL_SIMPL (DVFSF_SUBP F FAC) NIL (MINUS 1)))
                               FAC)
                              FU)
                             (LIST FAC))))
                         (CAR FAC)))
                (SETQ FORALL-ENDPTR (LASTPAIR FORALL-RESULT))
                (SETQ FAC (CDR FAC))
                (COND ((ATOM FORALL-ENDPTR) (GO STARTOVER)))
               LOOPLABEL
                (COND ((NULL FAC) (RETURN FORALL-RESULT)))
                (RPLACD FORALL-ENDPTR
                        ((LAMBDA (FAC)
                           (COND
                            ((EQ
                              ((LAMBDA (DVFSF_P*)
                                 (CL_SIMPL (DVFSF_SUBP F FAC) NIL (MINUS 1)))
                               FAC)
                              FU)
                             (LIST FAC))))
                         (CAR FAC)))
                (SETQ FORALL-ENDPTR (LASTPAIR FORALL-ENDPTR))
                (SETQ FAC (CDR FAC))
                (GO LOOPLABEL)))
      (SETQ OP (COND ((EQ U 'FALSE) 'NASSOC) (T 'ASSOC)))
      (SETQ XL (SORT XL 'LESSP))
      (RETURN
       ((LAMBDA (G139 G140)
          (COND ((AND G140 (CDR G140)) (CONS G139 G140))
                ((NULL G140) (COND ((EQ G139 'AND) 'TRUE) (T 'FALSE)))
                (T (CAR G140))))
        (COND ((EQ U 'FALSE) 'OR) (T 'AND))
        (PROG (X FORALL-RESULT FORALL-ENDPTR)
          (SETQ X XL)
          (COND ((NULL X) (RETURN NIL)))
          (SETQ FORALL-RESULT
                  (SETQ FORALL-ENDPTR
                          (CONS
                           ((LAMBDA (X) (DVFSF_MK2 OP X (CAR (SIMP 1))))
                            (CAR X))
                           NIL)))
         LOOPLABEL
          (SETQ X (CDR X))
          (COND ((NULL X) (RETURN FORALL-RESULT)))
          (RPLACD FORALL-ENDPTR
                  (CONS ((LAMBDA (X) (DVFSF_MK2 OP X (CAR (SIMP 1)))) (CAR X))
                        NIL))
          (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
          (GO LOOPLABEL)))))) 
(PUT 'DVFSF_COEFFACL 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_COEFFACL 'DEFINED-ON-LINE '334) 
(PUT 'DVFSF_COEFFACL 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_COEFFACL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_COEFFACL (F)
    (PROG (CFML)
      (SETQ CFML (CL_F2ML F 'DVFSF_COEFFACLAT))
      (RETURN
       (PROG (X FORALL-RESULT FORALL-ENDPTR)
         (SETQ X CFML)
         (COND ((NULL X) (RETURN NIL)))
         (SETQ FORALL-RESULT
                 (SETQ FORALL-ENDPTR
                         (CONS ((LAMBDA (X) (CAR X)) (CAR X)) NIL)))
        LOOPLABEL
         (SETQ X (CDR X))
         (COND ((NULL X) (RETURN FORALL-RESULT)))
         (RPLACD FORALL-ENDPTR (CONS ((LAMBDA (X) (CAR X)) (CAR X)) NIL))
         (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
         (GO LOOPLABEL))))) 
(PUT 'DVFSF_COEFFACLAT 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_COEFFACLAT 'DEFINED-ON-LINE '343) 
(PUT 'DVFSF_COEFFACLAT 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_COEFFACLAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_COEFFACLAT (AT)
    (LTO_ALMERGE
     (LIST (DVFSF_COEFFACLF (DVFSF_ARG2L AT))
           (DVFSF_COEFFACLF (DVFSF_ARG2R AT)))
     'PLUS2)) 
(PUT 'DVFSF_COEFFACLF 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_COEFFACLF 'DEFINED-ON-LINE '350) 
(PUT 'DVFSF_COEFFACLF 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_COEFFACLF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_COEFFACLF (F)
    (COND ((NULL F) (LIST)) ((OR (ATOM F) (ATOM (CAR F))) (DVFSF_COEFFACLZ F))
          ((EQ (CAAAR F) 'P)
           (LTO_ALMERGE
            (LIST (DVFSF_COEFFACLZ (CDAR F)) (DVFSF_COEFFACLF (CDR F)))
            'PLUS2))
          (T (REDERR "dvfsf_coeffaclf: unknown mvar")))) 
(PUT 'DVFSF_COEFFACLZ 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_COEFFACLZ 'DEFINED-ON-LINE '363) 
(PUT 'DVFSF_COEFFACLZ 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_COEFFACLZ 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_COEFFACLZ (Z)
    (COND ((OR (EQUAL Z 1) (EQUAL Z (MINUS 1)) (EQUAL Z 0)) (LIST))
          ((LESSP Z 0) (ZFACTOR (MINUS Z))) (T (ZFACTOR Z)))) 
(PUT 'DVFSF_SUBP 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_SUBP 'DEFINED-ON-LINE '374) 
(PUT 'DVFSF_SUBP 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'DVFSF_SUBP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SUBP (F P) (CL_APPLY2ATS1 F 'CL_SUBPAT (LIST (LIST (CONS 'P P))))) 
(PUT 'CL_SUBPAT 'NUMBER-OF-ARGS 2) 
(PUT 'CL_SUBPAT 'DEFINED-ON-LINE '380) 
(PUT 'CL_SUBPAT 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFMISC.RED) 
(PUT 'CL_SUBPAT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CL_SUBPAT (AT AL)
    (DVFSF_MK2 (DVFSF_OP AT) (CAR (SUBF (DVFSF_ARG2L AT) AL))
               (CAR (SUBF (DVFSF_ARG2R AT) AL)))) 
(ENDMODULE) 