(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'ORDER)) 
(FLUID '(KORD*)) 
(GLOBAL '(*PHYSOP-LOADED)) 
(PUT 'ORDAD 'NUMBER-OF-ARGS 2) 
(PUT 'ORDAD 'DEFINED-ON-LINE '42) 
(PUT 'ORDAD 'DEFINED-IN-FILE 'ALG/ORDER.RED) 
(PUT 'ORDAD 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE ORDAD (A U)
    (PROG (R)
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND U (NOT (ORDP A (CAR U))))) (RETURN NIL)))
        (PROGN (SETQ R (CONS (CAR U) R)) (SETQ U (CDR U)))
        (GO WHILELABEL))
      (SETQ U (CONS A U))
      (PROG ()
       WHILELABEL
        (COND ((NOT R) (RETURN NIL)))
        (PROGN (SETQ A (CDR R)) (RPLACD R U) (SETQ U R) (SETQ R A))
        (GO WHILELABEL))
      (RETURN U))) 
(PUT 'ORDN 'NUMBER-OF-ARGS 1) 
(PUT 'ORDN 'DEFINED-ON-LINE '50) 
(PUT 'ORDN 'DEFINED-IN-FILE 'ALG/ORDER.RED) 
(PUT 'ORDN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ORDN (U)
    (COND ((NULL U) NIL) ((NULL (CDR U)) U)
          ((NULL (CDDR U)) (ORD2 (CAR U) (CADR U)))
          (T (ORDAD (CAR U) (ORDN (CDR U)))))) 
(PUT 'ORD2 'NUMBER-OF-ARGS 2) 
(PUT 'ORD2 'DEFINED-ON-LINE '56) 
(PUT 'ORD2 'DEFINED-IN-FILE 'ALG/ORDER.RED) 
(PUT 'ORD2 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE ORD2 (U V) (COND ((ORDP U V) (LIST U V)) (T (LIST V U)))) 
(PUT 'ORDP 'NUMBER-OF-ARGS 2) 
(PUT 'ORDP 'DEFINED-ON-LINE '129) 
(PUT 'ORDP 'DEFINED-IN-FILE 'ALG/ORDER.RED) 
(PUT 'ORDP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE ORDP (U V)
    (COND ((NULL U) (NULL V)) ((NULL V) T)
          ((VECTORP U) (COND ((VECTORP V) (ORDPV U V)) (T (ATOM V))))
          ((ATOM U)
           (COND
            ((ATOM V)
             (COND ((NUMBERP U) (AND (NUMBERP V) (NOT (LESSP U V))))
                   ((IDP V) (ORDERP U V)) (T (NUMBERP V))))
            (T NIL)))
          ((ATOM V) T) ((EQUAL (CAR U) (CAR V)) (ORDPL (CDR U) (CDR V)))
          ((FLAGP (CAR U) 'NONCOM)
           (COND ((FLAGP (CAR V) 'NONCOM) (ORDP (CAR U) (CAR V))) (T T)))
          ((FLAGP (CAR V) 'NONCOM) NIL) (T (ORDP (CAR U) (CAR V))))) 
(PUT 'ORDPL 'NUMBER-OF-ARGS 2) 
(PUT 'ORDPL 'DEFINED-ON-LINE '151) 
(PUT 'ORDPL 'DEFINED-IN-FILE 'ALG/ORDER.RED) 
(PUT 'ORDPL 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE ORDPL (U V)
    (COND ((ATOM U) (ORDP U V)) ((ATOM V) T)
          ((EQUAL (CAR U) (CAR V)) (ORDPL (CDR U) (CDR V)))
          (T (ORDP (CAR U) (CAR V))))) 
(PUT 'ORDPV 'NUMBER-OF-ARGS 2) 
(PUT 'ORDPV 'DEFINED-ON-LINE '159) 
(PUT 'ORDPV 'DEFINED-IN-FILE 'ALG/ORDER.RED) 
(PUT 'ORDPV 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE ORDPV (U V) (ORDPV1 U V (MINUS 1) (UPBV U) (UPBV V))) 
(PUT 'ORDPV1 'NUMBER-OF-ARGS 5) 
(PUT 'ORDPV1 'DEFINED-ON-LINE '163) 
(PUT 'ORDPV1 'DEFINED-IN-FILE 'ALG/ORDER.RED) 
(PUT 'ORDPV1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE ORDPV1 (U V I LU LV)
    (COND ((GREATERP (SETQ I (IPLUS2 I 1)) LU) (GREATERP I LV))
          (T
           ((LAMBDA (X Y)
              (COND ((EQUAL X Y) (ORDPV1 U V I LU LV)) (T (ORDP X Y))))
            (GETV U I) (GETV V I))))) 
(PUT 'ORDOP 'NUMBER-OF-ARGS 2) 
(PUT 'ORDOP 'DEFINED-ON-LINE '168) 
(PUT 'ORDOP 'DEFINED-IN-FILE 'ALG/ORDER.RED) 
(PUT 'ORDOP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE ORDOP (U V)
    (COND (*PHYSOP-LOADED (PHYSOP-ORDOP U V))
          (T
           (PROG (X)
             (SETQ X KORD*)
            A
             (COND ((NULL X) (RETURN (ORDP U V))) ((EQ U (CAR X)) (RETURN T))
                   ((EQ V (CAR X)) (RETURN NIL)))
             (SETQ X (CDR X))
             (GO A))))) 
(PUT 'ORDPP 'NUMBER-OF-ARGS 2) 
(PUT 'ORDPP 'DEFINED-ON-LINE '179) 
(PUT 'ORDPP 'DEFINED-IN-FILE 'ALG/ORDER.RED) 
(PUT 'ORDPP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE ORDPP (U V)
    (PROG (X)
      (COND ((EQ (CAR U) (CAR V)) (RETURN (GREATERP (CDR U) (CDR V)))))
      (SETQ X KORD*)
      (SETQ U (CAR U))
      (SETQ V (CAR V))
     A
      (COND ((NULL X) (RETURN (ORDPA U V))) ((EQ U (CAR X)) (RETURN T))
            ((EQ V (CAR X)) (RETURN NIL)))
      (SETQ X (CDR X))
      (GO A))) 
(PUT 'ORDPA 'NUMBER-OF-ARGS 2) 
(PUT 'ORDPA 'DEFINED-ON-LINE '194) 
(PUT 'ORDPA 'DEFINED-IN-FILE 'ALG/ORDER.RED) 
(PUT 'ORDPA 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE ORDPA (U V)
    (COND ((NULL U) (NULL V)) ((NULL V) T)
          ((VECTORP U) (COND ((VECTORP V) (ORDPV U V)) (T (ATOM V))))
          ((ATOM U)
           (COND
            ((ATOM V)
             (COND ((NUMBERP U) (AND (NUMBERP V) (NOT (LESSP U V))))
                   ((IDP V) (ORDERP U V)) (T (NUMBERP V))))
            (T NIL)))
          ((ATOM V) T) ((EQUAL (CAR U) (CAR V)) (ORDPA (CDR U) (CDR V)))
          (T (ORDPA (CAR U) (CAR V))))) 
(ENDMODULE) 