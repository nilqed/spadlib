(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'VECANLYS)) 
(GLOBAL '(DIMEX* SGN*)) 
(FLUID '(*EXCALC_UTF8)) 
(NEWTOK '((•) DOTPROD)) 
(NEWTOK '((|\||) DOTPROD)) 
(INFIX (LIST 'DOTPROD)) 
(PRECEDENCE (LIST 'DOTPROD 'TIMES)) 
(NEWTOK '((|.| * |.|) CROSSPROD)) 
(NEWTOK '((×) CROSSPROD)) 
(INFIX (LIST 'CROSSPROD)) 
(PRECEDENCE (LIST 'CROSSPROD 'DOTPROD)) 
(PUT 'CROSSPROD 'PRTCH '.*.) 
(PUT '3DVECTORS 'NUMBER-OF-ARGS 1) 
(PUT '3DVECTORS 'DEFINED-ON-LINE '47) 
(PUT '3DVECTORS 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT '3DVECTORS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE 3DVECTORS (U)
    (PROG ()
      (SETQ DIMEX* 3)
      (SETQ SGN* (CONS 1 1))
      (PROG (J)
        (SETQ J U)
       LAB
        (COND ((NULL J) (RETURN NIL)))
        ((LAMBDA (J) (PUTFORM J 1)) (CAR J))
        (SETQ J (CDR J))
        (GO LAB))
      (PUT 'HODGE 'PRIFN '(LAMBDA (X) (MAPRIN (*EXT2VEC X))))
      (REMPROP 'D 'PRIFN)
      (PUT 'D 'PRIFN '(LAMBDA (X) (MAPRIN (*EXT2VEC X)))))) 
(RLISTAT '(3DVECTORS)) 
(PUT '3DFUNCTIONS 'NUMBER-OF-ARGS 1) 
(PUT '3DFUNCTIONS 'DEFINED-ON-LINE '59) 
(PUT '3DFUNCTIONS 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT '3DFUNCTIONS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE 3DFUNCTIONS (U)
    (PROG ()
      (SETQ DIMEX* 3)
      (SETQ SGN* (CONS 1 1))
      (PROG (J)
        (SETQ J U)
       LAB
        (COND ((NULL J) (RETURN NIL)))
        ((LAMBDA (J) (PUTFORM J NIL)) (CAR J))
        (SETQ J (CDR J))
        (GO LAB)))) 
(RLISTAT '(3DFUNCTIONS)) 
(PUT 'BASIS_VECTORS 'NUMBER-OF-ARGS 1) 
(PUT 'BASIS_VECTORS 'DEFINED-ON-LINE '68) 
(PUT 'BASIS_VECTORS 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'BASIS_VECTORS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BASIS_VECTORS (U)
    (COFRAM
     (PROG (J FORALL-RESULT FORALL-ENDPTR)
       (SETQ J U)
       (COND ((NULL J) (RETURN NIL)))
       (SETQ FORALL-RESULT
               (SETQ FORALL-ENDPTR (CONS ((LAMBDA (J) (CDR J)) (CAR J)) NIL)))
      LOOPLABEL
       (SETQ J (CDR J))
       (COND ((NULL J) (RETURN FORALL-RESULT)))
       (RPLACD FORALL-ENDPTR (CONS ((LAMBDA (J) (CDR J)) (CAR J)) NIL))
       (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
       (GO LOOPLABEL))
     NIL)) 
(RLISTAT '(BASIS_VECTORS)) 
(PUT 'SIMPGRAD 'NUMBER-OF-ARGS 1) 
(PUT 'SIMPGRAD 'DEFINED-ON-LINE '73) 
(PUT 'SIMPGRAD 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'SIMPGRAD 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SIMPGRAD (U) (*PF2SQ (PARTITGRADIENT U))) 
(PUT 'PARTITGRADIENT 'NUMBER-OF-ARGS 1) 
(PUT 'PARTITGRADIENT 'DEFINED-ON-LINE '76) 
(PUT 'PARTITGRADIENT 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'PARTITGRADIENT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PARTITGRADIENT (U) (EXDFPF (PARTITOP (CAR U)))) 
(PUT 'GRAD 'SIMPFN 'SIMPGRAD) 
(PUT 'GRAD 'PARTITFN 'PARTITGRADIENT) 
(PUT 'SIMP0GRAD 'NUMBER-OF-ARGS 1) 
(PUT 'SIMP0GRAD 'DEFINED-ON-LINE '82) 
(PUT 'SIMP0GRAD 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'SIMP0GRAD 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SIMP0GRAD (U) (CONS (LIST (CONS (CONS (CONS 'D (CDR U)) 1) 1)) 1)) 
(PUT 'GRAD 'SIMP0FN 'SIMP0GRAD) 
(PUT 'SIMPROT 'NUMBER-OF-ARGS 1) 
(PUT 'SIMPROT 'DEFINED-ON-LINE '87) 
(PUT 'SIMPROT 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'SIMPROT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SIMPROT (U) (*PF2SQ (PARTITROTATION U))) 
(PUT 'PARTITROTATION 'NUMBER-OF-ARGS 1) 
(PUT 'PARTITROTATION 'DEFINED-ON-LINE '90) 
(PUT 'PARTITROTATION 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'PARTITROTATION 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PARTITROTATION (U) (HODGEPF (EXDFPF (PARTITOP (CAR U))))) 
(PUT 'ROT 'SIMPFN 'SIMPROT) 
(PUT 'ROT 'PARTITFN 'PARTITROTATION) 
(PUT 'SIMP0ROT 'NUMBER-OF-ARGS 1) 
(PUT 'SIMP0ROT 'DEFINED-ON-LINE '96) 
(PUT 'SIMP0ROT 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'SIMP0ROT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SIMP0ROT (U)
    (CONS (LIST (CONS (CONS (LIST 'D (CONS 'HODGE (CDR U))) 1) 1)) 1)) 
(PUT 'ROT 'SIMP0FN 'SIMP0ROT) 
(PUT 'SIMPDIV 'NUMBER-OF-ARGS 1) 
(PUT 'SIMPDIV 'DEFINED-ON-LINE '101) 
(PUT 'SIMPDIV 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'SIMPDIV 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SIMPDIV (U) (*PF2SQ (PARTITDIVERGENCE U))) 
(PUT 'PARTITDIVERGENCE 'NUMBER-OF-ARGS 1) 
(PUT 'PARTITDIVERGENCE 'DEFINED-ON-LINE '104) 
(PUT 'PARTITDIVERGENCE 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'PARTITDIVERGENCE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PARTITDIVERGENCE (U) (HODGEPF (EXDFPF (HODGEPF (PARTITOP (CAR U)))))) 
(PUT 'DIV 'SIMPFN 'SIMPDIV) 
(PUT 'DIV 'PARTITFN 'PARTITDIVERGENCE) 
(PUT 'SIMP0DIV 'NUMBER-OF-ARGS 1) 
(PUT 'SIMP0DIV 'DEFINED-ON-LINE '110) 
(PUT 'SIMP0DIV 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'SIMP0DIV 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SIMP0DIV (U)
    (CONS
     (LIST (CONS (CONS (LIST 'HODGE (LIST 'D (CONS 'HODGE (CDR U)))) 1) 1)) 1)) 
(PUT 'DIV 'SIMP0FN 'SIMP0DIV) 
(PUT 'CROSSPROD 'PRTCH '.*.) 
(PUT 'SIMPCROSSPROD 'NUMBER-OF-ARGS 1) 
(PUT 'SIMPCROSSPROD 'DEFINED-ON-LINE '118) 
(PUT 'SIMPCROSSPROD 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'SIMPCROSSPROD 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SIMPCROSSPROD (U) (*PF2SQ (PARTITCROSSPROD U))) 
(PUT 'PARTITCROSSPROD 'NUMBER-OF-ARGS 1) 
(PUT 'PARTITCROSSPROD 'DEFINED-ON-LINE '121) 
(PUT 'PARTITCROSSPROD 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'PARTITCROSSPROD 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PARTITCROSSPROD (U) (CROSSPRODPF (PARTITOP (CAR U)) (PARTITOP (CADR U)))) 
(PUT 'CROSSPRODPF 'NUMBER-OF-ARGS 2) 
(PUT 'CROSSPRODPF 'DEFINED-ON-LINE '124) 
(PUT 'CROSSPRODPF 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'CROSSPRODPF 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CROSSPRODPF (U V) (HODGEPF (MKUNIQUEWEDGE (WEDGEPF2 U (MKUNARYWEDGE V))))) 
(PUT 'CROSSPROD 'SIMPFN 'SIMPCROSSPROD) 
(PUT 'CROSSPROD 'PARTITFN 'PARTITCROSSPROD) 
(FLAG '(CROSSPROD) 'SPACED) 
(PUT 'SIMP0CROSSPROD 'NUMBER-OF-ARGS 1) 
(PUT 'SIMP0CROSSPROD 'DEFINED-ON-LINE '131) 
(PUT 'SIMP0CROSSPROD 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'SIMP0CROSSPROD 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SIMP0CROSSPROD (U)
    (CONS (LIST (CONS (CONS (LIST 'HODGE (CONS 'WEDGE (CDR U))) 1) 1)) 1)) 
(PUT 'CROSSPROD 'SIMP0FN 'SIMP0CROSSPROD) 
(PUT 'SIMPDOTPROD 'NUMBER-OF-ARGS 1) 
(PUT 'SIMPDOTPROD 'DEFINED-ON-LINE '136) 
(PUT 'SIMPDOTPROD 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'SIMPDOTPROD 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SIMPDOTPROD (U) (*PF2SQ (PARTITDOTPROD U))) 
(PUT 'PARTITDOTPROD 'NUMBER-OF-ARGS 1) 
(PUT 'PARTITDOTPROD 'DEFINED-ON-LINE '139) 
(PUT 'PARTITDOTPROD 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'PARTITDOTPROD 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PARTITDOTPROD (U) (DOTPRODPF (PARTITOP (CAR U)) (PARTITOP (CADR U)))) 
(PUT 'DOTPRODPF 'NUMBER-OF-ARGS 2) 
(PUT 'DOTPRODPF 'DEFINED-ON-LINE '142) 
(PUT 'DOTPRODPF 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'DOTPRODPF 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DOTPRODPF (U V)
    (HODGEPF (MKUNIQUEWEDGE (WEDGEPF2 (HODGEPF U) (MKUNARYWEDGE V))))) 
(PUT 'DOTPROD 'SIMPFN 'SIMPDOTPROD) 
(PUT 'DOTPROD 'PARTITFN 'PARTITDOTPROD) 
(PUT 'SIMP0DOTPROD 'NUMBER-OF-ARGS 1) 
(PUT 'SIMP0DOTPROD 'DEFINED-ON-LINE '148) 
(PUT 'SIMP0DOTPROD 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'SIMP0DOTPROD 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SIMP0DOTPROD (U)
    (CONS
     (LIST
      (CONS (CONS (LIST 'HODGE (LIST 'WEDGE (CAR U) (CONS 'HODGE (CDDR U)))) 1)
            1))
     1)) 
(PUT 'DOTPROD 'SIMP0FN 'SIMP0DOTPROD) 
(PUT 'SIMPSPAT 'NUMBER-OF-ARGS 1) 
(PUT 'SIMPSPAT 'DEFINED-ON-LINE '153) 
(PUT 'SIMPSPAT 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'SIMPSPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SIMPSPAT (U) (*PF2SQ (PARTITSPAT U))) 
(PUT 'PARTITSPAT 'NUMBER-OF-ARGS 1) 
(PUT 'PARTITSPAT 'DEFINED-ON-LINE '156) 
(PUT 'PARTITSPAT 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'PARTITSPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PARTITSPAT (U)
    (SPATPF (PARTITOP (CAR U)) (PARTITOP (CADR U)) (PARTITOP (CADDR U)))) 
(PUT 'SPATPF 'NUMBER-OF-ARGS 3) 
(PUT 'SPATPF 'DEFINED-ON-LINE '159) 
(PUT 'SPATPF 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'SPATPF 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE SPATPF (U V W)
    (HODGEPF (MKUNIQUEWEDGE (WEDGEPF2 U (WEDGEPF2 V (MKUNARYWEDGE W)))))) 
(PUT 'SPAT 'SIMPFN 'SIMPSPAT) 
(PUT 'SPAT 'PARTITFN 'PARTITSPAT) 
(PUT 'SIMP0SPAT 'NUMBER-OF-ARGS 1) 
(PUT 'SIMP0SPAT 'DEFINED-ON-LINE '165) 
(PUT 'SIMP0SPAT 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'SIMP0SPAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SIMP0SPAT (U)
    (CONS (LIST (CONS (CONS (LIST 'HODGE (CONS 'WEDGE U)) 1) 1)) 1)) 
(PUT 'SPAT 'SIMP0FN 'SIMP0SPAT) 
(PUT '*EXT2VEC 'NUMBER-OF-ARGS 1) 
(PUT '*EXT2VEC 'DEFINED-ON-LINE '171) 
(PUT '*EXT2VEC 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT '*EXT2VEC 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE *EXT2VEC (U)
    (COND ((ATOM U) U) ((EQ (CAR U) 'D) (LIST 'GRAD (*EXT2VEC (CADR U))))
          ((EQ (CAR U) 'HODGE)
           (COND ((EQCAR (CADR U) 'WEDGE) (HODGEWEDGE2VEC (CDADR U)))
                 ((EQCAR (CADR U) 'D)
                  (COND
                   ((EQUAL (DEG*FORM (CADADR U)) 1)
                    (LIST 'ROT (*EXT2VEC (CADADR U))))
                   (T (LIST 'DIV (*EXT2VEC (CADR (CADADR U)))))))
                 (T U))))) 
(PUT 'HODGEWEDGE2VEC 'NUMBER-OF-ARGS 1) 
(PUT 'HODGEWEDGE2VEC 'DEFINED-ON-LINE '182) 
(PUT 'HODGEWEDGE2VEC 'DEFINED-IN-FILE 'EXCALC/VECANLYS.RED) 
(PUT 'HODGEWEDGE2VEC 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE HODGEWEDGE2VEC (U)
    (COND
     ((EQUAL (LENGTH U) 3)
      (LIST 'SPAT (*EXT2VEC (CAR U)) (*EXT2VEC (CADR U)) (*EXT2VEC (CADDR U))))
     ((EQUAL (DEG*FORM (CAR U)) 1)
      (COND
       ((EQUAL (DEG*FORM (CADR U)) 2)
        (LIST 'DOTPROD (*EXT2VEC (CAR U))
              (COND ((EQCAR (CADR U) 'D) (LIST 'ROT (*EXT2VEC (CADADR U))))
                    (T (*EXT2VEC (CADADR U))))))
       (T (LIST 'CROSSPROD (*EXT2VEC (CAR U)) (*EXT2VEC (CADR U))))))
     (T
      (LIST 'DOTPROD
            (COND ((EQCAR (CAR U) 'D) (LIST 'ROT (*EXT2VEC (CADAR U))))
                  (T (*EXT2VEC (CADAR U))))
            (*EXT2VEC (CADR U)))))) 
(ENDMODULE) 