(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'SQRTF)) 
(FLUID '(*NOEXTEND ZLIST)) 
(EXPORTS (LIST 'NROOTN 'DOMAINP 'MINUSF)) 
(IMPORTS
 (LIST 'CONTENTSMV 'GCDF 'INTERR '*MULTF 'PARTIALDIFF 'PRINTDF 'QUOTF
       'SIMPSQRT2 'VP2)) 
(PUT 'SQRTF 'NUMBER-OF-ARGS 1) 
(PUT 'SQRTF 'DEFINED-ON-LINE '65) 
(PUT 'SQRTF 'DEFINED-IN-FILE 'INT/SQRTF.RED) 
(PUT 'SQRTF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SQRTF (P)
    (PROG (IP QP)
      (COND ((NULL P) (RETURN NIL)))
      (SETQ IP (SQRTF1 P))
      (SETQ QP (CDR IP))
      (SETQ IP (CAR IP))
      (COND ((EQUAL QP 1) (RETURN IP)))
      (COND (*NOEXTEND (RETURN 'FAILED)))
      (COND ((ZLISTP QP) (RETURN 'FAILED)))
      (SETQ QP (SIMPSQRT2 QP))
      (RETURN (*MULTF IP QP)))) 
(PUT 'ZLISTP 'NUMBER-OF-ARGS 1) 
(PUT 'ZLISTP 'DEFINED-ON-LINE '83) 
(PUT 'ZLISTP 'DEFINED-IN-FILE 'INT/SQRTF.RED) 
(PUT 'ZLISTP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ZLISTP (QP)
    (COND ((ATOM QP) (MEMBER QP ZLIST))
          (T
           (OR (MEMBER (CAAAR QP) ZLIST) (ZLISTP (CDAR QP))
               (ZLISTP (CDR QP)))))) 
(PUT 'SQRTF1 'NUMBER-OF-ARGS 1) 
(PUT 'SQRTF1 'DEFINED-ON-LINE '87) 
(PUT 'SQRTF1 'DEFINED-IN-FILE 'INT/SQRTF.RED) 
(PUT 'SQRTF1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SQRTF1 (P)
    (COND
     ((OR (ATOM P) (ATOM (CAR P)))
      (COND ((FIXP P) (NROOTN P 2))
            (T (CONS (*Q2F (SIMPSQRT (LIST (PREPF P)))) 1))))
     (T
      (PROG (CO PP G PG)
        (SETQ CO (CONTENTSMV P (CAAAR P) NIL))
        (SETQ PP (QUOTF-FAIL P CO))
        (SETQ CO (SQRTF1 CO))
        (SETQ G (GCDF PP (PARTIALDIFF PP (CAAAR PP))))
        (SETQ PG (QUOTF-FAIL PP G))
        (SETQ G (GCDF G PG))
        (COND ((EQUAL G 1) (SETQ PG (CONS 1 PP)))
              (T
               (PROGN
                (SETQ PG (QUOTF-FAIL PP (*MULTF G G)))
                (SETQ PG (SQRTF1 PG))
                (RPLACA PG (*MULTF (CAR PG) G)))))
        (RPLACA PG (*MULTF (CAR PG) (CAR CO)))
        (RPLACD PG (*MULTF (CDR PG) (CDR CO)))
        (RETURN PG))))) 
(ENDMODULE) 