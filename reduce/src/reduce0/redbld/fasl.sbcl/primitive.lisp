(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'PRIMITIVE)) 
(FLUID '(*CRAMER BAREISS-STEP-SIZE*)) 
(PUT 'PRIMITIVESF 'NUMBER-OF-ARGS 2) 
(PUT 'PRIMITIVESF 'DEFINED-ON-LINE '30) 
(PUT 'PRIMITIVESF 'DEFINED-IN-FILE 'RATAPRX/PRIMITIVE.RED) 
(PUT 'PRIMITIVESF 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE PRIMITIVESF (XL VL)
    (PROG (X FORALL-RESULT FORALL-ENDPTR)
      (SETQ X XL)
      (COND ((NULL X) (RETURN NIL)))
      (SETQ FORALL-RESULT
              (SETQ FORALL-ENDPTR
                      (CONS ((LAMBDA (X) (QUOTF* X (COEFFGCD X VL))) (CAR X))
                            NIL)))
     LOOPLABEL
      (SETQ X (CDR X))
      (COND ((NULL X) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR
              (CONS ((LAMBDA (X) (QUOTF* X (COEFFGCD X VL))) (CAR X)) NIL))
      (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
      (GO LOOPLABEL))) 
(PUT 'COEFFGCD 'NUMBER-OF-ARGS 2) 
(PUT 'COEFFGCD 'DEFINED-ON-LINE '37) 
(PUT 'COEFFGCD 'DEFINED-IN-FILE 'RATAPRX/PRIMITIVE.RED) 
(PUT 'COEFFGCD 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE COEFFGCD (X VL)
    (COND ((OR (OR (ATOM X) (ATOM (CAR X))) (NOT (MEMQ (CAAAR X) VL))) X)
          ((NULL (CDR X)) (CDAR X)) (T (GCDF (CDAR X) (COEFFGCD (CDR X) VL))))) 
(PUT 'SOLVELNRSYS 'NUMBER-OF-ARGS 2) 
(PUT 'SOLVELNRSYS 'DEFINED-ON-LINE '44) 
(PUT 'SOLVELNRSYS 'DEFINED-IN-FILE 'RATAPRX/PRIMITIVE.RED) 
(PUT 'SOLVELNRSYS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SOLVELNRSYS (EXLIS VARLIS)
    (PROG (W METHOD)
      (SETQ EXLIS (PRIMITIVESF EXLIS VARLIS))
      (COND ((SETQ W (SOLVESPARSECHECK EXLIS VARLIS)) (SETQ EXLIS W))
            (T (SETQ EXLIS (CONS EXLIS VARLIS))))
      (COND
       ((AND (NULL *CRAMER) (NULL (EXPTEXPFLISTP EXLIS)))
        (SETQ METHOD 'SOLVEBAREISS))
       (T (SETQ METHOD 'SOLVECRAMER)))
      ((LAMBDA (BAREISS-STEP-SIZE*)
         (SETQ EXLIS (APPLY2 METHOD (CAR EXLIS) (CDR EXLIS))))
       (COND (W 4) (T 2)))
      (RETURN (SOLVESYSPOST EXLIS VARLIS)))) 
(ENDMODULE) 