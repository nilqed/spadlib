(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'BQUOTE)) 
(PUT 'BACKQ 'FORMFN 'FORMBQUOTE) 
(PUT 'FORMBQUOTE 'NUMBER-OF-ARGS 3) 
(PUT 'FORMBQUOTE 'DEFINED-ON-LINE '48) 
(PUT 'FORMBQUOTE 'DEFINED-IN-FILE 'RLISP88/BQUOTE.RED) 
(PUT 'FORMBQUOTE 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMBQUOTE (U VARS MODE) (MKBQUOTE (CADR U))) 
(PUT 'MKBQUOTE 'NUMBER-OF-ARGS 1) 
(PUT 'MKBQUOTE 'DEFINED-ON-LINE '50) 
(PUT 'MKBQUOTE 'DEFINED-IN-FILE 'RLISP88/BQUOTE.RED) 
(PUT 'MKBQUOTE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MKBQUOTE (U)
    (COND ((OR (NULL U) (CONSTANTP U)) U) ((ATOM U) (MKQUOTE U))
          ((EQ (CAR U) 'QUOTE)
           (COND ((EQ (CADR U) '|#|) (REDERR "Invalid use of # after '"))
                 (T (MKQUOTE U))))
          ((EQ (CAR U) 'LISTIFY) (MKBQUOTE (CDR U)))
          ((EQ (CAR U) '|#|)
           (COND
            ((EQCAR (CDR U) '@)
             (COND ((NULL (CDDDR U)) (CADDR U))
                   (T (LIST 'APPEND (CADDR U) (MKBQUOTE (CDDDR U))))))
            (T (LIST 'CONS (CADR U) (MKBQUOTE (CDDR U))))))
          ((EQ (CAR U) '@) (REDERR "Invalid use of @"))
          (T (LIST 'CONS (MKBQUOTE (CAR U)) (MKBQUOTE (CDR U)))))) 
(PUT 'BACKQUOTE 'STAT 'BQUOTSTAT) 
(PUT 'BQUOTSTAT 'NUMBER-OF-ARGS 0) 
(PUT 'BQUOTSTAT 'DEFINED-ON-LINE '71) 
(PUT 'BQUOTSTAT 'DEFINED-IN-FILE 'RLISP88/BQUOTE.RED) 
(PUT 'BQUOTSTAT 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE BQUOTSTAT NIL (LIST 'BACKQUOTE (RL2L (CADR (RLIS))))) 
(PUT 'RL2L 'NUMBER-OF-ARGS 1) 
(PUT 'RL2L 'DEFINED-ON-LINE '73) 
(PUT 'RL2L 'DEFINED-IN-FILE 'RLISP88/BQUOTE.RED) 
(PUT 'RL2L 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE RL2L (U)
    (COND ((ATOM U) U) ((ATOM (CAR U)) (CONS (CAR U) (RL2L (CDR U))))
          ((OR (EQ (CAAR U) 'HASH) (EQ (CAAR U) '|#|))
           (COND
            ((EQCAR (CADAR U) '@)
             (CONS '|#| (CONS '@ (CONS (CADR (CADAR U)) (RL2L (CDR U))))))
            (T (CONS '|#| (CONS (CADAR U) (RL2L (CDR U)))))))
          (T (CONS (RL2L (CAR U)) (RL2L (CDR U)))))) 
(PUT 'BACKQUOTE 'FORMFN 'FORMBQUOTE) 
(ENDMODULE) 