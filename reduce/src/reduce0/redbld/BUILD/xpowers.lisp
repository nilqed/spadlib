(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'XPOWERS)) 
(FLUID '(XDEGREELIST* XVARLIST*)) 
(RLISTAT '(XORDER)) 
(PUT 'XORDER 'NUMBER-OF-ARGS 1) 
(PUT 'XORDER 'DEFINED-ON-LINE '50) 
(PUT 'XORDER 'DEFINED-IN-FILE 'XIDEAL/XPOWERS.RED) 
(PUT 'XORDER 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE XORDER (U)
    (COND
     ((EQUAL U (LIST NIL)) (COMPRESS (PNTH (EXPLODE (GET 'WEDGE 'XORDER)) 6)))
     ((AND (OR (IDP (SETQ U (CAR U))) (IDP (SETQ U (REVAL1 U T))))
           (GETD (MKID 'XORD_ U)))
      (PROGN (PUT 'WEDGE 'XORDER (MKID 'XORD_ U)) U))
     (T (TYPERR U "xorder")))) 
(PUT 'WEDGE 'XORDER 'XORD_DEGLEX) 
(DE XVAL (F) (WEDGEFAX (CAAR F))) 
(PUT 'XVAL 'NUMBER-OF-ARGS 1) 
(PUT 'XVAL 'DEFINED-ON-LINE '61) 
(PUT 'XVAL 'DEFINED-IN-FILE 'XIDEAL/XPOWERS.RED) 
(PUT 'XVAL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'XVAL 'INLINE '(LAMBDA (F) (WEDGEFAX (CAAR F)))) 
(PUT 'PFORDP 'NUMBER-OF-ARGS 2) 
(PUT 'PFORDP 'DEFINED-ON-LINE '66) 
(PUT 'PFORDP 'DEFINED-IN-FILE 'XIDEAL/XPOWERS.RED) 
(PUT 'PFORDP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE PFORDP (F G)
    (COND ((NULL F) NIL) ((NULL G) (NEQ (CAAR F) 1))
          ((NOT (EQ (CAAR F) (CAAR G))) (TERMORDP (CAAR F) (CAAR G)))
          (T (PFORDP (CDR F) (CDR G))))) 
(PUT 'TERMORDP 'NUMBER-OF-ARGS 2) 
(PUT 'TERMORDP 'DEFINED-ON-LINE '76) 
(PUT 'TERMORDP 'DEFINED-IN-FILE 'XIDEAL/XPOWERS.RED) 
(PUT 'TERMORDP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE TERMORDP (U V) (MONORDP (WEDGEFAX U) (WEDGEFAX V))) 
(PUT 'MONORDP 'NUMBER-OF-ARGS 2) 
(PUT 'MONORDP 'DEFINED-ON-LINE '82) 
(PUT 'MONORDP 'DEFINED-IN-FILE 'XIDEAL/XPOWERS.RED) 
(PUT 'MONORDP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MONORDP (U V) (APPLY2 (GET 'WEDGE 'XORDER) U V)) 
(PUT 'FACTORORDP 'NUMBER-OF-ARGS 2) 
(PUT 'FACTORORDP 'DEFINED-ON-LINE '88) 
(PUT 'FACTORORDP 'DEFINED-IN-FILE 'XIDEAL/XPOWERS.RED) 
(PUT 'FACTORORDP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE FACTORORDP (U V) (COND ((EQ U V) NIL) (T (WORDERP U V)))) 
(PUT 'XORD_LEX 'NUMBER-OF-ARGS 2) 
(PUT 'XORD_LEX 'DEFINED-ON-LINE '97) 
(PUT 'XORD_LEX 'DEFINED-IN-FILE 'XIDEAL/XPOWERS.RED) 
(PUT 'XORD_LEX 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE XORD_LEX (U V)
    (COND ((OR (NULL U) (EQUAL (CAR U) 1)) NIL)
          ((OR (NULL V) (EQUAL (CAR V) 1)) T)
          ((EQ (CAR U) (CAR V)) (XORD_LEX (CDR U) (CDR V)))
          (T (FACTORORDP (CAR U) (CAR V))))) 
(PUT 'XORD_GRADLEX 'NUMBER-OF-ARGS 2) 
(PUT 'XORD_GRADLEX 'DEFINED-ON-LINE '105) 
(PUT 'XORD_GRADLEX 'DEFINED-IN-FILE 'XIDEAL/XPOWERS.RED) 
(PUT 'XORD_GRADLEX 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE XORD_GRADLEX (U V)
    (COND ((EQUAL (CAR U) 1) NIL) ((EQUAL (CAR V) 1) T)
          ((EQUAL (LENGTH U) (LENGTH V)) (XORD_LEX U V))
          (T (GREATERP (LENGTH U) (LENGTH V))))) 
(PUT 'XORD_DEGLEX 'NUMBER-OF-ARGS 2) 
(PUT 'XORD_DEGLEX 'DEFINED-ON-LINE '113) 
(PUT 'XORD_DEGLEX 'DEFINED-IN-FILE 'XIDEAL/XPOWERS.RED) 
(PUT 'XORD_DEGLEX 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE XORD_DEGLEX (U V)
    (COND ((EQUAL (CAR U) 1) NIL) ((EQUAL (CAR V) 1) T)
          (T
           ((LAMBDA (DU DV)
              (COND ((EQUAL DU DV) (XORD_LEX U V)) (T (GREATERP DU DV))))
            (XDEGREEMON U) (XDEGREEMON V))))) 
(PUT 'XDEGREEMON 'NUMBER-OF-ARGS 1) 
(PUT 'XDEGREEMON 'DEFINED-ON-LINE '122) 
(PUT 'XDEGREEMON 'DEFINED-IN-FILE 'XIDEAL/XPOWERS.RED) 
(PUT 'XDEGREEMON 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE XDEGREEMON (U)
    (COND ((NULL XDEGREELIST*) (XDEGREE (MKNWEDGE U)))
          (T
           (PROG (K FORALL-RESULT)
             (SETQ K U)
             (SETQ FORALL-RESULT 0)
            LAB1
             (COND ((NULL K) (RETURN FORALL-RESULT)))
             (SETQ FORALL-RESULT
                     (PLUS ((LAMBDA (K) (CDR (ATSOC K XDEGREELIST*))) (CAR K))
                           FORALL-RESULT))
             (SETQ K (CDR K))
             (GO LAB1))))) 
(PUT 'XORD_DEGGRADLEX 'NUMBER-OF-ARGS 2) 
(PUT 'XORD_DEGGRADLEX 'DEFINED-ON-LINE '129) 
(PUT 'XORD_DEGGRADLEX 'DEFINED-IN-FILE 'XIDEAL/XPOWERS.RED) 
(PUT 'XORD_DEGGRADLEX 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE XORD_DEGGRADLEX (U V)
    (COND ((EQUAL (CAR U) 1) NIL) ((EQUAL (CAR V) 1) T)
          (T
           ((LAMBDA (DU DV)
              (COND ((EQUAL DU DV) (XORD_GRADLEX U V)) (T (GREATERP DU DV))))
            (XDEGREE (MKNWEDGE U)) (XDEGREE (MKNWEDGE V)))))) 
(PUT 'XLCM 'NUMBER-OF-ARGS 2) 
(PUT 'XLCM 'DEFINED-ON-LINE '138) 
(PUT 'XLCM 'DEFINED-IN-FILE 'XIDEAL/XPOWERS.RED) 
(PUT 'XLCM 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE XLCM (R S)
    (COND ((OR (NULL R) (EQUAL (CAR R) 1)) S)
          ((OR (NULL S) (EQUAL (CAR S) 1)) R)
          ((EQ (CAR R) (CAR S)) (CONS (CAR R) (XLCM (CDR R) (CDR S))))
          ((FACTORORDP (CAR R) (CAR S)) (CONS (CAR R) (XLCM (CDR R) S)))
          (T (CONS (CAR S) (XLCM R (CDR S)))))) 
(PUT 'XDIV 'NUMBER-OF-ARGS 2) 
(PUT 'XDIV 'DEFINED-ON-LINE '148) 
(PUT 'XDIV 'DEFINED-IN-FILE 'XIDEAL/XPOWERS.RED) 
(PUT 'XDIV 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE XDIV (R S)
    (COND ((EQUAL R (LIST 1)) S)
          ((SUBLISTP R S) (COND ((SETQ S (LISTDIFF S R)) S) (T (LIST 1)))))) 
(PUT 'LISTUNION 'NUMBER-OF-ARGS 2) 
(PUT 'LISTUNION 'DEFINED-ON-LINE '156) 
(PUT 'LISTUNION 'DEFINED-IN-FILE 'XIDEAL/XPOWERS.RED) 
(PUT 'LISTUNION 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE LISTUNION (X Y)
    (COND ((NULL X) Y) ((NULL Y) X)
          (T
           (CONS (CAR X)
                 (LISTUNION (CDR X)
                  (COND ((MEMBER (CAR X) Y) (DELETE (CAR X) Y)) (T Y))))))) 
(ENDMODULE) 