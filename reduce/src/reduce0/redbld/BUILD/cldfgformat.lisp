(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'CLDFGFORMAT)) 
(REVISION 'CLDFGFORMAT
          "$Id: cldfgformat.red 5970 2021-08-24 16:31:08Z thomas-sturm $") 
(COPYRIGHT 'CLDFGFORMAT "(c) 2021 T. Sturm") 
(RL_PROVIDESERVICE 'RL_DFGPRINT 'CL_DFGPRINT '(RL_DFGPRINTV RL_DFGPRINTAT)) 
(PUT 'CL_DFGPRINT 'NUMBER-OF-ARGS 2) 
(PUT 'CL_DFGPRINT 'DEFINED-ON-LINE '34) 
(PUT 'CL_DFGPRINT 'DEFINED-IN-FILE 'REDLOG/CL/CLDFGFORMAT.RED) 
(PUT 'CL_DFGPRINT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CL_DFGPRINT (F FNAME)
    (PROGN
     (COND ((NEQ FNAME "") (OUT (LIST FNAME))))
     (PRIN2 "formula(")
     (CL_DFGPRINT1 F)
     (PRIN2 ")")
     (TERPRI)
     (COND ((NEQ FNAME "") (SHUT (LIST FNAME)))))) 
(PUT 'CL_DFGPRINT1 'NUMBER-OF-ARGS 1) 
(PUT 'CL_DFGPRINT1 'DEFINED-ON-LINE '47) 
(PUT 'CL_DFGPRINT1 'DEFINED-IN-FILE 'REDLOG/CL/CLDFGFORMAT.RED) 
(PUT 'CL_DFGPRINT1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CL_DFGPRINT1 (F)
    (PROG (QL VLL VL)
      (PROG (G178 G179)
        (SETQ G178 (CL_SPLIT F))
        (SETQ G179 G178)
        (SETQ QL (CAR G178))
        (SETQ G178 (CDR G178))
        (SETQ VLL (CAR G178))
        (SETQ G178 (CDR G178))
        (SETQ F (CAR G178))
        (SETQ G178 (CDR G178))
        (SETQ VL (CAR G178))
        (SETQ G178 (CDR G178))
        (RETURN G179))
      (SETQ QL (REVERSE QL))
      (SETQ VLL (REVERSE VLL))
      (PROG (Q)
        (SETQ Q QL)
       LAB
        (COND ((NULL Q) (RETURN NIL)))
        ((LAMBDA (Q)
           (PROGN
            (SETQ VL (REVERSE (PROG1 (CAR VLL) (SETQ VLL (CDR VLL)))))
            (PRIN2 (COND ((EQ Q 'EX) "exists") (T "forall")))
            (PRIN2 "(")
            (CL_DFGPRINTVL VL)
            (PRIN2 ", ")))
         (CAR Q))
        (SETQ Q (CDR Q))
        (GO LAB))
      (CL_DFGPRINTQFF F)
      (PROG (Q)
        (SETQ Q QL)
       LAB
        (COND ((NULL Q) (RETURN NIL)))
        ((LAMBDA (Q) (PRIN2 ")")) (CAR Q))
        (SETQ Q (CDR Q))
        (GO LAB)))) 
(PUT 'CL_DFGPRINTVL 'NUMBER-OF-ARGS 1) 
(PUT 'CL_DFGPRINTVL 'DEFINED-ON-LINE '65) 
(PUT 'CL_DFGPRINTVL 'DEFINED-IN-FILE 'REDLOG/CL/CLDFGFORMAT.RED) 
(PUT 'CL_DFGPRINTVL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CL_DFGPRINTVL (VL)
    (PROGN
     (PRIN2 "[")
     (PROG (RVL)
       (SETQ RVL VL)
      LAB
       (COND ((NULL RVL) (RETURN NIL)))
       (PROGN (RL_DFGPRINTV (CAR RVL)) (COND ((CDR RVL) (PRIN2 ", "))))
       (SETQ RVL (CDR RVL))
       (GO LAB))
     (PRIN2 "]"))) 
(PUT 'CL_DFGPRINTQFF 'NUMBER-OF-ARGS 1) 
(PUT 'CL_DFGPRINTQFF 'DEFINED-ON-LINE '75) 
(PUT 'CL_DFGPRINTQFF 'DEFINED-IN-FILE 'REDLOG/CL/CLDFGFORMAT.RED) 
(PUT 'CL_DFGPRINTQFF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CL_DFGPRINTQFF (F)
    (PROG (OP L R)
      (SETQ OP (COND ((ATOM F) F) (T (CAR F))))
      (COND
       ((EQ OP 'IMPL)
        (CL_DFGPRINTQFF (LIST 'OR (LIST 'NOT (CADR F)) (CADDR F))))
       ((EQ OP 'REPL)
        (CL_DFGPRINTQFF (LIST 'OR (CADR F) (LIST 'NOT (CADDR F)))))
       ((EQ OP 'EQUIV)
        (PROGN
         (SETQ L (CADR F))
         (SETQ R (CADDR F))
         (CL_DFGPRINT1 (CONS 'AND (LIST (LIST 'IMPL L R) (LIST 'REPL L R))))))
       ((EQ OP 'NOT)
        (PROGN (PRIN2 "not") (PRIN2 "(") (CL_DFGPRINT1 (CADR F)) (PRIN2 ")")))
       ((OR (EQ OP 'TRUE) (EQ OP 'FALSE)) (PRIN2 F))
       ((OR (EQ OP 'OR) (EQ OP 'AND)) (CL_DFGPRINTJ OP (CDR F)))
       (T (RL_DFGPRINTAT F))))) 
(PUT 'CL_DFGPRINTJ 'NUMBER-OF-ARGS 2) 
(PUT 'CL_DFGPRINTJ 'DEFINED-ON-LINE '99) 
(PUT 'CL_DFGPRINTJ 'DEFINED-IN-FILE 'REDLOG/CL/CLDFGFORMAT.RED) 
(PUT 'CL_DFGPRINTJ 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CL_DFGPRINTJ (OP ARGL)
    (COND ((NOT (CDR ARGL)) (CL_DFGPRINT1 (CAR ARGL)))
          (T
           (PROGN
            (PRIN2 OP)
            (PRIN2 "(")
            (PROG (RARGL)
              (SETQ RARGL ARGL)
             LAB
              (COND ((NULL RARGL) (RETURN NIL)))
              (PROGN
               (CL_DFGPRINT1 (CAR RARGL))
               (COND ((CDR RARGL) (PRIN2 ", "))))
              (SETQ RARGL (CDR RARGL))
              (GO LAB))
            (PRIN2 ")"))))) 
(PUT 'CL_DFGPRINTJ2 'NUMBER-OF-ARGS 2) 
(PUT 'CL_DFGPRINTJ2 'DEFINED-ON-LINE '113) 
(PUT 'CL_DFGPRINTJ2 'DEFINED-IN-FILE 'REDLOG/CL/CLDFGFORMAT.RED) 
(PUT 'CL_DFGPRINTJ2 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CL_DFGPRINTJ2 (OP ARGL)
    (COND ((NOT (CDR ARGL)) (CL_DFGPRINT1 (CAR ARGL)))
          (T
           (PROGN
            (PRIN2 OP)
            (PRIN2 "(")
            (CL_DFGPRINT1 (CAR ARGL))
            (PRIN2 ", ")
            (CL_DFGPRINTJ OP (CDR ARGL))
            (PRIN2 ")"))))) 
(ENDMODULE) 