(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'MVMATCH)) 
(PUT 'MV-COMPACT 'NUMBER-OF-ARGS 3) 
(PUT 'MV-COMPACT 'DEFINED-ON-LINE '32) 
(PUT 'MV-COMPACT 'DEFINED-IN-FILE 'MISC/MVMATCH.RED) 
(PUT 'MV-COMPACT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE MV-COMPACT (U V W)
    (PROG (X Y)
      (COND ((NULL U) (RETURN (MV-REVERSE W))))
      (COND
       ((AND (SETQ X (MV-POW-CHK U V))
             (SETQ Y (MV-COMPACT2 U (MV-POW-MV-+ X V))))
        (RETURN (MV-COMPACT Y V W)))
       ((AND (SETQ X (MV-POW-CHK U (CDR V)))
             (NOT (MV-POW-ASSOC (SETQ Y (MV-POW-+ X (CAAR V))) W))
             (SETQ Y (MV-COMPACT2 (CONS (CONS Y 0) U) (MV-POW-MV-+ X V))))
        (RETURN (MV-COMPACT Y V W)))
       (T (RETURN (MV-COMPACT (CDR U) V (CONS (CAR U) W))))))) 
(PUT 'MV-POW-ASSOC 'NUMBER-OF-ARGS 2) 
(PUT 'MV-POW-ASSOC 'DEFINED-ON-LINE '57) 
(PUT 'MV-POW-ASSOC 'DEFINED-IN-FILE 'MISC/MVMATCH.RED) 
(PUT 'MV-POW-ASSOC 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MV-POW-ASSOC (U V) (ASSOC U V)) 
(PUT 'MV-REVERSE 'NUMBER-OF-ARGS 1) 
(PUT 'MV-REVERSE 'DEFINED-ON-LINE '59) 
(PUT 'MV-REVERSE 'DEFINED-IN-FILE 'MISC/MVMATCH.RED) 
(PUT 'MV-REVERSE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MV-REVERSE (U) (REVERSIP U)) 
(PUT 'MV-POW-CHK 'NUMBER-OF-ARGS 2) 
(PUT 'MV-POW-CHK 'DEFINED-ON-LINE '61) 
(PUT 'MV-POW-CHK 'DEFINED-IN-FILE 'MISC/MVMATCH.RED) 
(PUT 'MV-POW-CHK 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MV-POW-CHK (U V)
    (COND
     ((AND V (SETQ U (MV-POW-- (CAAR U) (CAAR V))) (NOT (MV-POW-MINUSP U))) U)
     (T NIL))) 
(PUT 'MV-COMPACT2 'NUMBER-OF-ARGS 2) 
(PUT 'MV-COMPACT2 'DEFINED-ON-LINE '67) 
(PUT 'MV-COMPACT2 'DEFINED-IN-FILE 'MISC/MVMATCH.RED) 
(PUT 'MV-COMPACT2 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MV-COMPACT2 (U V)
    (PROG (X Y Z)
      (SETQ X (EQUIV-COEFFS U V))
      (SETQ Z (MV-DOMAINLIST V))
      (SETQ Y (REDUCE X Z))
      (RETURN
       (COND ((EQUAL Y X) NIL)
             (T (MV-+ (MV-COEFF-REPLACE V (MV-DOMAINLIST-- Y X)) U)))))) 
(PUT 'MV-COEFF-REPLACE 'NUMBER-OF-ARGS 2) 
(PUT 'MV-COEFF-REPLACE 'DEFINED-ON-LINE '79) 
(PUT 'MV-COEFF-REPLACE 'DEFINED-IN-FILE 'MISC/MVMATCH.RED) 
(PUT 'MV-COEFF-REPLACE 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MV-COEFF-REPLACE (U V)
    (COND ((NULL U) NIL) ((EQUAL (CAR V) 0) (MV-COEFF-REPLACE (CDR U) (CDR V)))
          (T
           (CONS (CONS (CAAR U) (CAR V)) (MV-COEFF-REPLACE (CDR U) (CDR V)))))) 
(PUT 'EQUIV-COEFFS 'NUMBER-OF-ARGS 2) 
(PUT 'EQUIV-COEFFS 'DEFINED-ON-LINE '87) 
(PUT 'EQUIV-COEFFS 'DEFINED-IN-FILE 'MISC/MVMATCH.RED) 
(PUT 'EQUIV-COEFFS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE EQUIV-COEFFS (U V)
    (COND ((NULL U) (NZEROS (LENGTH V))) ((NULL V) NIL)
          ((EQUAL (CAAR U) (CAAR V))
           (CONS (CDAR U) (EQUIV-COEFFS (CDR U) (CDR V))))
          ((MV-POW-> (CAAR U) (CAAR V)) (EQUIV-COEFFS (CDR U) V))
          (T (CONS 0 (EQUIV-COEFFS U (CDR V)))))) 
(ENDMODULE) 