(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'XAUX)) 
(PUT '*WEDGEPF2PF 'NUMBER-OF-ARGS 1) 
(PUT '*WEDGEPF2PF 'DEFINED-ON-LINE '49) 
(PUT '*WEDGEPF2PF 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT '*WEDGEPF2PF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE *WEDGEPF2PF (F)
    (COND ((NULL F) NIL)
          (T (CONS (CONS (MKUWEDGE (CAAR F)) (CDAR F)) (*WEDGEPF2PF (CDR F)))))) 
(PUT '*PF2WEDGEPF 'NUMBER-OF-ARGS 1) 
(PUT '*PF2WEDGEPF 'DEFINED-ON-LINE '55) 
(PUT '*PF2WEDGEPF 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT '*PF2WEDGEPF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE *PF2WEDGEPF (F)
    (COND ((NULL F) NIL)
          (T (CONS (CONS (WEDGEFAX (CAAR F)) (CDAR F)) (*PF2WEDGEPF (CDR F)))))) 
(PUT 'MKUWEDGE 'NUMBER-OF-ARGS 1) 
(PUT 'MKUWEDGE 'DEFINED-ON-LINE '61) 
(PUT 'MKUWEDGE 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'MKUWEDGE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MKUWEDGE (U) (COND ((CDR U) (CAR (FKERN (CONS 'WEDGE U)))) (T (CAR U)))) 
(PUT 'MKNWEDGE 'NUMBER-OF-ARGS 1) 
(PUT 'MKNWEDGE 'DEFINED-ON-LINE '67) 
(PUT 'MKNWEDGE 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'MKNWEDGE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MKNWEDGE (U) (COND ((CDR U) (CONS 'WEDGE U)) (T (CAR U)))) 
(PUT 'WEDGEFAX 'NUMBER-OF-ARGS 1) 
(PUT 'WEDGEFAX 'DEFINED-ON-LINE '73) 
(PUT 'WEDGEFAX 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'WEDGEFAX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE WEDGEFAX (U) (COND ((EQCAR U 'WEDGE) (CDR U)) (T (LIST U)))) 
(PUT 'WEDGEPF 'NUMBER-OF-ARGS 2) 
(PUT 'WEDGEPF 'DEFINED-ON-LINE '78) 
(PUT 'WEDGEPF 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'WEDGEPF 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE WEDGEPF (U V) (*WEDGEPF2PF (WEDGEPF2 U (*PF2WEDGEPF V)))) 
(FLUID '(XVARS*)) 
(RLISTAT '(XVARS)) 
(PUT 'XVARS 'NUMBER-OF-ARGS 1) 
(PUT 'XVARS 'DEFINED-ON-LINE '94) 
(PUT 'XVARS 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'XVARS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE XVARS (U)
    (PROG () (SETQ XVARS* (COND ((EQUAL U (LIST NIL)) T) (T (XVARLIST U)))))) 
(PUT 'XVARLIST 'NUMBER-OF-ARGS 1) 
(PUT 'XVARLIST 'DEFINED-ON-LINE '101) 
(PUT 'XVARLIST 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'XVARLIST 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE XVARLIST (U)
    (PROG (X FORALL-RESULT FORALL-ENDPTR)
      (SETQ X U)
     STARTOVER
      (COND ((NULL X) (RETURN NIL)))
      (SETQ FORALL-RESULT
              ((LAMBDA (X)
                 (COND ((EQCAR (SETQ X (REVAL1 X T)) 'LIST) (XVARLIST (CDR X)))
                       (T (LIST (*A2K X)))))
               (CAR X)))
      (SETQ FORALL-ENDPTR (LASTPAIR FORALL-RESULT))
      (SETQ X (CDR X))
      (COND ((ATOM FORALL-ENDPTR) (GO STARTOVER)))
     LOOPLABEL
      (COND ((NULL X) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR
              ((LAMBDA (X)
                 (COND ((EQCAR (SETQ X (REVAL1 X T)) 'LIST) (XVARLIST (CDR X)))
                       (T (LIST (*A2K X)))))
               (CAR X)))
      (SETQ FORALL-ENDPTR (LASTPAIR FORALL-ENDPTR))
      (SETQ X (CDR X))
      (GO LOOPLABEL))) 
(PUT 'XPARTITSQ 'NUMBER-OF-ARGS 1) 
(PUT 'XPARTITSQ 'DEFINED-ON-LINE '109) 
(PUT 'XPARTITSQ 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'XPARTITSQ 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE XPARTITSQ (U)
    ((LAMBDA (X Y)
       (COND ((NULL X) NIL)
             ((OR (ATOM X) (ATOM (CAR X))) (CONS (CONS 1 U) NIL))
             (T
              (ADDPF
               (COND
                ((SFP (CAAAR X))
                 (WEDGEPF (XEXPTPF (XPARTITSQ (CONS (CAAAR X) 1)) (CDAAR X))
                  (XPARTITSQ (CANCEL (CONS (CDAR X) Y)))))
                ((XVARP (CAAAR X))
                 (WEDGEPF (XEXPTPF (XPARTITK (CAAAR X)) (CDAAR X))
                  (XPARTITSQ (CANCEL (CONS (CDAR X) Y)))))
                (T
                 (MULTPFSQ (XPARTITSQ (CANCEL (CONS (CDAR X) Y)))
                           (CONS (LIST (CONS (CAAR X) 1)) 1))))
               (XPARTITSQ (CONS (CDR X) Y))))))
     (CAR U) (CDR U))) 
(PUT 'XPARTITK 'NUMBER-OF-ARGS 1) 
(PUT 'XPARTITK 'DEFINED-ON-LINE '127) 
(PUT 'XPARTITK 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'XPARTITK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE XPARTITK (K)
    (COND
     ((MEMQCAR K '(WEDGE PARTDF))
      ((LAMBDA (J)
         (COND ((EQUAL J K) (CONS (CONS K (CONS 1 1)) NIL)) (T (XPARTITOP J))))
       (REVAL1 K T)))
     (T (CONS (CONS K (CONS 1 1)) NIL)))) 
(PUT 'XPARTITOP 'NUMBER-OF-ARGS 1) 
(PUT 'XPARTITOP 'DEFINED-ON-LINE '136) 
(PUT 'XPARTITOP 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'XPARTITOP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE XPARTITOP (U) (XPARTITSQ (SIMP* U))) 
(PUT 'XEXPTPF 'NUMBER-OF-ARGS 2) 
(PUT 'XEXPTPF 'DEFINED-ON-LINE '140) 
(PUT 'XEXPTPF 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'XEXPTPF 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE XEXPTPF (U N)
    (COND ((EQUAL N 1) U) (T (WEDGEPF U (XEXPTPF U (DIFFERENCE N 1)))))) 
(PUT 'XVARP 'NUMBER-OF-ARGS 1) 
(PUT 'XVARP 'DEFINED-ON-LINE '146) 
(PUT 'XVARP 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'XVARP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE XVARP (U)
    (COND ((NEQ XVARS* T) (OR (NEQ (XDEGREE U) 0) (MEMQ U XVARS*)))
          ((ATOM U) (GET U 'FDEGREE))
          ((FLAGP (CAR U) 'INDEXVAR)
           (ASSOC (LENGTH (CDR U)) (GET (CAR U) 'IFDEGREE)))
          (T (MEMQ (CAR U) '(WEDGE D PARTDF HODGE INNERPROD LIEDF))))) 
(FLAG '(EXCOEFFS) 'OPFN) 
(PUT 'EXCOEFFS 'NUMBER-OF-ARGS 1) 
(PUT 'EXCOEFFS 'DEFINED-ON-LINE '166) 
(PUT 'EXCOEFFS 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'EXCOEFFS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE EXCOEFFS (U)
    (PROG (X)
      (SETQ U (CONS 1 (XPARTITOP U)))
      (PROG ()
       WHILELABEL
        (COND ((NOT (SETQ U (CDR U))) (RETURN NIL)))
        (SETQ X (CONS (MK*SQ (CDAR U)) X))
        (GO WHILELABEL))
      (RETURN (CONS 'LIST (REVERSE X))))) 
(FLAG '(EXVARS) 'OPFN) 
(PUT 'EXVARS 'NUMBER-OF-ARGS 1) 
(PUT 'EXVARS 'DEFINED-ON-LINE '176) 
(PUT 'EXVARS 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'EXVARS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE EXVARS (U)
    (PROG (X)
      (SETQ U (CONS 1 (XPARTITOP U)))
      (PROG ()
       WHILELABEL
        (COND ((NOT (SETQ U (CDR U))) (RETURN NIL)))
        (SETQ X (CONS (CAAR U) X))
        (GO WHILELABEL))
      (RETURN (CONS 'LIST (REVERSE X))))) 
(PUT 'XDEGREE 'NUMBER-OF-ARGS 1) 
(PUT 'XDEGREE 'DEFINED-ON-LINE '188) 
(PUT 'XDEGREE 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'XDEGREE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE XDEGREE (F) ((LAMBDA (X) (COND ((NULL X) 0) (T X))) (DEG*FORM F))) 
(PUT 'XHOMOGENEOUS 'NUMBER-OF-ARGS 1) 
(PUT 'XHOMOGENEOUS 'DEFINED-ON-LINE '197) 
(PUT 'XHOMOGENEOUS 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'XHOMOGENEOUS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE XHOMOGENEOUS (F)
    (COND ((NULL F) 0) ((NULL (CDR F)) (XDEGREE (CAAR F)))
          (T
           ((LAMBDA (D) (COND ((EQUAL D (XHOMOGENEOUS (CDR F))) D)))
            (XDEGREE (CAAR F)))))) 
(PUT 'XMAXDEGREE 'NUMBER-OF-ARGS 1) 
(PUT 'XMAXDEGREE 'DEFINED-ON-LINE '205) 
(PUT 'XMAXDEGREE 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'XMAXDEGREE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE XMAXDEGREE (F)
    (COND ((NULL F) 0) (T (MAX (XDEGREE (CAAR F)) (XMAXDEGREE (CDR F)))))) 
(PUT 'XNORMALISE 'NUMBER-OF-ARGS 1) 
(PUT 'XNORMALISE 'DEFINED-ON-LINE '212) 
(PUT 'XNORMALISE 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'XNORMALISE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE XNORMALISE (F)
    (COND ((NULL F) NIL) ((EQUAL (CDAR F) (CONS 1 1)) F)
          (T (MULTPFSQ F (INVSQ (CDAR F)))))) 
(PUT 'SUBS2PF 'NUMBER-OF-ARGS 1) 
(PUT 'SUBS2PF 'DEFINED-ON-LINE '220) 
(PUT 'SUBS2PF 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'SUBS2PF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SUBS2PF (F)
    (COND
     (F
      ((LAMBDA (C)
         (COND ((CAR C) (CONS (CONS (CAAR F) C) (CDR F)))
               (T (SUBS2PF (CDR F)))))
       (SUBS2 (RESIMP (CDAR F))))))) 
(PUT 'SUBS2PF* 'NUMBER-OF-ARGS 1) 
(PUT 'SUBS2PF* 'DEFINED-ON-LINE '228) 
(PUT 'SUBS2PF* 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'SUBS2PF* 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SUBS2PF* (F)
    (COND
     (F
      ((LAMBDA (C)
         (COND ((CAR C) (CONS (CONS (CAAR F) C) (SUBS2PF* (CDR F))))
               (T (SUBS2PF* (CDR F)))))
       (SUBS2 (RESIMP (CDAR F))))))) 
(PUT '*PF2A 'NUMBER-OF-ARGS 1) 
(PUT '*PF2A 'DEFINED-ON-LINE '239) 
(PUT '*PF2A 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT '*PF2A 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE *PF2A (F) (MK*SQ (*PF2SQ (REPARTIT F)))) 
(PUT '*PF2A1 'NUMBER-OF-ARGS 2) 
(PUT '*PF2A1 'DEFINED-ON-LINE '245) 
(PUT '*PF2A1 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT '*PF2A1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE *PF2A1 (F V) (*Q2A1 (*PF2SQ (REPARTIT F)) V)) 
(PUT 'PREPPF 'NUMBER-OF-ARGS 1) 
(PUT 'PREPPF 'DEFINED-ON-LINE '252) 
(PUT 'PREPPF 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'PREPPF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PREPPF (F)
    (COND ((NULL (SETQ F (PREPPF0 F))) 0) ((EQUAL (LENGTH F) 1) (CAR F))
          (T (CONS 'PLUS F)))) 
(PUT 'PREPPF0 'NUMBER-OF-ARGS 1) 
(PUT 'PREPPF0 'DEFINED-ON-LINE '260) 
(PUT 'PREPPF0 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'PREPPF0 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PREPPF0 (F)
    (COND ((NULL F) NIL)
          (T (CONS (PREPPF1 (CAAR F) (PREPSQ* (CDAR F))) (PREPPF0 (CDR F)))))) 
(PUT 'PREPPF1 'NUMBER-OF-ARGS 2) 
(PUT 'PREPPF1 'DEFINED-ON-LINE '268) 
(PUT 'PREPPF1 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'PREPPF1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE PREPPF1 (K C)
    (COND ((EQUAL K 1) C) ((EQUAL C 1) K)
          ((EQCAR C 'MINUS) (LIST 'MINUS (PREPPF1 K (CADR C))))
          ((EQCAR C 'TIMES) (APPEND C (LIST K)))
          ((AND (EQCAR C 'QUOTIENT) (EQCAR (CADR C) 'MINUS))
           (PREPPF1 K
            (LIST 'MINUS (LIST 'QUOTIENT (CADR (CADR C)) (CADDR C)))))
          (T (LIST 'TIMES C K)))) 
(PUT 'PRINTPF 'NUMBER-OF-ARGS 1) 
(PUT 'PRINTPF 'DEFINED-ON-LINE '280) 
(PUT 'PRINTPF 'DEFINED-IN-FILE 'XIDEAL/XAUX.RED) 
(PUT 'PRINTPF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PRINTPF (F) (MATHPRINT (PREPPF F))) 
(ENDMODULE) 