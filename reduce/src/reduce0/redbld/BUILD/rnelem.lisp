(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'RNELEM)) 
(FLUID '(*ROUNDED)) 
(DEFLIST
 '((FIX RNFIX*) (ROUND RNROUND*) (CEILING RNCEILING*) (FLOOR RNFLOOR*)
   (FACTORIAL RNFACTORIAL*) (PERM RNPERM*) (CHOOSE RNCHOOSE*))
 '|:RN:|) 
(PROG (C)
  (SETQ C '(FIX ROUND CEILING FLOOR FACTORIAL PERM CHOOSE))
 LAB
  (COND ((NULL C) (RETURN NIL)))
  ((LAMBDA (C) (PUT C 'SIMPFN 'SIMPIDEN)) (CAR C))
  (SETQ C (CDR C))
  (GO LAB)) 
(FLAG '(FIX FLOOR CEILING ROUND ISQRT ICBRT IROOTN ILOG2 FACTORIAL PERM CHOOSE)
      'INTEGER) 
(DEFLIST '((PERM 2) (CHOOSE 2)) 'NUMBER-OF-ARGS) 
(PUT 'RNFIX* 'NUMBER-OF-ARGS 1) 
(PUT 'RNFIX* 'DEFINED-ON-LINE '46) 
(PUT 'RNFIX* 'DEFINED-IN-FILE 'POLY/RNELEM.RED) 
(PUT 'RNFIX* 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE RNFIX* (X) (QUOTIENT (CADR X) (CDDR X))) 
(PUT 'RNFIXCHK 'NUMBER-OF-ARGS 1) 
(PUT 'RNFIXCHK 'DEFINED-ON-LINE '48) 
(PUT 'RNFIXCHK 'DEFINED-IN-FILE 'POLY/RNELEM.RED) 
(PUT 'RNFIXCHK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE RNFIXCHK (X)
    ((LAMBDA (Y)
       (COND ((EQUAL (CDR Y) 0) (CAR Y))
             (T (ERROR 0 (LIST (PREPF X) "is not an integer equivalent")))))
     (DIVIDE (CADR X) (CDDR X)))) 
(PUT 'RNFLOOR* 'NUMBER-OF-ARGS 1) 
(PUT 'RNFLOOR* 'DEFINED-ON-LINE '55) 
(PUT 'RNFLOOR* 'DEFINED-IN-FILE 'POLY/RNELEM.RED) 
(PUT 'RNFLOOR* 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE RNFLOOR* (X)
    (COND
     ((LESSP (CDR (SETQ X (DIVIDE (CADR X) (CDDR X)))) 0)
      (DIFFERENCE (CAR X) 1))
     (T (CAR X)))) 
(PUT 'RNCEILING* 'NUMBER-OF-ARGS 1) 
(PUT 'RNCEILING* 'DEFINED-ON-LINE '58) 
(PUT 'RNCEILING* 'DEFINED-IN-FILE 'POLY/RNELEM.RED) 
(PUT 'RNCEILING* 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE RNCEILING* (X)
    (COND
     ((GREATERP (CDR (SETQ X (DIVIDE (CADR X) (CDDR X)))) 0) (PLUS (CAR X) 1))
     (T (CAR X)))) 
(PUT 'RNROUND* 'NUMBER-OF-ARGS 1) 
(PUT 'RNROUND* 'DEFINED-ON-LINE '61) 
(PUT 'RNROUND* 'DEFINED-IN-FILE 'POLY/RNELEM.RED) 
(PUT 'RNROUND* 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE RNROUND* (X)
    ((LAMBDA (Y)
       (COND ((EQUAL (CADR (|RNDIFFERENCE:| X (*I2RN Y))) 0) Y)
             ((|RNMINUSP:| X)
              (MINUS
               (RNROUND* (CONS '|:RN:| (CONS (MINUS (CADR X)) (CDDR X))))))
             (T (RNFLOOR* (|RNPLUS:| X (CONS '|:RN:| (CONS 1 2)))))))
     (RNFIX* X))) 
(PUT 'RNILOG2* 'NUMBER-OF-ARGS 1) 
(PUT 'RNILOG2* 'DEFINED-ON-LINE '68) 
(PUT 'RNILOG2* 'DEFINED-IN-FILE 'POLY/RNELEM.RED) 
(PUT 'RNILOG2* 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE RNILOG2* (X) (ILOG2 (RNFIX* X))) 
(PUT 'RNFACTORIAL* 'NUMBER-OF-ARGS 1) 
(PUT 'RNFACTORIAL* 'DEFINED-ON-LINE '70) 
(PUT 'RNFACTORIAL* 'DEFINED-IN-FILE 'POLY/RNELEM.RED) 
(PUT 'RNFACTORIAL* 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE RNFACTORIAL* (X)
    ((LAMBDA (Y)
       (COND ((AND (FIXP Y) (NOT (LESSP Y 0))) (NFACTORIAL Y))
             (T (LIST (CONS (GETPOWER (FKERN (LIST 'FACTORIAL Y)) 1) 1)))))
     (RNFIXCHK X))) 
(PUT 'RNPERM* 'NUMBER-OF-ARGS 2) 
(PUT 'RNPERM* 'DEFINED-ON-LINE '75) 
(PUT 'RNPERM* 'DEFINED-IN-FILE 'POLY/RNELEM.RED) 
(PUT 'RNPERM* 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE RNPERM* (X N) (PERM (RNFIXCHK X) (RNFIXCHK N))) 
(PUT 'PERM 'NUMBER-OF-ARGS 2) 
(PUT 'PERM 'DEFINED-ON-LINE '77) 
(PUT 'PERM 'DEFINED-IN-FILE 'POLY/RNELEM.RED) 
(PUT 'PERM 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE PERM (X N)
    (COND
     ((OR (NOT (FIXP X)) (NOT (FIXP N)) (LESSP X 0) (GREATERP X N))
      (TERRLST (LIST X N) 'PERM))
     (T
      (PROG (J FORALL-RESULT)
        (SETQ J (PLUS (DIFFERENCE N X) 1))
        (SETQ FORALL-RESULT 1)
       LAB1
        (COND ((MINUSP (DIFFERENCE N J)) (RETURN FORALL-RESULT)))
        (SETQ FORALL-RESULT (TIMES J FORALL-RESULT))
        (SETQ J (PLUS2 J 1))
        (GO LAB1))))) 
(PUT 'RNCHOOSE* 'NUMBER-OF-ARGS 2) 
(PUT 'RNCHOOSE* 'DEFINED-ON-LINE '81) 
(PUT 'RNCHOOSE* 'DEFINED-IN-FILE 'POLY/RNELEM.RED) 
(PUT 'RNCHOOSE* 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE RNCHOOSE* (X N) (CHOOSE (RNFIXCHK X) (RNFIXCHK N))) 
(PUT 'CHOOSE 'NUMBER-OF-ARGS 2) 
(PUT 'CHOOSE 'DEFINED-ON-LINE '83) 
(PUT 'CHOOSE 'DEFINED-IN-FILE 'POLY/RNELEM.RED) 
(PUT 'CHOOSE 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CHOOSE (X N) (QUOTIENT (PERM X N) (FACTORIAL X))) 
(PUT 'SIMPRN 'NUMBER-OF-ARGS 1) 
(PUT 'SIMPRN 'DEFINED-ON-LINE '85) 
(PUT 'SIMPRN 'DEFINED-IN-FILE 'POLY/RNELEM.RED) 
(PUT 'SIMPRN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SIMPRN (X)
    (PROG (*ROUNDED DMODE*)
      (SETQ DMODE* '|:RN:|)
      (RETURN
       (PROG (A FORALL-RESULT FORALL-ENDPTR)
         (SETQ A (SIMPLIST X))
         (COND ((NULL A) (RETURN NIL)))
         (SETQ FORALL-RESULT
                 (SETQ FORALL-ENDPTR
                         (CONS
                          ((LAMBDA (A) (COND ((ATOM A) (*I2RN A)) (T A)))
                           (CAR A))
                          NIL)))
        LOOPLABEL
         (SETQ A (CDR A))
         (COND ((NULL A) (RETURN FORALL-RESULT)))
         (RPLACD FORALL-ENDPTR
                 (CONS ((LAMBDA (A) (COND ((ATOM A) (*I2RN A)) (T A))) (CAR A))
                       NIL))
         (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
         (GO LOOPLABEL))))) 
(PUT 'RNIROOTN* 'NUMBER-OF-ARGS 2) 
(PUT 'RNIROOTN* 'DEFINED-ON-LINE '94) 
(PUT 'RNIROOTN* 'DEFINED-IN-FILE 'POLY/RNELEM.RED) 
(PUT 'RNIROOTN* 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE RNIROOTN* (X N) (IROOTN (RNFIX* X) (RNFIXCHK N))) 
(ENDMODULE) 