(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'DVFSFSISM)) 
(REVISION 'DVFSFSISM
          "$Id: dvfsfsism.red 5986 2021-08-28 13:35:27Z thomas-sturm $") 
(COPYRIGHT 'DVFSFSISM "(c) 1995-2009 A. Dolzmann, T. Sturm") 
(PUT 'DVFSF_SUSIRMKNOWL 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_SUSIRMKNOWL 'DEFINED-ON-LINE '36) 
(PUT 'DVFSF_SUSIRMKNOWL 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSISM.RED) 
(PUT 'DVFSF_SUSIRMKNOWL 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SUSIRMKNOWL (KNOWL V)
    (PROG (P FORALL-RESULT FORALL-ENDPTR)
      (SETQ P KNOWL)
     STARTOVER
      (COND ((NULL P) (RETURN NIL)))
      (SETQ FORALL-RESULT
              ((LAMBDA (P)
                 (COND ((MEMQ V (DVFSF_VARLAT (CAR P))) NIL) (T (LIST P))))
               (CAR P)))
      (SETQ FORALL-ENDPTR (LASTPAIR FORALL-RESULT))
      (SETQ P (CDR P))
      (COND ((ATOM FORALL-ENDPTR) (GO STARTOVER)))
     LOOPLABEL
      (COND ((NULL P) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR
              ((LAMBDA (P)
                 (COND ((MEMQ V (DVFSF_VARLAT (CAR P))) NIL) (T (LIST P))))
               (CAR P)))
      (SETQ FORALL-ENDPTR (LASTPAIR FORALL-ENDPTR))
      (SETQ P (CDR P))
      (GO LOOPLABEL))) 
(PUT 'DVFSF_SUSIBIN 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_SUSIBIN 'DEFINED-ON-LINE '43) 
(PUT 'DVFSF_SUSIBIN 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSISM.RED) 
(PUT 'DVFSF_SUSIBIN 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SUSIBIN (OLD NEW)
    (PROG (OOP OLHS ORHS OLEV NOP NLHS NRHS NLEV *RLSIEXPL)
      (SETQ OLEV (CDR OLD))
      (SETQ OLD (CAR OLD))
      (SETQ OOP (DVFSF_OP OLD))
      (SETQ OLHS (DVFSF_ARG2L OLD))
      (SETQ ORHS (DVFSF_ARG2R OLD))
      (SETQ NLEV (CDR NEW))
      (SETQ NEW (CAR NEW))
      (SETQ NOP (DVFSF_OP NEW))
      (SETQ NLHS (DVFSF_ARG2L NEW))
      (SETQ NRHS (DVFSF_ARG2R NEW))
      (COND
       ((AND (EQUAL OLHS NLHS) (EQUAL ORHS NRHS))
        (RETURN (DVFSF_SUSIBIN1 OOP NOP NLHS NRHS NLEV))))
      (COND
       ((AND (EQUAL OLHS NRHS) (EQUAL ORHS NLHS))
        (RETURN (DVFSF_SUSIBIN2 OOP NOP NLHS NRHS NLEV))))
      (COND
       ((AND (OR (EQ OOP 'EQUAL) (EQ OOP 'NEQ)) (NEQ NOP 'EQUAL) (NEQ NOP 'NEQ)
             (DVFSF_SUSIBIN-EQLHSMATCH NLHS NRHS OLHS))
        (RETURN (DVFSF_SUSIBIN1 OOP NOP NLHS NRHS NLEV))))
      (COND
       ((AND (OR (EQ NOP 'EQUAL) (EQ NOP 'NEQ)) (NEQ OOP 'EQUAL) (NEQ OOP 'NEQ)
             (DVFSF_SUSIBIN-EQLHSMATCH OLHS ORHS NLHS))
        (RETURN (DVFSF_SUSIBIN1 OOP NOP OLHS ORHS NLEV))))
      (RETURN NIL))) 
(PUT 'DVFSF_SUSIBIN-EQLHSMATCH 'NUMBER-OF-ARGS 3) 
(PUT 'DVFSF_SUSIBIN-EQLHSMATCH 'DEFINED-ON-LINE '75) 
(PUT 'DVFSF_SUSIBIN-EQLHSMATCH 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSISM.RED) 
(PUT 'DVFSF_SUSIBIN-EQLHSMATCH 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SUSIBIN-EQLHSMATCH (LHS RHS EQLHS)
    (PROG (W)
      (SETQ W (DVFSF_SIMPLAT1 (DVFSF_0MK2 'EQUAL (ADDF LHS (NEGF RHS))) NIL))
      (COND
       ((NOT (OR (EQ W 'TRUE) (EQ W 'FALSE)))
        (RETURN (EQUAL (DVFSF_ARG2L W) EQLHS))))
      (RETURN NIL))) 
(PUT 'DVFSF_SUSIBIN1 'NUMBER-OF-ARGS 5) 
(PUT 'DVFSF_SUSIBIN1 'DEFINED-ON-LINE '86) 
(PUT 'DVFSF_SUSIBIN1 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSISM.RED) 
(PUT 'DVFSF_SUSIBIN1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SUSIBIN1 (ROLD RNEW LHS RHS NLEV)
    (COND ((EQ ROLD RNEW) '((DELETE . T)))
          ((EQ ROLD 'NEQ)
           (COND ((EQ RNEW 'EQUAL) 'FALSE)
                 ((OR (EQ RNEW 'SDIV) (EQ RNEW 'NASSOC)) '((DELETE))) (T NIL)))
          ((EQ ROLD 'SDIV)
           (COND
            ((OR (EQ RNEW 'NEQ) (EQ RNEW 'DIV) (EQ RNEW 'NASSOC))
             '((DELETE . T)))
            (T 'FALSE)))
          ((EQ ROLD 'DIV)
           (COND
            ((OR (EQ RNEW 'SDIV) (EQ RNEW 'ASSOC) (EQ RNEW 'EQUAL))
             '((DELETE)))
            ((EQ RNEW 'NASSOC)
             (LIST '(DELETE) '(DELETE . T)
                   (CONS 'ADD (CONS (DVFSF_MK2 'SDIV LHS RHS) NLEV))))
            (T NIL)))
          ((EQ ROLD 'ASSOC)
           (COND ((OR (EQ RNEW 'SDIV) (EQ RNEW 'NASSOC)) 'FALSE)
                 ((EQ RNEW 'DIV) '((DELETE . T)))
                 ((EQ RNEW 'EQUAL) '((DELETE))) (T NIL)))
          ((EQ ROLD 'EQUAL)
           (COND ((OR (EQ RNEW 'NEQ) (EQ RNEW 'SDIV) (EQ RNEW 'NASSOC)) 'FALSE)
                 (T '((DELETE . T)))))
          ((EQ ROLD 'NASSOC)
           (COND ((EQ RNEW 'SDIV) '((DELETE)))
                 ((OR (EQ RNEW 'ASSOC) (EQ RNEW 'EQUAL)) 'FALSE)
                 ((EQ RNEW 'DIV)
                  (LIST '(DELETE) '(DELETE . T)
                        (CONS 'ADD (CONS (DVFSF_MK2 'SDIV LHS RHS) NLEV))))
                 (T '((DELETE . T)))))
          (T (REDERR (LIST "BUG IN dvfsf_susibin1(" ROLD "," RNEW ")"))))) 
(PUT 'DVFSF_SUSIBIN2 'NUMBER-OF-ARGS 5) 
(PUT 'DVFSF_SUSIBIN2 'DEFINED-ON-LINE '136) 
(PUT 'DVFSF_SUSIBIN2 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSISM.RED) 
(PUT 'DVFSF_SUSIBIN2 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SUSIBIN2 (ROLD RNEW NLHS NRHS NLEV)
    (COND
     ((EQ ROLD 'DIV)
      (COND ((EQ RNEW 'SDIV) 'FALSE)
            ((EQ RNEW 'DIV)
             (LIST '(DELETE) '(DELETE . T)
                   (CONS 'ADD
                         (CONS
                          (DVFSF_SIMPLAT1 (DVFSF_MK2 'ASSOC NLHS NRHS) NIL)
                          NLEV))))
            ((EQ RNEW 'ASSOC) '((DELETE)))
            ((EQ RNEW 'NASSOC)
             (LIST '(DELETE) '(DELETE . T)
                   (CONS 'ADD (CONS (DVFSF_MK2 'SDIV NRHS NLHS) NLEV))))
            (T NIL)))
     ((EQ ROLD 'SDIV)
      (COND ((OR (EQ RNEW 'DIV) (EQ RNEW 'SDIV) (EQ RNEW 'ASSOC)) 'FALSE)
            ((EQ RNEW 'NASSOC) '((DELETE . T))) (T NIL)))
     ((EQ ROLD 'NASSOC)
      (COND ((EQ RNEW 'SDIV) '((DELETE)))
            ((EQ RNEW 'DIV)
             (LIST '(DELETE) '(DELETE . T)
                   (CONS 'ADD (CONS (DVFSF_MK2 'SDIV NLHS NRHS) NLEV))))
            (T NIL)))
     ((EQ ROLD 'ASSOC)
      (COND ((EQ RNEW 'SDIV) 'FALSE) ((EQ RNEW 'DIV) '((DELETE . T))) (T NIL)))
     (T NIL))) 
(DE DVFSF_SUSIPOST (ATL KNOWL) ATL) 
(PUT 'DVFSF_SUSIPOST 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_SUSIPOST 'DEFINED-ON-LINE '178) 
(PUT 'DVFSF_SUSIPOST 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSISM.RED) 
(PUT 'DVFSF_SUSIPOST 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(PUTC 'DVFSF_SUSIPOST 'INLINE '(LAMBDA (ATL KNOWL) ATL)) 
(DE DVFSF_SUSITF (AT KNOWL) AT) 
(PUT 'DVFSF_SUSITF 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_SUSITF 'DEFINED-ON-LINE '186) 
(PUT 'DVFSF_SUSITF 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSISM.RED) 
(PUT 'DVFSF_SUSITF 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(PUTC 'DVFSF_SUSITF 'INLINE '(LAMBDA (AT KNOWL) AT)) 
(ENDMODULE) 