(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'VECT)) 
(EXPORTS
 (LIST 'MKUNIQUEVECT 'MKVEC 'MKVECF2Q 'MKIDENM 'COPYVEC 'VECSORT 'SWAP
       'NON-NULL-VEC 'MKVECT2)) 
(PUT 'MKUNIQUEVECT 'NUMBER-OF-ARGS 1) 
(PUT 'MKUNIQUEVECT 'DEFINED-ON-LINE '34) 
(PUT 'MKUNIQUEVECT 'DEFINED-IN-FILE 'INT/VECT.RED) 
(PUT 'MKUNIQUEVECT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MKUNIQUEVECT (V)
    (PROG (U N)
      (SETQ N (UPBV V))
      (PROG (I)
        (SETQ I 0)
       LAB
        (COND ((MINUSP (DIFFERENCE N I)) (RETURN NIL)))
        (PROG (UU)
          (SETQ UU (GETV V I))
          (COND ((NOT (MEMBER UU U)) (SETQ U (CONS UU U)))))
        (SETQ I (PLUS2 I 1))
        (GO LAB))
      (RETURN (MKVEC U)))) 
(PUT 'MKVEC 'NUMBER-OF-ARGS 1) 
(PUT 'MKVEC 'DEFINED-ON-LINE '46) 
(PUT 'MKVEC 'DEFINED-IN-FILE 'INT/VECT.RED) 
(PUT 'MKVEC 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MKVEC (L)
    (PROG (V I)
      (SETQ V (MKVECT (ISUB1 (LENGTH L))))
      (SETQ I 0)
      (PROG ()
       WHILELABEL
        (COND ((NOT L) (RETURN NIL)))
        (PROGN (PUTV V I (CAR L)) (SETQ I (IADD1 I)) (SETQ L (CDR L)))
        (GO WHILELABEL))
      (RETURN V))) 
(PUT 'MKVECF2Q 'NUMBER-OF-ARGS 1) 
(PUT 'MKVECF2Q 'DEFINED-ON-LINE '54) 
(PUT 'MKVECF2Q 'DEFINED-IN-FILE 'INT/VECT.RED) 
(PUT 'MKVECF2Q 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MKVECF2Q (L)
    (PROG (V I LL)
      (SETQ V (MKVECT (ISUB1 (LENGTH L))))
      (SETQ I 0)
      (PROG ()
       WHILELABEL
        (COND ((NOT L) (RETURN NIL)))
        (PROGN
         (SETQ LL (CAR L))
         (COND ((EQUAL LL 0) (SETQ LL NIL)))
         (PUTV V I (CONS LL 1))
         (SETQ I (IADD1 I))
         (SETQ L (CDR L)))
        (GO WHILELABEL))
      (RETURN V))) 
(PUT 'MKIDENM 'NUMBER-OF-ARGS 1) 
(PUT 'MKIDENM 'DEFINED-ON-LINE '68) 
(PUT 'MKIDENM 'DEFINED-IN-FILE 'INT/VECT.RED) 
(PUT 'MKIDENM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MKIDENM (N)
    (PROG (ANS U C0 C1)
      (SETQ C0 (CONS NIL 1))
      (SETQ C1 (CONS 1 1))
      (SETQ ANS (MKVECT N))
      (PROG (I)
        (SETQ I 0)
       LAB
        (COND ((MINUSP (DIFFERENCE N I)) (RETURN NIL)))
        (PROGN
         (SETQ U (MKVECT N))
         (PROG (J)
           (SETQ J 0)
          LAB
           (COND ((MINUSP (DIFFERENCE N J)) (RETURN NIL)))
           (COND ((IEQUAL I J) (PUTV U J C1)) (T (PUTV U J C0)))
           (SETQ J (PLUS2 J 1))
           (GO LAB))
         (PUTV ANS I U))
        (SETQ I (PLUS2 I 1))
        (GO LAB))
      (RETURN ANS))) 
(PUT 'COPYVEC 'NUMBER-OF-ARGS 2) 
(PUT 'COPYVEC 'DEFINED-ON-LINE '86) 
(PUT 'COPYVEC 'DEFINED-IN-FILE 'INT/VECT.RED) 
(PUT 'COPYVEC 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE COPYVEC (V N)
    (PROG (NEW)
      (SETQ NEW (MKVECT N))
      (PROG (I)
        (SETQ I 0)
       LAB
        (COND ((MINUSP (DIFFERENCE N I)) (RETURN NIL)))
        (PUTV NEW I (GETV V I))
        (SETQ I (PLUS2 I 1))
        (GO LAB))
      (RETURN NEW))) 
(PUT 'VECSORT 'NUMBER-OF-ARGS 2) 
(PUT 'VECSORT 'DEFINED-ON-LINE '93) 
(PUT 'VECSORT 'DEFINED-IN-FILE 'INT/VECT.RED) 
(PUT 'VECSORT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VECSORT (U L)
    (PROG (J K N V W)
      (SETQ N (UPBV U))
      (PROG (I)
        (SETQ I 1)
       LAB
        (COND ((MINUSP (DIFFERENCE N I)) (RETURN NIL)))
        (PROG ()
          (SETQ V (GETV U I))
          (SETQ K I)
         LOOP
          (SETQ J K)
          (SETQ K (ISUB1 K))
          (SETQ W (GETV U K))
          (COND ((LEQ V W) (GO ORDERED)))
          (PUTV U K V)
          (PUTV U J W)
          (MAPC L (FUNCTION (LAMBDA (U) (SWAP U J K))))
          (COND ((GREATERP K 0) (GO LOOP)))
         ORDERED)
        (SETQ I (PLUS2 I 1))
        (GO LAB))
      (RETURN NIL))) 
(PUT 'SWAP 'NUMBER-OF-ARGS 3) 
(PUT 'SWAP 'DEFINED-ON-LINE '119) 
(PUT 'SWAP 'DEFINED-IN-FILE 'INT/VECT.RED) 
(PUT 'SWAP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE SWAP (U J K)
    (COND ((NULL U) NIL)
          (T
           (PROG (V) (SETQ V (GETV U J)) (PUTV U J (GETV U K)) (PUTV U K V))))) 
(PUT 'NON-NULL-VEC 'NUMBER-OF-ARGS 1) 
(PUT 'NON-NULL-VEC 'DEFINED-ON-LINE '130) 
(PUT 'NON-NULL-VEC 'DEFINED-IN-FILE 'INT/VECT.RED) 
(PUT 'NON-NULL-VEC 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE NON-NULL-VEC (V)
    (PROG (CNT)
      (SETQ CNT 0)
      (PROG (I)
        (SETQ I 0)
       LAB
        (COND ((MINUSP (DIFFERENCE (UPBV V) I)) (RETURN NIL)))
        (COND ((GETV V I) (SETQ CNT (IADD1 CNT))))
        (SETQ I (PLUS2 I 1))
        (GO LAB))
      (RETURN CNT))) 
(PUT 'MKVECT2 'NUMBER-OF-ARGS 2) 
(PUT 'MKVECT2 'DEFINED-ON-LINE '140) 
(PUT 'MKVECT2 'DEFINED-IN-FILE 'INT/VECT.RED) 
(PUT 'MKVECT2 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MKVECT2 (N INITIAL)
    (PROG (U)
      (SETQ U (MKVECT N))
      (PROG (I)
        (SETQ I 0)
       LAB
        (COND ((MINUSP (DIFFERENCE N I)) (RETURN NIL)))
        (PUTV U I INITIAL)
        (SETQ I (PLUS2 I 1))
        (GO LAB))
      (RETURN U))) 
(ENDMODULE) 