(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'SUPERV)) 
(FLUID
 '(*DEBUG *DEFN *DEMO *ECHO *ERRCONT *INT *LISP_HOOK *MODE *OUTPUT *PRET
   *REDUCE4 *SLIN *TIME *RLISP88 IFL* CURLINE* DFPRINT* PEEKCHAR* ERRMSG*
   LISPSYSTEM* LOOPDELIMSLIST* LREADFN* NEWRULE* SEMIC* TSLIN*
   *LIBREDUCE_ACTIVE)) 
(GLOBAL
 '($EOF$ *BYEFLAG* *EXTRAECHO *LESSSPACE *MICRO-VERSION *NOSAVE* *STRIND
   *STRUCT CLOC* CMSG* CRBUF* CRBUFLIS* CRBUF1* CURSYM* CURESCAPED* EOF* ERFG*
   FORKEYWORDS* IPL* INITL* INPUTBUFLIS* KEY* OFL* OPL* OGCTIME* OTIME*
   OGCTIME1* OTIME1* OGCTIME2* OTIME2* OGCTIME3* OTIME3* PROGRAM* PROGRAML*
   PROMPTEXP* REPEATKEYWORDS* RESULTBUFLIS* ST* STATCOUNTER SYMCHAR* TOK*
   TTYPE* WHILEKEYWORDS* WS)) 
(SETQ *OUTPUT T) 
(PUT 'OUTPUT 'SWITCHDEFAULT T) 
(SETQ EOF* 0) 
(SETQ INITL* '(FNAME* OUTL*)) 
(SETQ STATCOUNTER 0) 
(PUT 'ERRORP 'NUMBER-OF-ARGS 1) 
(PUT 'ERRORP 'DEFINED-ON-LINE '117) 
(PUT 'ERRORP 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'ERRORP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ERRORP (U) (OR (ATOM U) (CDR U))) 
(PUT 'PRINTPROMPT 'NUMBER-OF-ARGS 1) 
(PUT 'PRINTPROMPT 'DEFINED-ON-LINE '121) 
(PUT 'PRINTPROMPT 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'PRINTPROMPT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PRINTPROMPT (U)
    (PROGN (AND OFL* (WRS NIL)) (PRIN2 U) (AND OFL* (WRS (CDR OFL*))))) 
(PUT 'SETCLOC* 'NUMBER-OF-ARGS 0) 
(PUT 'SETCLOC* 'DEFINED-ON-LINE '125) 
(PUT 'SETCLOC* 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'SETCLOC* 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE SETCLOC* NIL
    (SETQ CLOC*
            (COND ((NULL IFL*) NIL) (T (CONS (CAR IFL*) (CONS 1 CURLINE*)))))) 
(PUT 'COMMDEMO 'NUMBER-OF-ARGS 0) 
(PUT 'COMMDEMO 'DEFINED-ON-LINE '133) 
(PUT 'COMMDEMO 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'COMMDEMO 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE COMMDEMO NIL
    (PROG (ECHO X Y Z *DEMO)
      (SETQ ECHO *ECHO)
      (SETQ *ECHO NIL)
      (SETQ X IFL*)
      (TERPRI)
      (RDS NIL)
      (SETQ Y (READCH))
      (COND
       ((NULL (SEPRP Y))
        (PROG (CRBUF CRBUF1 CRCHAR IFL)
          (SETQ CRBUF CRBUF*)
          (SETQ CRBUF* NIL)
          (SETQ CRBUF1 CRBUF1*)
          (SETQ CRBUF1* (LIST Y))
          (SETQ CRCHAR CRCHAR*)
          (SETQ CRCHAR* BLANK)
          (SETQ IFL IFL*)
          (SETQ IFL* NIL)
          (SETQ Z (ERRORSET* '(COMMAND) T))
          (SETQ Z (COND ((ERRORP Z) '(ALGEBRAIC (AEVAL 0))) (T (CAR Z))))
          (PROG ()
           WHILELABEL
            (COND
             ((NOT (SETQ Y (AND (NEQ (READCH) $EOL$) (NEQ Y $EOF$))))
              (RETURN NIL)))
           NIL
            (GO WHILELABEL))
          (RDS (CADR X))
          (SETQ CRBUF* CRBUF)
          (SETQ CRBUF1* CRBUF1)
          (SETQ CRCHAR* CRCHAR)
          (SETQ IFL* IFL)
          (SETQ *ECHO ECHO)))
       (T (PROGN (RDS (CADR X)) (SETQ *ECHO ECHO) (SETQ Z (COMMAND)))))
      (RETURN Z))) 
(PUT 'COMMAND1 'NUMBER-OF-ARGS 0) 
(PUT 'COMMAND1 'DEFINED-ON-LINE '171) 
(PUT 'COMMAND1 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'COMMAND1 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE COMMAND1 NIL
    (PROG () (SCAN) (SETCLOC*) (SETQ KEY* CURSYM*) (RETURN (XREAD1 NIL)))) 
(PUT 'COMMAND 'NUMBER-OF-ARGS 0) 
(PUT 'COMMAND 'DEFINED-ON-LINE '180) 
(PUT 'COMMAND 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'COMMAND 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE COMMAND NIL
    (PROG (ERRMSG* LOOPDELIMSLIST* MODE X Y)
      (COND ((AND *DEMO IFL*) (RETURN (COMMDEMO)))
            ((OR (NULL *SLIN) *REDUCE4)
             (PROGN
              (PROG ()
               WHILELABEL
                (COND
                 ((NOT (EQUAL (SETQ CRCHAR* (READCH1)) $EOL$)) (RETURN NIL)))
               NIL
                (GO WHILELABEL))
              (SETQ Y (COMMAND1))))
            (T
             (PROGN
              (SETCLOC*)
              (SETQ Y (COND (LREADFN* (LISPAPPLY LREADFN* NIL)) (T (READ)))))))
     B
      (COND (*REDUCE4 (GO C)) (*STRUCT (SETQ Y (STRUCTCHK Y))))
      (COND
       ((AND *PRET (OR (ATOM Y) (NULL (MEMQ (CAR Y) '(IN OUT SHUT)))))
        (COND ((AND (NULL Y) (EQUAL CURSYM* 'END)) (RPRINT 'END))
              (T (PROGN (RPRINT Y) (TERPRI))))))
      (COND (*SLIN (RETURN (LIST 'SYMBOLIC Y))))
      (SETQ X (FORM Y))
      (COND
       ((AND (EQUAL *MODE 'ALGEBRAIC) (NOT (ATOM X)) (EQCAR (CAR X) 'LAMBDA))
        (SETQ X (LIST 'AEVAL X))))
      (COND ((FLAGP KEY* 'MODEFN) (SETQ MODE KEY*))
            ((AND (NULL (ATOM X)) (NULL (EQUAL (CAR X) 'QUOTE))
                  (OR
                   (NULL
                    (AND (IDP (CAR X))
                         (OR (FLAGP (CAR X) 'NOCHANGE) (FLAGP (CAR X) 'INTFN)
                             (EQUAL (CAR X) 'LIST))))
                   (AND (MEMQ (CAR X) '(SETQ SETEL SETF))
                        (EQCAR (CADDR X) 'QUOTE))))
             (SETQ MODE 'SYMBOLIC))
            (T (SETQ MODE *MODE)))
      (RETURN (LIST MODE (CONVERTMODE1 X NIL 'SYMBOLIC MODE)))
     C
      (COND (*DEBUG (PROGN (PRIN2 "Parse: ") (PRETTYPRINT Y))))
      (COND
       ((EQUAL KEY* '*SEMICOL*)
        (PROGN
         (PROG ()
          WHILELABEL
           (COND ((NOT (EQUAL (SETQ CRCHAR* (READCH1)) $EOL$)) (RETURN NIL)))
          NIL
           (GO WHILELABEL))
         (SETQ Y (COMMAND1))
         (GO B))))
      (COND ((NULL *REDUCE4) (SETQ Y (FORM Y))) (T (SETQ Y (N_FORM Y))))
      (COND (*DEBUG (PROGN (TERPRI) (PRIN2 "Form: ") (PRETTYPRINT Y))))
      (RETURN Y))) 
(PUT 'UPDATE_PROMPT 'NUMBER-OF-ARGS 0) 
(PUT 'UPDATE_PROMPT 'DEFINED-ON-LINE '227) 
(PUT 'UPDATE_PROMPT 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'UPDATE_PROMPT 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE UPDATE_PROMPT NIL
    (PROG ()
      (SETQ STATCOUNTER (PLUS STATCOUNTER 1))
      (SETQ PROMPTEXP*
              (INTERN
               (LIST2STRING
                (APPEND (EXPLODE STATCOUNTER)
                        (COND
                         ((OR (NULL SYMCHAR*) (EQUAL *MODE 'ALGEBRAIC))
                          '(|:| | |))
                         (T '(* | |)))))))
      (SETPCHAR PROMPTEXP*))) 
(PUT 'BEGIN1 'NUMBER-OF-ARGS 0) 
(PUT 'BEGIN1 'DEFINED-ON-LINE '237) 
(PUT 'BEGIN1 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'BEGIN1 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE BEGIN1 NIL (BEGIN1A NIL)) 
(GLOBAL '(OTIME-SET*)) 
(SETQ OTIME-SET* NIL) 
(PUT 'PREPARE-FOR-TOP-LOOP 'NUMBER-OF-ARGS 1) 
(PUT 'PREPARE-FOR-TOP-LOOP 'DEFINED-ON-LINE '262) 
(PUT 'PREPARE-FOR-TOP-LOOP 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'PREPARE-FOR-TOP-LOOP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PREPARE-FOR-TOP-LOOP (~PREFIXCHARS~)
    (PROG ()
      (COND
       ((NOT OTIME-SET*)
        (PROGN
         (SETQ OTIME* (TIME))
         (COND ((GETD 'GCTIME) (SETQ OGCTIME* (GCTIME))) (T (SETQ OGCTIME* 0)))
         (SETQ OTIME1* (SETQ OTIME2* (SETQ OTIME3* OTIME*)))
         (SETQ OGCTIME1* (SETQ OGCTIME2* (SETQ OGCTIME3* OGCTIME*)))
         (SETQ OTIME-SET* T))))
      (SETQ PEEKCHAR* ~PREFIXCHARS~)
      (SETQ CURSYM* '*SEMICOL*)
      (SETQ CURESCAPED* NIL))) 
(FLUID '(*NAT)) 
(PUT 'PREPARE-FOR-WEB-TOP-LEVEL 'NUMBER-OF-ARGS 1) 
(PUT 'PREPARE-FOR-WEB-TOP-LEVEL 'DEFINED-ON-LINE '279) 
(PUT 'PREPARE-FOR-WEB-TOP-LEVEL 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'PREPARE-FOR-WEB-TOP-LEVEL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PREPARE-FOR-WEB-TOP-LEVEL (~PREFIXCHARS~)
    (PROG ()
      (VERBOS NIL)
      (COND
       ((NOT OTIME-SET*)
        (PROGN
         (SETQ OTIME* (TIME))
         (COND ((GETD 'GCTIME) (SETQ OGCTIME* (GCTIME))) (T (SETQ OGCTIME* 0)))
         (SETQ OTIME1* (SETQ OTIME2* (SETQ OTIME3* OTIME*)))
         (SETQ OGCTIME1* (SETQ OGCTIME2* (SETQ OGCTIME3* OGCTIME*)))
         (SETQ OTIME-SET* T))))
      (SETQ PEEKCHAR* ~PREFIXCHARS~)
      (SETQ CURSYM* '*SEMICOL*)
      (SETQ CURESCAPED* NIL)
      (SETQ *ECHO NIL)
      (SETQ *NAT NIL)
      (SETQ *MODE (PROGN (SETQ ALGLIST* (CONS NIL NIL)) 'ALGEBRAIC)))) 
(PUT 'PROCESS-ONE-REDUCE-STATEMENT 'NUMBER-OF-ARGS 0) 
(PUT 'PROCESS-ONE-REDUCE-STATEMENT 'DEFINED-ON-LINE '302) 
(PUT 'PROCESS-ONE-REDUCE-STATEMENT 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'PROCESS-ONE-REDUCE-STATEMENT 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE PROCESS-ONE-REDUCE-STATEMENT NIL
    (PROG (~PARSERR~ ~RESULT~ ~X~)
      (COND
       ((TERMINALP)
        (PROGN
         (COND ((OR *NOSAVE* (EQUAL STATCOUNTER 0)) NIL) (T (ADD2BUFLIS)))
         (UPDATE_PROMPT))))
      (SETQ *NOSAVE* NIL)
      (SETQ *STRIND 0)
      (SETQ ~PARSERR~ NIL)
      (COND (*TIME (LISPEVAL '(SHOWTIME NIL))))
      (COND
       ((AND *OUTPUT (NULL OFL*) (TERMINALP) (NULL *DEFN) (NULL *LESSSPACE))
        (TERPRI)))
      (COND
       (TSLIN*
        (PROGN
         (SETQ *SLIN (CAR TSLIN*))
         (SETQ LREADFN* (CDR TSLIN*))
         (SETQ TSLIN* NIL))))
      (SETQ ~X~ INITL*)
      (PROG ()
       WHILELABEL
        (COND ((NOT ~X~) (RETURN NIL)))
        (PROGN (SINITL (CAR ~X~)) (SETQ ~X~ (CDR ~X~)))
        (GO WHILELABEL))
      (REMFLAG FORKEYWORDS* 'DELIM)
      (REMFLAG REPEATKEYWORDS* 'DELIM)
      (REMFLAG WHILEKEYWORDS* 'DELIM)
      (COND (*INT (SETQ ERFG* NIL)))
      (COND ((EQUAL CURSYM* 'END) (PROGN (COMM1 'END) (RETURN '(NIL))))
            ((AND (TERMINALP) (NULL (EQUAL KEY* 'ED)))
             (PRINTPROMPT PROMPTEXP*)))
      (SETQ ~X~ (ERRORSET* '(COMMAND) T))
      (CONDTERPRI)
      (COND ((ERRORP ~X~) (GO ERR1)))
      (SETQ ~X~ (CAR ~X~))
      (COND
       ((AND (EQUAL (CAR ~X~) 'SYMBOLIC) (EQCAR (CADR ~X~) 'XMODULE))
        (SETQ ~RESULT~ (XMODLOOP (EVAL (CADR ~X~)))))
       (T (SETQ ~RESULT~ (BEGIN11 ~X~))))
      (COND ((NULL ~RESULT~) (RETURN NIL))
            ((EQUAL ~RESULT~ 'END) (RETURN '(NIL)))
            ((EQUAL ~RESULT~ 'ERR2) (GO ERR2))
            ((EQUAL ~RESULT~ 'ERR3) (GO ERR3)))
     C
      (COND
       (CRBUF1*
        (PROGN
         (LPRIM "Closing object improperly removed. Redo edit.")
         (SETQ CRBUF1* NIL)
         (RETURN '(NIL))))
       ((GREATERP EOF* 4)
        (PROGN (LPRIM "End-of-file read") (RETURN (LIST (LISPEVAL '(BYE))))))
       ((TERMINALP) (PROGN (SETQ CRBUF* NIL) (SETQ *NOSAVE* T) (RETURN NIL)))
       (T (RETURN '(NIL))))
     ERR1
      (COND ((OR (EOFCHECK) (GREATERP EOF* 0)) (GO C))
            ((EQUAL ~X~ "BEGIN invalid") (RETURN NIL)))
      (SETQ ~PARSERR~ T)
     ERR2
      (RESETPARSER)
     ERR3
      (SETQ ERFG* T)
      (COND
       ((AND (NULL *INT) (NULL *ERRCONT))
        (PROGN
         (SETQ *DEFN T)
         (SETQ *ECHO T)
         (COND ((NULL CMSG*) (LPRIE "Continuing with parsing only ...")))
         (SETQ CMSG* T)))
       ((NULL *ERRCONT)
        (PROGN
         (SETQ ~RESULT~ (PAUSE1 ~PARSERR~))
         (COND (~RESULT~ (RETURN (NULL (LISPEVAL ~RESULT~)))))
         (SETQ ERFG* NIL)))
       (T (SETQ ERFG* NIL)))
      (RETURN NIL))) 
(PUT 'BEGIN1A 'NUMBER-OF-ARGS 1) 
(PUT 'BEGIN1A 'DEFINED-ON-LINE '373) 
(PUT 'BEGIN1A 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'BEGIN1A 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BEGIN1A (~PREFIXCHARS~)
    (PROG (W)
      (PREPARE-FOR-TOP-LOOP ~PREFIXCHARS~)
      (PROG ()
       WHILELABEL
        (COND
         ((NOT (ATOM (SETQ W (PROCESS-ONE-REDUCE-STATEMENT)))) (RETURN NIL)))
       NIL
        (GO WHILELABEL))
      (RETURN (CAR W)))) 
(PUT 'BEGIN11 'NUMBER-OF-ARGS 1) 
(PUT 'BEGIN11 'DEFINED-ON-LINE '383) 
(PUT 'BEGIN11 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'BEGIN11 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BEGIN11 (~X~)
    (PROG (ERRMSG* ~MODE~ ~RESULT~ NEWRULE*)
      (COND
       ((EQUAL CURSYM* 'END)
        (COND
         ((AND (TERMINALP) (NULL *LISP_HOOK))
          (PROGN
           (SETQ CURSYM* '*SEMICOL*)
           (SETQ CURESCAPED* NIL)
           (SETQ *NOSAVE* T)
           (RETURN NIL)))
         (T (PROGN (COMM1 'END) (RETURN 'END)))))
       ((EQCAR (COND (*REDUCE4 ~X~) (T (CADR ~X~))) 'RETRY)
        (COND (PROGRAML* (SETQ ~X~ PROGRAML*))
              (T (PROGN (LPRIM "No previous expression") (RETURN NIL))))))
      (COND
       ((NULL *REDUCE4) (PROGN (SETQ ~MODE~ (CAR ~X~)) (SETQ ~X~ (CADR ~X~)))))
      (SETQ PROGRAM* ~X~)
      (COND ((EOFCHECK) (RETURN 'C)) (T (SETQ EOF* 0)))
      (ADD2INPUTBUF ~X~ (COND (*REDUCE4 NIL) (T ~MODE~)))
      (COND
       ((AND (NULL (ATOM ~X~)) (MEMQ (CAR ~X~) '(BYE QUIT)))
        (COND
         ((GETD 'BYE) (PROGN (LISPEVAL ~X~) (SETQ *NOSAVE* T) (RETURN NIL)))
         (T (PROGN (SETQ *BYEFLAG* T) (RETURN NIL)))))
       ((AND (NULL *REDUCE4) (EQCAR ~X~ 'ED))
        (PROGN
         (COND ((AND (GETD 'CEDIT) (TERMINALP)) (CEDIT (CDR ~X~)))
               (T (LPRIM "ED not supported")))
         (SETQ *NOSAVE* T)
         (RETURN NIL)))
       (*DEFN
        (COND (ERFG* (RETURN NIL))
              ((AND (NULL (FLAGP KEY* 'IGNORE)) (NULL (EQCAR ~X~ 'QUOTE)))
               (PROGN
                (COND (~X~ (DFPRINT ~X~)) (T NIL))
                (COND ((NULL (FLAGP KEY* 'EVAL)) (RETURN NIL))))))))
      (COND ((AND *OUTPUT IFL* *ECHO (NULL *LESSSPACE)) (TERPRI)))
      (SETQ ~RESULT~ (ERRORSET* ~X~ T))
      (COND
       ((OR (ERRORP ~RESULT~) ERFG*)
        (PROGN (SETQ PROGRAML* (LIST ~MODE~ ~X~)) (RETURN 'ERR2)))
       (*DEFN (RETURN NIL)))
      (COND
       ((NULL *REDUCE4)
        (COND ((NULL (EQUAL ~MODE~ 'SYMBOLIC)) (SETQ ~X~ (GETSETVARS ~X~)))
              (T NIL)))
       (T
        (PROGN
         (SETQ ~RESULT~ (CAR ~RESULT~))
         (COND ((NULL ~RESULT~) (SETQ ~RESULT~ (MKOBJECT NIL 'NOVAL))))
         (SETQ ~MODE~ (TYPE ~RESULT~))
         (SETQ ~RESULT~ (VALUE ~RESULT~)))))
      (ADD2RESULTBUF (COND ((NULL *REDUCE4) (CAR ~RESULT~)) (T ~RESULT~))
                     ~MODE~)
      (COND ((NULL *OUTPUT) (RETURN NIL))
            ((NULL (EQUAL SEMIC* '$))
             (COND
              (*REDUCE4
               (PROG ()
                 (TERPRI)
                 (COND ((EQUAL ~MODE~ 'NOVAL) (RETURN NIL))
                       (*DEBUG (PRIN2T "Value:")))
                 (RAPPLY1 'PRINT (LIST (LIST ~MODE~ ~RESULT~)))))
              ((EQUAL ~MODE~ 'SYMBOLIC)
               (COND
                ((AND (NULL (CAR ~RESULT~)) (NULL (EQUAL *MODE 'SYMBOLIC)))
                 NIL)
                (T
                 (PROG ()
                   (TERPRI)
                   (SETQ ~RESULT~
                           (ERRORSET* (LIST 'PRINT (MKQUOTE (CAR ~RESULT~)))
                                      T))))))
              ((CAR ~RESULT~)
               (SETQ ~RESULT~
                       (ERRORSET*
                        (LIST 'ASSGNPRI (MKQUOTE (CAR ~RESULT~))
                              (COND (~X~ (CONS 'LIST ~X~)) (T NIL))
                              (MKQUOTE 'ONLY))
                        T))))))
      (COND ((NULL *REDUCE4) (RETURN (COND ((ERRORP ~RESULT~) 'ERR3) (T NIL))))
            ((NULL (EQUAL *MODE 'NOVAL))
             (PROGN (TERPRI) (PRIN2 "of type: ") (PRINT ~MODE~))))
      (RETURN NIL))) 
(PUT 'GETSETVARLIS 'NUMBER-OF-ARGS 1) 
(PUT 'GETSETVARLIS 'DEFINED-ON-LINE '458) 
(PUT 'GETSETVARLIS 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'GETSETVARLIS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE GETSETVARLIS (U)
    (COND ((NULL U) NIL) ((ATOM U) (ERRACH (LIST "getsetvarlis" U)))
          ((ATOM (CAR U)) (CONS (CAR U) (GETSETVARLIS (CDR U))))
          ((MEMQ (CAAR U) '(SETEL SETK))
           (CONS (GETSETVARLIS (CADAR U)) (GETSETVARLIS (CDR U))))
          ((EQUAL (CAAR U) 'SETQ)
           (CONS (MKQUOTE (CADAR U)) (GETSETVARLIS (CDR U))))
          (T (CONS (CAR U) (GETSETVARLIS (CDR U)))))) 
(PUT 'GETSETVARS 'NUMBER-OF-ARGS 1) 
(PUT 'GETSETVARS 'DEFINED-ON-LINE '467) 
(PUT 'GETSETVARS 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'GETSETVARS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE GETSETVARS (U)
    (COND ((ATOM U) NIL)
          ((MEMQ (CAR U) '(SETEL SETK))
           (CONS (GETSETVARLIS (CADR U)) (GETSETVARS (CADDR U))))
          ((EQUAL (CAR U) 'SETQ)
           (CONS (MKQUOTE (CADR U)) (GETSETVARS (CADDR U))))
          (T NIL))) 
(FLAG '(DEFLIST FLAG FLUID GLOBAL REMFLAG REMPROP UNFLUID) 'EVAL) 
(PUT 'CLOSE-INPUT-FILES 'NUMBER-OF-ARGS 0) 
(PUT 'CLOSE-INPUT-FILES 'DEFINED-ON-LINE '476) 
(PUT 'CLOSE-INPUT-FILES 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'CLOSE-INPUT-FILES 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE CLOSE-INPUT-FILES NIL
    (PROG ()
      (COND (IFL* (PROGN (RDS NIL) (SETQ IFL* NIL))))
      (PROG ()
       WHILELABEL
        (COND ((NOT IPL*) (RETURN NIL)))
        (PROGN (CLOSE (CADAR IPL*)) (SETQ IPL* (CDR IPL*)))
        (GO WHILELABEL)))) 
(PUT 'CLOSE-OUTPUT-FILES 'NUMBER-OF-ARGS 0) 
(PUT 'CLOSE-OUTPUT-FILES 'DEFINED-ON-LINE '485) 
(PUT 'CLOSE-OUTPUT-FILES 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'CLOSE-OUTPUT-FILES 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE CLOSE-OUTPUT-FILES NIL
    (PROG ()
      (COND (OFL* (PROGN (WRS NIL) (SETQ OFL* NIL))))
      (PROG ()
       WHILELABEL
        (COND ((NOT OPL*) (RETURN NIL)))
        (PROGN (CLOSE (CDAR OPL*)) (SETQ OPL* (CDR OPL*)))
        (GO WHILELABEL)))) 
(PUT 'ADD2BUFLIS 'NUMBER-OF-ARGS 0) 
(PUT 'ADD2BUFLIS 'DEFINED-ON-LINE '494) 
(PUT 'ADD2BUFLIS 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'ADD2BUFLIS 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE ADD2BUFLIS NIL
    (PROG ()
      (COND ((NULL CRBUF*) (RETURN NIL)))
      (SETQ CRBUF* (REVERSIP CRBUF*))
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND CRBUF* (SEPRP (CAR CRBUF*)))) (RETURN NIL)))
        (SETQ CRBUF* (CDR CRBUF*))
        (GO WHILELABEL))
      (SETQ CRBUFLIS* (CONS (CONS STATCOUNTER CRBUF*) CRBUFLIS*))
      (SETQ CRBUF* NIL))) 
(PUT 'ADD2INPUTBUF 'NUMBER-OF-ARGS 2) 
(PUT 'ADD2INPUTBUF 'DEFINED-ON-LINE '503) 
(PUT 'ADD2INPUTBUF 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'ADD2INPUTBUF 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE ADD2INPUTBUF (U MODE)
    (PROG ()
      (COND ((OR (NULL (TERMINALP)) *NOSAVE*) (RETURN NIL)))
      (SETQ INPUTBUFLIS* (CONS (LIST STATCOUNTER MODE U) INPUTBUFLIS*)))) 
(PUT 'ADD2RESULTBUF 'NUMBER-OF-ARGS 2) 
(PUT 'ADD2RESULTBUF 'DEFINED-ON-LINE '509) 
(PUT 'ADD2RESULTBUF 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'ADD2RESULTBUF 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE ADD2RESULTBUF (U MODE)
    (PROG ()
      (COND
       (*LIBREDUCE_ACTIVE
        (PROGN
         (LR_RESULT)
         (COND ((NULL (EQUAL SEMIC* '$)) (LR_PRINTER U MODE)))
         (LR_STATCOUNTER)
         (PRIN2 STATCOUNTER)
         (LR_MODE)
         (PRIN2 (COND ((EQUAL *MODE 'SYMBOLIC) 1) (T 0)))
         (LR_POSTTEXT)
         (TERPRI))))
      (COND
       ((OR (EQUAL MODE 'SYMBOLIC)
            (AND (NULL U) (OR (NULL *REDUCE4) (NULL (EQUAL MODE 'EMPTY_LIST))))
            *NOSAVE*)
        (RETURN NIL)))
      (COND (*REDUCE4 (PUTOBJECT 'WS U MODE))
            (T (SETQ WS (PROGN (SETQ ALGLIST* (CONS NIL NIL)) U))))
      (COND
       ((TERMINALP)
        (SETQ RESULTBUFLIS* (CONS (CONS STATCOUNTER U) RESULTBUFLIS*)))))) 
(PUT 'CONDTERPRI 'NUMBER-OF-ARGS 0) 
(PUT 'CONDTERPRI 'DEFINED-ON-LINE '532) 
(PUT 'CONDTERPRI 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'CONDTERPRI 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE CONDTERPRI NIL
    (AND *OUTPUT *ECHO *EXTRAECHO (OR (NULL *INT) IFL*) (NULL *DEFN)
         (NULL *DEMO) (TERPRI))) 
(PUT 'EOFCHECK 'NUMBER-OF-ARGS 0) 
(PUT 'EOFCHECK 'DEFINED-ON-LINE '536) 
(PUT 'EOFCHECK 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'EOFCHECK 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE EOFCHECK NIL
    (AND (EQ PROGRAM* $EOF$) (EQUAL TTYPE* 3) (SETQ EOF* (PLUS EOF* 1)))) 
(PUT 'RESETPARSER 'NUMBER-OF-ARGS 0) 
(PUT 'RESETPARSER 'DEFINED-ON-LINE '540) 
(PUT 'RESETPARSER 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'RESETPARSER 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE RESETPARSER NIL (COND ((NULL *SLIN) (COMM1 T)))) 
(PUT 'TERMINALP 'NUMBER-OF-ARGS 0) 
(PUT 'TERMINALP 'DEFINED-ON-LINE '544) 
(PUT 'TERMINALP 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'TERMINALP 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE TERMINALP NIL (AND *INT (NULL IFL*))) 
(PUT 'DFPRINT 'NUMBER-OF-ARGS 1) 
(PUT 'DFPRINT 'DEFINED-ON-LINE '548) 
(PUT 'DFPRINT 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'DFPRINT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DFPRINT (U)
    (PROG () (COND ((NOT (ZEROP (POSN))) (TERPRI))) (RETURN (DFPRINT1 U)))) 
(PUT 'DFPRINT1 'NUMBER-OF-ARGS 1) 
(PUT 'DFPRINT1 'DEFINED-ON-LINE '554) 
(PUT 'DFPRINT1 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'DFPRINT1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DFPRINT1 (U)
    (COND (DFPRINT* (LISPAPPLY DFPRINT* (LIST U))) (CMSG* NIL)
          ((NULL (EQCAR U 'PROGN)) (PRETTYPRINT U))
          (T
           (PROG ()
            WHILELABEL
             (COND ((NOT (SETQ U (CDR U))) (RETURN NIL)))
             (DFPRINT1 (CAR U))
             (GO WHILELABEL))))) 
(PUT 'SHOWTIME 'NUMBER-OF-ARGS 1) 
(PUT 'SHOWTIME 'DEFINED-ON-LINE '562) 
(PUT 'SHOWTIME 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'SHOWTIME 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SHOWTIME (OPTARG)
    (PROG (X Y)
      (SETQ X OTIME*)
      (SETQ OTIME* (TIME))
      (SETQ X (DIFFERENCE OTIME* X))
      (SETQ Y OGCTIME*)
      (SETQ OGCTIME* (GCTIME))
      (SETQ Y (DIFFERENCE OGCTIME* Y))
      (COND ((MEMQ 'PSL LISPSYSTEM*) (SETQ X (DIFFERENCE X Y))))
      (TERPRI)
      (COND (OPTARG (PRIN2 OPTARG)))
      (PRIN2 "Time: ")
      (PRIN2 X)
      (PRIN2 " ms")
      (COND
       ((NULL (EQUAL Y 0))
        (PROGN (PRIN2 "  plus GC time: ") (PRIN2 Y) (PRIN2 " ms"))))
      (TERPRI)
      (RETURN (COND (*REDUCE4 (MKNOVALOBJ)) (T NIL))))) 
(PUT 'SHOWTIME1 'NUMBER-OF-ARGS 1) 
(PUT 'SHOWTIME1 'DEFINED-ON-LINE '599) 
(PUT 'SHOWTIME1 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'SHOWTIME1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SHOWTIME1 (OPTARG)
    (PROG (X Y)
      (SETQ X OTIME1*)
      (SETQ OTIME1* (TIME))
      (SETQ X (DIFFERENCE OTIME1* X))
      (SETQ Y OGCTIME1*)
      (SETQ OGCTIME1* (GCTIME))
      (SETQ Y (DIFFERENCE OGCTIME1* Y))
      (COND ((MEMQ 'PSL LISPSYSTEM*) (SETQ X (DIFFERENCE X Y))))
      (TERPRI)
      (COND (OPTARG (PRIN2 OPTARG)))
      (PRIN2 "Time (counter 1): ")
      (PRIN2 X)
      (PRIN2 " ms")
      (COND
       ((NULL (EQUAL Y 0))
        (PROGN (PRIN2 "  plus GC time: ") (PRIN2 Y) (PRIN2 " ms"))))
      (TERPRI)
      (RETURN (COND (*REDUCE4 (MKNOVALOBJ)) (T NIL))))) 
(PUT 'SHOWTIME2 'NUMBER-OF-ARGS 1) 
(PUT 'SHOWTIME2 'DEFINED-ON-LINE '617) 
(PUT 'SHOWTIME2 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'SHOWTIME2 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SHOWTIME2 (OPTARG)
    (PROG (X Y)
      (SETQ X OTIME2*)
      (SETQ OTIME2* (TIME))
      (SETQ X (DIFFERENCE OTIME2* X))
      (SETQ Y OGCTIME2*)
      (SETQ OGCTIME2* (GCTIME))
      (SETQ Y (DIFFERENCE OGCTIME2* Y))
      (COND ((MEMQ 'PSL LISPSYSTEM*) (SETQ X (DIFFERENCE X Y))))
      (TERPRI)
      (COND (OPTARG (PRIN2 OPTARG)))
      (PRIN2 "Time (counter 2): ")
      (PRIN2 X)
      (PRIN2 " ms")
      (COND
       ((NULL (EQUAL Y 0))
        (PROGN (PRIN2 "  plus GC time: ") (PRIN2 Y) (PRIN2 " ms"))))
      (TERPRI)
      (RETURN (COND (*REDUCE4 (MKNOVALOBJ)) (T NIL))))) 
(PUT 'SHOWTIME3 'NUMBER-OF-ARGS 1) 
(PUT 'SHOWTIME3 'DEFINED-ON-LINE '635) 
(PUT 'SHOWTIME3 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'SHOWTIME3 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SHOWTIME3 (OPTARG)
    (PROG (X Y)
      (SETQ X OTIME3*)
      (SETQ OTIME3* (TIME))
      (SETQ X (DIFFERENCE OTIME3* X))
      (SETQ Y OGCTIME3*)
      (SETQ OGCTIME3* (GCTIME))
      (SETQ Y (DIFFERENCE OGCTIME3* Y))
      (COND ((MEMQ 'PSL LISPSYSTEM*) (SETQ X (DIFFERENCE X Y))))
      (TERPRI)
      (COND (OPTARG (PRIN2 OPTARG)))
      (PRIN2 "Time (counter 3): ")
      (PRIN2 X)
      (PRIN2 " ms")
      (COND
       ((NULL (EQUAL Y 0))
        (PROGN (PRIN2 "  plus GC time: ") (PRIN2 Y) (PRIN2 " ms"))))
      (TERPRI)
      (RETURN (COND (*REDUCE4 (MKNOVALOBJ)) (T NIL))))) 
(PUT 'RESETTIME 'NUMBER-OF-ARGS 0) 
(PUT 'RESETTIME 'DEFINED-ON-LINE '653) 
(PUT 'RESETTIME 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'RESETTIME 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE RESETTIME NIL
    (PROGN
     (SETQ OTIME* (TIME))
     (SETQ OGCTIME* (GCTIME))
     (COND (*REDUCE4 (MKNOVALOBJ)) (T NIL)))) 
(PUT 'RESETTIME1 'NUMBER-OF-ARGS 0) 
(PUT 'RESETTIME1 'DEFINED-ON-LINE '658) 
(PUT 'RESETTIME1 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'RESETTIME1 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE RESETTIME1 NIL
    (PROGN
     (SETQ OTIME1* (TIME))
     (SETQ OGCTIME1* (GCTIME))
     (COND (*REDUCE4 (MKNOVALOBJ)) (T NIL)))) 
(PUT 'RESETTIME2 'NUMBER-OF-ARGS 0) 
(PUT 'RESETTIME2 'DEFINED-ON-LINE '663) 
(PUT 'RESETTIME2 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'RESETTIME2 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE RESETTIME2 NIL
    (PROGN
     (SETQ OTIME2* (TIME))
     (SETQ OGCTIME2* (GCTIME))
     (COND (*REDUCE4 (MKNOVALOBJ)) (T NIL)))) 
(PUT 'RESETTIME3 'NUMBER-OF-ARGS 0) 
(PUT 'RESETTIME3 'DEFINED-ON-LINE '668) 
(PUT 'RESETTIME3 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'RESETTIME3 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE RESETTIME3 NIL
    (PROGN
     (SETQ OTIME3* (TIME))
     (SETQ OGCTIME3* (GCTIME))
     (COND (*REDUCE4 (MKNOVALOBJ)) (T NIL)))) 
(PUT 'SINITL 'NUMBER-OF-ARGS 1) 
(PUT 'SINITL 'DEFINED-ON-LINE '674) 
(PUT 'SINITL 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'SINITL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SINITL (U) (SET U (EVAL (GET U 'INITL)))) 
(PUT 'GETENV_IF_NOT_EMPTY 'NUMBER-OF-ARGS 1) 
(PUT 'GETENV_IF_NOT_EMPTY 'DEFINED-ON-LINE '680) 
(PUT 'GETENV_IF_NOT_EMPTY 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'GETENV_IF_NOT_EMPTY 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE GETENV_IF_NOT_EMPTY (NAME)
    (PROG ()
      (SETQ NAME (GETENV NAME))
      (COND ((EQUAL NAME "") (SETQ NAME NIL)))
      (RETURN NAME))) 
(PUT 'READ-INIT-FILE 'NUMBER-OF-ARGS 1) 
(PUT 'READ-INIT-FILE 'DEFINED-ON-LINE '687) 
(PUT 'READ-INIT-FILE 'DEFINED-IN-FILE 'RLISP/SUPERV.RED) 
(PUT 'READ-INIT-FILE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE READ-INIT-FILE (NAME)
    (PROG (*ERRCONT *INT BASE FNAME OLDMODE X Y)
      (SETQ BASE
              (OR (GETENV_IF_NOT_EMPTY "HOME")
                  (AND (SETQ X (GETENV "HOMEDRIVE"))
                       (SETQ Y (GETENV "HOMEPATH")) (CONCAT2 X Y))
                  "."))
      (COND
       ((AND (NEQ BASE "") (NEQ (CAR (REVERSIP (EXPLODE2 BASE))) '/))
        (SETQ BASE (CONCAT2 BASE "/"))))
      (SETQ FNAME
              (COND
               ((FILEP
                 (SETQ X (CONCAT2 BASE (CONCAT2 "." (CONCAT2 NAME "rc")))))
                X)
               ((FILEP (SETQ X (CONCAT2 BASE (CONCAT2 NAME ".rc")))) X)
               ((FILEP (SETQ X (CONCAT2 BASE (CONCAT2 NAME ".INI")))) X)))
      (COND ((NULL FNAME) (RETURN NIL))
            ((AND (NEQ *MODE 'ALGEBRAIC) (NULL *RLISP88))
             (PROGN
              (SETQ OLDMODE *MODE)
              (SETQ *MODE (PROGN (SETQ ALGLIST* (CONS NIL NIL)) 'ALGEBRAIC)))))
      (SETQ X (ERRORSET (LIST 'IN_LIST1 FNAME NIL) NIL NIL))
      (COND
       ((OR (ERRORP X) ERFG*)
        (PROGN
         (TERPRI)
         (PRIN2 "***** Error processing resource file ")
         (PRIN2T FNAME))))
      (CLOSE-INPUT-FILES)
      (SETQ ERFG* (SETQ CMSG* (SETQ *DEFN (SETQ CRBUF* NIL))))
      (COND
       (OLDMODE (SETQ *MODE (PROGN (SETQ ALGLIST* (CONS NIL NIL)) OLDMODE))))
      (TERPRI)
      (SETQ STATCOUNTER 0))) 
(ENDMODULE) 