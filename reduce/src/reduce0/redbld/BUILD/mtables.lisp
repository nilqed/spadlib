(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(SETQ CONSTANTS*
        '(|&TRUE;| |&FALSE;| |&IMAGINARYI;| |&II;| |&EXPONENTIALE;| |&EE;|
          |&PI;| |&INFIN;| |&GAMMA;| |&DIFFERENTIALD;| |&DD;|)) 
(SETQ RELATIONS*
        '((TENDSTO BINARYRD TENDSTO) (TENDSTO/ BINARYRD TENDSTO)
          (EQ/ NARYRD EQ) (NEQ/ BINARYRD NEQ) (LT/ NARYRD LT) (GT/ NARYRD GT)
          (GEQ/ NARYRD GEQ) (LEQ/ NARYRD LEQ) (IN/ BINARYRD IN)
          (NOTIN/ BINARYRD NOTIN) (SUBSET/ SUBSETRD SUBSET)
          (PRSUBSET/ PRSUBSETRD PRSUBSET) (NOTPRSUBSET/ BINARYRD NOTPRSUBSET)
          (NOTSUBSET/ BINARYRD NOTSUBSET))) 
(SETQ FUNCTIONS*
        '((DIVIDE/ BINARYRD DIVIDE) (SCALARPRODUCT/ BINARYRD SCALARPRODUCT)
          (VECTORPRODUCT/ BINARYRD VECTORPRODUCT)
          (OUTERPRODUCT/ BINARYRD OUTERPRODUCT)
          (DIVERGENCE/ UNARYRD DIVERGENCE) (CURL/ UNARYRD CURL)
          (LAPLACIAN/ UNARYRD LAPLACIAN) (GRAD/ UNARYRD GRAD)
          (SIZE/ UNARYRD SIZE) (SETDIFF/ SETFUNCSBINRD SETDIFF)
          (SELECT/ SELECTRD SELECTOR) (SELECTOR/ SELECTRD SELECTOR)
          (TRANSPOSE/ TRANSPOSERD TRANSPOSE)
          (DETERMINANT/ DETERMINANTRD DETERMINANT) (FN APPLYFNRD FN)
          (UNION/ SETFUNCSNARYRD UNION) (INTERSECT/ SETFUNCSNARYRD INTERSECT)
          (IMPLIES/ BINARYRD IMPLIES) (NOT/ UNARYRD NOT) (XOR/ NARYRD XOR)
          (OR/ NARYRD OR) (AND/ NARYRD AND) (MEAN/ NARYRD MEAN)
          (MODE/ NARYRD MODE) (VAR/ NARYRD VARIANCE) (VARIANCE/ NARYRD VAR)
          (SDEV/ NARYRD SDEV) (MOMENT/ MOMENTRD MOMENT) (MEDIAN/ NARYRD MEDIAN)
          (SIN/ UNARYRD SIN) (SEC/ UNARYRD SEC) (SINH/ UNARYRD SINH)
          (SECH/ UNARYRD SECH) (ARCSIN/ UNARYRD ARCSIN) (COS/ UNARYRD COS)
          (CSC/ UNARYRD CSC) (COSH/ UNARYRD COSH) (CSCH/ UNARYRD CSCH)
          (ARCCOS/ UNARYRD ARCCOS) (TAN/ UNARYRD TAN) (COT/ UNARYRD COT)
          (TANH/ UNARYRD TANH) (COTH/ UNARYRD COTH) (ARCTAN/ UNARYRD ARCTAN)
          (ABS/ UNARYRD ABS) (LN/ UNARYRD LN) (PLUS/ NARYRD PLUS)
          (TIMES/ NARYRD TIMES) (POWER/ BINARYRD POWER) (EXP/ UNARYRD EXP)
          (FACTORIAL/ UNARYRD FACTORIAL) (QUOTIENT/ BINARYRD QUOTIENT)
          (MAX/ MINMAXRD MAX) (MIN/ MINMAXRD MIN) (MINUS/ MINUSRD MINUS)
          (REM/ BINARYRD REM) (CONJUGATE/ UNARYRD CONJUGATE)
          (ROOT/ ROOTRD ROOT) (GCD/ NARYRD GCD) (LOG/ LOGRD LOG)
          (INT/ SYMBOLSRD INT) (SUM/ SYMBOLSRD SUM) (LIMIT/ LIMITRD LIMIT)
          (CONDITION CONDITIONRD CONDITION) (PRODUCT/ SYMBOLSRD PRODUCT)
          (DIFF/ DIFFRD DIFF) (PARTIALDIFF/ PARTIALDIFFRD PARTIALDIFF)
          (INVERSE/ UNARYRD INVERSE) (TENDSTO BINARYRD TENDSTO)
          (TENDSTO/ BINARYRD TENDSTO) (EQ/ NARYRD EQ) (NEQ/ BINARYRD NEQ)
          (LT/ NARYRD LT) (GT/ NARYRD GT) (GEQ/ NARYRD GEQ) (LEQ/ NARYRD LEQ)
          (IN/ SETFUNCSBINRD IN) (NOTIN/ SETFUNCSBINRD NOTIN)
          (SUBSET/ SUBSETRD SUBSET) (PRSUBSET/ PRSUBSETRD PRSUBSET)
          (NOTPRSUBSET/ SETFUNCABINRD NOTPRSUBSET)
          (NOTSUBSET/ SETFUNCSBINRD NOTSUBSET) (FORALL/ QUANTIFIERRD FORALL)
          (EXISTS/ QUANTIFIERRD EXISTS) (EQUIVALENT/ BINARYRD EQUIVALENT)
          (APPROX/ BINARYRD APPROX) (IMAGINARY/ UNARYRD IMAGINARY)
          (REAL/ UNARYRD REAL) (ARG/ UNARYRD ARG) (COMPOSE/ NARYRD COMPOSE)
          (CSYMBOL CSYMBOLRD CSYMBOL))) 
(SETQ CONSTRUCTORS*
        '((RELN RELNRD /RELN "</reln>") (SET SETRD /SET "</set>")
          (FN FNRD /FN "</fn>") (DECLARE DECLARERD /DECLARE "</declare>")
          (INTERVAL INTERVALRD /INTERVAL "</interval>")
          (LIST LISTRD /LIST "</list>") (MATRIX MATRIXRD /MATRIX "</matrix>")
          (APPLY APPLYRD /APPLY "</apply>") (CN CNRD /CN "</cn>")
          (CI CIRD /CI "</ci>") (LAMBDA LAMBDARD /LAMBDA "</lambda>"))) 
(SETQ IR2MML*
        '((DETERMINANT NARY DETERMINANT NARYOM)
          (SEMANTIC SEMANTICML NIL SEMANTICOM) (STRING NIL NIL STROM)
          (BASED_INTEGER NUMML BASED_INTEGER NARYOM)
          (COMPLEX_CARTESIAN NUMML COMPLEX_CARTESIAN NARYOM)
          (COMPLEX_POLAR NUMML COMPLEX_POLAR NARYOM) (CI CIML NIL CIOM)
          (CN CNML NIL CNOM) (VECTORML VECTORML NIL CONTAINEROM)
          (SCALARPRODUCT NARY SCALARPRODUCT NARYOM)
          (VECTORPRODUCT NARY VECTORPRODUCT NARYOM)
          (OUTERPRODUCT NARY OUTERPRODUCT NARYOM)
          (LAMBDA CONTAINERML LAMBDA LAMBDAOM) (DECLARE DECLAREML NIL)
          (DIVERGENCE NARY DIVERGENCE NARYOM) (LAPLACIAN NARY LAPLACIAN NARYOM)
          (CURL NARY CURL NARYOM) (GRAD NARY GRAD NARYOM)
          (SIZE NARY SIZE NARYOM) (MOMENT DEGREETOKSML MOMENT NARYOM)
          (TRANSPOSE NARY TRANSPOSE NARYOM) (SUM NARY SUM SYMBOLSOM)
          (PRODUCT NARY PRODUCT SYMBOLSOM) (LIMIT NARY LIMIT LIMITOM)
          (TENDSTO TENDSTOML NIL) (DF DFML NIL) (DIFF NARY DIFF SYMBOLSOM)
          (PARTIALDIFF NARY PARTIALDIFF PARTIALDIFFOM)
          (CONJUGATE NARY CONJUGATE NARYOM) (INVERSE NARY INVERSE NARYOM)
          (ABS NARY ABS NARYOM) (GCD NARY GCD NARYOM)
          (SET CONTAINERML SET CONTAINEROM) (FACTORIAL NARY FACTORIAL NARYOM)
          (MAX NARY MAX NARYOM) (MIN NARY MIN NARYOM) (AND NARY AND NARYOM)
          (OR NARY OR NARYOM) (XOR NARY XOR NARYOM)
          (SELECTOR NARY SELECTOR SELECTOM) (COS NARY COS NARYOM)
          (SIN NARY SIN NARYOM) (SEC NARY SEC NARYOM) (COSH NARY COSH NARYOM)
          (COT NARY COT NARYOM) (COTH NARY COTH NARYOM) (CSCH NARY CSCH NARYOM)
          (ARCCOS NARY ARCCOS NARYOM) (ARCSIN NARY ARCSIN NARYOM)
          (ARCTAN NARY ARCTAN NARYOM) (SECH NARY SECH NARYOM)
          (SINH NARY SINH NARYOM) (TAN NARY TAN NARYOM) (TANH NARY TANH NARYOM)
          (CSC NARY CSC NARYOM) (ARG NARY ARG NARYOM) (REAL NARY REAL NARYOM)
          (EXP NARY EXP NARYOM) (NOT NARY NOT NARYOM) (REM NARY REM NARYOM)
          (IMAGINARY NARY IMAGINARY NARYOM)
          (QUOTIENT QUOTIENTML QUOTIENT NARYOM)
          (DIVIDE QUOTIENTML DIVIDE NARYOM) (EQUIVALENT NARY EQUIVALENT NARYOM)
          (APPROX NARY APPROX NARYOM) (IMPLIES NARY IMPLIES NARYOM)
          (PLUS NARY PLUS NARYOM) (TIMES NARY TIMES NARYOM)
          (POWER NARY POWER NARYOM) (MEDIAN NARY MEDIAN NARYOM)
          (MEAN NARY MEAN NARYOM) (SDEV NARY SDEV NARYOM)
          (VARIANCE NARY VARIANCE NARYOM) (MODE NARY MODE NARYOM)
          (COMPOSE NARY COMPOSE NARYOM) (ROOT DEGREETOKSML ROOT NARYOM)
          (LOG LOG_BASEML LOG NARYOM) (LOGB LOG_BASEML LOGB)
          (LOG10 LOG_BASEML LOG10) (LN NARY LN NARYOM) (EQ RELN EQ NARYOM)
          (NEQ RELN NEQ NARYOM) (GT RELN GT NARYOM) (LT RELN LT NARYOM)
          (GEQ RELN GEQ NARYOM) (LEQ RELN LEQ NARYOM) (UNION SETS UNION NARYOM)
          (INTERSECT SETS INTERSECT NARYOM) (IN RELN IN NARYOM)
          (NOTIN RELN NOTIN NARYOM) (SUBSET RELN SUBSET NARYOM)
          (PRSUBSET RELN PRSUBSET NARYOM) (NOTSUBSET RELN NOTSUBSET NARYOM)
          (NOTPRSUBSET RELN NOTPRSUBSET NARYOM) (SETDIFF SETS SETDIFF NARYOM)
          (RATIONAL RATIONALML NIL NARYOM) (MATRIX MATRIXML NIL MATRIXOM)
          (MINUS MINUSML NIL NARYOM) (INT NARY INT SYMBOLSOM)
          (EQUAL EQUALML NIL NARYOM) (BVAR BVARML NIL) (DEGREE DEGREEML NIL)
          (INTERVAL CONTAINERML INTERVAL INTERVALOM)
          (INTEGER_INTERVAL CONTAINERML INTERVAL INTERVALOM)
          (CONDITION CONDITIONML NIL)
          (LOWUPPERLIMIT LOWUPPERLIMITML NIL INTERVALOM)
          (LOWLIMIT LOWLIMITML NIL) (FN CSYMBOL_FN NIL) (IDENT IDENTML NIL)
          (FORALL NARY FORALL QUANTOM) (EXISTS NARY EXISTS QUANTOM)
          (LIST CONTAINERML LIST CONTAINEROM))) 
(SETQ VALID_OM*
        '((DIVIDE ARITH1) (INTEGER (OMTYPES)) (FLOAT (OMTYPES))
          (SELECTOR LINALG3) (COMPLEX_CARTESIAN NUMS1) (COMPLEX_POLAR NUMS1)
          (BASED_INTEGER NUMS1) (EQUIVALENT LOGIC2) (APPROX RELATION2)
          (DETERMINANT LINALG3) (TRANSPOSE LINALG3) (INVERSE FNS1 ARITH2)
          (IN SET1 MULTISET1) (SUBSET SET1 MULTISET1) (PRSUBSET SET1 MULTISET1)
          (NOTSUBSET SET1 MULTISET1) (NOTPRSUBSET SET1 MULTISET1)
          (SET SET1 MULTISET1) (SETDIFF SET1 MULTISET1) (UNION SET1 MULTISET1)
          (NOTIN SET1 MULTISET1) (INTERSECT SET1 MULTISET1) (IMPLIES LOGIC1)
          (NOT LOGIC1) (XOR LOGIC1) (VECTORPRODUCT LINALG1)
          (VECTOR LINALG1 LINALG2) (OR LOGIC1) (FORALL QUANT1) (AND LOGIC1)
          (MEAN STATS1) (MODE STATS1) (VARIANCE STATS1) (SDEV STATS1)
          (MOMENT STATS1) (MEDIAN STATS1) (SIN TRANSC1) (SINH TRANSC1)
          (ARCSIN TRANSC1) (ARCSINH TRANSC1 TRANSC2) (SEC TRANSC1)
          (SECH TRANSC1) (ARCSEC TRANSC1 TRANSC2) (ARCSECH TRANSC1 TRANSC2)
          (COS TRANSC1) (ARCCOS TRANSC1) (COSH TRANSC1)
          (ARCCOSH TRANSC1 ARCTRANS2) (CSC TRANSC1) (CSCH TRANSC1)
          (ARCCSC TRANSC1 TRANSC2) (ARCCSCH TRANSC1 TRANSC2) (TAN TRANSC1)
          (TANH TRANSC1) (ARCTAN TRANSC1) (ARCTANH TRANSC1 TRANSC2)
          (COT TRANSC1) (COTH TRANSC1) (ARCCOT TRANSC1 TRANSC2)
          (ARCCOTH TRANSC1 TRANSC2) (LN TRANSC1) (EXP TRANSC1) (ABS ARITH1)
          (PLUS ARITH1) (TIMES ARITH1 ARITH2) (POWER ARITH1)
          (FACTORIAL INTEGER1) (MINUS ARITH1) (REM INTEGER1) (CONJUGATE ARITH1)
          (ROOT ARITH1) (LOG TRANSC1) (INT CALCULUS1) (GCD INTEGER1)
          (QUOTIENT INTEGER1) (SUM ARITH1) (PRODUCT ARITH1)
          (SCALARPRODUCT LINALG1) (OUTERPRODUCT LINALG1) (DIFF CALCULUS1)
          (PARTIALDIFF CALCULUS1) (EQ RELATION1) (NEQ RELATION1)
          (LEQ RELATION1) (GEQ RELATION1) (LT RELATION1) (GT RELATION1)
          (QUOTIENT INTEGER1) (INTERVAL INTERVAL1) (INTEGER_INTERVAL INTERVAL1)
          (MIN MINMAX1) (MAX MINMAX1) (IMAGINARY NUMS1) (REAL NUMS1)
          (FORALL QUANT1) (EXISTS QUANT1) (LAMBDA FNS1) (LIST LIST1)
          (ARG ARITH2) (TYPE TYPMML) (RATIONAL NUMS1) (CURL VECCALC1)
          (DIVERGENCE VECCALC1) (GRAD VECCALC1) (SIZE LINALG3)
          (LAPLACIAN VECCALC1))) 
(SETQ SPECIAL_CASES*
        '((UNARY_MINUS ARITH1 MINUS NIL) (BOTH_SIDES LIMIT1 NIL NIL)
          (ABOVE LIMIT1 TENDSTO ABOVE) (BELOW LIMIT1 TENDSTO BELOW)
          (NULL LIMIT1 NIL NIL) (MULTISET MULTISET1 SET (TYPE MULTISET))
          (COMPLEX_CARTESIAN_TYPE TYPMML COMPLEX_CARTESIAN NIL)
          (COMPLEX_POLAR_TYPE TYPMML COMPLEX_POLAR NIL)
          (CONSTANT_TYPE TYPMML CONSTANT NIL) (FN_TYPE TYPMML CSYMBOL NIL)
          (INTEGER_TYPE TYPMML INTEGER NIL) (LIST_TYPE TYPMML LIST NIL)
          (MATRIX_TYPE TYPMML MATRIX NIL) (RATIONAL_TYPE TYPMML RATIONAL NIL)
          (REAL_TYPE TYPMML REAL NIL) (SET_TYPE TYPMML SET NIL)
          (VECTOR_TYPE TYPMML VECTORML NIL)
          (INTEGER_INTERVAL INTERVAL1 INTERVAL NIL)
          (INTERVAL_OO INTERVAL1 INTERVAL (CLOSURE OPEN))
          (INTERVAL_CC INTERVAL1 INTERVAL (CLOSURE CLOSE))
          (INTERVAL_OC INTERVAL1 INTERVAL (CLOSURE OPEN-CLOSED))
          (INTERVAL_CO INTERVAL1 INTERVAL (CLOSURE CLOSED-OPEN)))) 
(SETQ SPECIAL_CASES2*
        '((MATRIX MATRIXIR) (LIMIT LIMITIR) (VECTOR_SELECTOR SELECTIR)
          (MATRIX_SELECTOR SELECTIR) (COMPLEX_CARTESIAN NUMIR)
          (COMPLEX_POLAR NUMIR) (RATIONAL NUMIR) (DEFINT INTEGRALIR)
          (INT INTEGRALIR) (DIFF INTEGRALIR) (PARTIALDIFF PARTIALDIFFIR)
          (SUM SUM_PRODIR) (PRODUCT SUM_PRODIR) (ONE UNARYIR ALG1 1)
          (ZERO UNARYIR ALG1 0) (I UNARYIR NUMS1 |&IMAGINARYI;|)
          (E UNARYIR NUMS1 |&EXPONENTIALE;|) (PI UNARYIR NUMS1 |&PI;|)
          (NAN UNARYIR NUMS1 |&NOTANUMBER;|) (GAMMA UNARYIR NUMS1 |&GAMMA;|)
          (INFINITY UNARYIR NUMS1 |&INFIN;|) (FALSE UNARYIR LOGIC1 |&FALSE;|)
          (TRUE UNARYIR LOGIC1 |&TRUE;|))) 
(SETQ MMLEQ*
        '(DIVIDE BASED_INTEGER EQUIVALENT APPROX DETERMINANT TRANSPOSE INVERSE
                 IN SUBSET PRSUBSET NOTSUBSET NOTPRSUBSET SET SETDIFF UNION
                 NOTIN INTERSECT IMPLIES NOT XOR VECTORPRODUCT VECTOR OR FORALL
                 AND MEAN MODE VARIANCE SDEV MOMENT MEDIAN SIN SINH ARCSIN
                 ARCSINH SEC SECH ARCSEC ARCSECH COS ARCCOS COSH ARCCOSH CSC
                 CSCH ARCCSC ARCCSCH TAN TANH ARCTAN ARCTANH COT COTH ARCCOT
                 ARCCOTH LN EXP ABS PLUS TIMES POWER FACTORIAL MINUS REM
                 CONJUGATE ROOT LOG GCD QUOTIENT SCALARPRODUCT OUTERPRODUCT EQ
                 NEQ LEQ GEQ LT GT QUOTIENT INTERVAL MIN MAX IMAGINARY REAL
                 FORALL EXISTS LAMBDA LIST ARG TYPE LAPLACIAN DIVERGENCE CURL
                 GRAD SIZE INTEGER)) 