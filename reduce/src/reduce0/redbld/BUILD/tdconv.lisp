(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'TDCONV)) 
(PUT 'SETUNION 'NUMBER-OF-ARGS 2) 
(PUT 'SETUNION 'DEFINED-ON-LINE '31) 
(PUT 'SETUNION 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'SETUNION 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SETUNION (L1 L2)
    (COND ((NULL L2) L1) ((MEMBER (CAR L2) L1) (SETUNION L1 (CDR L2)))
          (T (SETUNION (APPEND L1 (CONS (CAR L2) NIL)) (CDR L2))))) 
(PUT 'SEARCHTM 'NUMBER-OF-ARGS 1) 
(PUT 'SEARCHTM 'DEFINED-ON-LINE '37) 
(PUT 'SEARCHTM 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'SEARCHTM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SEARCHTM (TERM)
    (COND ((OR (ATOM TERM) (ATOM (CAR TERM))) NIL)
          (T (CONS (CAAR TERM) (SEARCHPL (CDR TERM)))))) 
(PUT 'SEARCHPL 'NUMBER-OF-ARGS 1) 
(PUT 'SEARCHPL 'DEFINED-ON-LINE '42) 
(PUT 'SEARCHPL 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'SEARCHPL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SEARCHPL (POLY)
    (COND ((OR (ATOM POLY) (ATOM (CAR POLY))) NIL)
          (T (SETUNION (SEARCHTM (CAR POLY)) (SEARCHPL (CDR POLY)))))) 
(PUT 'QSORT 'NUMBER-OF-ARGS 1) 
(PUT 'QSORT 'DEFINED-ON-LINE '47) 
(PUT 'QSORT 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'QSORT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QSORT (L)
    (PROG (A L1 L2 LL)
      (COND ((NULL L) (RETURN NIL)))
      (SETQ A (CAR L))
      (SETQ LL (CDR L))
     LOOP
      (COND ((NULL LL) (GO EXIT)))
      (COND ((ORDOP A (CAR LL)) (SETQ L2 (CONS (CAR LL) L2)))
            (T (SETQ L1 (CONS (CAR LL) L1))))
      (SETQ LL (CDR LL))
      (GO LOOP)
     EXIT
      (RETURN (APPEND (QSORT L1) (CONS A (QSORT L2)))))) 
(PUT 'MAPINS 'NUMBER-OF-ARGS 2) 
(PUT 'MAPINS 'DEFINED-ON-LINE '61) 
(PUT 'MAPINS 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'MAPINS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MAPINS (EP CFL)
    (COND ((NULL CFL) NIL)
          (T
           (CONS (CONS (CONS EP (CAAR CFL)) (CDAR CFL))
                 (MAPINS EP (CDR CFL)))))) 
(PUT 'MKZL 'NUMBER-OF-ARGS 1) 
(PUT 'MKZL 'DEFINED-ON-LINE '66) 
(PUT 'MKZL 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'MKZL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MKZL (N) (COND ((EQUAL N 1) NIL) (T (CONS 0 (MKZL (DIFFERENCE N 1)))))) 
(PUT 'SQ2SSTM 'NUMBER-OF-ARGS 2) 
(PUT 'SQ2SSTM 'DEFINED-ON-LINE '70) 
(PUT 'SQ2SSTM 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'SQ2SSTM 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SQ2SSTM (SQTM VD)
    (PROG (EP CF CFL)
      (COND
       ((EQUAL (CAAR SQTM) (CAAR VD))
        (PROGN
         (SETQ CF (CDR SQTM))
         (SETQ EP (CDAR SQTM))
         (COND
          ((OR (ATOM CF) (ATOM (CAR CF)))
           (RETURN (CONS (CONS (CONS EP (MKZL (CDR VD))) CF) NIL)))
          (T (SETQ CFL (SQ2SSCFPL CF (CONS (CDAR VD) (SUB1 (CDR VD)))))))))
       (T
        (PROGN
         (SETQ CFL
                 (SQ2SSCFPL (CONS SQTM NIL) (CONS (CDAR VD) (SUB1 (CDR VD)))))
         (SETQ EP 0))))
      (RETURN (MAPINS EP CFL)))) 
(PUT 'SQ2SSCFPL 'NUMBER-OF-ARGS 2) 
(PUT 'SQ2SSCFPL 'DEFINED-ON-LINE '83) 
(PUT 'SQ2SSCFPL 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'SQ2SSCFPL 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SQ2SSCFPL (CFPL VD)
    (COND ((NULL CFPL) NIL)
          ((OR (ATOM CFPL) (ATOM (CAR CFPL)))
           (CONS (CONS (MKZL (PLUS (CDR VD) 1)) CFPL) NIL))
          (T (APPEND (SQ2SSTM (CAR CFPL) VD) (SQ2SSCFPL (CDR CFPL) VD))))) 
(PUT 'SQ2SSPL 'NUMBER-OF-ARGS 2) 
(PUT 'SQ2SSPL 'DEFINED-ON-LINE '89) 
(PUT 'SQ2SSPL 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'SQ2SSPL 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SQ2SSPL (SQPL VD)
    (COND ((OR (ATOM SQPL) (ATOM (CAR SQPL))) SQPL)
          (T (APPEND (SQ2SSTM (CAR SQPL) VD) (SQ2SSPL (CDR SQPL) VD))))) 
(PUT 'SDLIST 'NUMBER-OF-ARGS 1) 
(PUT 'SDLIST 'DEFINED-ON-LINE '94) 
(PUT 'SDLIST 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'SDLIST 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SDLIST (NM)
    (PROG (ANSLIST PARTLIST N RNM)
      (SETQ RNM NM)
     INIT
      (SETQ N (CAAAR RNM))
      (SETQ PARTLIST (CONS (CAR RNM) NIL))
     LOOP
      (SETQ RNM (CDR RNM))
      (COND
       ((NULL RNM)
        (PROGN (SETQ ANSLIST (APPEND ANSLIST (CONS PARTLIST NIL))) (GO EXIT))))
      (COND
       ((OR (ATOM RNM) (ATOM (CAR RNM)))
        (PROGN
         (SETQ ANSLIST (APPEND (APPEND ANSLIST (CONS PARTLIST NIL)) RNM))
         (GO EXIT))))
      (COND
       ((EQUAL N (CAAAR RNM))
        (PROGN
         (SETQ PARTLIST (APPEND PARTLIST (CONS (CAR RNM) NIL)))
         (GO LOOP)))
       (T
        (PROGN (SETQ ANSLIST (APPEND ANSLIST (CONS PARTLIST NIL))) (GO INIT))))
     EXIT
      (RETURN ANSLIST))) 
(PUT 'UNIVSDL2SQ 'NUMBER-OF-ARGS 2) 
(PUT 'UNIVSDL2SQ 'DEFINED-ON-LINE '116) 
(PUT 'UNIVSDL2SQ 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'UNIVSDL2SQ 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE UNIVSDL2SQ (VAR SDL)
    (COND ((OR (ATOM SDL) (ATOM (CAR SDL))) SDL)
          ((ZEROP (CAAAAR SDL)) (CDAAR SDL))
          (T
           (CONS (CONS (CONS VAR (CAAAAR SDL)) (CDAAR SDL))
                 (UNIVSDL2SQ VAR (CDR SDL)))))) 
(PUT 'MAPDEL 'NUMBER-OF-ARGS 1) 
(PUT 'MAPDEL 'DEFINED-ON-LINE '122) 
(PUT 'MAPDEL 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'MAPDEL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MAPDEL (SDL)
    (COND ((NULL SDL) NIL)
          (T (CONS (CONS (CDAAR SDL) (CDAR SDL)) (MAPDEL (CDR SDL)))))) 
(PUT 'MULVSDL2SQ 'NUMBER-OF-ARGS 2) 
(PUT 'MULVSDL2SQ 'DEFINED-ON-LINE '127) 
(PUT 'MULVSDL2SQ 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'MULVSDL2SQ 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MULVSDL2SQ (VD SDL)
    (COND ((OR (ATOM SDL) (ATOM (CAR SDL))) SDL)
          ((ZEROP (CAAAAR SDL))
           (COND
            ((AND (OR (ATOM (CDR SDL)) (ATOM (CAR (CDR SDL)))) (CDR SDL))
             (APPEND
              (SDL2SQ (CONS (CDAR VD) (SUB1 (CDR VD)))
                      (SDLIST (MAPDEL (CAR SDL))))
              (CDR SDL)))
            (T
             (SDL2SQ (CONS (CDAR VD) (SUB1 (CDR VD)))
                     (SDLIST (MAPDEL (CAR SDL)))))))
          (T
           (CONS
            (CONS (CONS (CAAR VD) (CAAAAR SDL))
                  (SDL2SQ (CONS (CDAR VD) (SUB1 (CDR VD)))
                          (SDLIST (MAPDEL (CAR SDL)))))
            (MULVSDL2SQ VD (CDR SDL)))))) 
(PUT 'SDL2SQ 'NUMBER-OF-ARGS 2) 
(PUT 'SDL2SQ 'DEFINED-ON-LINE '142) 
(PUT 'SDL2SQ 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'SDL2SQ 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SDL2SQ (VD SDL)
    (COND ((EQUAL (CDR VD) 1) (UNIVSDL2SQ (CAAR VD) SDL))
          (T (MULVSDL2SQ VD SDL)))) 
(PUT 'TERMORDER1 'NUMBER-OF-ARGS 2) 
(PUT 'TERMORDER1 'DEFINED-ON-LINE '147) 
(PUT 'TERMORDER1 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'TERMORDER1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE TERMORDER1 (TERM1 TERM2)
    (COND ((NULL TERM1) 0) ((AND (ZEROP TERM1) (ZEROP TERM2)) 0)
          ((ZEROP TERM1) (MINUS 1)) ((ZEROP TERM2) 1)
          ((LESSP (CAR TERM1) (CAR TERM2)) (MINUS 1))
          ((GREATERP (CAR TERM1) (CAR TERM2)) 1)
          (T (TERMORDER1 (CDR TERM1) (CDR TERM2))))) 
(PUT 'LISTSUM 'NUMBER-OF-ARGS 1) 
(PUT 'LISTSUM 'DEFINED-ON-LINE '158) 
(PUT 'LISTSUM 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'LISTSUM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE LISTSUM (L) (COND ((NULL L) 0) (T (PLUS (CAR L) (LISTSUM (CDR L)))))) 
(PUT 'TERMORDER 'NUMBER-OF-ARGS 2) 
(PUT 'TERMORDER 'DEFINED-ON-LINE '162) 
(PUT 'TERMORDER 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'TERMORDER 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE TERMORDER (TERM1 TERM2)
    (PROG (S1 S2)
      (COND ((NULL TERM1) 0) ((AND (ZEROP TERM1) (ZEROP TERM2)) 0)
            ((ZEROP TERM1) (MINUS 1)) ((ZEROP TERM2) 1))
      (SETQ S1 (LISTSUM TERM1))
      (SETQ S2 (LISTSUM TERM2))
      (RETURN
       (COND ((EQUAL S1 S2) (TERMORDER1 TERM1 TERM2)) ((LESSP S1 S2) (MINUS 1))
             (T 1))))) 
(PUT 'XXSORT 'NUMBER-OF-ARGS 1) 
(PUT 'XXSORT 'DEFINED-ON-LINE '175) 
(PUT 'XXSORT 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'XXSORT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE XXSORT (L)
    (SORT L (FUNCTION (LAMBDA (A B) (LESSP (TERMORDER (CAR A) (CAR B)) 0))))) 
(PUT 'LXSORT 'NUMBER-OF-ARGS 1) 
(PUT 'LXSORT 'DEFINED-ON-LINE '192) 
(PUT 'LXSORT 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'LXSORT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE LXSORT (L)
    (SORT L (FUNCTION (LAMBDA (A B) (LESSP (TERMORDER1 (CAR A) (CAR B)) 0))))) 
(PUT 'DELET 'NUMBER-OF-ARGS 2) 
(PUT 'DELET 'DEFINED-ON-LINE '208) 
(PUT 'DELET 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'DELET 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DELET (A L)
    (COND ((NULL A) L) ((OR (NULL L) (EQUAL A L)) NIL)
          ((EQUAL A (CAR L)) (CDR L)) (T (CONS (CAR L) (DELET A (CDR L)))))) 
(PUT 'LX2XX 'NUMBER-OF-ARGS 1) 
(PUT 'LX2XX 'DEFINED-ON-LINE '215) 
(PUT 'LX2XX 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'LX2XX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE LX2XX (SS)
    (PROG (NM CT)
      (COND
       ((OR (OR (ATOM SS) (ATOM (CAR SS)))
            (OR (ATOM (CAR SS)) (ATOM (CAR (CAR SS)))))
        (RETURN SS)))
      (SETQ NM (CADR SS))
      (SETQ CT (CDR (LASTNONDOMAIN NM)))
      (RETURN
       (CONS (CAR SS) (CONS (APPEND (XXSORT (DELET CT NM)) CT) (CDDR SS)))))) 
(PUT 'LASTNONDOMAIN 'NUMBER-OF-ARGS 1) 
(PUT 'LASTNONDOMAIN 'DEFINED-ON-LINE '223) 
(PUT 'LASTNONDOMAIN 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'LASTNONDOMAIN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE LASTNONDOMAIN (U)
    (COND ((OR (ATOM U) (ATOM (CAR U))) (ERRACH (LIST "non-domain" U)))
          ((OR (ATOM (CDR U)) (ATOM (CAR (CDR U)))) U)
          (T (LASTNONDOMAIN (CDR U))))) 
(PUT 'XX2LX 'NUMBER-OF-ARGS 1) 
(PUT 'XX2LX 'DEFINED-ON-LINE '229) 
(PUT 'XX2LX 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'XX2LX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE XX2LX (SS)
    (PROG (NM CT)
      (COND
       ((OR (OR (ATOM SS) (ATOM (CAR SS)))
            (OR (ATOM (CAR SS)) (ATOM (CAR (CAR SS)))))
        (RETURN SS)))
      (SETQ NM (CADR SS))
      (SETQ CT (CDR (LASTNONDOMAIN NM)))
      (RETURN
       (CONS (CAR SS) (CONS (APPEND (LXSORT (DELET CT NM)) CT) (CDDR SS)))))) 
(PUT 'SF2SS 'NUMBER-OF-ARGS 1) 
(PUT 'SF2SS 'DEFINED-ON-LINE '237) 
(PUT 'SF2SS 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'SF2SS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SF2SS (F)
    (PROG (VL VD)
      (COND ((OR (ATOM F) (ATOM (CAR F))) (RETURN F)))
      (SETQ VL (SEARCHPL F))
      (SETQ VD (CONS (QSORT VL) (LENGTH VL)))
      (RETURN (LX2XX (CONS VD (CONS (SQ2SSPL F VD) 1)))))) 
(PUT 'SS2SF 'NUMBER-OF-ARGS 1) 
(PUT 'SS2SF 'DEFINED-ON-LINE '245) 
(PUT 'SS2SF 'DEFINED-IN-FILE 'POLY/TDCONV.RED) 
(PUT 'SS2SF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SS2SF (S)
    (COND ((OR (ATOM S) (ATOM (CAR S))) S)
          (T (SDL2SQ (CAR S) (SDLIST (CADR (XX2LX S))))))) 
(ENDMODULE) 