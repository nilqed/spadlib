(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'VDPCOM)) 
(FLAG '(VDPPRINTMAX) 'SHARE) 
(SETQ VDPPRINTMAX (PROGN (SETQ ALGLIST* (CONS NIL NIL)) 5)) 
(DE VDPPOLY (U) (CADR (CDDR U))) 
(PUT 'VDPPOLY 'NUMBER-OF-ARGS 1) 
(PUT 'VDPPOLY 'DEFINED-ON-LINE '35) 
(PUT 'VDPPOLY 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPPOLY 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'VDPPOLY 'INLINE '(LAMBDA (U) (CADR (CDDR U)))) 
(DE VDPZERO? (U) (OR (NULL U) (NULL (CADR (CDDR U))))) 
(PUT 'VDPZERO? 'NUMBER-OF-ARGS 1) 
(PUT 'VDPZERO? 'DEFINED-ON-LINE '37) 
(PUT 'VDPZERO? 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPZERO? 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'VDPZERO? 'INLINE '(LAMBDA (U) (OR (NULL U) (NULL (CADR (CDDR U)))))) 
(DE VDPEVLMON (U) (CADR U)) 
(PUT 'VDPEVLMON 'NUMBER-OF-ARGS 1) 
(PUT 'VDPEVLMON 'DEFINED-ON-LINE '39) 
(PUT 'VDPEVLMON 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPEVLMON 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'VDPEVLMON 'INLINE '(LAMBDA (U) (CADR U))) 
(PUT 'VEVNTH 'NUMBER-OF-ARGS 2) 
(PUT 'VEVNTH 'DEFINED-ON-LINE '46) 
(PUT 'VEVNTH 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VEVNTH 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VEVNTH (A N)
    (COND ((NULL A) 0) ((EQUAL N 1) (CAR A))
          (T (VEVNTH (CDR A) (IDIFFERENCE N 1))))) 
(DE VEVZERO? (U) (OR (NULL U) (AND (EQUAL (CAR U) 0) (VEVZERO?1 (CDR U))))) 
(PUT 'VEVZERO? 'NUMBER-OF-ARGS 1) 
(PUT 'VEVZERO? 'DEFINED-ON-LINE '51) 
(PUT 'VEVZERO? 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VEVZERO? 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(PUTC 'VEVZERO? 'INLINE
      '(LAMBDA (U) (OR (NULL U) (AND (EQUAL (CAR U) 0) (VEVZERO?1 (CDR U)))))) 
(PUT 'VEVZERO?1 'NUMBER-OF-ARGS 1) 
(PUT 'VEVZERO?1 'DEFINED-ON-LINE '54) 
(PUT 'VEVZERO?1 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VEVZERO?1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE VEVZERO?1 (U)
    (OR (NULL U)
        (AND (EQUAL (CAR U) 0)
             (OR (NULL (CDR U))
                 (AND (EQUAL (CAR (CDR U)) 0) (VEVZERO?1 (CDR (CDR U)))))))) 
(PUT 'VEVEQ 'NUMBER-OF-ARGS 2) 
(PUT 'VEVEQ 'DEFINED-ON-LINE '57) 
(PUT 'VEVEQ 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VEVEQ 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VEVEQ (VEV1 VEV2)
    (COND
     ((NULL VEV1)
      (OR (NULL VEV2) (AND (EQUAL (CAR VEV2) 0) (VEVZERO?1 (CDR VEV2)))))
     ((NULL VEV2)
      (OR (NULL VEV1) (AND (EQUAL (CAR VEV1) 0) (VEVZERO?1 (CDR VEV1)))))
     (T (AND (EQUAL (CAR VEV1) (CAR VEV2)) (VEVEQUAL (CDR VEV1) VEV2))))) 
(PUT 'VEVMAPTOZERO 'NUMBER-OF-ARGS 1) 
(PUT 'VEVMAPTOZERO 'DEFINED-ON-LINE '62) 
(PUT 'VEVMAPTOZERO 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VEVMAPTOZERO 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE VEVMAPTOZERO (E) (VEVMAPTOZERO1 E NIL)) 
(PUT 'VEVMAPTOZERO1 'NUMBER-OF-ARGS 2) 
(PUT 'VEVMAPTOZERO1 'DEFINED-ON-LINE '66) 
(PUT 'VEVMAPTOZERO1 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VEVMAPTOZERO1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VEVMAPTOZERO1 (E VEV)
    (COND ((NULL E) VEV) (T (VEVMAPTOZERO1 (CDR E) (CONS 0 VEV))))) 
(PUT 'VEVMTEST? 'NUMBER-OF-ARGS 2) 
(PUT 'VEVMTEST? 'DEFINED-ON-LINE '69) 
(PUT 'VEVMTEST? 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VEVMTEST? 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VEVMTEST? (E1 E2)
    (COND ((NULL E2) T)
          ((NULL E1)
           (COND
            ((OR (NULL E2) (AND (EQUAL (CAR E2) 0) (VEVZERO?1 (CDR E2)))) T)
            (T NIL)))
          (T
           (AND (NOT (ILESSP (CAR E1) (CAR E2)))
                (VEVMTEST? (CDR E1) (CDR E2)))))) 
(PUT 'VEVLCM 'NUMBER-OF-ARGS 2) 
(PUT 'VEVLCM 'DEFINED-ON-LINE '77) 
(PUT 'VEVLCM 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VEVLCM 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VEVLCM (E1 E2)
    (PROG (X)
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND E1 E2)) (RETURN NIL)))
        (PROGN
         (SETQ X
                 (CONS
                  (COND ((IGREATERP (CAR E1) (CAR E2)) (CAR E1)) (T (CAR E2)))
                  X))
         (SETQ E1 (CDR E1))
         (SETQ E2 (CDR E2)))
        (GO WHILELABEL))
      (SETQ X (REVERSIP X))
      (COND (E1 (SETQ X (NCONC X E1))) (E2 (SETQ X (NCONC X E2))))
      (RETURN X))) 
(PUT 'VEVMIN 'NUMBER-OF-ARGS 2) 
(PUT 'VEVMIN 'DEFINED-ON-LINE '90) 
(PUT 'VEVMIN 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VEVMIN 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VEVMIN (E1 E2)
    (PROG (X)
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND E1 E2)) (RETURN NIL)))
        (PROGN
         (SETQ X
                 (CONS
                  (COND ((ILESSP (CAR E1) (CAR E2)) (CAR E1)) (T (CAR E2))) X))
         (SETQ E1 (CDR E1))
         (SETQ E2 (CDR E2)))
        (GO WHILELABEL))
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND X (EQUAL 0 (CAR X)))) (RETURN NIL)))
        (SETQ X (CDR X))
        (GO WHILELABEL))
      (RETURN (REVERSIP X)))) 
(PUT 'VEVSUM 'NUMBER-OF-ARGS 2) 
(PUT 'VEVSUM 'DEFINED-ON-LINE '99) 
(PUT 'VEVSUM 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VEVSUM 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VEVSUM (E1 E2)
    (PROG (X)
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND E1 E2)) (RETURN NIL)))
        (PROGN
         (SETQ X (CONS (IPLUS2 (CAR E1) (CAR E2)) X))
         (SETQ E1 (CDR E1))
         (SETQ E2 (CDR E2)))
        (GO WHILELABEL))
      (SETQ X (REVERSIP X))
      (COND (E1 (SETQ X (NCONC X E1))) (E2 (SETQ X (NCONC X E2))))
      (RETURN X))) 
(PUT 'VEVTDEG 'NUMBER-OF-ARGS 1) 
(PUT 'VEVTDEG 'DEFINED-ON-LINE '110) 
(PUT 'VEVTDEG 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VEVTDEG 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE VEVTDEG (U) (COND ((NULL U) 0) (T (IPLUS2 (CAR U) (VEVTDEG (CDR U)))))) 
(PUT 'VDPTDEG 'NUMBER-OF-ARGS 1) 
(PUT 'VDPTDEG 'DEFINED-ON-LINE '114) 
(PUT 'VDPTDEG 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPTDEG 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE VDPTDEG (U)
    (COND ((OR (NULL U) (NULL (CADR (CDDR U)))) 0)
          (T (MAX (VEVTDEG (CADR U)) (VDPTDEG (VDPRED U)))))) 
(PUT 'VEVDIF 'NUMBER-OF-ARGS 2) 
(PUT 'VEVDIF 'DEFINED-ON-LINE '118) 
(PUT 'VEVDIF 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VEVDIF 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VEVDIF (EE1 EE2)
    (PROG (X Y BREAK E1 E2)
      (SETQ E1 EE1)
      (SETQ E2 EE2)
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND E1 E2 (NOT BREAK))) (RETURN NIL)))
        (PROGN
         (SETQ Y (IDIFFERENCE (CAR E1) (CAR E2)))
         (SETQ X (CONS Y X))
         (SETQ BREAK (ILESSP Y 0))
         (SETQ E1 (CDR E1))
         (SETQ E2 (CDR E2)))
        (GO WHILELABEL))
      (COND
       ((OR BREAK
            (AND E2
                 (NOT
                  (OR (NULL E2)
                      (AND (EQUAL (CAR E2) 0) (VEVZERO?1 (CDR E2)))))))
        (PROGN
         (PRINT EE1)
         (PRINT EE2)
         (COND ((GETD 'BACKTRACE) (BACKTRACE)))
         (RETURN (RERROR 'DIPOLY 5 "Vevdif, difference would be < 0")))))
      (RETURN (NCONC (REVERSIP X) E1)))) 
(PUT 'VDPENUMERATE 'NUMBER-OF-ARGS 1) 
(PUT 'VDPENUMERATE 'DEFINED-ON-LINE '137) 
(PUT 'VDPENUMERATE 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPENUMERATE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE VDPENUMERATE (F)
    (COND ((OR (NULL F) (NULL (CADR (CDDR F)))) F)
          (T
           (PROGN
            (SETQ F F)
            (COND
             ((NOT (VDPGETPROP F 'NUMBER))
              (SETQ F
                      (VDPPUTPROP F 'NUMBER
                       (SETQ PCOUNT* (IPLUS2 PCOUNT* 1))))))
            F)))) 
(PUT 'GSUGAR 'NUMBER-OF-ARGS 1) 
(PUT 'GSUGAR 'DEFINED-ON-LINE '150) 
(PUT 'GSUGAR 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'GSUGAR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE GSUGAR (P)
    (COND
     (*GSUGAR
      ((LAMBDA (S)
         (OR S
             (PROGN
              (PRINT (LIST "*** missing sugar" P))
              (BACKTRACE)
              (SETQ S (VDPTDEG P))
              (GSETSUGAR P S)
              S)))
       (COND ((OR (NULL P) (NULL (CADR (CDDR P)))) 0)
             (T (VDPGETPROP P 'SUGAR))))))) 
(PUT 'GSETSUGAR 'NUMBER-OF-ARGS 2) 
(PUT 'GSETSUGAR 'DEFINED-ON-LINE '157) 
(PUT 'GSETSUGAR 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'GSETSUGAR 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE GSETSUGAR (P S)
    (OR (AND *GSUGAR (VDPPUTPROP P 'SUGAR (OR S (VDPTDEG P)))) P)) 
(PUT 'VDPMEMBER 'NUMBER-OF-ARGS 2) 
(PUT 'VDPMEMBER 'DEFINED-ON-LINE '165) 
(PUT 'VDPMEMBER 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPMEMBER 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VDPMEMBER (P1 L)
    (COND ((NULL L) NIL) ((VDPEQUAL P1 (CAR L)) L) (T (VDPMEMBER P1 (CDR L))))) 
(PUT 'VDPUNION 'NUMBER-OF-ARGS 2) 
(PUT 'VDPUNION 'DEFINED-ON-LINE '170) 
(PUT 'VDPUNION 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPUNION 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VDPUNION (S1 S2)
    (COND ((NULL S1) S2) ((VDPMEMBER (CAR S1) S2) (VDPUNION (CDR S1) S2))
          (T (CONS (CAR S1) (VDPUNION (CDR S1) S2))))) 
(PUT 'VDPINTERSECTION 'NUMBER-OF-ARGS 2) 
(PUT 'VDPINTERSECTION 'DEFINED-ON-LINE '177) 
(PUT 'VDPINTERSECTION 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPINTERSECTION 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VDPINTERSECTION (S1 S2)
    (COND ((NULL S1) NIL)
          ((VDPMEMBER (CAR S1) S2) (CONS (CAR S1) (VDPUNION (CDR S1) S2)))
          (T (VDPUNION (CDR S1) S2)))) 
(PUT 'VDPSETEQUAL? 'NUMBER-OF-ARGS 2) 
(PUT 'VDPSETEQUAL? 'DEFINED-ON-LINE '184) 
(PUT 'VDPSETEQUAL? 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPSETEQUAL? 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VDPSETEQUAL? (S1 S2)
    (COND ((NOT (EQUAL (LENGTH S1) (LENGTH S2))) NIL)
          (T (VDPSETEQUAL?1 S1 (APPEND S2 NIL))))) 
(PUT 'VDPSETEQUAL?1 'NUMBER-OF-ARGS 2) 
(PUT 'VDPSETEQUAL?1 'DEFINED-ON-LINE '189) 
(PUT 'VDPSETEQUAL?1 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPSETEQUAL?1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VDPSETEQUAL?1 (S1 S2)
    (COND ((AND (NULL S1) (NULL S2)) T) ((OR (NULL S1) (NULL S2)) NIL)
          (T
           ((LAMBDA (HUGO)
              (COND (HUGO (VDPSETEQUAL?1 (CDR S1) (GROEDELETIP (CAR HUGO) S2)))
                    (T NIL)))
            (VDPMEMBER (CAR S1) S2))))) 
(PUT 'VDPSORTEDSETEQUAL? 'NUMBER-OF-ARGS 2) 
(PUT 'VDPSORTEDSETEQUAL? 'DEFINED-ON-LINE '196) 
(PUT 'VDPSORTEDSETEQUAL? 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPSORTEDSETEQUAL? 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VDPSORTEDSETEQUAL? (S1 S2)
    (COND ((AND (NULL S1) (NULL S2)) T) ((OR (NULL S1) (NULL S2)) NIL)
          ((VDPEQUAL (CAR S1) (CAR S2)) (VDPSORTEDSETEQUAL? (CDR S1) (CDR S2)))
          (T NIL))) 
(PUT 'VDPDISJOINT? 'NUMBER-OF-ARGS 2) 
(PUT 'VDPDISJOINT? 'DEFINED-ON-LINE '203) 
(PUT 'VDPDISJOINT? 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPDISJOINT? 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VDPDISJOINT? (S1 S2)
    (COND ((NULL S1) T) ((VDPMEMBER (CAR S1) S2) NIL)
          (T (VDPDISJOINT? (CDR S1) S2)))) 
(PUT 'VDPSUBSET? 'NUMBER-OF-ARGS 2) 
(PUT 'VDPSUBSET? 'DEFINED-ON-LINE '209) 
(PUT 'VDPSUBSET? 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPSUBSET? 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VDPSUBSET? (S1 S2)
    (AND (NOT (GREATERP (LENGTH S1) (LENGTH S2))) (VDPSUBSET?1 S1 S2))) 
(PUT 'VDPSUBSET?1 'NUMBER-OF-ARGS 2) 
(PUT 'VDPSUBSET?1 'DEFINED-ON-LINE '212) 
(PUT 'VDPSUBSET?1 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPSUBSET?1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VDPSUBSET?1 (S1 S2)
    (COND ((NULL S1) T) ((VDPMEMBER (CAR S1) S2) (VDPSUBSET?1 (CDR S1) S2))
          (T NIL))) 
(PUT 'VDPDELETEMEMBER 'NUMBER-OF-ARGS 2) 
(PUT 'VDPDELETEMEMBER 'DEFINED-ON-LINE '218) 
(PUT 'VDPDELETEMEMBER 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPDELETEMEMBER 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VDPDELETEMEMBER (P L)
    (COND ((NULL L) NIL) ((VDPEQUAL P (CAR L)) (VDPDELETEMEMBER P (CDR L)))
          (T (CONS (CAR L) (VDPDELETEMEMBER P (CDR L)))))) 
(PUT 'VDPLSORT 'NUMBER-OF-ARGS 1) 
(PUT 'VDPLSORT 'DEFINED-ON-LINE '229) 
(PUT 'VDPLSORT 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPLSORT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE VDPLSORT (PL) (SORT PL (FUNCTION VDPVEVLCOMP))) 
(PUT 'VDPLSORTIN 'NUMBER-OF-ARGS 2) 
(PUT 'VDPLSORTIN 'DEFINED-ON-LINE '235) 
(PUT 'VDPLSORTIN 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPLSORTIN 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VDPLSORTIN (P PL)
    (COND ((NULL PL) (LIST P)) (T (PROGN (VDPLSORTIN1 P PL PL) PL)))) 
(PUT 'VDPLSORTIN1 'NUMBER-OF-ARGS 3) 
(PUT 'VDPLSORTIN1 'DEFINED-ON-LINE '241) 
(PUT 'VDPLSORTIN1 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPLSORTIN1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE VDPLSORTIN1 (P PL OLDPL)
    (COND ((NULL PL) (SETCDR OLDPL (CONS P NIL)))
          ((EQUAL 1 (EVCOMP (CADR (CAR PL)) (CADR P)))
           (VDPLSORTIN1 P (CDR PL) PL))
          (T (PROGN (SETCDR PL (CONS (CAR PL) (CDR PL))) (SETCAR PL P))))) 
(PUT 'VDPLSORTINREPLACING 'NUMBER-OF-ARGS 2) 
(PUT 'VDPLSORTINREPLACING 'DEFINED-ON-LINE '247) 
(PUT 'VDPLSORTINREPLACING 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPLSORTINREPLACING 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VDPLSORTINREPLACING (PO PL)
    (PROG (OOPL OPL)
      (COND (PL (GO BB)))
     AA
      (RETURN (CONS PO NIL))
     BB
      (COND
       ((VEVMTEST? (CADR (CAR PL)) (CADR PO))
        (PROGN (SETQ PL (CDR PL)) (COND ((NULL PL) (GO AA))) (GO BB))))
      (SETQ OPL PL)
     CC
      (COND
       ((NULL PL)
        (PROGN
         (SETQ OOPL (LASTPAIR OPL))
         (SETCDR OOPL (CONS PO NIL))
         (RETURN OPL))))
      (COND
       ((AND (NOT (EQ PL OPL)) (VEVMTEST? (CADR (CAR PL)) (CADR PO)))
        (PROGN
         (COND
          ((NULL (CDR PL))
           (PROGN (SETQ OOPL (LASTPAIR1 OPL)) (SETCDR OOPL NIL) (SETQ PL NIL)))
          (T (PROGN (SETCAR PL (CADR PL)) (SETCDR PL (CDDR PL)))))
         (GO CC))))
      (COND
       ((EQUAL 1 (EVCOMP (CADR (CAR PL)) (CADR PO)))
        (PROGN (SETQ PL (CDR PL)) (GO CC))))
      (SETCDR PL (CONS (CAR PL) (CDR PL)))
      (SETCAR PL PO)
      (RETURN OPL))) 
(PUT 'LASTPAIR1 'NUMBER-OF-ARGS 1) 
(PUT 'LASTPAIR1 'DEFINED-ON-LINE '270) 
(PUT 'LASTPAIR1 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'LASTPAIR1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE LASTPAIR1 (OPL)
    (COND ((OR (NULL OPL) (NULL (CDR OPL))) T)
          (T
           (PROGN
            (PROG ()
             WHILELABEL
              (COND ((NOT (CDDR OPL)) (RETURN NIL)))
              (SETQ OPL (CDR OPL))
              (GO WHILELABEL))
            OPL)))) 
(PUT 'COUNTLASTVAR 'NUMBER-OF-ARGS 2) 
(PUT 'COUNTLASTVAR 'DEFINED-ON-LINE '277) 
(PUT 'COUNTLASTVAR 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'COUNTLASTVAR 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE COUNTLASTVAR (A M)
    (PROG (N NN)
      (SETQ N 0)
      (SETQ NN 0)
      (SETQ A (CADR (CDDR A)))
     AA
      (COND ((ATOM A) (RETURN N)))
      (SETQ NN (IPLUS2 NN 1))
      (COND ((IGREATERP NN 25) (RETURN 0)))
      (SETQ N (IPLUS2 N 1))
      (COND
       ((ILESSP (COUNTLASTVAR1 (CAR A)) 1)
        (COND (M (RETURN 0)) (T (SETQ N 0)))))
      (SETQ A (CDDR A))
      (GO AA))) 
(PUT 'COUNTLASTVAR1 'NUMBER-OF-ARGS 1) 
(PUT 'COUNTLASTVAR1 'DEFINED-ON-LINE '289) 
(PUT 'COUNTLASTVAR1 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'COUNTLASTVAR1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE COUNTLASTVAR1 (B)
    (PROG (N)
      (SETQ N 1)
     AA
      (COND ((ATOM B) (RETURN 0)) ((EQUAL N VDPLASTVAR*) (RETURN (CAR B))))
      (SETQ B (CDR B))
      (SETQ N (IPLUS2 N 1))
      (GO AA))) 
(PUT 'VDPPUTPROP 'NUMBER-OF-ARGS 3) 
(PUT 'VDPPUTPROP 'DEFINED-ON-LINE '299) 
(PUT 'VDPPUTPROP 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPPUTPROP 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE VDPPUTPROP (POLY PROP VAL)
    (PROG (C P)
      (COND
       ((OR (NOT (PAIRP POLY)) (NOT (PAIRP (SETQ C (CDR POLY))))
            (NOT (PAIRP (SETQ C (CDR C)))) (NOT (PAIRP (SETQ C (CDR C))))
            (NOT (PAIRP (SETQ C (CDR C)))))
        (RERROR 'DIPOLY 6
                (LIST "vdpputprop given a non-vdp as 1st parameter" POLY PROP
                      VAL))))
      (SETQ P (ASSOC PROP (CAR C)))
      (COND (P (RPLACD P VAL)) (T (RPLACA C (CONS (CONS PROP VAL) (CAR C)))))
      (RETURN POLY))) 
(PUT 'VDPGETPROP 'NUMBER-OF-ARGS 2) 
(PUT 'VDPGETPROP 'DEFINED-ON-LINE '309) 
(PUT 'VDPGETPROP 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPGETPROP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VDPGETPROP (POLY PROP)
    (COND ((NULL POLY) NIL)
          ((NOT (EQCAR POLY 'VDP))
           (RERROR 'DIPOLY 7
                   (LIST "vdpgetprop given a non-vdp as 1st parameter" POLY
                         PROP)))
          (T
           ((LAMBDA (P) (COND (P (CDR P)) (T NIL)))
            (ASSOC PROP (CADR (CDDDR POLY))))))) 
(PUT 'VDPREMALLPROPS 'NUMBER-OF-ARGS 1) 
(PUT 'VDPREMALLPROPS 'DEFINED-ON-LINE '318) 
(PUT 'VDPREMALLPROPS 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPREMALLPROPS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE VDPREMALLPROPS (U)
    (PROG (C)
      (COND
       ((NOT
         (OR (NOT (PAIRP U)) (NOT (PAIRP (SETQ C (CDR U))))
             (NOT (PAIRP (SETQ C (CDR C)))) (NOT (PAIRP (SETQ C (CDR C))))
             (NOT (PAIRP (SETQ C (CDR C))))))
        (RPLACA C NIL)))
      (RETURN U))) 
(FLUID '(*SUB2)) 
(PUT 'GROEBSUBS2 'NUMBER-OF-ARGS 1) 
(PUT 'GROEBSUBS2 'DEFINED-ON-LINE '331) 
(PUT 'GROEBSUBS2 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'GROEBSUBS2 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE GROEBSUBS2 (Q) ((LAMBDA (*SUB2) (SUBS2 Q)) T)) 
(PUT 'VDPPRINTSHORT 'NUMBER-OF-ARGS 1) 
(PUT 'VDPPRINTSHORT 'DEFINED-ON-LINE '338) 
(PUT 'VDPPRINTSHORT 'DEFINED-IN-FILE 'DIPOLY/VDPCOM.RED) 
(PUT 'VDPPRINTSHORT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE VDPPRINTSHORT (U)
    (PROG (M)
      (SETQ M VDPPRINTMAX)
      (SETQ VDPPRINTMAX (PROGN (SETQ ALGLIST* (CONS NIL NIL)) 2))
      (VDPPRINT U)
      (SETQ VDPPRINTMAX (PROGN (SETQ ALGLIST* (CONS NIL NIL)) M)))) 
(ENDMODULE) 