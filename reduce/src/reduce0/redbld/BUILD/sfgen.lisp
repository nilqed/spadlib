(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'SFGEN)) 
(EXPORTS (LIST 'SQ2BF* 'SF*EVAL)) 
(PUT 'SF*ASSOC 'NUMBER-OF-ARGS 3) 
(PUT 'SF*ASSOC 'DEFINED-ON-LINE '32) 
(PUT 'SF*ASSOC 'DEFINED-IN-FILE 'SPECFN/SFGEN.RED) 
(PUT 'SF*ASSOC 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE SF*ASSOC (COMPARE VAL ALIST)
    (COND ((NULL ALIST) NIL)
          ((NOT (APPLY2 COMPARE (CAR (CAR ALIST)) VAL)) (CAR ALIST))
          (T (SF*ASSOC COMPARE VAL (CDR ALIST))))) 
(PUT 'SF*MULTI*ASSOC*COMPARATOR 'NUMBER-OF-ARGS 3) 
(PUT 'SF*MULTI*ASSOC*COMPARATOR 'DEFINED-ON-LINE '38) 
(PUT 'SF*MULTI*ASSOC*COMPARATOR 'DEFINED-IN-FILE 'SPECFN/SFGEN.RED) 
(PUT 'SF*MULTI*ASSOC*COMPARATOR 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE SF*MULTI*ASSOC*COMPARATOR (COMPARE VALS ENTRY)
    (COND ((NULL ENTRY) (NULL VALS))
          (T
           (AND (NOT (NULL VALS)) (APPLY2 COMPARE (CAR VALS) (CAR ENTRY))
                (SF*MULTI*ASSOC*COMPARATOR COMPARE (CDR VALS) (CDR ENTRY)))))) 
(PUT 'SF*MULTI*ASSOC 'NUMBER-OF-ARGS 3) 
(PUT 'SF*MULTI*ASSOC 'DEFINED-ON-LINE '45) 
(PUT 'SF*MULTI*ASSOC 'DEFINED-IN-FILE 'SPECFN/SFGEN.RED) 
(PUT 'SF*MULTI*ASSOC 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE SF*MULTI*ASSOC (COMPARE VALS ALIST)
    (COND ((NULL ALIST) NIL)
          ((SF*MULTI*ASSOC*COMPARATOR COMPARE VALS (CAR (CAR ALIST)))
           (CAR ALIST))
          (T (SF*MULTI*ASSOC COMPARE VALS (CDR ALIST))))) 
(PUT 'SF*DO*EVAL 'NUMBER-OF-ARGS 1) 
(PUT 'SF*DO*EVAL 'DEFINED-ON-LINE '51) 
(PUT 'SF*DO*EVAL 'DEFINED-IN-FILE 'SPECFN/SFGEN.RED) 
(PUT 'SF*DO*EVAL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SF*DO*EVAL (EXPRESSION)
    (PROG (PREPRE RESULT)
      (SETQ PREPRE (PRECISION 0))
      (PRECISION (PLUS PREPRE 3))
      (SETQ RESULT (REVAL1 EXPRESSION NIL))
      (PRECISION PREPRE)
      (RETURN RESULT))) 
(PUT 'SF*EVAL 'NUMBER-OF-ARGS 2) 
(PUT 'SF*EVAL 'DEFINED-ON-LINE '66) 
(PUT 'SF*EVAL 'DEFINED-IN-FILE 'SPECFN/SFGEN.RED) 
(PUT 'SF*EVAL 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SF*EVAL (NAME ARGS)
    (PROG (PART1 PART2 RESULT)
      (SETQ ARGS (CDR ARGS))
      (SETQ PART1 (GET NAME 'SF-ALIST))
      (COND
       ((AND PART1 (SETQ PART1 (ATSOC *COMPLEX PART1)))
        (COND
         ((SETQ PART2 (SF*ASSOC 'LESSP |:BPREC:| (CDR PART1)))
          (COND
           ((SETQ RESULT (SF*MULTI*ASSOC 'EVALEQUAL ARGS (CDR PART2)))
            (SETQ RESULT (CDR RESULT)))
           (T
            (PROGN
             (SETQ RESULT (SF*DO*EVAL (CONS NAME ARGS)))
             (COND
              (*SAVESFS
               (SETCDR PART2 (CONS (CONS ARGS RESULT) (CDR PART2)))))))))
         (T
          (PROGN
           (SETQ RESULT (SF*DO*EVAL (CONS NAME ARGS)))
           (COND
            (*SAVESFS
             (SETCDR PART1
                     (CONS (LIST |:BPREC:| (CONS ARGS RESULT))
                           (CDR PART1)))))))))
       (T
        (PROGN
         (SETQ RESULT (SF*DO*EVAL (CONS NAME ARGS)))
         (COND
          (*SAVESFS
           (PUT NAME 'SF-ALIST
                (CONS (LIST *COMPLEX (LIST |:BPREC:| (CONS ARGS RESULT)))
                      (GET 'NAME 'SF-ALIST))))))))
      (RETURN RESULT))) 
(ENDMODULE) 