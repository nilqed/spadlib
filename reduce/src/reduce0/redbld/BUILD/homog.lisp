(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'HOMOG)) 
(PUT 'HOMOGP 'NUMBER-OF-ARGS 1) 
(PUT 'HOMOGP 'DEFINED-ON-LINE '32) 
(PUT 'HOMOGP 'DEFINED-IN-FILE 'POLY/HOMOG.RED) 
(PUT 'HOMOGP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE HOMOGP (S)
    (COND
     ((OR (OR (ATOM S) (ATOM (CAR S)))
          (OR (ATOM (CAR S)) (ATOM (CAR (CAR S)))))
      NIL)
     ((NULL (CDADR S)) NIL)
     (((LAMBDA (U) (OR (ATOM U) (ATOM (CAR U))))
       (CDR (LASTNONDOMAIN (CADR S))))
      NIL)
     ((EQUAL (LISTSUM (CAAADR S)) (LISTSUM (CAAR (LASTNONDOMAIN (CADR S))))) T)
     (T NIL))) 
(PUT 'SUBS0 'NUMBER-OF-ARGS 1) 
(PUT 'SUBS0 'DEFINED-ON-LINE '41) 
(PUT 'SUBS0 'DEFINED-IN-FILE 'POLY/HOMOG.RED) 
(PUT 'SUBS0 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SUBS0 (NM)
    (COND ((NULL NM) NIL)
          (T (CONS (CONS (CONS 0 (CDAAR NM)) (CDAR NM)) (SUBS0 (CDR NM)))))) 
(PUT 'VARSS 'NUMBER-OF-ARGS 2) 
(PUT 'VARSS 'DEFINED-ON-LINE '46) 
(PUT 'VARSS 'DEFINED-IN-FILE 'POLY/HOMOG.RED) 
(PUT 'VARSS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE VARSS (V D)
    (CONS (CONS (CONS V NIL) 1) (CONS (CONS (CONS (CONS D NIL) 1) NIL) 1))) 
(PUT 'RCONSTNM 'NUMBER-OF-ARGS 3) 
(PUT 'RCONSTNM 'DEFINED-ON-LINE '50) 
(PUT 'RCONSTNM 'DEFINED-IN-FILE 'POLY/HOMOG.RED) 
(PUT 'RCONSTNM 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE RCONSTNM (NM NV TD)
    (COND ((NULL NM) NIL)
          ((OR (ATOM NM) (ATOM (CAR NM)))
           (CONS (CONS (CONS TD (MKZL (PLUS NV 1))) NM) NIL))
          (T
           (CONS
            (CONS (CONS (DIFFERENCE TD (LISTSUM (CAAR NM))) (CAAR NM))
                  (CDAR NM))
            (RCONSTNM (CDR NM) NV TD))))) 
(PUT 'RCONST1 'NUMBER-OF-ARGS 3) 
(PUT 'RCONST1 'DEFINED-ON-LINE '57) 
(PUT 'RCONST1 'DEFINED-IN-FILE 'POLY/HOMOG.RED) 
(PUT 'RCONST1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE RCONST1 (S V TD)
    (COND ((HOMOGP S) S)
          (T
           (CONS (CONS (CONS V (CAAR S)) (PLUS (CDAR S) 1))
                 (CONS (REVERSE (RCONSTNM (CADR S) (CDAR S) TD)) (CDDR S)))))) 
(PUT 'RCONST 'NUMBER-OF-ARGS 2) 
(PUT 'RCONST 'DEFINED-ON-LINE '63) 
(PUT 'RCONST 'DEFINED-IN-FILE 'POLY/HOMOG.RED) 
(PUT 'RCONST 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE RCONST (P FCTRLIS)
    (PROG (V D TD FS FCF FFL X)
      (SETQ V (CAR P))
      (SETQ D (CDR P))
      (SETQ FCF (CAR FCTRLIS))
      (PROG (I)
        (SETQ I 2)
       LAB
        (COND ((MINUSP (DIFFERENCE (LENGTH FCTRLIS) I)) (RETURN NIL)))
        (PROGN
         (SETQ X (NTH FCTRLIS I))
         (SETQ FS (SF2SS (CAR X)))
         (SETQ TD (LISTSUM (CAAADR FS)))
         (SETQ FS (RCONST1 FS V TD))
         (SETQ D (DIFFERENCE D (TIMES (CDR X) TD)))
         (SETQ FFL (ACONC FFL (CONS (SS2SF FS) (CDR X)))))
        (SETQ I (PLUS2 I 1))
        (GO LAB))
      (SETQ FFL (CONS FCF FFL))
      (COND
       ((GREATERP D 0) (SETQ FFL (ACONC FFL (CONS (SS2SF (VARSS V 1)) D)))))
      (RETURN FFL))) 
(ENDMODULE) 