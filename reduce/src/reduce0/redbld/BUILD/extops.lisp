(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'EXTOPS)) 
(PUT '*SF2EX 'NUMBER-OF-ARGS 2) 
(PUT '*SF2EX 'DEFINED-ON-LINE '39) 
(PUT '*SF2EX 'DEFINED-IN-FILE 'MATRIX/EXTOPS.RED) 
(PUT '*SF2EX 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE *SF2EX (U V)
    (COND ((NULL U) NIL)
          ((OR (OR (ATOM U) (ATOM (CAR U))) (NULL (MEMQ (CAAAR U) V)))
           (CONS (CONS (LIST NIL) U) NIL))
          (T (CONS (CONS (LIST (CAAAR U)) (CDAR U)) (*SF2EX (CDR U) V))))) 
(PUT '*EX2SF 'NUMBER-OF-ARGS 1) 
(PUT '*EX2SF 'DEFINED-ON-LINE '46) 
(PUT '*EX2SF 'DEFINED-IN-FILE 'MATRIX/EXTOPS.RED) 
(PUT '*EX2SF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE *EX2SF (U)
    (COND ((NULL U) NIL) ((EQUAL (CAR (CAAR U)) NIL) (SUBS2CHK (CDAR U)))
          (T
           (CONS (CONS (CONS (CAR (CAAR U)) 1) (SUBS2CHK (CDAR U)))
                 (*EX2SF (CDR U)))))) 
(PUT 'EXTMULT 'NUMBER-OF-ARGS 2) 
(PUT 'EXTMULT 'DEFINED-ON-LINE '68) 
(PUT 'EXTMULT 'DEFINED-IN-FILE 'MATRIX/EXTOPS.RED) 
(PUT 'EXTMULT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE EXTMULT (U V)
    (PROG (STACK X W R)
     TOP
      (COND ((OR (NULL U) (NULL V)) (PROGN (SETQ R NIL) (GO EXIT))))
      (SETQ STACK (CONS (CONS U V) STACK))
      (COND ((CDR U) (SETQ U (LIST (CAR U)))))
      (SETQ V (CDR V))
      (GO TOP)
     EXIT
      (PROG ()
       WHILELABEL
        (COND ((NOT STACK) (RETURN NIL)))
        (PROGN
         (SETQ U (CAAR STACK))
         (SETQ V (CDAR STACK))
         (SETQ STACK (CDR STACK))
         (SETQ X (ORDEXN (CAR (CAAR U)) (CAAR V)))
         (COND
          (X
           (PROGN
            (SETQ W (|C:SUBS2MULTF| (CDAR U) (CDAR V)))
            (COND ((CAR X) (SETQ W (NEGF W))))
            (SETQ R (CONS (CONS (CDR X) W) (EXTADD R (EXTMULT (CDR U) V))))))
          (T (SETQ R (EXTADD (EXTMULT (CDR U) V) R)))))
        (GO WHILELABEL))
      (RETURN R))) 
(PUT 'EXTADD 'NUMBER-OF-ARGS 2) 
(PUT 'EXTADD 'DEFINED-ON-LINE '94) 
(PUT 'EXTADD 'DEFINED-IN-FILE 'MATRIX/EXTOPS.RED) 
(PUT 'EXTADD 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE EXTADD (U V)
    (COND ((NULL U) V) ((NULL V) U)
          (T
           (PROG (S W Z)
             (SETQ S (SETQ Z (CONS NIL NIL)))
             (PROG ()
              WHILELABEL
               (COND ((NOT (AND U V)) (RETURN NIL)))
               (COND
                ((EQUAL (CAAR V) (CAAR U))
                 (PROGN
                  (COND
                   ((SETQ W (ADDF (CDAR U) (CDAR V)))
                    (PROGN
                     (SETCDR Z (CONS (CONS (CAAR U) W) NIL))
                     (SETQ Z (CDR Z)))))
                  (SETQ U (CDR U))
                  (SETQ V (CDR V))))
                ((ORDEXP (CAAR V) (CAAR U))
                 (PROGN
                  (SETCDR Z (CONS (CAR V) NIL))
                  (SETQ V (CDR V))
                  (SETQ Z (CDR Z))))
                (T
                 (PROGN
                  (SETCDR Z (CONS (CAR U) NIL))
                  (SETQ U (CDR U))
                  (SETQ Z (CDR Z)))))
               (GO WHILELABEL))
             (SETCDR Z (COND (U U) (T V)))
             (RETURN (CDR S)))))) 
(PUT 'ORDEXP 'NUMBER-OF-ARGS 2) 
(PUT 'ORDEXP 'DEFINED-ON-LINE '117) 
(PUT 'ORDEXP 'DEFINED-IN-FILE 'MATRIX/EXTOPS.RED) 
(PUT 'ORDEXP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE ORDEXP (U V)
    (COND ((NULL U) T) ((EQ (CAR U) (CAR V)) (ORDEXP (CDR U) (CDR V)))
          ((NULL (CAR U)) NIL) ((NULL (CAR V)) T) (T (ORDOP (CAR U) (CAR V))))) 
(PUT 'ORDEXN 'NUMBER-OF-ARGS 2) 
(PUT 'ORDEXN 'DEFINED-ON-LINE '124) 
(PUT 'ORDEXN 'DEFINED-IN-FILE 'MATRIX/EXTOPS.RED) 
(PUT 'ORDEXN 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE ORDEXN (U V)
    (PROG (S X)
     A
      (COND ((NULL V) (RETURN (CONS S (REVERSE (CONS U X)))))
            ((EQ U (CAR V)) (RETURN NIL))
            ((AND U (ORDOP U (CAR V)))
             (RETURN (CONS S (APPEND (REVERSE (CONS U X)) V))))
            (T
             (PROGN
              (SETQ X (CONS (CAR V) X))
              (SETQ V (CDR V))
              (SETQ S (NOT S)))))
      (GO A))) 
(PUT 'QUOTEXF* 'NUMBER-OF-ARGS 2) 
(PUT 'QUOTEXF* 'DEFINED-ON-LINE '139) 
(PUT 'QUOTEXF* 'DEFINED-IN-FILE 'MATRIX/EXTOPS.RED) 
(PUT 'QUOTEXF* 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QUOTEXF* (U V)
    (COND ((NULL U) NIL)
          (T
           (CONS (CONS (CAAR U) (QUOTFEXF*1 (CDAR U) V))
                 (QUOTEXF* (CDR U) V))))) 
(PUT 'QUOTFEXF*1 'NUMBER-OF-ARGS 2) 
(PUT 'QUOTFEXF*1 'DEFINED-ON-LINE '145) 
(PUT 'QUOTFEXF*1 'DEFINED-IN-FILE 'MATRIX/EXTOPS.RED) 
(PUT 'QUOTFEXF*1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE QUOTFEXF*1 (U V)
    (COND ((NULL U) NIL)
          (T
           ((LAMBDA (X)
              (COND (X X)
                    (T
                     ((LAMBDA (Y)
                        (COND ((EQUAL (CDR Y) 1) (CAR Y))
                              ((EQUAL
                                (CDR
                                 (SETQ Y
                                         ((LAMBDA (*RATIONALIZE)
                                            (RATIONALIZESQ Y))
                                          T)))
                                1)
                               (CAR Y))
                              (T
                               (RERROR 'MATRIX 11
                                       "Catastrophic division failure"))))
                      (RATIONALIZESQ (CONS U V))))))
            ((LAMBDA (*EXP) (QUOTF1 U V)) T))))) 
(PUT 'NEGEX 'NUMBER-OF-ARGS 1) 
(PUT 'NEGEX 'DEFINED-ON-LINE '159) 
(PUT 'NEGEX 'DEFINED-IN-FILE 'MATRIX/EXTOPS.RED) 
(PUT 'NEGEX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE NEGEX (U)
    (COND ((NULL U) NIL)
          (T (CONS (CONS (CAAR U) (NEGF (CDAR U))) (NEGEX (CDR U)))))) 
(PUT 'SPLITUP 'NUMBER-OF-ARGS 2) 
(PUT 'SPLITUP 'DEFINED-ON-LINE '164) 
(PUT 'SPLITUP 'DEFINED-IN-FILE 'MATRIX/EXTOPS.RED) 
(PUT 'SPLITUP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SPLITUP (U V)
    (COND ((NULL U) (LIST NIL NIL))
          (((LAMBDA (X) (OR (NULL X) (MEMQ X V))) (CAR (CAAR U))) (LIST NIL U))
          (T
           ((LAMBDA (X) (LIST (CONS (CAR U) (CAR X)) (CADR X)))
            (SPLITUP (CDR U) V))))) 
(PUT 'INNPRODPEX 'NUMBER-OF-ARGS 2) 
(PUT 'INNPRODPEX 'DEFINED-ON-LINE '173) 
(PUT 'INNPRODPEX 'DEFINED-IN-FILE 'MATRIX/EXTOPS.RED) 
(PUT 'INNPRODPEX 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE INNPRODPEX (V U)
    (COND ((NULL U) NIL)
          (T
           ((LAMBDA (X)
              (COND
               (X
                (CONS
                 (CONS (CDR X) (COND ((CAR X) (NEGF (CDAR U))) (T (CDAR U))))
                 (INNPRODPEX V (CDR U))))
               (T (INNPRODPEX V (CDR U)))))
            (INNPRODP2 V (CAAR U)))))) 
(PUT 'INNPRODP2 'NUMBER-OF-ARGS 2) 
(PUT 'INNPRODP2 'DEFINED-ON-LINE '183) 
(PUT 'INNPRODP2 'DEFINED-IN-FILE 'MATRIX/EXTOPS.RED) 
(PUT 'INNPRODP2 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE INNPRODP2 (V U)
    (PROG ()
      (SETQ U (CONS NIL U))
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND V U)) (RETURN NIL)))
        (PROGN
         (SETQ U (INNPRODKP NIL (CAR V) (CDR U) (CAR U)))
         (SETQ V (CDR V)))
        (GO WHILELABEL))
      (RETURN U))) 
(PUT 'INNPRODKP 'NUMBER-OF-ARGS 4) 
(PUT 'INNPRODKP 'DEFINED-ON-LINE '196) 
(PUT 'INNPRODKP 'DEFINED-IN-FILE 'MATRIX/EXTOPS.RED) 
(PUT 'INNPRODKP 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE INNPRODKP (W V U S)
    (COND ((NULL U) NIL) ((EQUAL V (CAR U)) (CONS S (REVERSIP2 W (CDR U))))
          (T (INNPRODKP (CONS (CAR U) W) V (CDR U) (NOT S))))) 
(PUT 'SUBS2CHKEX 'NUMBER-OF-ARGS 1) 
(PUT 'SUBS2CHKEX 'DEFINED-ON-LINE '207) 
(PUT 'SUBS2CHKEX 'DEFINED-IN-FILE 'MATRIX/EXTOPS.RED) 
(PUT 'SUBS2CHKEX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SUBS2CHKEX (U)
    (COND ((NULL U) NIL)
          (T
           ((LAMBDA (X)
              (COND (X (CONS (CONS (CAAR U) X) (CDR U)))
                    (T (SUBS2CHKEX (CDR U)))))
            (SUBS2CHK (CDAR U)))))) 
(PUT 'SUBS2CHK 'NUMBER-OF-ARGS 1) 
(PUT 'SUBS2CHK 'DEFINED-ON-LINE '215) 
(PUT 'SUBS2CHK 'DEFINED-IN-FILE 'MATRIX/EXTOPS.RED) 
(PUT 'SUBS2CHK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SUBS2CHK (U)
    (PROG (X)
      (COND
       ((AND SUBFG* (EQUAL (CDR (SETQ X (SUBS2F U))) 1)) (SETQ U (CAR X))))
      (RETURN U))) 
(ENDMODULE) 