(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'LOOPS)) 
(FLUID '(*BLOCKP)) 
(GLOBAL '(CURSYM*)) 
(PUT 'REPEATSTAT 'NUMBER-OF-ARGS 0) 
(PUT 'REPEATSTAT 'DEFINED-ON-LINE '39) 
(PUT 'REPEATSTAT 'DEFINED-IN-FILE 'RLISP/LOOPS.RED) 
(PUT 'REPEATSTAT 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE REPEATSTAT NIL
    (PROG (*BLOCKP BODY BOOL)
      (COND ((FLAGP 'UNTIL 'DELIM) (SETQ BOOL T)) (T (FLAG '(UNTIL) 'DELIM)))
      (SETQ BODY (XREAD T))
      (COND ((NOT BOOL) (REMFLAG '(UNTIL) 'DELIM)))
      (COND ((NOT (EQUAL CURSYM* 'UNTIL)) (SYMERR 'REPEAT T)))
      (RETURN (LIST 'REPEAT BODY (XREAD T))))) 
(PUT 'REPEAT 'DEFINED-ON-LINE '49) 
(PUT 'REPEAT 'DEFINED-IN-FILE 'RLISP/LOOPS.RED) 
(PUT 'REPEAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DM REPEAT (U)
    (PROG (BODY BOOL LAB)
      (SETQ BODY (CADR U))
      (SETQ BOOL (CADDR U))
      (SETQ LAB 'REPEATLABEL)
      (RETURN
       (MKPROG NIL
               (LIST LAB BODY
                     (LIST 'COND (LIST (LIST 'NOT BOOL) (LIST 'GO LAB)))))))) 
(PUT 'REPEAT 'STAT 'REPEATSTAT) 
(FLAG '(REPEAT) 'NOCHANGE) 
(PUT 'FORMREPEAT 'NUMBER-OF-ARGS 3) 
(PUT 'FORMREPEAT 'DEFINED-ON-LINE '61) 
(PUT 'FORMREPEAT 'DEFINED-IN-FILE 'RLISP/LOOPS.RED) 
(PUT 'FORMREPEAT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMREPEAT (U VARS MODE)
    (PROG (**A2SFN)
      (SETQ **A2SFN 'AEVAL*)
      (RETURN
       (LIST 'REPEAT (FORMC (CADR U) VARS MODE)
             (FORMBOOL (CADDR U) VARS MODE))))) 
(PUT 'REPEAT 'FORMFN 'FORMREPEAT) 
(PUT 'WHILSTAT 'NUMBER-OF-ARGS 0) 
(PUT 'WHILSTAT 'DEFINED-ON-LINE '73) 
(PUT 'WHILSTAT 'DEFINED-IN-FILE 'RLISP/LOOPS.RED) 
(PUT 'WHILSTAT 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE WHILSTAT NIL
    (PROG (*BLOCKP BOOL BOOL2)
      (COND ((FLAGP 'DO 'DELIM) (SETQ BOOL2 T)) (T (FLAG '(DO) 'DELIM)))
      (SETQ BOOL (XREAD T))
      (COND ((NOT BOOL2) (REMFLAG '(DO) 'DELIM)))
      (COND ((NOT (EQUAL CURSYM* 'DO)) (SYMERR 'WHILE T)))
      (RETURN (LIST 'WHILE BOOL (XREAD T))))) 
(PUT 'WHILE 'DEFINED-ON-LINE '89) 
(PUT 'WHILE 'DEFINED-IN-FILE 'RLISP/LOOPS.RED) 
(PUT 'WHILE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DM WHILE (U)
    (PROG (BODY BOOL LAB)
      (SETQ BOOL (CADR U))
      (SETQ BODY (CDDR U))
      (SETQ LAB 'WHILELABEL)
      (RETURN
       (MKPROG NIL
               (CONS LAB
                     (CONS
                      (LIST 'COND (LIST (LIST 'NOT BOOL) (LIST 'RETURN NIL)))
                      (APPEND BODY (LIST (LIST 'GO LAB))))))))) 
(PUT 'WHILE 'STAT 'WHILSTAT) 
(FLAG '(WHILE) 'NOCHANGE) 
(PUT 'FORMWHILE 'NUMBER-OF-ARGS 3) 
(PUT 'FORMWHILE 'DEFINED-ON-LINE '104) 
(PUT 'FORMWHILE 'DEFINED-IN-FILE 'RLISP/LOOPS.RED) 
(PUT 'FORMWHILE 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE FORMWHILE (U VARS MODE)
    (PROG (**A2SFN)
      (SETQ **A2SFN 'AEVAL*)
      (RETURN
       (LIST 'WHILE (FORMBOOL (CADR U) VARS MODE)
             (FORMC (CADDR U) VARS MODE))))) 
(PUT 'WHILE 'FORMFN 'FORMWHILE) 
(ENDMODULE) 