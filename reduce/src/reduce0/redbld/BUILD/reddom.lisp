(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'REDDOM)) 
(FLUID '(MV-VARS*)) 
(GLOBAL '(*XXX *YYY)) 
(SETQ *XXX (SETQ *YYY T)) 
(DE DOMAIN-+ (U V) (PLUS U V)) 
(PUT 'DOMAIN-+ 'NUMBER-OF-ARGS 2) 
(PUT 'DOMAIN-+ 'DEFINED-ON-LINE '43) 
(PUT 'DOMAIN-+ 'DEFINED-IN-FILE 'MISC/REDDOM.RED) 
(PUT 'DOMAIN-+ 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(PUTC 'DOMAIN-+ 'INLINE '(LAMBDA (U V) (PLUS U V))) 
(DE DOMAIN-- (U V) (DIFFERENCE U V)) 
(PUT 'DOMAIN-- 'NUMBER-OF-ARGS 2) 
(PUT 'DOMAIN-- 'DEFINED-ON-LINE '45) 
(PUT 'DOMAIN-- 'DEFINED-IN-FILE 'MISC/REDDOM.RED) 
(PUT 'DOMAIN-- 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(PUTC 'DOMAIN-- 'INLINE '(LAMBDA (U V) (DIFFERENCE U V))) 
(DE DOMAIN-* (U V) (TIMES U V)) 
(PUT 'DOMAIN-* 'NUMBER-OF-ARGS 2) 
(PUT 'DOMAIN-* 'DEFINED-ON-LINE '47) 
(PUT 'DOMAIN-* 'DEFINED-IN-FILE 'MISC/REDDOM.RED) 
(PUT 'DOMAIN-* 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(PUTC 'DOMAIN-* 'INLINE '(LAMBDA (U V) (TIMES U V))) 
(DE DOMAIN-DIVIDE (U V) (DIVIDE U V)) 
(PUT 'DOMAIN-DIVIDE 'NUMBER-OF-ARGS 2) 
(PUT 'DOMAIN-DIVIDE 'DEFINED-ON-LINE '49) 
(PUT 'DOMAIN-DIVIDE 'DEFINED-IN-FILE 'MISC/REDDOM.RED) 
(PUT 'DOMAIN-DIVIDE 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(PUTC 'DOMAIN-DIVIDE 'INLINE '(LAMBDA (U V) (DIVIDE U V))) 
(PUT 'MV-DOMAINLIST-+ 'NUMBER-OF-ARGS 2) 
(PUT 'MV-DOMAINLIST-+ 'DEFINED-ON-LINE '54) 
(PUT 'MV-DOMAINLIST-+ 'DEFINED-IN-FILE 'MISC/REDDOM.RED) 
(PUT 'MV-DOMAINLIST-+ 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MV-DOMAINLIST-+ (U V)
    (COND ((NULL U) NIL)
          (T (CONS (PLUS (CAR U) (CAR V)) (MV-DOMAINLIST-+ (CDR U) (CDR V)))))) 
(PUT 'MV-DOMAINLIST-- 'NUMBER-OF-ARGS 2) 
(PUT 'MV-DOMAINLIST-- 'DEFINED-ON-LINE '58) 
(PUT 'MV-DOMAINLIST-- 'DEFINED-IN-FILE 'MISC/REDDOM.RED) 
(PUT 'MV-DOMAINLIST-- 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MV-DOMAINLIST-- (U V)
    (COND ((NULL U) NIL)
          (T
           (CONS (DIFFERENCE (CAR U) (CAR V))
                 (MV-DOMAINLIST-- (CDR U) (CDR V)))))) 
(PUT 'MV-DOMAINLIST-* 'NUMBER-OF-ARGS 2) 
(PUT 'MV-DOMAINLIST-* 'DEFINED-ON-LINE '62) 
(PUT 'MV-DOMAINLIST-* 'DEFINED-IN-FILE 'MISC/REDDOM.RED) 
(PUT 'MV-DOMAINLIST-* 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MV-DOMAINLIST-* (U V)
    (COND ((NULL V) NIL)
          (T (CONS (TIMES U (CAR V)) (MV-DOMAINLIST-* U (CDR V)))))) 
(PUT 'REDUCE 'NUMBER-OF-ARGS 2) 
(PUT 'REDUCE 'DEFINED-ON-LINE '68) 
(PUT 'REDUCE 'DEFINED-IN-FILE 'MISC/REDDOM.RED) 
(PUT 'REDUCE 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE REDUCE (U V)
    (PROG (WEIGHTLIST X)
      (SETQ X U)
      (COND (*YYY (SETQ X (REDUCE-RATIOS X V))))
      (SETQ WEIGHTLIST (SET-WEIGHTS V))
      (COND (*XXX (SETQ X (REDUCE-COLUMNS X V WEIGHTLIST))))
      (COND (*XXX (SETQ X (REDUCE-WEIGHTS X V WEIGHTLIST))))
      (RETURN X))) 
(PUT 'SET-WEIGHTS 'NUMBER-OF-ARGS 1) 
(PUT 'SET-WEIGHTS 'DEFINED-ON-LINE '87) 
(PUT 'SET-WEIGHTS 'DEFINED-IN-FILE 'MISC/REDDOM.RED) 
(PUT 'SET-WEIGHTS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SET-WEIGHTS (V)
    (PROG (N)
      (SETQ N 0)
      (RETURN
       (REVERSIP
        (CONS 0
              (PROG (J FORALL-RESULT FORALL-ENDPTR)
                (SETQ J (CDR V))
                (COND ((NULL J) (RETURN NIL)))
                (SETQ FORALL-RESULT
                        (SETQ FORALL-ENDPTR
                                (CONS ((LAMBDA (J) 1) (CAR J)) NIL)))
               LOOPLABEL
                (SETQ J (CDR J))
                (COND ((NULL J) (RETURN FORALL-RESULT)))
                (RPLACD FORALL-ENDPTR (CONS ((LAMBDA (J) 1) (CAR J)) NIL))
                (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                (GO LOOPLABEL))))))) 
(PUT 'REDUCE-RATIOS 'NUMBER-OF-ARGS 2) 
(PUT 'REDUCE-RATIOS 'DEFINED-ON-LINE '95) 
(PUT 'REDUCE-RATIOS 'DEFINED-IN-FILE 'MISC/REDDOM.RED) 
(PUT 'REDUCE-RATIOS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE REDUCE-RATIOS (U V)
    (PROG (X)
      (COND ((NULL (SETQ X (RED-RATIOS1 U V))) (RETURN U)))
      (SETQ X
              (MV-DOMAINLIST-- (MV-DOMAINLIST-* (CAR X) U)
               (MV-DOMAINLIST-* (CDR X) V)))
      (RETURN
       (COND ((GEQ (REDDOM_ZEROS U) (REDDOM_ZEROS X)) U)
             (T (REDUCE-RATIOS X V)))))) 
(PUT 'REDDOM_ZEROS 'NUMBER-OF-ARGS 1) 
(PUT 'REDDOM_ZEROS 'DEFINED-ON-LINE '104) 
(PUT 'REDDOM_ZEROS 'DEFINED-IN-FILE 'MISC/REDDOM.RED) 
(PUT 'REDDOM_ZEROS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE REDDOM_ZEROS (U)
    (COND ((NULL U) 0) ((EQUAL (CAR U) 0) (PLUS 1 (REDDOM_ZEROS (CDR U))))
          (T (REDDOM_ZEROS (CDR U))))) 
(PUT 'RED-RATIOS1 'NUMBER-OF-ARGS 2) 
(PUT 'RED-RATIOS1 'DEFINED-ON-LINE '109) 
(PUT 'RED-RATIOS1 'DEFINED-IN-FILE 'MISC/REDDOM.RED) 
(PUT 'RED-RATIOS1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE RED-RATIOS1 (U V)
    (AND U
         (OR (RED-RATIOS2 (CDR U) (CDR V) (CAR U) (CAR V))
             (RED-RATIOS1 (CDR U) (CDR V))))) 
(PUT 'RED-RATIOS2 'NUMBER-OF-ARGS 4) 
(PUT 'RED-RATIOS2 'DEFINED-ON-LINE '113) 
(PUT 'RED-RATIOS2 'DEFINED-IN-FILE 'MISC/REDDOM.RED) 
(PUT 'RED-RATIOS2 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE RED-RATIOS2 (U V U1 V1)
    (PROG (N)
      (SETQ N 0)
      (RETURN
       (COND ((NULL U) NIL)
             ((AND (EQUAL (SETQ N (TIMES U1 (CAR V))) (TIMES V1 (CAR U)))
                   (NEQ N 0) (EQUAL (REMAINDER (GCDN V1 U1) V1) 0))
              (RED-LOWEST-TERMS V1 U1))
             (T (RED-RATIOS2 (CDR U) (CDR V) U1 V1)))))) 
(PUT 'RED-LOWEST-TERMS 'NUMBER-OF-ARGS 2) 
(PUT 'RED-LOWEST-TERMS 'DEFINED-ON-LINE '124) 
(PUT 'RED-LOWEST-TERMS 'DEFINED-IN-FILE 'MISC/REDDOM.RED) 
(PUT 'RED-LOWEST-TERMS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE RED-LOWEST-TERMS (U V)
    (PROG (X)
      (COND ((LESSP U 0) (PROGN (SETQ U (MINUS U)) (SETQ V (MINUS V)))))
      (SETQ X (GCDN U V))
      (COND ((NEQ X U) (ERRACH (LIST "red-lowest-terms" U V))))
      (RETURN (CONS 1 (QUOTIENT V X))))) 
(PUT 'REDUCE-COLUMNS 'NUMBER-OF-ARGS 3) 
(PUT 'REDUCE-COLUMNS 'DEFINED-ON-LINE '134) 
(PUT 'REDUCE-COLUMNS 'DEFINED-IN-FILE 'MISC/REDDOM.RED) 
(PUT 'REDUCE-COLUMNS 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE REDUCE-COLUMNS (U V WEIGHTLIST)
    (PROG (W X Y Z Z1)
      (SETQ X U)
      (SETQ Y V)
      (SETQ W (CONS U (RED-WEIGHT U WEIGHTLIST)))
     A
      (COND ((NULL X) (RETURN (CAR W)))
            ((OR (EQUAL (CAR X) 0) (EQUAL (CAR Y) 0)) NIL)
            ((EQUAL (CDR (SETQ Z (DIVIDE (CAR X) (CAR Y)))) 0)
             (PROGN
              (SETQ Z (MV-DOMAINLIST-- U (MV-DOMAINLIST-* (CAR Z) V)))
              (SETQ Z1 (RED-WEIGHT Z WEIGHTLIST))
              (COND
               ((AND (RED-WEIGHT-LESS-P Z1 (CDR W))
                     (NOT (MORE-APARTP (CONS Z Z1) W)))
                (SETQ W (CONS Z Z1)))))))
      (SETQ X (CDR X))
      (SETQ Y (CDR Y))
      (GO A))) 
(PUT 'MORE-APARTP 'NUMBER-OF-ARGS 2) 
(PUT 'MORE-APARTP 'DEFINED-ON-LINE '152) 
(PUT 'MORE-APARTP 'DEFINED-IN-FILE 'MISC/REDDOM.RED) 
(PUT 'MORE-APARTP 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MORE-APARTP (U V)
    (AND (EQUAL (CADR U) 2) (EQUAL (CADR U) (CADR V)) (EQUAL (CADAR U) 0)
         (NEQ (CADAR V) 0))) 
(PUT 'REDUCE-WEIGHTS 'NUMBER-OF-ARGS 3) 
(PUT 'REDUCE-WEIGHTS 'DEFINED-ON-LINE '155) 
(PUT 'REDUCE-WEIGHTS 'DEFINED-IN-FILE 'MISC/REDDOM.RED) 
(PUT 'REDUCE-WEIGHTS 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE REDUCE-WEIGHTS (U V WEIGHTLIST)
    (PROG (SUCCESS X Y Z)
      (SETQ X (RED-WEIGHT U WEIGHTLIST))
     A
      (SETQ Y (MV-DOMAINLIST-+ U V))
      (SETQ Z (RED-WEIGHT Y WEIGHTLIST))
      (COND
       ((RED-WEIGHT-LESS-P Z X)
        (PROGN (SETQ SUCCESS T) (SETQ U Y) (SETQ X Z) (GO A))))
      (COND (SUCCESS (RETURN U)))
     B
      (SETQ Y (MV-DOMAINLIST-- U V))
      (SETQ Z (RED-WEIGHT Y WEIGHTLIST))
      (COND ((RED-WEIGHT-LESS-P Z X) (PROGN (SETQ U Y) (SETQ X Z) (GO B))))
      (RETURN U))) 
(PUT 'RED-WEIGHT 'NUMBER-OF-ARGS 2) 
(PUT 'RED-WEIGHT 'DEFINED-ON-LINE '169) 
(PUT 'RED-WEIGHT 'DEFINED-IN-FILE 'MISC/REDDOM.RED) 
(PUT 'RED-WEIGHT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE RED-WEIGHT (U WEIGHTLIST)
    (CONS (NONZERO-LENGTH U) (RED-WEIGHT1 U WEIGHTLIST))) 
(PUT 'RED-WEIGHT1 'NUMBER-OF-ARGS 2) 
(PUT 'RED-WEIGHT1 'DEFINED-ON-LINE '172) 
(PUT 'RED-WEIGHT1 'DEFINED-IN-FILE 'MISC/REDDOM.RED) 
(PUT 'RED-WEIGHT1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE RED-WEIGHT1 (U WEIGHTLIST)
    (COND ((NULL U) 0)
          (T
           (PLUS (TIMES (ABS (CAR U)) (CAR WEIGHTLIST))
                 (RED-WEIGHT1 (CDR U) (CDR WEIGHTLIST)))))) 
(PUT 'NONZERO-LENGTH 'NUMBER-OF-ARGS 1) 
(PUT 'NONZERO-LENGTH 'DEFINED-ON-LINE '177) 
(PUT 'NONZERO-LENGTH 'DEFINED-IN-FILE 'MISC/REDDOM.RED) 
(PUT 'NONZERO-LENGTH 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE NONZERO-LENGTH (U)
    (COND ((NULL U) 0) ((EQUAL (CAR U) 0) (NONZERO-LENGTH (CDR U)))
          (T (ADD1 (NONZERO-LENGTH (CDR U)))))) 
(PUT 'RED-WEIGHT-LESS-P 'NUMBER-OF-ARGS 2) 
(PUT 'RED-WEIGHT-LESS-P 'DEFINED-ON-LINE '182) 
(PUT 'RED-WEIGHT-LESS-P 'DEFINED-IN-FILE 'MISC/REDDOM.RED) 
(PUT 'RED-WEIGHT-LESS-P 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE RED-WEIGHT-LESS-P (U V)
    (COND ((EQUAL (CAR U) (CAR V)) (LESSP (CDR U) (CDR V)))
          (T (LESSP (CAR U) (CAR V))))) 
(ENDMODULE) 