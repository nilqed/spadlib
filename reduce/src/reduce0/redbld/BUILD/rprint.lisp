(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'RPRINT)) 
(CREATE-PACKAGE '(RPRINT) '(UTIL)) 
(FLUID
 '(*LOWER *RAISE *N BUFFP COMBUFF* CURMARK CURPOS ORIG PRETOP PRETOPRINF RMAR
   RPRIFN* RTERFN*)) 
(SWITCH (LIST 'RPRINT_LOWER)) 
(SETQ *RPRINT_LOWER T) 
(SETQ PRETOP 'OP) 
(SETQ PRETOPRINF 'OPRINF) 
(PUT 'RPRINT 'NUMBER-OF-ARGS 1) 
(PUT 'RPRINT 'DEFINED-ON-LINE '46) 
(PUT 'RPRINT 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'RPRINT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE RPRINT (U)
    (PROG (*N BUFF BUFFP CURMARK RMAR X)
      (SETQ *N 0)
      (SETQ CURMARK 0)
      (SETQ BUFF (SETQ BUFFP (LIST (LIST 0 0))))
      (SETQ RMAR (LINELENGTH NIL))
      (LINELENGTH (PLUS RMAR 64))
      (SETQ X (GET '*SEMICOL* PRETOP))
      (SETQ *N 0)
      (MPRINO1 U (LIST (CAAR X) (CADAR X)))
      (PRIN2OX ";")
      (OMARKO CURMARK)
      (PRINOS BUFF)
      (LINELENGTH RMAR))) 
(PUT 'RPRIN1 'NUMBER-OF-ARGS 1) 
(PUT 'RPRIN1 'DEFINED-ON-LINE '63) 
(PUT 'RPRIN1 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'RPRIN1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE RPRIN1 (U)
    (PROG (BUFF BUFFP CURMARK X)
      (SETQ CURMARK 0)
      (SETQ BUFF (SETQ BUFFP (LIST (LIST 0 0))))
      (SETQ X (GET '*SEMICOL* PRETOP))
      (MPRINO1 U (LIST (CAAR X) (CADAR X)))
      (OMARKO CURMARK)
      (PRINOS BUFF))) 
(PUT 'MPRINO 'NUMBER-OF-ARGS 1) 
(PUT 'MPRINO 'DEFINED-ON-LINE '73) 
(PUT 'MPRINO 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'MPRINO 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MPRINO (U) (MPRINO1 U (LIST 0 0))) 
(PUT 'MPRINO1 'NUMBER-OF-ARGS 2) 
(PUT 'MPRINO1 'DEFINED-ON-LINE '75) 
(PUT 'MPRINO1 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'MPRINO1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MPRINO1 (U V)
    (PROG (X)
      (COND
       ((SETQ X (ATSOC U COMBUFF*))
        (PROGN
         (PROG (Y)
           (SETQ Y (CDR X))
          LAB
           (COND ((NULL Y) (RETURN NIL)))
           ((LAMBDA (Y) (COMPROX Y)) (CAR Y))
           (SETQ Y (CDR Y))
           (GO LAB))
         (SETQ COMBUFF* (DELETE X COMBUFF*)))))
      (COND
       ((AND (NUMBERP U) (LESSP U 0) (SETQ X (GET 'DIFFERENCE PRETOP)))
        (RETURN
         (PROG (P)
           (SETQ X (CAR X))
           (SETQ P
                   (OR (NOT (GREATERP (CAR X) (CADR V)))
                       (NOT (GREATERP (CADR X) (CAR V)))))
           (COND (P (PRIN2OX "(")))
           (PRINOX U)
           (COND (P (PRIN2OX ")"))))))
       ((ATOM U) (RETURN (PRINOX U)))
       ((AND (NOT (ATOM (CAR U))) (SETQ X (STRANGEOP U)))
        (RETURN (MPRINO1 X V)))
       ((NOT (ATOM (CAR U)))
        (PROGN
         (SETQ CURMARK (PLUS CURMARK 1))
         (PRIN2OX "(")
         (MPRINO (CAR U))
         (PRIN2OX ")")
         (OMARK (LIST CURMARK 3))
         (SETQ CURMARK (DIFFERENCE CURMARK 1))))
       ((SETQ X (GET (CAR U) PRETOPRINF))
        (RETURN
         (PROG (P)
           (SETQ P
                   (AND (GREATERP (CAR V) 0)
                        (NOT
                         (MEMQ (CAR U)
                               '(LIST PROCEDURE PROG QUOTE RBLOCK STRING)))))
           (COND (P (PRIN2OX "(")))
           (APPLY1 X (CDR U))
           (COND (P (PRIN2OX ")"))))))
       ((SETQ X (GET (CAR U) PRETOP))
        (RETURN
         (COND ((CAR X) (INPRINOX U (CAR X) V))
               ((NULL (CADR X)) (INPRINOX U (LIST 100 1) V))
               (T (INPRINOX U (LIST 100 (CADR X)) V)))))
       ((AND (FLAGP (CAR U) 'MODEFN) (EQCAR (CADR U) 'PROCEDURE))
        (RETURN (PROCEOX (CONS (CADADR U) (CONS (CAR U) (CDR (CDDADR U)))))))
       (T (PRINOX (CAR U))))
      (COND ((RLISTATP (CAR U)) (RETURN (RLPRI (CDR U)))))
      (SETQ U (CDR U))
      (COND ((NULL U) (PRIN2OX "()")) (T (MPRARGS U V))))) 
(PUT 'STRANGEOP 'NUMBER-OF-ARGS 1) 
(PUT 'STRANGEOP 'DEFINED-ON-LINE '117) 
(PUT 'STRANGEOP 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'STRANGEOP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE STRANGEOP (U) NIL) 
(PUT 'MPRARGS 'NUMBER-OF-ARGS 2) 
(PUT 'MPRARGS 'DEFINED-ON-LINE '125) 
(PUT 'MPRARGS 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'MPRARGS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MPRARGS (U V)
    (COND
     ((NULL (CDR U)) (PROGN (PRIN2OX " ") (MPRINO1 (CAR U) (LIST 100 100))))
     (T (INPRINOX (CONS '*COMMA* U) (LIST 0 0) V)))) 
(PUT 'INPRINOX 'NUMBER-OF-ARGS 3) 
(PUT 'INPRINOX 'DEFINED-ON-LINE '129) 
(PUT 'INPRINOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'INPRINOX 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE INPRINOX (U X V)
    (PROG (P)
      (SETQ P
              (OR (NOT (GREATERP (CAR X) (CADR V)))
                  (NOT (GREATERP (CADR X) (CAR V)))))
      (COND (P (PRIN2OX "(")))
      (OMARK '(M U))
      (INPRINO (CAR U) X (CDR U))
      (COND (P (PRIN2OX ")")))
      (OMARK '(M D)))) 
(PUT 'INPRINO 'NUMBER-OF-ARGS 3) 
(PUT 'INPRINO 'DEFINED-ON-LINE '137) 
(PUT 'INPRINO 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'INPRINO 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE INPRINO (OPR V L)
    (PROG (FLG X)
      (SETQ CURMARK (PLUS CURMARK 2))
      (SETQ X (GET OPR PRETOP))
      (COND
       ((AND X (CAR X))
        (PROGN
         (MPRINO1 (CAR L) (LIST (CAR V) 0))
         (SETQ L (CDR L))
         (SETQ FLG T))))
      (PROG ()
       WHILELABEL
        (COND ((NOT L) (RETURN NIL)))
        (PROGN
         (COND ((EQ OPR '*COMMA*) (PROGN (PRIN2OX ",") (OMARKO CURMARK)))
               ((EQ OPR 'SETQ)
                (PROGN (PRIN2OX " := ") (OMARK (LIST CURMARK 1))))
               ((OR (ATOM (CAR L)) (NOT (EQ OPR (GET (CAAR L) 'ALT))))
                (PROGN
                 (OMARK (LIST CURMARK 1))
                 (OPRINO OPR FLG)
                 (SETQ FLG T))))
         (MPRINO1 (CAR L)
          (LIST (COND ((NULL (CDR L)) 0) (T (CAR V)))
                (COND ((NULL FLG) 0) (T (CADR V)))))
         (SETQ L (CDR L)))
        (GO WHILELABEL))
      (SETQ CURMARK (DIFFERENCE CURMARK 2)))) 
(PUT 'OPRINO 'NUMBER-OF-ARGS 2) 
(PUT 'OPRINO 'DEFINED-ON-LINE '155) 
(PUT 'OPRINO 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'OPRINO 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE OPRINO (OPR B)
    ((LAMBDA (X)
       (COND
        ((NULL X) (PROGN (COND (B (PRIN2OX " "))) (PRINOX OPR) (PRIN2OX " ")))
        (T
         ((LAMBDA (Y)
            (PROGN
             (COND (Y (PRIN2OX " ")))
             (PRIN2OX X)
             (COND (Y (PRIN2OX " ")))))
          (FLAGP OPR 'SPACED)))))
     (GET OPR 'PRTCH))) 
(FLAG '(CONS) 'SPACED) 
(FLAG '(ADD MULT OVER TO) 'SPACED) 
(PUT 'PRIN2OX 'NUMBER-OF-ARGS 1) 
(PUT 'PRIN2OX 'DEFINED-ON-LINE '167) 
(PUT 'PRIN2OX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'PRIN2OX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PRIN2OX (U)
    (PROGN
     (RPLACD BUFFP (EXPLODEX U))
     (PROG ()
      WHILELABEL
       (COND ((NOT (CDR BUFFP)) (RETURN NIL)))
       (SETQ BUFFP (CDR BUFFP))
       (GO WHILELABEL)))) 
(PUT 'EXPLODEX 'NUMBER-OF-ARGS 1) 
(PUT 'EXPLODEX 'DEFINED-ON-LINE '171) 
(PUT 'EXPLODEX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'EXPLODEX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE EXPLODEX (U)
    (COND ((NUMBERP U) (EXPLODE U))
          ((STRINGP U) (REVERSIP (CDR (REVERSIP (CDR (EXPLODE U))))))
          (T (EXPLODEX1 (EXPLODE U))))) 
(PUT 'EXPLODEX1 'NUMBER-OF-ARGS 1) 
(PUT 'EXPLODEX1 'DEFINED-ON-LINE '177) 
(PUT 'EXPLODEX1 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'EXPLODEX1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE EXPLODEX1 (U)
    (COND ((NULL U) NIL) ((EQ (CAR U) '!) (CONS (CADR U) (EXPLODEX1 (CDDR U))))
          (T (CONS (CHECK-DOWNCASE (CAR U)) (EXPLODEX1 (CDR U)))))) 
(PUT 'EXPLODEY 'NUMBER-OF-ARGS 1) 
(PUT 'EXPLODEY 'DEFINED-ON-LINE '182) 
(PUT 'EXPLODEY 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'EXPLODEY 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE EXPLODEY (U)
    (PROG (V)
      (SETQ V (EXPLODE U))
      (COND
       ((AND (IDP U) *RPRINT_LOWER)
        (SETQ V
                (PROG (X FORALL-RESULT FORALL-ENDPTR)
                  (SETQ X V)
                  (COND ((NULL X) (RETURN NIL)))
                  (SETQ FORALL-RESULT
                          (SETQ FORALL-ENDPTR
                                  (CONS
                                   ((LAMBDA (X) (CHECK-DOWNCASE X)) (CAR X))
                                   NIL)))
                 LOOPLABEL
                  (SETQ X (CDR X))
                  (COND ((NULL X) (RETURN FORALL-RESULT)))
                  (RPLACD FORALL-ENDPTR
                          (CONS ((LAMBDA (X) (CHECK-DOWNCASE X)) (CAR X)) NIL))
                  (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
                  (GO LOOPLABEL)))))
      (RETURN V))) 
(PUT 'CHECK-DOWNCASE 'NUMBER-OF-ARGS 1) 
(PUT 'CHECK-DOWNCASE 'DEFINED-ON-LINE '192) 
(PUT 'CHECK-DOWNCASE 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'CHECK-DOWNCASE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CHECK-DOWNCASE (U)
    (PROG (Z)
      (RETURN
       (COND
        ((AND (LITER U)
              (SETQ Z
                      (ATSOC U
                             '((|a| . A) (|b| . B) (|c| . C) (|d| . D)
                               (|e| . E) (|f| . F) (|g| . G) (|h| . H)
                               (|i| . I) (|j| . J) (|k| . K) (|l| . L)
                               (|m| . M) (|n| . N) (|o| . O) (|p| . P)
                               (|q| . Q) (|r| . R) (|s| . S) (|t| . T)
                               (|u| . U) (|v| . V) (|w| . W) (|x| . X)
                               (|y| . Y) (|z| . Z)))))
         (CDR Z))
        (T U))))) 
(PUT 'PRINOX 'NUMBER-OF-ARGS 1) 
(PUT 'PRINOX 'DEFINED-ON-LINE '206) 
(PUT 'PRINOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'PRINOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PRINOX (U)
    ((LAMBDA (X)
       (PROGN
        (COND (X (SETQ U X)))
        (RPLACD BUFFP (EXPLODEY U))
        (PROG ()
         WHILELABEL
          (COND ((NOT (CDR BUFFP)) (RETURN NIL)))
          (SETQ BUFFP (CDR BUFFP))
          (GO WHILELABEL))))
     (GET U 'OLDNAM))) 
(PUT 'OMARK 'NUMBER-OF-ARGS 1) 
(PUT 'OMARK 'DEFINED-ON-LINE '212) 
(PUT 'OMARK 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'OMARK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OMARK (U) (PROGN (RPLACD BUFFP (LIST U)) (SETQ BUFFP (CDR BUFFP)))) 
(PUT 'OMARKO 'NUMBER-OF-ARGS 1) 
(PUT 'OMARKO 'DEFINED-ON-LINE '215) 
(PUT 'OMARKO 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'OMARKO 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE OMARKO (U) (OMARK (LIST U 0))) 
(PUT 'COMPROX 'NUMBER-OF-ARGS 1) 
(PUT 'COMPROX 'DEFINED-ON-LINE '217) 
(PUT 'COMPROX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'COMPROX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE COMPROX (U)
    (PROG (X)
      (COND
       ((EQUAL (CAR BUFFP) '(0 0))
        (RETURN
         (PROGN
          (PROG (J)
            (SETQ J U)
           LAB
            (COND ((NULL J) (RETURN NIL)))
            ((LAMBDA (J) (PRIN2OX J)) (CAR J))
            (SETQ J (CDR J))
            (GO LAB))
          (OMARK '(0 0))))))
      (SETQ X (CAR BUFFP))
      (RPLACA BUFFP (LIST (PLUS CURMARK 1) 3))
      (PROG (J)
        (SETQ J U)
       LAB
        (COND ((NULL J) (RETURN NIL)))
        ((LAMBDA (J) (PRIN2OX J)) (CAR J))
        (SETQ J (CDR J))
        (GO LAB))
      (OMARK X))) 
(PUT 'RLISTATP 'NUMBER-OF-ARGS 1) 
(PUT 'RLISTATP 'DEFINED-ON-LINE '228) 
(PUT 'RLISTATP 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'RLISTATP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE RLISTATP (U) (MEMBER (GET U 'STAT) '(ENDSTAT RLIS))) 
(PUT 'RLPRI 'NUMBER-OF-ARGS 1) 
(PUT 'RLPRI 'DEFINED-ON-LINE '231) 
(PUT 'RLPRI 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'RLPRI 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE RLPRI (U)
    (COND ((NULL U) NIL)
          (T
           (PROG ()
             (PRIN2OX " ")
             (OMARK '(M U))
             (INPRINO '*COMMA* (LIST 0 0) U)
             (OMARK '(M D)))))) 
(PUT 'CONDOX 'NUMBER-OF-ARGS 1) 
(PUT 'CONDOX 'DEFINED-ON-LINE '240) 
(PUT 'CONDOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'CONDOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CONDOX (U)
    (PROG (X)
      (OMARK '(M U))
      (SETQ CURMARK (PLUS CURMARK 2))
      (PROG ()
       WHILELABEL
        (COND ((NOT U) (RETURN NIL)))
        (PROGN
         (PRIN2OX "if ")
         (MPRINO (CAAR U))
         (OMARK (LIST CURMARK 1))
         (PRIN2OX " then ")
         (COND
          ((CDDAR U)
           (SETQ U (CONS (LIST (CAAR U) (CONS 'PROGN (CDAR U))) (CDR U)))))
         (COND
          ((AND (CDR U) (EQCAR (CADAR U) 'COND)
                (NOT (EQCAR (CAR (REVERSE (CADAR U))) 'T)))
           (PROGN (SETQ X T) (PRIN2OX "("))))
         (MPRINO (CADAR U))
         (COND (X (PRIN2OX ")")))
         (SETQ U (CDR U))
         (COND (U (PROGN (OMARKO (DIFFERENCE CURMARK 1)) (PRIN2OX " else "))))
         (COND
          ((AND U (NULL (CDR U)) (EQ (CAAR U) 'T))
           (PROGN
            (MPRINO (COND ((CDDAR U) (CONS 'PROGN (CDAR U))) (T (CADAR U))))
            (SETQ U NIL)))))
        (GO WHILELABEL))
      (SETQ CURMARK (DIFFERENCE CURMARK 2))
      (OMARK '(M D)))) 
(PUT 'COND PRETOPRINF 'CONDOX) 
(PUT 'IFOX 'NUMBER-OF-ARGS 1) 
(PUT 'IFOX 'DEFINED-ON-LINE '264) 
(PUT 'IFOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'IFOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE IFOX (U)
    (PROG (P A B)
      (SETQ P (CAR U))
      (SETQ U (CDR U))
      (COND (U (PROGN (SETQ A (CAR U)) (SETQ U (CDR U)))))
      (COND (U (PROGN (SETQ B (CAR U)) (SETQ U (CDR U)))))
      (COND ((NULL B) (CONDOX (LIST (LIST P A))))
            (T (CONDOX (LIST (LIST P A) (LIST T B))))))) 
(PUT 'IF PRETOPRINF 'IFOX) 
(PUT 'BLOCKOX 'NUMBER-OF-ARGS 1) 
(PUT 'BLOCKOX 'DEFINED-ON-LINE '280) 
(PUT 'BLOCKOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'BLOCKOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BLOCKOX (U)
    (PROG ()
      (OMARK '(M U))
      (SETQ CURMARK (PLUS CURMARK 2))
      (PRIN2OX "begin ")
      (COND ((CAR U) (VARPRX (CAR U))))
      (SETQ U (LABCHK (CDR U)))
      (OMARK (LIST CURMARK (COND ((EQCAR (CAR U) '*LABEL) 1) (T 3))))
      (PROG ()
       WHILELABEL
        (COND ((NOT U) (RETURN NIL)))
        (PROGN
         (MPRINO (CAR U))
         (COND ((AND (NOT (EQCAR (CAR U) '*LABEL)) (CDR U)) (PRIN2OX "; ")))
         (SETQ U (CDR U))
         (COND
          (U (OMARK (LIST CURMARK (COND ((EQCAR (CAR U) '*LABEL) 1) (T 3)))))))
        (GO WHILELABEL))
      (OMARK (LIST (DIFFERENCE CURMARK 1) (MINUS 1)))
      (PRIN2OX " end")
      (SETQ CURMARK (DIFFERENCE CURMARK 2))
      (OMARK '(M D)))) 
(PUT 'RETOX 'NUMBER-OF-ARGS 1) 
(PUT 'RETOX 'DEFINED-ON-LINE '301) 
(PUT 'RETOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'RETOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE RETOX (U)
    (PROG ()
      (OMARK '(M U))
      (SETQ CURMARK (PLUS CURMARK 2))
      (PRIN2OX "return ")
      (OMARK '(M U))
      (MPRINO (CAR U))
      (SETQ CURMARK (DIFFERENCE CURMARK 2))
      (OMARK '(M D))
      (OMARK '(M D)))) 
(PUT 'RETURN PRETOPRINF 'RETOX) 
(PUT 'VARPRX 'NUMBER-OF-ARGS 1) 
(PUT 'VARPRX 'DEFINED-ON-LINE '315) 
(PUT 'VARPRX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'VARPRX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE VARPRX (U)
    (PROG (TYP)
      (PROG ()
       WHILELABEL
        (COND ((NOT U) (RETURN NIL)))
        (PROGN
         (COND
          ((EQ (CDAR U) TYP)
           (PROGN (PRIN2OX ",") (OMARKO (PLUS CURMARK 1)) (PRINOX (CAAR U))))
          (T
           (PROGN
            (COND (TYP (PROGN (PRIN2OX "; ") (OMARK '(M D)))))
            (PRINOX (SETQ TYP (CDAR U)))
            (PRIN2OX " ")
            (OMARK '(M U))
            (PRINOX (CAAR U)))))
         (SETQ U (CDR U)))
        (GO WHILELABEL))
      (PRIN2OX "; ")
      (OMARK '(M D)))) 
(PUT 'RBLOCK PRETOPRINF 'BLOCKOX) 
(PUT 'PROGOX 'NUMBER-OF-ARGS 1) 
(PUT 'PROGOX 'DEFINED-ON-LINE '330) 
(PUT 'PROGOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'PROGOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PROGOX (U)
    (BLOCKOX
     (CONS
      (PROG (J FORALL-RESULT FORALL-ENDPTR)
        (SETQ J (CAR U))
        (COND ((NULL J) (RETURN NIL)))
        (SETQ FORALL-RESULT
                (SETQ FORALL-ENDPTR
                        (CONS ((LAMBDA (J) (CONS J 'SCALAR)) (CAR J)) NIL)))
       LOOPLABEL
        (SETQ J (CDR J))
        (COND ((NULL J) (RETURN FORALL-RESULT)))
        (RPLACD FORALL-ENDPTR
                (CONS ((LAMBDA (J) (CONS J 'SCALAR)) (CAR J)) NIL))
        (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
        (GO LOOPLABEL))
      (CDR U)))) 
(PUT 'LABCHK 'NUMBER-OF-ARGS 1) 
(PUT 'LABCHK 'DEFINED-ON-LINE '335) 
(PUT 'LABCHK 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'LABCHK 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE LABCHK (U)
    (PROG (X)
      (PROG (Z)
        (SETQ Z U)
       LAB
        (COND ((NULL Z) (RETURN NIL)))
        ((LAMBDA (Z)
           (COND ((ATOM Z) (SETQ X (CONS (LIST '*LABEL Z) X)))
                 (T (SETQ X (CONS Z X)))))
         (CAR Z))
        (SETQ Z (CDR Z))
        (GO LAB))
      (RETURN (REVERSIP X)))) 
(PUT 'PROG PRETOPRINF 'PROGOX) 
(PUT 'GOX 'NUMBER-OF-ARGS 1) 
(PUT 'GOX 'DEFINED-ON-LINE '344) 
(PUT 'GOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'GOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE GOX (U) (PROGN (PRIN2OX "go to ") (PRINOX (CAR U)))) 
(PUT 'GO PRETOPRINF 'GOX) 
(PUT 'LABOX 'NUMBER-OF-ARGS 1) 
(PUT 'LABOX 'DEFINED-ON-LINE '349) 
(PUT 'LABOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'LABOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE LABOX (U) (PROGN (PRINOX (CAR U)) (PRIN2OX ": "))) 
(PUT '*LABEL PRETOPRINF 'LABOX) 
(PUT 'QUOTOXX 'NUMBER-OF-ARGS 1) 
(PUT 'QUOTOXX 'DEFINED-ON-LINE '354) 
(PUT 'QUOTOXX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'QUOTOXX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QUOTOXX (U)
    (PROG ()
      (COND ((STRINGP U) (RETURN (PRINOX U))))
      (PRIN2OX "'")
      (SETQ U (CAR U))
      (COND ((ATOM U) (RETURN (PRINOX U))))
      (SETQ CURMARK (PLUS CURMARK 1))
      (PRIN2OX "(")
      (OMARK '(M U))
     A
      (COND ((ATOM U) (PROGN (PRIN2OX " . ") (PRINOX U) (SETQ U NIL)))
            (T
             (PROGN
              (MPRINO (CAR U))
              (SETQ U (CDR U))
              (COND (U (PROGN (PRIN2OX BLANK) (OMARKO CURMARK)))))))
      (COND (U (GO A)))
      (OMARK '(M D))
      (PRIN2OX ")")
      (SETQ CURMARK (DIFFERENCE CURMARK 1)))) 
(PUT 'QUOTOX 'NUMBER-OF-ARGS 1) 
(PUT 'QUOTOX 'DEFINED-ON-LINE '372) 
(PUT 'QUOTOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'QUOTOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE QUOTOX (U)
    (COND ((STRINGP U) (PRINOX U)) (T (PROGN (PRIN2OX "'") (PRINSOX (CAR U)))))) 
(PUT 'PRINSOX 'NUMBER-OF-ARGS 1) 
(PUT 'PRINSOX 'DEFINED-ON-LINE '375) 
(PUT 'PRINSOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'PRINSOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PRINSOX (U)
    (COND ((ATOM U) (PRINOX U))
          (T
           (PROGN
            (SETQ CURMARK (PLUS CURMARK 1))
            (PRIN2OX "(")
            (OMARK '(M U))
            (PROG ()
             WHILELABEL
              (COND ((NOT U) (RETURN NIL)))
              (PROGN
               (PRINSOX (CAR U))
               (SETQ U (CDR U))
               (COND
                (U
                 (PROGN
                  (OMARK (LIST CURMARK (MINUS 1)))
                  (COND
                   ((ATOM U) (PROGN (PRIN2OX " . ") (PRINSOX U) (SETQ U NIL)))
                   (T (PRIN2OX " ")))))))
              (GO WHILELABEL))
            (OMARK '(M D))
            (PRIN2OX ")")
            (SETQ CURMARK (DIFFERENCE CURMARK 1)))))) 
(PUT 'QUOTE PRETOPRINF 'QUOTOX) 
(PUT 'PROGNOX 'NUMBER-OF-ARGS 1) 
(PUT 'PROGNOX 'DEFINED-ON-LINE '392) 
(PUT 'PROGNOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'PROGNOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PROGNOX (U)
    (PROG ()
      (SETQ CURMARK (PLUS CURMARK 1))
      (PRIN2OX "<<")
      (OMARK '(M U))
      (PROG ()
       WHILELABEL
        (COND ((NOT U) (RETURN NIL)))
        (PROGN
         (MPRINO (CAR U))
         (SETQ U (CDR U))
         (COND (U (PROGN (PRIN2OX "; ") (OMARKO CURMARK)))))
        (GO WHILELABEL))
      (OMARK '(M D))
      (PRIN2OX ">>")
      (SETQ CURMARK (DIFFERENCE CURMARK 1)))) 
(PUT 'PROG2 PRETOPRINF 'PROGNOX) 
(PUT 'PROGN PRETOPRINF 'PROGNOX) 
(PUT 'LISTOX 'NUMBER-OF-ARGS 1) 
(PUT 'LISTOX 'DEFINED-ON-LINE '408) 
(PUT 'LISTOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'LISTOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE LISTOX (U)
    (PROG ()
      (SETQ CURMARK (PLUS CURMARK 1))
      (PRIN2OX "{")
      (OMARK '(M U))
      (PROG ()
       WHILELABEL
        (COND ((NOT U) (RETURN NIL)))
        (PROGN
         (MPRINO (CAR U))
         (SETQ U (CDR U))
         (COND (U (PROGN (PRIN2OX ",") (OMARKO CURMARK)))))
        (GO WHILELABEL))
      (OMARK '(M D))
      (PRIN2OX "}")
      (SETQ CURMARK (DIFFERENCE CURMARK 1)))) 
(PUT 'LIST PRETOPRINF 'LISTOX) 
(PUT 'REPEATOX 'NUMBER-OF-ARGS 1) 
(PUT 'REPEATOX 'DEFINED-ON-LINE '423) 
(PUT 'REPEATOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'REPEATOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE REPEATOX (U)
    (PROG ()
      (SETQ CURMARK (PLUS CURMARK 1))
      (OMARK '(M U))
      (PRIN2OX "repeat ")
      (MPRINO (CAR U))
      (PRIN2OX " until ")
      (OMARK (LIST CURMARK 3))
      (MPRINO (CADR U))
      (OMARK '(M D))
      (SETQ CURMARK (DIFFERENCE CURMARK 1)))) 
(PUT 'REPEAT PRETOPRINF 'REPEATOX) 
(PUT 'WHILEOX 'NUMBER-OF-ARGS 1) 
(PUT 'WHILEOX 'DEFINED-ON-LINE '438) 
(PUT 'WHILEOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'WHILEOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE WHILEOX (U)
    (PROG ()
      (SETQ CURMARK (PLUS CURMARK 1))
      (OMARK '(M U))
      (PRIN2OX "while ")
      (MPRINO (CAR U))
      (PRIN2OX " do ")
      (OMARK (LIST CURMARK 3))
      (MPRINO (CADR U))
      (OMARK '(M D))
      (SETQ CURMARK (DIFFERENCE CURMARK 1)))) 
(PUT 'WHILE PRETOPRINF 'WHILEOX) 
(PUT 'PROCOX 'NUMBER-OF-ARGS 1) 
(PUT 'PROCOX 'DEFINED-ON-LINE '453) 
(PUT 'PROCOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'PROCOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PROCOX (U)
    (PROG ()
      (OMARK '(M U))
      (SETQ CURMARK (PLUS CURMARK 1))
      (COND ((CADDDR (CDR U)) (PROGN (MPRINO (CADDDR (CDR U))) (PRIN2OX " "))))
      (PRIN2OX "procedure ")
      (PROCOX1 (CAR U) (CADR U) (CADDR U)))) 
(PUT 'PROCOX1 'NUMBER-OF-ARGS 3) 
(PUT 'PROCOX1 'DEFINED-ON-LINE '462) 
(PUT 'PROCOX1 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'PROCOX1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE PROCOX1 (U V W)
    (PROG ()
      (PRINOX U)
      (COND (V (MPRARGS V (LIST 0 0))))
      (PRIN2OX "; ")
      (OMARK (LIST CURMARK 3))
      (MPRINO W)
      (SETQ CURMARK (DIFFERENCE CURMARK 1))
      (OMARK '(M D)))) 
(PUT 'PROC PRETOPRINF 'PROCOX) 
(PUT 'PROCEOX 'NUMBER-OF-ARGS 1) 
(PUT 'PROCEOX 'DEFINED-ON-LINE '475) 
(PUT 'PROCEOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'PROCEOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PROCEOX (U)
    (PROG ()
      (OMARK '(M U))
      (SETQ CURMARK (PLUS CURMARK 1))
      (COND ((CADR U) (PROGN (MPRINO (CADR U)) (PRIN2OX " "))))
      (COND
       ((NOT (EQ (CADDR U) 'EXPR)) (PROGN (MPRINO (CADDR U)) (PRIN2OX " "))))
      (PRIN2OX "procedure ")
      (PROCEOX1 (CAR U) (CADDDR U) (CAR (CDDDDR U))))) 
(PUT 'PROCEOX1 'NUMBER-OF-ARGS 3) 
(PUT 'PROCEOX1 'DEFINED-ON-LINE '485) 
(PUT 'PROCEOX1 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'PROCEOX1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE PROCEOX1 (U V W)
    (PROG (ANNOT)
      (PRINOX U)
      (COND
       (V
        (PROGN
         (COND ((NOT (ATOM (CAR V))) (SETQ V (MAPOVERCAR V))))
         (MPRARGS V (LIST 0 0)))))
      (PRIN2OX "; ")
      (COND
       ((SETQ ANNOT (GET U 'ACTIVE-ANNOTATION))
        (PROGN
         (OMARK (LIST CURMARK 3))
         (PRIN2OX "/* ")
         (PRINCOM (CAR ANNOT))
         (PRIN2OX " */")
         (OMARK '(M D)))))
      (OMARK (LIST CURMARK 3))
      (MPRINO W)
      (SETQ CURMARK (DIFFERENCE CURMARK 1))
      (OMARK '(M D)))) 
(PUT 'PROCEDURE PRETOPRINF 'PROCEOX) 
(PUT 'PROCEOX0 'NUMBER-OF-ARGS 4) 
(PUT 'PROCEOX0 'DEFINED-ON-LINE '509) 
(PUT 'PROCEOX0 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'PROCEOX0 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE PROCEOX0 (U V W X)
    (PROCEOX
     (LIST U 'SYMBOLIC V
           (PROG (J FORALL-RESULT FORALL-ENDPTR)
             (SETQ J W)
             (COND ((NULL J) (RETURN NIL)))
             (SETQ FORALL-RESULT
                     (SETQ FORALL-ENDPTR
                             (CONS ((LAMBDA (J) (CONS J 'SYMBOLIC)) (CAR J))
                                   NIL)))
            LOOPLABEL
             (SETQ J (CDR J))
             (COND ((NULL J) (RETURN FORALL-RESULT)))
             (RPLACD FORALL-ENDPTR
                     (CONS ((LAMBDA (J) (CONS J 'SYMBOLIC)) (CAR J)) NIL))
             (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
             (GO LOOPLABEL))
           X))) 
(PUT 'DEOX 'NUMBER-OF-ARGS 1) 
(PUT 'DEOX 'DEFINED-ON-LINE '512) 
(PUT 'DEOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'DEOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DEOX (U)
    (PROCEOX0 (CAR U) 'EXPR (CADR U)
     (COND ((CDDDR U) (CONS 'PROGN (CDDR U))) (T (CADDR U))))) 
(PUT 'DE PRETOPRINF 'DEOX) 
(PUT 'DSOX 'NUMBER-OF-ARGS 1) 
(PUT 'DSOX 'DEFINED-ON-LINE '525) 
(PUT 'DSOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'DSOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DSOX (U) (PROCEOX0 (CAR U) 'SMACRO (CADR U) (CADDR U))) 
(PUT 'DS PRETOPRINF 'DSOX) 
(PUT 'STRINGOX 'NUMBER-OF-ARGS 1) 
(PUT 'STRINGOX 'DEFINED-ON-LINE '530) 
(PUT 'STRINGOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'STRINGOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE STRINGOX (U) (PROGN (PRIN2OX '|"|) (PRIN2OX (CAR U)) (PRIN2OX '|"|))) 
(PUT 'STRING PRETOPRINF 'STRINGOX) 
(PUT 'LAMBDOX 'NUMBER-OF-ARGS 1) 
(PUT 'LAMBDOX 'DEFINED-ON-LINE '535) 
(PUT 'LAMBDOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'LAMBDOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE LAMBDOX (U)
    (PROG ()
      (OMARK '(M U))
      (SETQ CURMARK (PLUS CURMARK 1))
      (PROCOX1 'LAMBDA (CAR U) (CADR U)))) 
(PUT 'LAMBDA PRETOPRINF 'LAMBDOX) 
(PUT 'EACHOX 'NUMBER-OF-ARGS 1) 
(PUT 'EACHOX 'DEFINED-ON-LINE '544) 
(PUT 'EACHOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'EACHOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE EACHOX (U)
    (PROGN
     (PRIN2OX "for each ")
     (PROG ()
      WHILELABEL
       (COND ((NOT (CDR U)) (RETURN NIL)))
       (PROGN (MPRINO (CAR U)) (PRIN2OX " ") (SETQ U (CDR U)))
       (GO WHILELABEL))
     (MPRINO (CAR U)))) 
(PUT 'FOREACH PRETOPRINF 'EACHOX) 
(PUT 'FOROX 'NUMBER-OF-ARGS 1) 
(PUT 'FOROX 'DEFINED-ON-LINE '551) 
(PUT 'FOROX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'FOROX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE FOROX (U)
    (PROG ()
      (SETQ CURMARK (PLUS CURMARK 1))
      (OMARK '(M U))
      (PRIN2OX "for ")
      (MPRINO (CAR U))
      (PRIN2OX " := ")
      (MPRINO (CAADR U))
      (COND
       ((NEQ (CADR (CADR U)) 1)
        (PROGN
         (PRIN2OX " step ")
         (MPRINO (CADR (CADR U)))
         (PRIN2OX " until ")))
       (T (PRIN2OX ":")))
      (MPRINO (CADDR (CADR U)))
      (PRIN2OX " ")
      (MPRINO (CADDR U))
      (PRIN2OX " ")
      (OMARK (LIST CURMARK 3))
      (MPRINO (CADDDR U))
      (OMARK '(M D))
      (SETQ CURMARK (DIFFERENCE CURMARK 1)))) 
(PUT 'FOR PRETOPRINF 'FOROX) 
(PUT 'FORALLOX 'NUMBER-OF-ARGS 1) 
(PUT 'FORALLOX 'DEFINED-ON-LINE '574) 
(PUT 'FORALLOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'FORALLOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE FORALLOX (U)
    (PROG ()
      (SETQ CURMARK (PLUS CURMARK 1))
      (OMARK '(M U))
      (PRIN2OX "for all ")
      (INPRINO '*COMMA* (LIST 0 0) (CAR U))
      (COND
       ((CADR U)
        (PROGN
         (OMARK (LIST CURMARK 3))
         (PRIN2OX " such that ")
         (MPRINO (CADR U)))))
      (PRIN2OX " ")
      (OMARK (LIST CURMARK 3))
      (MPRINO (CADDR U))
      (OMARK '(M D))
      (SETQ CURMARK (DIFFERENCE CURMARK 1)))) 
(PUT 'FORALL PRETOPRINF 'FORALLOX) 
(PUT 'AEVAL* PRETOPRINF 'AEVALOX) 
(PUT 'AEVAL PRETOPRINF 'AEVALOX) 
(PUT 'REVALX PRETOPRINF 'AEVALOX) 
(PUT 'AEVALOX 'NUMBER-OF-ARGS 1) 
(PUT 'AEVALOX 'DEFINED-ON-LINE '601) 
(PUT 'AEVALOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'AEVALOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE AEVALOX (U) (MPRINO (AEVALOX1 (CAR U)))) 
(PUT 'AEVALOX1 'NUMBER-OF-ARGS 1) 
(PUT 'AEVALOX1 'DEFINED-ON-LINE '604) 
(PUT 'AEVALOX1 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'AEVALOX1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE AEVALOX1 (U)
    (COND ((EQCAR U 'QUOTE) (CADR U))
          ((EQCAR U 'LIST)
           (PROG (Q FORALL-RESULT FORALL-ENDPTR)
             (SETQ Q U)
             (COND ((NULL Q) (RETURN NIL)))
             (SETQ FORALL-RESULT
                     (SETQ FORALL-ENDPTR
                             (CONS ((LAMBDA (Q) (AEVALOX1 Q)) (CAR Q)) NIL)))
            LOOPLABEL
             (SETQ Q (CDR Q))
             (COND ((NULL Q) (RETURN FORALL-RESULT)))
             (RPLACD FORALL-ENDPTR
                     (CONS ((LAMBDA (Q) (AEVALOX1 Q)) (CAR Q)) NIL))
             (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
             (GO LOOPLABEL)))
          (T U))) 
(PUT 'MINUSPOX 'NUMBER-OF-ARGS 1) 
(PUT 'MINUSPOX 'DEFINED-ON-LINE '610) 
(PUT 'MINUSPOX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'MINUSPOX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE MINUSPOX (U)
    (COND ((EQCAR (CAR U) 'DIFFERENCE) (MPRINO (CONS 'LESSP (CDAR U))))
          (T (MPRINO (CONS 'LESSP (CONS (CAR U) '(0))))))) 
(PUT 'MINUSP PRETOPRINF 'MINUSPOX) 
(PUT '|AMINUSP:| PRETOPRINF 'MINUSPOX) 
(PUT 'EVALEQUAL PRETOPRINF (FUNCTION (LAMBDA (U) (MPRINO (CONS 'EQUAL U))))) 
(PUT 'EVALGREATERP PRETOPRINF
     (FUNCTION (LAMBDA (U) (MPRINO (CONS 'GREATERP U))))) 
(PUT 'EVALGEQ PRETOPRINF (FUNCTION (LAMBDA (U) (MPRINO (CONS 'GEQ U))))) 
(PUT 'EVALLESSP PRETOPRINF (FUNCTION (LAMBDA (U) (MPRINO (CONS 'LESSP U))))) 
(PUT 'EVALLEQ PRETOPRINF (FUNCTION (LAMBDA (U) (MPRINO (CONS 'LEQ U))))) 
(PUT 'EVALNEQ PRETOPRINF (FUNCTION (LAMBDA (U) (MPRINO (CONS 'NEQ U))))) 
(PUT '|:DN:| PRETOPRINF
     (FUNCTION
      (LAMBDA (U) (MPRINO (TIMES (FLOAT (CAR U)) (EXPT (FLOAT 10) (CDR U))))))) 
(PUT '|:RD:| PRETOPRINF
     (FUNCTION
      (LAMBDA (U)
        (MPRINO
         (COND ((ATOM U) U)
               (T (TIMES (FLOAT (CAR U)) (EXPT (FLOAT 2) (CDR U))))))))) 
(PUT 'PLUS2 PRETOPRINF (FUNCTION (LAMBDA (U) (MPRINO (CONS 'PLUS U))))) 
(COND
 ((NULL (GET '*SEMICOL* 'OP))
  (PROGN (PUT '*SEMICOL* 'OP '((-1 0))) (PUT '*COMMA* 'OP '((5 6)))))) 
(PUT 'PRINCOM 'NUMBER-OF-ARGS 1) 
(PUT 'PRINCOM 'DEFINED-ON-LINE '638) 
(PUT 'PRINCOM 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'PRINCOM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PRINCOM (U)
    (PROG (W X Y Z N)
      (SETQ N 0)
      (SETQ X (EXPLODE2 U))
      (PROG ()
       WHILELABEL
        (COND ((NOT (EQ (CAR X) BLANK)) (RETURN NIL)))
        (SETQ X (CDR X))
        (GO WHILELABEL))
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND X (NEQ (CAR X) $EOL$))) (RETURN NIL)))
        (PROGN (SETQ Y (CONS (CAR X) Y)) (SETQ X (CDR X)))
        (GO WHILELABEL))
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND Y (EQ (CAR Y) BLANK))) (RETURN NIL)))
        (SETQ Y (CDR Y))
        (GO WHILELABEL))
      (SETQ W (REVERSIP* Y))
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND X (SETQ X (CDR X)))) (RETURN NIL)))
        (PROGN
         (SETQ Y NIL)
         (SETQ N 0)
         (PROG ()
          WHILELABEL
           (COND ((NOT (EQ (CAR X) BLANK)) (RETURN NIL)))
           (PROGN (SETQ X (CDR X)) (SETQ N (PLUS N 1)))
           (GO WHILELABEL))
         (PROG ()
          WHILELABEL
           (COND ((NOT (AND X (NEQ (CAR X) $EOL$))) (RETURN NIL)))
           (PROGN (SETQ Y (CONS (CAR X) Y)) (SETQ X (CDR X)))
           (GO WHILELABEL))
         (PROG ()
          WHILELABEL
           (COND ((NOT (AND Y (EQ (CAR Y) BLANK))) (RETURN NIL)))
           (SETQ Y (CDR Y))
           (GO WHILELABEL))
         (SETQ Z (CONS (CONS N (REVERSIP* Y)) Z)))
        (GO WHILELABEL))
      (SETQ Y Z)
      (COND
       (Y
        (PROGN
         (SETQ N (CAAR Y))
         (PROG ()
          WHILELABEL
           (COND ((NOT (SETQ Y (CDR Y))) (RETURN NIL)))
           (SETQ N (MIN N (CAAR Y)))
           (GO WHILELABEL)))))
      (PROG ()
       WHILELABEL
        (COND ((NOT Z) (RETURN NIL)))
        (PROGN
         (SETQ Y (CONS (ADDBLANKS (CDAR Z) (DIFFERENCE (CAAR Z) N)) Y))
         (SETQ Z (CDR Z)))
        (GO WHILELABEL))
      (PROG ()
       WHILELABEL
        (COND ((NOT Y) (RETURN NIL)))
        (PROGN
         (SETQ Z (CAR Y))
         (COND
          ((AND (NOT (EQ (CAR Z) BLANK)) (NOT (EQ (CAR W) BLANK)))
           (PROGN (SETQ Z (CONS BLANK Z)) (SETQ W (NCONC* W Z))))
          (T (PROGN (SETQ X (CONS W X)) (SETQ W Z))))
         (SETQ Y (CDR Y)))
        (GO WHILELABEL))
      (SETQ X (CONS W X))
      (SETQ X (REVERSIP* X))
      (PROG ()
       WHILELABEL
        (COND ((NOT X) (RETURN NIL)))
        (PROGN
         (ADDMARKS (CAR X))
         (SETQ X (CDR X))
         (COND (X (OMARK (LIST CURMARK 3)))))
        (GO WHILELABEL)))) 
(PUT 'ADDBLANKS 'NUMBER-OF-ARGS 2) 
(PUT 'ADDBLANKS 'DEFINED-ON-LINE '674) 
(PUT 'ADDBLANKS 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'ADDBLANKS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE ADDBLANKS (U N)
    (COND ((EQUAL N 0) U) (T (CONS BLANK (ADDBLANKS U (DIFFERENCE N 1)))))) 
(PUT 'ADDMARKS 'NUMBER-OF-ARGS 1) 
(PUT 'ADDMARKS 'DEFINED-ON-LINE '677) 
(PUT 'ADDMARKS 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'ADDMARKS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE ADDMARKS (U)
    (PROG (BOOL X)
      (PROG ()
       WHILELABEL
        (COND ((NOT U) (RETURN NIL)))
        (PROGN
         (COND
          ((EQ (CAR U) BLANK)
           (COND
            ((NULL BOOL)
             (PROGN (SETQ BOOL T) (SETQ X (CONS (LIST 'M 'L) X))))))
          (T (SETQ BOOL NIL)))
         (SETQ X (CONS (CAR U) X))
         (SETQ U (CDR U)))
        (GO WHILELABEL))
      (RPLACD BUFFP (REVERSIP* X))
      (PROG ()
       WHILELABEL
        (COND ((NOT (CDR BUFFP)) (RETURN NIL)))
        (SETQ BUFFP (CDR BUFFP))
        (GO WHILELABEL)))) 
(FLUID '(ORIG CURPOS)) 
(PUT 'PRINOS 'NUMBER-OF-ARGS 1) 
(PUT 'PRINOS 'DEFINED-ON-LINE '693) 
(PUT 'PRINOS 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'PRINOS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PRINOS (U)
    (PROG (CURPOS *LOWER ORIG)
      (SETQ CURPOS 0)
      (SETQ ORIG (LIST (POSN)))
      (SETQ CURPOS (CAR ORIG))
      (PRINOY U 0)
      (TERPRI0X))) 
(PUT 'PRINOY 'NUMBER-OF-ARGS 2) 
(PUT 'PRINOY 'DEFINED-ON-LINE '702) 
(PUT 'PRINOY 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'PRINOY 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE PRINOY (U N)
    (PROG (X)
      (COND ((CAR (SETQ X (SPACELEFT U N))) (RETURN (PRINOM U N)))
            ((NULL (CDR X))
             (RETURN
              (COND ((LESSP (CAR ORIG) 10) (PRINOM U N))
                    (T
                     (PROGN
                      (SETQ ORIG (CONS 9 (CDR ORIG)))
                      (TERPRI0X)
                      (SPACES20X (SETQ CURPOS (PLUS 9 (CADAR U))))
                      (PRINOY U N))))))
            (T
             (PROG ()
              A
               (SETQ U (PRINOY U (PLUS N 1)))
               (COND ((OR (NULL (CDR U)) (LEQ (CAAR U) N)) (RETURN NIL)))
               (TERPRI0X)
               (SPACES20X (SETQ CURPOS (PLUS (CAR ORIG) (CADAR U))))
               (GO A))))
      (RETURN U))) 
(PUT 'SPACELEFT 'NUMBER-OF-ARGS 2) 
(PUT 'SPACELEFT 'DEFINED-ON-LINE '719) 
(PUT 'SPACELEFT 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'SPACELEFT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SPACELEFT (U MARK)
    (PROG (N FLG MFLG)
      (SETQ N 0)
      (SETQ N (DIFFERENCE RMAR CURPOS))
      (SETQ U (CDR U))
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND U (NOT FLG) (GEQ N 0))) (RETURN NIL)))
        (PROGN
         (COND ((ATOM (CAR U)) (SETQ N (DIFFERENCE N 1)))
               ((EQ (CAAR U) 'M) NIL)
               ((GEQ MARK (CAAR U)) (PROGN (SETQ FLG T) (SETQ U (CONS NIL U))))
               (T (SETQ MFLG T)))
         (SETQ U (CDR U)))
        (GO WHILELABEL))
      (RETURN (CONS (GEQ N 0) MFLG)))) 
(PUT 'PRINOM 'NUMBER-OF-ARGS 2) 
(PUT 'PRINOM 'DEFINED-ON-LINE '735) 
(PUT 'PRINOM 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'PRINOM 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE PRINOM (U MARK)
    (PROG (N FLG X)
      (SETQ N 0)
      (SETQ N CURPOS)
      (SETQ U (CDR U))
      (PROG ()
       WHILELABEL
        (COND ((NOT (AND U (NOT FLG))) (RETURN NIL)))
        (PROGN
         (COND
          ((ATOM (CAR U))
           (PROGN (SETQ X (PRIN20X (CAR U))) (SETQ N (PLUS N 1))))
          ((EQ (CAAR U) 'M)
           (COND ((EQ (CADAR U) 'U) (SETQ ORIG (CONS N ORIG)))
                 ((EQ (CADAR U) 'L)
                  (COND
                   ((GREATERP (CHARS2 (CDR U)) (DIFFERENCE RMAR (POSN)))
                    (PROGN (TERPRI0X) (SPACES20X (PLUS CURMARK 5))))))
                 (T (SETQ ORIG (CDR ORIG)))))
          ((AND (GEQ MARK (CAAR U))
                (NOT
                 (AND (MEMQ X '(|,|))
                      (GREATERP (DIFFERENCE (DIFFERENCE RMAR N) 6)
                                (CHARSPACE U X MARK)))))
           (PROGN (SETQ FLG T) (SETQ U (CONS NIL U)))))
         (SETQ U (CDR U)))
        (GO WHILELABEL))
      (SETQ CURPOS N)
      (COND
       ((AND (EQUAL MARK 0) (CDR U))
        (PROGN
         (TERPRI0X)
         (SETQ ORIG (LIST 0))
         (SETQ CURPOS 0)
         (PRINOY U MARK))))
      (RETURN U))) 
(PUT 'CHARS2 'NUMBER-OF-ARGS 1) 
(PUT 'CHARS2 'DEFINED-ON-LINE '762) 
(PUT 'CHARS2 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'CHARS2 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CHARS2 (U) (CHARS21 U 0)) 
(PUT 'CHARS21 'NUMBER-OF-ARGS 2) 
(PUT 'CHARS21 'DEFINED-ON-LINE '764) 
(PUT 'CHARS21 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'CHARS21 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CHARS21 (U N)
    (COND ((EQCAR (CAR U) 'M) N) (T (CHARS21 (CDR U) (PLUS N 1))))) 
(PUT 'CHARSPACE 'NUMBER-OF-ARGS 3) 
(PUT 'CHARSPACE 'DEFINED-ON-LINE '767) 
(PUT 'CHARSPACE 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'CHARSPACE 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE CHARSPACE (U CHAR MARK)
    (PROG (N)
      (SETQ N 0)
      (SETQ N 0)
      (PROG ()
       WHILELABEL
        (COND ((NOT U) (RETURN NIL)))
        (PROGN
         (COND ((EQUAL (CAR U) CHAR) (SETQ U (LIST NIL)))
               ((ATOM (CAR U)) (SETQ N (PLUS N 1)))
               ((EQUAL (CAR U) '(M U))
                (PROGN (SETQ N 1000) (SETQ U (LIST NIL))))
               ((AND (NUMBERP (CAAR U)) (LESSP (CAAR U) MARK))
                (SETQ U (LIST NIL))))
         (SETQ U (CDR U)))
        (GO WHILELABEL))
      (RETURN N))) 
(PUT 'SPACES20X 'NUMBER-OF-ARGS 1) 
(PUT 'SPACES20X 'DEFINED-ON-LINE '780) 
(PUT 'SPACES20X 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'SPACES20X 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SPACES20X (N)
    (PROG ()
     WHILELABEL
      (COND ((NOT (GREATERP N 0)) (RETURN NIL)))
      (PROGN (PRIN20X BLANK) (SETQ N (DIFFERENCE N 1)))
      (GO WHILELABEL))) 
(PUT 'PRIN2ROX 'NUMBER-OF-ARGS 1) 
(PUT 'PRIN2ROX 'DEFINED-ON-LINE '784) 
(PUT 'PRIN2ROX 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'PRIN2ROX 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PRIN2ROX (U)
    (PROG (M N X Y)
      (SETQ M 0)
      (SETQ N 0)
      (SETQ M (DIFFERENCE RMAR 12))
      (SETQ N (DIFFERENCE RMAR 1))
      (PROG ()
       WHILELABEL
        (COND ((NOT U) (RETURN NIL)))
        (COND
         ((EQ (CAR U) '|"|)
          (PROGN
           (COND
            ((NOT (STRINGSPACE (CDR U) (DIFFERENCE N *N)))
             (PROGN (TERPRI0X) (SETQ *N 0)))
            (T NIL))
           (PRIN20X '|"|)
           (SETQ U (CDR U))
           (PROG ()
            WHILELABEL
             (COND ((NOT (NOT (EQ (CAR U) '|"|))) (RETURN NIL)))
             (PROGN (PRIN20X (CAR U)) (SETQ U (CDR U)) (SETQ *N (PLUS *N 1)))
             (GO WHILELABEL))
           (PRIN20X '|"|)
           (SETQ U (CDR U))
           (SETQ *N (PLUS *N 2))
           (SETQ X (SETQ Y NIL))))
         ((AND (ATOM (CAR U))
               (NOT
                (AND (EQ (CAR U) BLANK)
                     (OR (EQUAL *N 0) (NULL X) (AND (CDR U) (BREAKP (CADR U)))
                         (AND (BREAKP X) (NOT (EQ Y '!)))))))
          (PROGN
           (SETQ Y X)
           (PRIN20X (SETQ X (CAR U)))
           (SETQ *N (PLUS *N 1))
           (SETQ U (CDR U))
           (COND
            ((OR (EQUAL *N N)
                 (AND (GREATERP *N M) (NOT (BREAKP (CAR U)))
                      (NOSPACE U (DIFFERENCE N *N))))
             (PROGN (TERPRI0X) (SETQ X (SETQ Y NIL))))
            (T NIL))))
         (T (SETQ U (CDR U))))
        (GO WHILELABEL)))) 
(PUT 'NOSPACE 'NUMBER-OF-ARGS 2) 
(PUT 'NOSPACE 'DEFINED-ON-LINE '810) 
(PUT 'NOSPACE 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'NOSPACE 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE NOSPACE (U N)
    (COND ((LESSP N 1) T) ((NULL U) NIL)
          ((NOT (ATOM (CAR U))) (NOSPACE (CDR U) N))
          ((AND (NOT (EQ (CAR U) '!))
                (OR (EQ (CADR U) BLANK) (BREAKP (CADR U))))
           NIL)
          (T (NOSPACE (CDR U) (DIFFERENCE N 1))))) 
(PUT 'BREAKP 'NUMBER-OF-ARGS 1) 
(PUT 'BREAKP 'DEFINED-ON-LINE '818) 
(PUT 'BREAKP 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'BREAKP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BREAKP (U) (MEMBER U '(< > |;| |:| = |)| + - |,| |'| |"|))) 
(PUT 'STRINGSPACE 'NUMBER-OF-ARGS 2) 
(PUT 'STRINGSPACE 'DEFINED-ON-LINE '821) 
(PUT 'STRINGSPACE 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'STRINGSPACE 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE STRINGSPACE (U N)
    (COND ((LESSP N 1) NIL)
          (T (OR (EQ (CAR U) '|"|) (STRINGSPACE (CDR U) (DIFFERENCE N 1)))))) 
(PUT 'PRIN20X 'NUMBER-OF-ARGS 1) 
(PUT 'PRIN20X 'DEFINED-ON-LINE '827) 
(PUT 'PRIN20X 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'PRIN20X 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PRIN20X (U) (COND (RPRIFN* (APPLY1 RPRIFN* U)) (T (PRIN2 U)))) 
(PUT 'TERPRI0X 'NUMBER-OF-ARGS 0) 
(PUT 'TERPRI0X 'DEFINED-ON-LINE '830) 
(PUT 'TERPRI0X 'DEFINED-IN-FILE 'RPRINT/RPRINT.RED) 
(PUT 'TERPRI0X 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE TERPRI0X NIL (COND (RTERFN* (LISPEVAL (LIST RTERFN*))) (T (TERPRI)))) 
(ENDMODULE) 