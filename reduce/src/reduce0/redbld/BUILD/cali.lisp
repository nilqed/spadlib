(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'CALI)) 
(CREATE-PACKAGE
 '(CALI BCSF RING MO DPOLY BAS DPMAT RED GROEB GROEBF MATOP QUOT MOID HF RES
   INTF ODIM PRIME SCRIPTS CALIMAT LF TRIANG)
 '(CONTRIB CALI)) 
(LOAD-PACKAGE 'MATRIX) 
(FLUID '(CALI=BASERING CALI=DEGREES CALI=MONSET)) 
(SWITCH
 (LIST 'HARDZEROTEST 'RED_TOTAL 'BCSIMP 'NOETHERIAN 'FACTORPRIMES 'FACTORUNITS
       'DETECTUNITS 'LEXEFGB)) 
(PUT 'CALI 'TRACE 0) 
(FLAG '(SETCALITRACE) 'OPFN) 
(PUT 'SETCALITRACE 'NUMBER-OF-ARGS 1) 
(PUT 'SETCALITRACE 'DEFINED-ON-LINE '212) 
(PUT 'SETCALITRACE 'DEFINED-IN-FILE 'CALI/CALI.RED) 
(PUT 'SETCALITRACE 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SETCALITRACE (N) (PUT 'CALI 'TRACE N)) 
(FLAG '(SETCALIPRINTTERMS) 'OPFN) 
(PUT 'SETCALIPRINTTERMS 'NUMBER-OF-ARGS 1) 
(PUT 'SETCALIPRINTTERMS 'DEFINED-ON-LINE '217) 
(PUT 'SETCALIPRINTTERMS 'DEFINED-IN-FILE 'CALI/CALI.RED) 
(PUT 'SETCALIPRINTTERMS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SETCALIPRINTTERMS (N)
    (COND ((LEQ N 0) (TYPERR N "number of terms to be printed"))
          (T (PUT 'CALI 'PRINTTERMS N)))) 
(FLAG '(CLEARCALIPRINTTERMS) 'OPFN) 
(PUT 'CLEARCALIPRINTTERMS 'NUMBER-OF-ARGS 0) 
(PUT 'CLEARCALIPRINTTERMS 'DEFINED-ON-LINE '223) 
(PUT 'CLEARCALIPRINTTERMS 'DEFINED-IN-FILE 'CALI/CALI.RED) 
(PUT 'CLEARCALIPRINTTERMS 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE CLEARCALIPRINTTERMS NIL
    (PROGN
     (REMPROP 'CALI 'PRINTTERMS)
     (PROGN (PRIN2 "Term print bound cleared") NIL)
     (TERPRI)
     NIL)) 
(PUT 'CALI_TRACE 'NUMBER-OF-ARGS 0) 
(PUT 'CALI_TRACE 'DEFINED-ON-LINE '229) 
(PUT 'CALI_TRACE 'DEFINED-IN-FILE 'CALI/CALI.RED) 
(PUT 'CALI_TRACE 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE CALI_TRACE NIL (GET 'CALI 'TRACE)) 
(PUT 'STRCAT 'NUMBER-OF-ARGS 1) 
(PUT 'STRCAT 'DEFINED-ON-LINE '236) 
(PUT 'STRCAT 'DEFINED-IN-FILE 'CALI/CALI.RED) 
(PUT 'STRCAT 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE STRCAT (L)
    (PROG (U)
      (SETQ U
              (PROG (X FORALL-RESULT FORALL-ENDPTR)
                (SETQ X L)
               STARTOVER
                (COND ((NULL X) (RETURN NIL)))
                (SETQ FORALL-RESULT ((LAMBDA (X) (EXPLODE X)) (CAR X)))
                (SETQ FORALL-ENDPTR (LASTPAIR FORALL-RESULT))
                (SETQ X (CDR X))
                (COND ((ATOM FORALL-ENDPTR) (GO STARTOVER)))
               LOOPLABEL
                (COND ((NULL X) (RETURN FORALL-RESULT)))
                (RPLACD FORALL-ENDPTR ((LAMBDA (X) (EXPLODE X)) (CAR X)))
                (SETQ FORALL-ENDPTR (LASTPAIR FORALL-ENDPTR))
                (SETQ X (CDR X))
                (GO LOOPLABEL)))
      (PROG ()
       WHILELABEL
        (COND ((NOT (MEMQ '! U)) (RETURN NIL)))
        (SETQ U (DELETE '! U))
        (GO WHILELABEL))
      (PROG ()
       WHILELABEL
        (COND ((NOT (MEMQ '|"| U)) (RETURN NIL)))
        (SETQ U (DELETE '|"| U))
        (GO WHILELABEL))
      (RETURN (COMPRESS (APPEND (APPEND '(|"|) U) '(|"|)))))) 
(PUT 'NUMBERLISTP 'NUMBER-OF-ARGS 1) 
(PUT 'NUMBERLISTP 'DEFINED-ON-LINE '245) 
(PUT 'NUMBERLISTP 'DEFINED-IN-FILE 'CALI/CALI.RED) 
(PUT 'NUMBERLISTP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE NUMBERLISTP (L)
    (COND ((NULL L) T) (T (AND (FIXP (CAR L)) (NUMBERLISTP (CDR L)))))) 
(PUT 'MERGE 'NUMBER-OF-ARGS 3) 
(PUT 'MERGE 'DEFINED-ON-LINE '250) 
(PUT 'MERGE 'DEFINED-IN-FILE 'CALI/CALI.RED) 
(PUT 'MERGE 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE MERGE (L1 L2 FN)
    (COND ((NULL L1) L2) ((NULL L2) L1)
          ((APPLY2 FN (CAR L1) (CAR L2)) (RPLACD L1 (MERGE (CDR L1) L2 FN)))
          (T (RPLACD L2 (MERGE L1 (CDR L2) FN))))) 
(PUT 'LISTEXPAND 'NUMBER-OF-ARGS 2) 
(PUT 'LISTEXPAND 'DEFINED-ON-LINE '257) 
(PUT 'LISTEXPAND 'DEFINED-IN-FILE 'CALI/CALI.RED) 
(PUT 'LISTEXPAND 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE LISTEXPAND (FN L) (EVAL (EXPAND L FN))) 
(PUT 'LISTTEST 'NUMBER-OF-ARGS 3) 
(PUT 'LISTTEST 'DEFINED-ON-LINE '259) 
(PUT 'LISTTEST 'DEFINED-IN-FILE 'CALI/CALI.RED) 
(PUT 'LISTTEST 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE LISTTEST (A B F)
    (COND ((NULL A) NIL)
          ((APPLY2 F (CAR A) B) (COND ((EQUAL (CAR A) NIL) T) (T (CAR A))))
          (T (LISTTEST (CDR A) B F)))) 
(PUT 'LISTMINIMIZE 'NUMBER-OF-ARGS 2) 
(PUT 'LISTMINIMIZE 'DEFINED-ON-LINE '265) 
(PUT 'LISTMINIMIZE 'DEFINED-IN-FILE 'CALI/CALI.RED) 
(PUT 'LISTMINIMIZE 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE LISTMINIMIZE (A F) (COND ((NULL A) NIL) (T (REVERSE (CALI=MIN NIL A F))))) 
(PUT 'CALI=MIN 'NUMBER-OF-ARGS 3) 
(PUT 'CALI=MIN 'DEFINED-ON-LINE '270) 
(PUT 'CALI=MIN 'DEFINED-IN-FILE 'CALI/CALI.RED) 
(PUT 'CALI=MIN 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE CALI=MIN (B A F)
    (COND ((NULL A) B)
          ((OR (LISTTEST B (CAR A) F) (LISTTEST (CDR A) (CAR A) F))
           (CALI=MIN B (CDR A) F))
          (T (CALI=MIN (CONS (CAR A) B) (CDR A) F)))) 
(PUT 'DISJOINT 'NUMBER-OF-ARGS 2) 
(PUT 'DISJOINT 'DEFINED-ON-LINE '283) 
(PUT 'DISJOINT 'DEFINED-IN-FILE 'CALI/CALI.RED) 
(PUT 'DISJOINT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DISJOINT (A B)
    (COND ((NULL A) T) (T (AND (NOT (MEMBER (CAR A) B)) (DISJOINT (CDR A) B))))) 
(PUT 'PRINT_LF 'NUMBER-OF-ARGS 1) 
(PUT 'PRINT_LF 'DEFINED-ON-LINE '286) 
(PUT 'PRINT_LF 'DEFINED-IN-FILE 'CALI/CALI.RED) 
(PUT 'PRINT_LF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PRINT_LF (U)
    (PROGN (COND ((GREATERP (POSN) 69) (PROGN (TERPRI) (TERPRI)))) (PRIN2 U))) 
(PUT 'CALI_CHOOSE 'NUMBER-OF-ARGS 2) 
(PUT 'CALI_CHOOSE 'DEFINED-ON-LINE '290) 
(PUT 'CALI_CHOOSE 'DEFINED-IN-FILE 'CALI/CALI.RED) 
(PUT 'CALI_CHOOSE 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CALI_CHOOSE (M K)
    (COND ((LESSP (LENGTH M) K) NIL)
          ((EQUAL K 1)
           (PROG (X FORALL-RESULT FORALL-ENDPTR)
             (SETQ X M)
             (COND ((NULL X) (RETURN NIL)))
             (SETQ FORALL-RESULT
                     (SETQ FORALL-ENDPTR
                             (CONS ((LAMBDA (X) (LIST X)) (CAR X)) NIL)))
            LOOPLABEL
             (SETQ X (CDR X))
             (COND ((NULL X) (RETURN FORALL-RESULT)))
             (RPLACD FORALL-ENDPTR (CONS ((LAMBDA (X) (LIST X)) (CAR X)) NIL))
             (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
             (GO LOOPLABEL)))
          (T
           (NCONC
            (PROG (X FORALL-RESULT FORALL-ENDPTR)
              (SETQ X (CALI_CHOOSE (CDR M) (DIFFERENCE K 1)))
              (COND ((NULL X) (RETURN NIL)))
              (SETQ FORALL-RESULT
                      (SETQ FORALL-ENDPTR
                              (CONS ((LAMBDA (X) (CONS (CAR M) X)) (CAR X))
                                    NIL)))
             LOOPLABEL
              (SETQ X (CDR X))
              (COND ((NULL X) (RETURN FORALL-RESULT)))
              (RPLACD FORALL-ENDPTR
                      (CONS ((LAMBDA (X) (CONS (CAR M) X)) (CAR X)) NIL))
              (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
              (GO LOOPLABEL))
            (CALI_CHOOSE (CDR M) K))))) 
(FLUID '(|CALI:VARINDEX!|)) 
(SETQ |CALI:VARINDEX!| 0) 
(PUT 'MAKE_CALI_VARNAME 'NUMBER-OF-ARGS 0) 
(PUT 'MAKE_CALI_VARNAME 'DEFINED-ON-LINE '301) 
(PUT 'MAKE_CALI_VARNAME 'DEFINED-IN-FILE 'CALI/CALI.RED) 
(PUT 'MAKE_CALI_VARNAME 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE MAKE_CALI_VARNAME NIL
    (PROGN
     (SETQ |CALI:VARINDEX!| (PLUS |CALI:VARINDEX!| 1))
     (MKID '|CALI:VAR| |CALI:VARINDEX!|))) 
(ENDMODULE) 