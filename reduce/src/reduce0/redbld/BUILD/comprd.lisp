(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'COMPRD)) 
(EXPORTS
 (LIST '*CR2CRN '*CR2RD '*CR2RN '*CRN2CR '*GI2CR '*RD2CR '*RN2CR '|CR:DIFFER|
       '|CR:MINUS| '|CR:MINUSP| '|CR:ONEP| '|CR:PLUS| '|CR:PREP| '|CR:PRIN|
       '|CR:QUOTIENT| '|CR:TIMES| '|CR:ZEROP| 'CR2I* 'CRHALF* 'CRI* 'CRI/2
       'CRONE* 'CRPRCD '|GF2CR:| 'I2CR* 'MKCR)) 
(IMPORTS
 (LIST 'BFLOAT 'BFNZP '|BFTRIM:| 'BFZP 'CHKINT* 'CHKRN* 'CONVPREC 'CONVPREC*
       'CRIM 'CRRL '|EP:| 'ERRORP 'ERRORSET* 'GF2BF 'GFDIFFER 'GFMINUS 'GFPLUS
       'GFQUOTIENT 'GFTIMES 'GFZEROP 'INITDMODE 'LEQ '|LESSP:| '|MAKE:CR|
       '|MAKE:RD| 'MAPRIN 'MKCRN 'MKQUOTE 'MKRN 'MKROUND 'NORMBF 'OVER 'PLUBF
       '|PRECI:| 'PRIN2* 'R2BF '|RD:MINUS| '|RD:MINUSP| '|RD:ONEP| '|RD:PREP|
       '|RD:ZEROP| 'RDPREP1 'RDHALF* 'RDONE* 'RDQOTERR 'RDTWO* 'RDZCHK 'RDZERO*
       'REALRAT 'RETAG 'RNDBFON '|ROUND:MT| 'SAFE-FP-PLUS 'SAFE-FP-TIMES 'TIMBF
       'UNION)) 
(FLUID '(|:PREC:| |:BPREC:|)) 
(GLOBAL '(BFONE* EPSQRT*)) 
(FLUID '(DMODE* *BFSPACE *NUMVAL *ROUNDBF **ROUNDBF)) 
(GLOBAL '(CR-TOLERANCE* DOMAINLIST* !NFPD !FLPREC !RDPREC BFZ* YY!)) 
(SETQ DOMAINLIST* (UNION '(|:CR:|) DOMAINLIST*)) 
(FLUID '(*COMPLEX-ROUNDED)) 
(PUT 'COMPLEX-ROUNDED 'TAG '|:CR:|) 
(PUT '|:CR:| 'DNAME 'COMPLEX-ROUNDED) 
(FLAG '(|:CR:|) 'FIELD) 
(PUT '|:CR:| 'I2D 'I2CR*) 
(PUT '|:CR:| 'PLUS '|CR:PLUS|) 
(PUT '|:CR:| 'TIMES '|CR:TIMES|) 
(PUT '|:CR:| 'DIFFERENCE '|CR:DIFFER|) 
(PUT '|:CR:| 'QUOTIENT '|CR:QUOTIENT|) 
(PUT '|:CR:| 'ZEROP '|CR:ZEROP|) 
(PUT '|:CR:| 'ONEP '|CR:ONEP|) 
(PUT '|:CR:| 'PREPFN '|CR:PREP|) 
(PUT '|:CR:| 'PRIFN '|CR:PRIN|) 
(PUT '|:CR:| 'MINUS '|CR:MINUS|) 
(PUT '|:CR:| 'MINUSP '|CR:MINUSP|) 
(PUT '|:CR:| '|:RN:| '*CR2RN) 
(PUT '|:RN:| '|:CR:| '*RN2CR) 
(PUT '|:RD:| '|:CR:| '*RD2CR) 
(PUT '|:CR:| '|:RD:| '*CR2RD) 
(PUT '|:CR:| '|:CRN:| '*CR2CRN) 
(PUT '|:CRN:| '|:CR:| '*CRN2CR) 
(PUT '|:GI:| '|:CR:| '*GI2CR) 
(PUT '|:CR:| 'CMPXFN 'MKCR) 
(PUT '|:CR:| 'IVALUE 'MKDCRN) 
(PUT '|:CR:| 'REALTYPE '|:RD:|) 
(PUT '|:RD:| 'CMPXTYPE '|:CR:|) 
(PUT '|:CR:| 'ABS 'CRNORM*) 
(PUT '|:CR:| 'REPART '|CR:REPART|) 
(PUT '|:CR:| 'IMPART '|CR:IMPART|) 
(PUT '|CR:MINUSP| 'NUMBER-OF-ARGS 1) 
(PUT '|CR:MINUSP| 'DEFINED-ON-LINE '102) 
(PUT '|CR:MINUSP| 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT '|CR:MINUSP| 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE |CR:MINUSP| (U)
    ((LAMBDA (X Y)
       (COND ((ATOM X) (AND (ZEROP Y) (LESSP X 0)))
             (T (AND (ZEROP (CAR Y)) (LESSP (CAR X) 0)))))
     (CADR U) (CDDR U))) 
(PUT 'STRIPTAG 'NUMBER-OF-ARGS 1) 
(PUT 'STRIPTAG 'DEFINED-ON-LINE '106) 
(PUT 'STRIPTAG 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT 'STRIPTAG 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE STRIPTAG (U) (COND ((ATOM U) U) (T (CDR U)))) 
(PUT 'MKCR 'NUMBER-OF-ARGS 2) 
(PUT 'MKCR 'DEFINED-ON-LINE '108) 
(PUT 'MKCR 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT 'MKCR 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MKCR (U V) (CONS '|:CR:| (CONS (STRIPTAG U) (STRIPTAG V)))) 
(PUT '|GF2CR:| 'NUMBER-OF-ARGS 1) 
(PUT '|GF2CR:| 'DEFINED-ON-LINE '110) 
(PUT '|GF2CR:| 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT '|GF2CR:| 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE |GF2CR:| (X) (CONS '|:CR:| (CONS (STRIPTAG (CAR X)) (STRIPTAG (CDR X))))) 
(PUT 'CRPRCD 'NUMBER-OF-ARGS 1) 
(PUT 'CRPRCD 'DEFINED-ON-LINE '113) 
(PUT 'CRPRCD 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT 'CRPRCD 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CRPRCD (U)
    ((LAMBDA (RL IM) (CONS RL IM)) (CONVPREC* (CADR U)) (CONVPREC* (CDDR U)))) 
(PUT 'CRPRCD2 'NUMBER-OF-ARGS 2) 
(PUT 'CRPRCD2 'DEFINED-ON-LINE '116) 
(PUT 'CRPRCD2 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT 'CRPRCD2 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE CRPRCD2 (X Y) (PROGN (SETQ X (CRPRCD X)) (SETQ YY! (CRPRCD Y)) X)) 
(PUT '|CR:SIMP| 'NUMBER-OF-ARGS 1) 
(PUT '|CR:SIMP| 'DEFINED-ON-LINE '120) 
(PUT '|CR:SIMP| 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT '|CR:SIMP| 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE |CR:SIMP| (U) (CONS (|GF2CR:| (CRPRCD U)) 1)) 
(PUT '|:CR:| 'SIMPFN '|CR:SIMP|) 
(FLAG '(|:CR:|) 'FULL) 
(PUT '|CR:REPART| 'NUMBER-OF-ARGS 1) 
(PUT '|CR:REPART| 'DEFINED-ON-LINE '129) 
(PUT '|CR:REPART| 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT '|CR:REPART| 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE |CR:REPART| (U) (CONS '|:RD:| (CADR U))) 
(PUT '|CR:IMPART| 'NUMBER-OF-ARGS 1) 
(PUT '|CR:IMPART| 'DEFINED-ON-LINE '131) 
(PUT '|CR:IMPART| 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT '|CR:IMPART| 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE |CR:IMPART| (U) (CONS '|:RD:| (CDDR U))) 
(PUT 'I2CR* 'NUMBER-OF-ARGS 1) 
(PUT 'I2CR* 'DEFINED-ON-LINE '133) 
(PUT 'I2CR* 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT 'I2CR* 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE I2CR* (U)
    (PROGN (SETQ U (CHKINT* U)) (MKCR U (COND ((ATOM U) 0.0) (T BFZ*))))) 
(PUT 'TRIMCRRL 'NUMBER-OF-ARGS 1) 
(PUT 'TRIMCRRL 'DEFINED-ON-LINE '137) 
(PUT 'TRIMCRRL 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT 'TRIMCRRL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE TRIMCRRL (N) (TRIMCR (CADR N))) 
(PUT 'TRIMCR 'NUMBER-OF-ARGS 1) 
(PUT 'TRIMCR 'DEFINED-ON-LINE '139) 
(PUT 'TRIMCR 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT 'TRIMCR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE TRIMCR (N)
    (|BFTRIM:|
     (COND
      ((ATOM N)
       (COND ((FLOATP N) (FL2BF N))
             (T
              (NORMBF
               (COND ((NOT (ATOM N)) N) ((FIXP N) (CONS '|:RD:| (CONS N 0)))
                     (T (|READ:NUM| N)))))))
      (T (COND ((ATOM N) N) (T (CONS '|:RD:| N))))))) 
(PUT 'CR2RDERR 'NUMBER-OF-ARGS 0) 
(PUT 'CR2RDERR 'DEFINED-ON-LINE '142) 
(PUT 'CR2RDERR 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT 'CR2RDERR 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE CR2RDERR NIL
    (ERROR 0 "complex to real type conversion requires zero imaginary part")) 
(PUT '*CR2RN 'NUMBER-OF-ARGS 1) 
(PUT '*CR2RN 'DEFINED-ON-LINE '146) 
(PUT '*CR2RN 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT '*CR2RN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE *CR2RN (N)
    (COND
     (((LAMBDA (U) (NOT (COND ((ATOM U) (ZEROP U)) (T (EQUAL (CADR U) 0)))))
       (COND ((ATOM (CDDR N)) (CDDR N)) (T (CONS '|:RD:| (CDDR N)))))
      (CR2RDERR))
     (T (PROGN (SETQ N (REALRAT (TRIMCRRL N))) (MKRN (CAR N) (CDR N)))))) 
(PUT '*RN2CR 'NUMBER-OF-ARGS 1) 
(PUT '*RN2CR 'DEFINED-ON-LINE '151) 
(PUT '*RN2CR 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT '*RN2CR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE *RN2CR (U)
    (PROGN
     (SETQ U (CHKRN* (R2BF (CDR U))))
     (MKCR U (COND ((ATOM U) 0.0) (T BFZ*))))) 
(PUT '*CR2CRN 'NUMBER-OF-ARGS 1) 
(PUT '*CR2CRN 'DEFINED-ON-LINE '156) 
(PUT '*CR2CRN 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT '*CR2CRN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE *CR2CRN (U) (MKCRN (REALRAT (TRIMCRRL U)) (REALRAT (TRIMCR (CDDR U))))) 
(PUT '*CRN2CR 'NUMBER-OF-ARGS 1) 
(PUT '*CRN2CR 'DEFINED-ON-LINE '160) 
(PUT '*CRN2CR 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT '*CRN2CR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE *CRN2CR (U)
    ((LAMBDA (IM)
       ((LAMBDA (RL)
          (MKCR RL
                (COND
                 (*ROUNDBF
                  (COND ((FLOATP IM) (FL2BF IM))
                        (T
                         (NORMBF
                          (COND ((NOT (ATOM IM)) IM)
                                ((FIXP IM) (CONS '|:RD:| (CONS IM 0)))
                                (T (|READ:NUM| IM)))))))
                 (T IM))))
        (CHKRN* (R2BF (CADR U)))))
     (CHKRN* (R2BF (CDDR U))))) 
(PUT '*CR2RD 'NUMBER-OF-ARGS 1) 
(PUT '*CR2RD 'DEFINED-ON-LINE '165) 
(PUT '*CR2RD 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT '*CR2RD 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE *CR2RD (N)
    (COND
     (((LAMBDA (U) (NOT (COND ((ATOM U) (ZEROP U)) (T (EQUAL (CADR U) 0)))))
       (COND ((ATOM (CDDR N)) (CDDR N)) (T (CONS '|:RD:| (CDDR N)))))
      (CR2RDERR))
     (T (CONS '|:RD:| (CADR N))))) 
(PUT '*RD2CR 'NUMBER-OF-ARGS 1) 
(PUT '*RD2CR 'DEFINED-ON-LINE '168) 
(PUT '*RD2CR 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT '*RD2CR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE *RD2CR (U)
    ((LAMBDA (X) (MKCR X (COND ((ATOM X) 0.0) (T BFZ*)))) (CONVPREC U))) 
(PUT '*GI2CR 'NUMBER-OF-ARGS 1) 
(PUT '*GI2CR 'DEFINED-ON-LINE '171) 
(PUT '*GI2CR 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT '*GI2CR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE *GI2CR (U)
    ((LAMBDA (IM)
       ((LAMBDA (RL)
          (MKCR RL
                (COND
                 (*ROUNDBF
                  (COND ((FLOATP IM) (FL2BF IM))
                        (T
                         (NORMBF
                          (COND ((NOT (ATOM IM)) IM)
                                ((FIXP IM) (CONS '|:RD:| (CONS IM 0)))
                                (T (|READ:NUM| IM)))))))
                 (T IM))))
        (CHKINT* (CADR U))))
     (CHKINT* (CDDR U)))) 
(PUT 'BFRSQ 'NUMBER-OF-ARGS 1) 
(PUT 'BFRSQ 'DEFINED-ON-LINE '175) 
(PUT 'BFRSQ 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT 'BFRSQ 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE BFRSQ (U)
    ((LAMBDA (X Y)
       (COND ((ATOM X) (PLUS (TIMES X X) (TIMES Y Y)))
             (T
              (PLUBF (NORMBF (|ROUND:MT| (|TIMES:| X X) |:BPREC:|))
                     (NORMBF (|ROUND:MT| (|TIMES:| Y Y) |:BPREC:|))))))
     (CAR U) (CDR U))) 
(PUT 'CRZCHK 'NUMBER-OF-ARGS 3) 
(PUT 'CRZCHK 'DEFINED-ON-LINE '179) 
(PUT 'CRZCHK 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT 'CRZCHK 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE CRZCHK (U X Y)
    (PROG ()
      (COND
       ((ATOM (CAR U))
        (COND
         ((LESSP (BFRSQ U) (TIMES (BFRSQ X) !FLEPS2)) (RETURN (CONS 0.0 0.0)))
         (T (GO CK)))))
      (COND
       ((|LESSP:| (BFRSQ U)
                  (NORMBF
                   (|ROUND:MT| (|TIMES:| (BFRSQ X) CR-TOLERANCE*) |:BPREC:|)))
        (RETURN (CONS BFZ* BFZ*))))
     CK
      (RETURN
       (CONS (RDZCHK (CAR U) (CAR X) (CAR Y))
             (RDZCHK (CDR U) (CDR X) (CDR Y)))))) 
(PUT '|CR:PLUS| 'NUMBER-OF-ARGS 2) 
(PUT '|CR:PLUS| 'DEFINED-ON-LINE '187) 
(PUT '|CR:PLUS| 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT '|CR:PLUS| 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE |CR:PLUS| (U V)
    (PROG (X Y)
      (SETQ X (CRPRCD2 U V))
      (SETQ Y YY!)
      (SETQ U
              (COND (**ROUNDBF (GFPLUS X Y)) ((SETQ V (SAFE-CRFP-PLUS X Y)) V)
                    (T
                     ((LAMBDA (R)
                        (COND
                         ((ERRORP R)
                          (PROGN
                           (RNDBFON)
                           (GFPLUS (SETQ X (GF2BF X)) (SETQ Y (GF2BF Y)))))
                         (T (CAR R))))
                      (ERRORSET (LIST 'GFPLUS (MKQUOTE X) (MKQUOTE Y)) NIL
                                NIL)))))
      (RETURN (|GF2CR:| (CRZCHK U X Y))))) 
(PUT '|CR:DIFFER| 'NUMBER-OF-ARGS 2) 
(PUT '|CR:DIFFER| 'DEFINED-ON-LINE '196) 
(PUT '|CR:DIFFER| 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT '|CR:DIFFER| 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE |CR:DIFFER| (U V)
    (PROG (X Y)
      (SETQ X (CRPRCD2 U V))
      (SETQ Y YY!)
      (SETQ U
              (COND (**ROUNDBF (GFDIFFER X Y))
                    ((SETQ V (SAFE-CRFP-DIFF X Y)) V)
                    (T
                     ((LAMBDA (R)
                        (COND
                         ((ERRORP R)
                          (PROGN
                           (RNDBFON)
                           (GFPLUS (SETQ X (GF2BF X)) (SETQ Y (GF2BF Y)))))
                         (T (CAR R))))
                      (ERRORSET (LIST 'GFDIFFER (MKQUOTE X) (MKQUOTE Y)) NIL
                                NIL)))))
      (RETURN (|GF2CR:| (CRZCHK U X (GFMINUS Y)))))) 
(PUT '|CR:TIMES| 'NUMBER-OF-ARGS 2) 
(PUT '|CR:TIMES| 'DEFINED-ON-LINE '205) 
(PUT '|CR:TIMES| 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT '|CR:TIMES| 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE |CR:TIMES| (U V)
    ((LAMBDA (X)
       (|GF2CR:|
        (COND (**ROUNDBF (GFTIMES X YY!)) ((SETQ U (SAFE-CRFP-TIMES X YY!)) U)
              (T
               ((LAMBDA (R)
                  (COND
                   ((ERRORP R)
                    (PROGN (RNDBFON) (GFTIMES (GF2BF X) (GF2BF YY!))))
                   (T (CAR R))))
                (ERRORSET* (LIST 'GFTIMES (MKQUOTE X) (MKQUOTE YY!)) NIL))))))
     (CRPRCD2 U V))) 
(PUT '|CR:QUOTIENT| 'NUMBER-OF-ARGS 2) 
(PUT '|CR:QUOTIENT| 'DEFINED-ON-LINE '214) 
(PUT '|CR:QUOTIENT| 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT '|CR:QUOTIENT| 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE |CR:QUOTIENT| (U V)
    ((LAMBDA (X)
       (|GF2CR:|
        (COND
         (((LAMBDA (U)
             (COND
              ((NOT (ATOM (CAR U)))
               (AND (EQUAL (CADR (CAR U)) 0) (EQUAL (CADR (CDR U)) 0)))
              (T (EQUAL U '(0.0 . 0.0)))))
           YY!)
          (RDQOTERR))
         (**ROUNDBF (GFQUOTIENT X YY!)) ((SETQ U (SAFE-CRFP-QUOT X YY!)) U)
         (T
          ((LAMBDA (R)
             (COND
              ((ERRORP R) (PROGN (RNDBFON) (GFQUOTIENT (GF2BF X) (GF2BF YY!))))
              (T (CAR R))))
           (ERRORSET* (LIST 'GFQUOTIENT (MKQUOTE X) (MKQUOTE YY!)) NIL))))))
     (CRPRCD2 U V))) 
(PUT 'SAFE-CRFP-PLUS 'NUMBER-OF-ARGS 2) 
(PUT 'SAFE-CRFP-PLUS 'DEFINED-ON-LINE '224) 
(PUT 'SAFE-CRFP-PLUS 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT 'SAFE-CRFP-PLUS 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SAFE-CRFP-PLUS (U V)
    ((LAMBDA (X Y) (COND ((AND X Y) (CRZCHK (CONS X Y) U V))))
     (SAFE-FP-PLUS (CAR U) (CAR V)) (SAFE-FP-PLUS (CDR U) (CDR V)))) 
(PUT 'SAFE-CRFP-DIFF 'NUMBER-OF-ARGS 2) 
(PUT 'SAFE-CRFP-DIFF 'DEFINED-ON-LINE '228) 
(PUT 'SAFE-CRFP-DIFF 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT 'SAFE-CRFP-DIFF 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SAFE-CRFP-DIFF (U V)
    ((LAMBDA (X Y) (COND ((AND X Y) (CRZCHK (CONS X Y) U (GFMINUS V)))))
     (SAFE-FP-PLUS (CAR U) (MINUS (CAR V)))
     (SAFE-FP-PLUS (CDR U) (MINUS (CDR V))))) 
(PUT 'SAFE-CRFP-TIMES 'NUMBER-OF-ARGS 2) 
(PUT 'SAFE-CRFP-TIMES 'DEFINED-ON-LINE '232) 
(PUT 'SAFE-CRFP-TIMES 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT 'SAFE-CRFP-TIMES 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SAFE-CRFP-TIMES (U V)
    (PROG (RU IU RV IV A B)
      (SETQ RU (CAR U))
      (SETQ IU (CDR U))
      (SETQ RV (CAR V))
      (SETQ IV (CDR V))
      (COND
       ((OR (NOT (SETQ A (SAFE-FP-TIMES RU RV)))
            (NOT (SETQ B (SAFE-FP-TIMES IU IV))))
        (RETURN NIL)))
      (COND ((NOT (SETQ U (SAFE-FP-PLUS A (MINUS B)))) (RETURN NIL)))
      (SETQ U (RDZCHK U A (SAFE-FP-MINUS B)))
      (COND
       ((OR (NOT (SETQ A (SAFE-FP-TIMES RU IV)))
            (NOT (SETQ B (SAFE-FP-TIMES IU RV))))
        (RETURN NIL)))
      (COND ((NOT (SETQ V (SAFE-FP-PLUS A B))) (RETURN NIL)))
      (RETURN (CONS U (RDZCHK V A B))))) 
(PUT 'SAFE-CRFP-QUOT 'NUMBER-OF-ARGS 2) 
(PUT 'SAFE-CRFP-QUOT 'DEFINED-ON-LINE '244) 
(PUT 'SAFE-CRFP-QUOT 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT 'SAFE-CRFP-QUOT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE SAFE-CRFP-QUOT (U V)
    (PROG (RU IU RV IV A B DD)
      (SETQ RU (CAR U))
      (SETQ IU (CDR U))
      (SETQ RV (CAR V))
      (SETQ IV (CDR V))
      (COND
       ((OR (NOT (SETQ A (SAFE-FP-TIMES RV RV)))
            (NOT (SETQ B (SAFE-FP-TIMES IV IV)))
            (NOT (SETQ DD (SAFE-FP-PLUS A B))))
        (RETURN NIL)))
      (SETQ RV (QUOTIENT RV DD))
      (SETQ IV (QUOTIENT IV DD))
      (COND
       ((OR (NOT (SETQ A (SAFE-FP-TIMES RU RV)))
            (NOT (SETQ B (SAFE-FP-TIMES IU IV)))
            (NOT (SETQ U (SAFE-FP-PLUS A B))))
        (RETURN NIL)))
      (SETQ U (RDZCHK U A B))
      (COND
       ((OR (NOT (SETQ A (SAFE-FP-TIMES RU (MINUS IV))))
            (NOT (SETQ B (SAFE-FP-TIMES IU RV)))
            (NOT (SETQ V (SAFE-FP-PLUS A B))))
        (RETURN NIL)))
      (RETURN (CONS U (RDZCHK V A B))))) 
(PUT '|CR:MINUS| 'NUMBER-OF-ARGS 1) 
(PUT '|CR:MINUS| 'DEFINED-ON-LINE '261) 
(PUT '|CR:MINUS| 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT '|CR:MINUS| 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE |CR:MINUS| (U) (|GF2CR:| (GFMINUS (CRPRCD U)))) 
(PUT '|CR:ZEROP| 'NUMBER-OF-ARGS 1) 
(PUT '|CR:ZEROP| 'DEFINED-ON-LINE '263) 
(PUT '|CR:ZEROP| 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT '|CR:ZEROP| 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE |CR:ZEROP| (U)
    (AND
     ((LAMBDA (U) (COND ((ATOM U) (ZEROP U)) (T (EQUAL (CADR U) 0))))
      (COND ((ATOM (CADR U)) (CADR U)) (T (CONS '|:RD:| (CADR U)))))
     ((LAMBDA (U) (COND ((ATOM U) (ZEROP U)) (T (EQUAL (CADR U) 0))))
      (COND ((ATOM (CDDR U)) (CDDR U)) (T (CONS '|:RD:| (CDDR U))))))) 
(PUT '|CR:ONEP| 'NUMBER-OF-ARGS 1) 
(PUT '|CR:ONEP| 'DEFINED-ON-LINE '266) 
(PUT '|CR:ONEP| 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT '|CR:ONEP| 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE |CR:ONEP| (U)
    (AND
     ((LAMBDA (U) (COND ((ATOM U) (ZEROP U)) (T (EQUAL (CADR U) 0))))
      (COND ((ATOM (CDDR U)) (CDDR U)) (T (CONS '|:RD:| (CDDR U)))))
     (|RD:ONEP|
      (MKROUND (COND ((ATOM (CADR U)) (CADR U)) (T (CONS '|:RD:| (CADR U)))))))) 
(PUT '|CR:PREP| 'NUMBER-OF-ARGS 1) 
(PUT '|CR:PREP| 'DEFINED-ON-LINE '272) 
(PUT '|CR:PREP| 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT '|CR:PREP| 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE |CR:PREP| (U)
    (CRPREP1
     (CONS (|RD:PREP| (CONS '|:RD:| (CADR U)))
           (|RD:PREP| (CONS '|:RD:| (CDDR U)))))) 
(PUT 'CRPREP1 'NUMBER-OF-ARGS 1) 
(PUT 'CRPREP1 'DEFINED-ON-LINE '275) 
(PUT 'CRPREP1 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT 'CRPREP1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CRPREP1 (U)
    ((LAMBDA (A D)
       (COND ((AND (NOT (NUMBERP D)) (|RD:ZEROP| D)) A)
             (T
              (PROGN
               (SETQ D
                       (COND
                        ((OR (NUMBERP D) (NOT (|RD:MINUSP| D))) (CRPRIMP D))
                        (T (LIST 'MINUS (CRPRIMP (|RD:MINUS| D))))))
               (COND ((AND (NOT (NUMBERP A)) (|RD:ZEROP| A)) D)
                     (T
                      (PROGN
                       (COND ((EQUAL A (MINUS 1)) (SETQ A (LIST 'MINUS 1)))
                             ((AND (NOT (NUMBERP A)) (|RD:MINUSP| A))
                              (SETQ A (LIST 'MINUS (|RD:MINUS| A)))))
                       (LIST 'PLUS A D))))))))
     (CAR U) (CDR U))) 
(PUT 'CRPRIMP 'NUMBER-OF-ARGS 1) 
(PUT 'CRPRIMP 'DEFINED-ON-LINE '286) 
(PUT 'CRPRIMP 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT 'CRPRIMP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CRPRIMP (U)
    (COND ((EQUAL U 1) 'I) ((EQUAL U (MINUS 1)) (LIST 'MINUS 'I))
          (T (LIST 'TIMES U 'I)))) 
(PUT '|CR:PRIN| 'NUMBER-OF-ARGS 1) 
(PUT '|CR:PRIN| 'DEFINED-ON-LINE '289) 
(PUT '|CR:PRIN| 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT '|CR:PRIN| 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE |CR:PRIN| (V)
    (COND
     ((OR (ATOM (SETQ V (|CR:PREP| V))) (EQ (CAR V) 'TIMES)
          (MEMQ (CAR V) DOMAINLIST*))
      (MAPRIN V))
     (T (PROGN (PRIN2* "(") (MAPRIN V) (PRIN2* ")"))))) 
(INITDMODE 'COMPLEX-ROUNDED) 
(PUT 'CRONE* 'NUMBER-OF-ARGS 0) 
(PUT 'CRONE* 'DEFINED-ON-LINE '297) 
(PUT 'CRONE* 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT 'CRONE* 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE CRONE* NIL (MKCR (RDONE*) (RDZERO*))) 
(PUT 'CRHALF* 'NUMBER-OF-ARGS 0) 
(PUT 'CRHALF* 'DEFINED-ON-LINE '299) 
(PUT 'CRHALF* 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT 'CRHALF* 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE CRHALF* NIL (MKCR (RDHALF*) (RDZERO*))) 
(PUT 'CRI* 'NUMBER-OF-ARGS 0) 
(PUT 'CRI* 'DEFINED-ON-LINE '301) 
(PUT 'CRI* 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT 'CRI* 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE CRI* NIL (MKCR (RDZERO*) (RDONE*))) 
(PUT 'CRI/2 'NUMBER-OF-ARGS 0) 
(PUT 'CRI/2 'DEFINED-ON-LINE '303) 
(PUT 'CRI/2 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT 'CRI/2 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE CRI/2 NIL (MKCR (RDZERO*) (RDHALF*))) 
(PUT 'CR2I* 'NUMBER-OF-ARGS 0) 
(PUT 'CR2I* 'DEFINED-ON-LINE '305) 
(PUT 'CR2I* 'DEFINED-IN-FILE 'ARITH/COMPRD.RED) 
(PUT 'CR2I* 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE CR2I* NIL (MKCR (RDZERO*) (RDTWO*))) 
(ENDMODULE) 