(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'RLISP88)) 
(FLUID '(*MINUSLITER *MODE *OLDMINUSLITER *RLISP88 FORBINOPS* OLDMODE*)) 
(SWITCH (LIST 'RLISP88)) 
(CREATE-PACKAGE '(RLISP88 FOR88 LOOPS88 BQUOTE RVECTOR MSTRUCT RECORDS INSPECT)
                '(RLISP)) 
(PUT 'RLISP88_ON 'NUMBER-OF-ARGS 0) 
(PUT 'RLISP88_ON 'DEFINED-ON-LINE '42) 
(PUT 'RLISP88_ON 'DEFINED-IN-FILE 'RLISP88/RLISP88.RED) 
(PUT 'RLISP88_ON 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE RLISP88_ON NIL
    (PROG ()
      (COND (*RLISP88 (RETURN NIL)))
      (SETQ *RLISP88 T)
      (SETQ *OLDMINUSLITER *MINUSLITER)
      (SETQ *MINUSLITER T)
      (DEFLIST
       '((MODULE FORMMODULE) (GLOBAL FORMGLOBALFLUID) (FLUID FORMGLOBALFLUID)
         (PROCEDURE NFORMPROC))
       'FORMFN)
      (REMPROP 'JOIN 'NEWNAM)
      (PUT 'CONC 'NEWNAM 'JOIN)
      (PUT 'OLDWHEN 'INFIX (GET 'WHEN 'INFIX))
      (REMPROP 'WHEN 'INFIX)
      (FLAG '(FOR) 'NOCHANGE)
      (DEFLIST FORBINOPS* 'BIN)
      (DEFLIST '((FOR FORSTAT88) (REPEAT REPEATSTAT88) (WHILE WHILSTAT88))
               'STAT)
      (DEFLIST '((FOR FORMFOR88) (REPEAT FORMREPEAT88) (WHILE FORMWHILE88))
               'FORMFN)
      (COPYD 'FOR 'FOR88)
      (COPYD 'OLDREPEAT* 'REPEAT)
      (REMD 'REPEAT)
      (COPYD 'REPEAT 'REPEAT88)
      (COPYD 'OLDWHILE* 'WHILE)
      (REMD 'WHILE)
      (COPYD 'WHILE 'WHILE88)
      (COND
       ((NOT (EQ *MODE 'SYMBOLIC))
        (PROGN
         (SETQ OLDMODE* *MODE)
         (SETQ *MODE (PROGN (SETQ ALGLIST* (CONS NIL NIL)) 'SYMBOLIC)))))
      (REMPROP 'ARRAY 'STAT)
      (REMPROP 'INDEX 'STAT)
      (REMPROP 'DEF 'STAT)
      (REMPROP 'ARRAY 'FORMFN)
      (REMPROP 'ADD 'NUMBER-OF-ARGS)
      (REMPROP 'ADD 'INLINE))) 
(PUT 'RLISP88_OFF 'NUMBER-OF-ARGS 0) 
(PUT 'RLISP88_OFF 'DEFINED-ON-LINE '82) 
(PUT 'RLISP88_OFF 'DEFINED-IN-FILE 'RLISP88/RLISP88.RED) 
(PUT 'RLISP88_OFF 'PROCEDURE_TYPE '(ARROW UNIT GENERAL)) 
(DE RLISP88_OFF NIL
    (PROG ()
      (COND ((NULL *RLISP88) (RETURN NIL))
            ((NULL (GETD 'OLDREPEAT*)) (REDERR "Rlisp88 mode not set")))
      (SETQ *MINUSLITER *OLDMINUSLITER)
      (REMPROP 'MODULE 'FORMFN)
      (REMPROP 'GLOBAL 'FORMFN)
      (REMPROP 'FLUID 'FORMFN)
      (PUT 'PROCEDURE 'FORMFN 'FORMPROC)
      (REMPROP 'CONC 'NEWNAM)
      (PUT 'JOIN 'NEWNAM 'CONC)
      (PUT 'WHEN 'INFIX (GET 'OLDWHEN 'INFIX))
      (REMFLAG '(FOR) 'NOCHANGE)
      (PROG (X)
        (SETQ X '(APPEND COLLECT COUNT JOIN MAXIMIZE MINIMIZE))
       LAB
        (COND ((NULL X) (RETURN NIL)))
        ((LAMBDA (X) (REMPROP X 'BIN)) (CAR X))
        (SETQ X (CDR X))
        (GO LAB))
      (DEFLIST '((PRODUCT TIMES2) (SUM PLUS2)) 'BIN)
      (DEFLIST '((FOR FORSTAT) (REPEAT REPEATSTAT) (WHILE WHILSTAT)) 'STAT)
      (DEFLIST '((FOR FORMFOR) (REPEAT FORMREPEAT) (WHILE FORMWHILE)) 'FORMFN)
      (REMD 'FOR)
      (REMD 'REPEAT)
      (REMD 'WHILE)
      (COPYD 'REPEAT 'OLDREPEAT*)
      (COPYD 'WHILE 'OLDWHILE*)
      (REMD 'OLDREPEAT*)
      (REMD 'OLDWHILE*)
      (COND
       (OLDMODE*
        (PROGN
         (SETQ *MODE (PROGN (SETQ ALGLIST* (CONS NIL NIL)) OLDMODE*))
         (SETQ OLDMODE* NIL))))
      (DEFLIST '((ARRAY RLIS) (DEF RLIS) (INDEX RLIS)) 'STAT)
      (PUT 'ARRAY 'FORMFN 'FORMARRAY)
      (PUT 'ADD 'NUMBER-OF-ARGS 2)
      (PUT 'ADD 'INLINE '(LAMBDA (U V) (CONS U V))))) 
(PUT 'RLISP88 'SIMPFG '((T (RLISP88_ON)) (NIL (RLISP88_OFF)))) 
(ENDMODULE) 