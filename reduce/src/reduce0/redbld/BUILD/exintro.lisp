(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'EXINTRO)) 
(FLUID '(DEPL* METRICD* METRICU*)) 
(GLOBAL
 '(DIMEX* LFTSHFT* DETM* BASISFORML* SGN* WEDGEMTCH* BNDEQ* BASISVECTORL*
   INDXL* NOSUML* *NOSUM COORD* KEEPL* *PRODUCT-RULE)) 
(SETQ DIMEX* (*Q2F (SIMP 'DIM))) 
(SETQ SGN* (CONS (LIST (CONS (CONS 'SGN 1) 1)) 1)) 
(SETQ *PRODUCT-RULE T) 
(RLISTAT
 '(PFORM FDOMAIN REMFDOMAIN TVECTOR SPACEDIM FORDER REMFORDER FRAME DUALFRAME
   KEEP CLOSEDFORM XPND NOXPND ISOLATE REMISOLATE)) 
(PUT 'SPACEDIM 'NUMBER-OF-ARGS 1) 
(PUT 'SPACEDIM 'DEFINED-ON-LINE '46) 
(PUT 'SPACEDIM 'DEFINED-IN-FILE 'EXCALC/EXINTRO.RED) 
(PUT 'SPACEDIM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE SPACEDIM (U) (PROG () (SETQ DIMEX* (*Q2F (SIMP (CAR U)))))) 
(PUT 'FDOMAIN 'NUMBER-OF-ARGS 1) 
(PUT 'FDOMAIN 'DEFINED-ON-LINE '51) 
(PUT 'FDOMAIN 'DEFINED-IN-FILE 'EXCALC/EXINTRO.RED) 
(PUT 'FDOMAIN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE FDOMAIN (U) (FDOMAIN1 U)) 
(PUT 'FDOMAIN1 'NUMBER-OF-ARGS 1) 
(PUT 'FDOMAIN1 'DEFINED-ON-LINE '53) 
(PUT 'FDOMAIN1 'DEFINED-IN-FILE 'EXCALC/EXINTRO.RED) 
(PUT 'FDOMAIN1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE FDOMAIN1 (U)
    (PROG ()
     WHILELABEL
      (COND ((NOT U) (RETURN NIL)))
      (PROGN
       (COND ((NOT (EQEXPR (CAR U))) (ERRPRI2 (CAR U) 'HOLD))
             (T
              (PROG (Y)
                (RMSUBS)
                (SETQ Y (GET (CADAR U) 'RTYPE))
                (REMPROP (CADAR U) 'RTYPE)
                (PROG (X)
                  (SETQ X (CDR (CADDAR U)))
                 LAB
                  (COND ((NULL X) (RETURN NIL)))
                  ((LAMBDA (X)
                     (PROGN
                      (COND
                       ((INDVARP X)
                        (PROG (J)
                          (SETQ J (MKAINDXC (FLATINDXL (CDR X)) NIL))
                         LAB
                          (COND ((NULL J) (RETURN NIL)))
                          ((LAMBDA (J)
                             (DEPEND1 (CADAR U)
                                      (PREPSQ
                                       (SIMPINDEXVAR
                                        (SUBLIS (PAIR (FLATINDXL (CDR X)) J)
                                                X)))
                                      T))
                           (CAR J))
                          (SETQ J (CDR J))
                          (GO LAB)))
                       (T (DEPEND1 (CADAR U) X T)))))
                   (CAR X))
                  (SETQ X (CDR X))
                  (GO LAB))
                (FLAG (LIST (CADAR U)) 'IMPFUN)
                (COND (Y (PUT (CADAR U) 'RTYPE Y))))))
       (SETQ U (CDR U)))
      (GO WHILELABEL))) 
(PUT 'REMFDOMAIN 'NUMBER-OF-ARGS 1) 
(PUT 'REMFDOMAIN 'DEFINED-ON-LINE '73) 
(PUT 'REMFDOMAIN 'DEFINED-IN-FILE 'EXCALC/EXINTRO.RED) 
(PUT 'REMFDOMAIN 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE REMFDOMAIN (U)
    (PROG (X)
      (PROG (J)
        (SETQ J U)
       LAB
        (COND ((NULL J) (RETURN NIL)))
        ((LAMBDA (J)
           (COND
            ((SETQ X (ASSOC J DEPL*))
             (PROGN (SETQ DEPL* (DELETE X DEPL*)) (REMFLAG (LIST J) 'IMPFUN)))
            (T (RERROR 'EXCALC 1 (LIST J " had no dependencies")))))
         (CAR J))
        (SETQ J (CDR J))
        (GO LAB)))) 
(PUT 'PUTFORM 'NUMBER-OF-ARGS 2) 
(PUT 'PUTFORM 'DEFINED-ON-LINE '82) 
(PUT 'PUTFORM 'DEFINED-IN-FILE 'EXCALC/EXINTRO.RED) 
(PUT 'PUTFORM 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE PUTFORM (U V)
    (COND
     ((ATOM U)
      (PROGN
       (COND
        ((FLAGP U 'RESERVED)
         (PROGN
          (REMFLAG (LIST U) 'RESERVED)
          (LPRI
           (LIST "***Warning: reserved variable" U
                 "declared exterior form")))))
       (PUT (SETQ U (*A2K U)) 'FDEGREE (LIST (*Q2F (SIMP V))))
       (PUT U 'CLEARFN 'CLEARFDEGREE)))
     (T
      (PROG (X Y N)
        (SETQ N 0)
        (SETQ N (LENGTH (CDR U)))
        (COND
         ((AND (SETQ X (GET (CAR U) 'IFDEGREE)) (SETQ Y (ASSOC N X)))
          (SETQ X (DELETE Y X))))
        (PUT (CAR U) 'IFDEGREE
             (COND (X (CONS (CONS N (*Q2F (SIMP V))) X))
                   (T (LIST (CONS N (*Q2F (SIMP V)))))))
        (SETQ X (CAR U))
        (FLAG (LIST X) 'INDEXVAR)
        (PUT X 'RTYPE 'INDEXED-FORM)
        (PUT X 'SIMPFN 'SIMPINDEXVAR)
        (PUT X 'PARTITFN 'PARTITINDEXVAR)
        (PUT X 'EVALARGFN 'REVALINDL)
        (FLAG (LIST X) 'FULL)
        (PUT X 'PRIFN 'INDVARPRT)
        (PUT X 'FANCY-PPRIFN 'XINDVARPRT)
        (REMFLAG '(MINUS) 'INTFN)
        (COND ((NULL (CAR (SIMP V))) (FLAG (LIST X) 'COVARIANT))))))) 
(PUT 'PFORM 'NUMBER-OF-ARGS 1) 
(PUT 'PFORM 'DEFINED-ON-LINE '110) 
(PUT 'PFORM 'DEFINED-IN-FILE 'EXCALC/EXINTRO.RED) 
(PUT 'PFORM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE PFORM (U)
    (PROG ()
      (RMSUBS)
      (PROG (J)
        (SETQ J U)
       LAB
        (COND ((NULL J) (RETURN NIL)))
        ((LAMBDA (J)
           (COND ((NOT (EQEXPR J)) (ERRPRI2 J 'HOLD))
                 ((EQCAR (CADR J) 'LIST)
                  (PROG (K)
                    (SETQ K (CDADR J))
                   LAB
                    (COND ((NULL K) (RETURN NIL)))
                    ((LAMBDA (K) (PUTFORM K (CADDR J))) (CAR K))
                    (SETQ K (CDR K))
                    (GO LAB)))
                 (T (PUTFORM (CADR J) (CADDR J)))))
         (CAR J))
        (SETQ J (CDR J))
        (GO LAB)))) 
(PUT 'TVECTOR 'NUMBER-OF-ARGS 1) 
(PUT 'TVECTOR 'DEFINED-ON-LINE '119) 
(PUT 'TVECTOR 'DEFINED-IN-FILE 'EXCALC/EXINTRO.RED) 
(PUT 'TVECTOR 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE TVECTOR (U)
    (PROG (J)
      (SETQ J U)
     LAB
      (COND ((NULL J) (RETURN NIL)))
      ((LAMBDA (J) (PUTFORM J (MINUS 1))) (CAR J))
      (SETQ J (CDR J))
      (GO LAB))) 
(PUT 'GETLOWER 'NUMBER-OF-ARGS 1) 
(PUT 'GETLOWER 'DEFINED-ON-LINE '122) 
(PUT 'GETLOWER 'DEFINED-IN-FILE 'EXCALC/EXINTRO.RED) 
(PUT 'GETLOWER 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE GETLOWER (U) (CDR (ATSOC U METRICD*))) 
(PUT 'GETUPPER 'NUMBER-OF-ARGS 1) 
(PUT 'GETUPPER 'DEFINED-ON-LINE '125) 
(PUT 'GETUPPER 'DEFINED-IN-FILE 'EXCALC/EXINTRO.RED) 
(PUT 'GETUPPER 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE GETUPPER (U) (CDR (ATSOC U METRICU*))) 
(PUT 'XPND 'NUMBER-OF-ARGS 1) 
(PUT 'XPND 'DEFINED-ON-LINE '128) 
(PUT 'XPND 'DEFINED-IN-FILE 'EXCALC/EXINTRO.RED) 
(PUT 'XPND 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE XPND (U) (PROGN (RMSUBS) (REMFLAG U 'NOXPND))) 
(PUT 'NOXPND 'NUMBER-OF-ARGS 1) 
(PUT 'NOXPND 'DEFINED-ON-LINE '131) 
(PUT 'NOXPND 'DEFINED-IN-FILE 'EXCALC/EXINTRO.RED) 
(PUT 'NOXPND 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE NOXPND (U) (PROGN (RMSUBS) (FLAG U 'NOXPND))) 
(PUT 'CLOSEDFORM 'NUMBER-OF-ARGS 1) 
(PUT 'CLOSEDFORM 'DEFINED-ON-LINE '134) 
(PUT 'CLOSEDFORM 'DEFINED-IN-FILE 'EXCALC/EXINTRO.RED) 
(PUT 'CLOSEDFORM 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE CLOSEDFORM (U) (PROGN (RMSUBS) (FLAG U 'CLOSED))) 
(PUT 'MEMQCAR 'NUMBER-OF-ARGS 2) 
(PUT 'MEMQCAR 'DEFINED-ON-LINE '138) 
(PUT 'MEMQCAR 'DEFINED-IN-FILE 'EXCALC/EXINTRO.RED) 
(PUT 'MEMQCAR 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE MEMQCAR (U V) (AND (NULL (ATOM U)) (MEMQ (CAR U) V))) 
(ENDMODULE) 