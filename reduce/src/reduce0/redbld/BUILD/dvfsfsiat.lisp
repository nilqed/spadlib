(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'DVFSFSIAT)) 
(REVISION 'DVFSFSIAT
          "$Id: dvfsfsiat.red 6086 2021-10-08 16:01:45Z thomas-sturm $") 
(COPYRIGHT 'DVFSFSIAT "(c) 1995-2009 A. Dolzmann and T. Sturm") 
(PUT 'DVFSF_SIMPLAT1 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_SIMPLAT1 'DEFINED-ON-LINE '34) 
(PUT 'DVFSF_SIMPLAT1 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSIAT.RED) 
(PUT 'DVFSF_SIMPLAT1 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SIMPLAT1 (ATF SOP)
    (PROG (OP)
      (SETQ OP (DVFSF_OP ATF))
      (COND
       ((OR (EQ OP 'EQUAL) (EQ OP 'NEQ))
        (RETURN (DVFSF_SAFIELD OP (DVFSF_ARG2L ATF) SOP))))
      (RETURN (DVFSF_SAVAL OP (DVFSF_ARG2L ATF) (DVFSF_ARG2R ATF) SOP)))) 
(PUT 'DVFSF_SAVAL 'NUMBER-OF-ARGS 4) 
(PUT 'DVFSF_SAVAL 'DEFINED-ON-LINE '47) 
(PUT 'DVFSF_SAVAL 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSIAT.RED) 
(PUT 'DVFSF_SAVAL 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SAVAL (OP LHS RHS SOP)
    (PROG ()
      (COND ((MINUSF LHS) (SETQ LHS (NEGF LHS))))
      (COND ((MINUSF RHS) (SETQ RHS (NEGF RHS))))
      (COND
       ((EQUAL LHS RHS)
        (RETURN (COND ((OR (EQ OP 'SDIV) (EQ OP 'NASSOC)) 'FALSE) (T 'TRUE)))))
      (COND
       ((NULL LHS)
        (PROGN
         (COND ((EQ OP 'SDIV) (RETURN 'FALSE)))
         (COND ((EQ OP 'NASSOC) (RETURN (DVFSF_SAFIELD 'NEQ RHS SOP))))
         (RETURN (DVFSF_SAFIELD 'EQUAL RHS SOP)))))
      (COND
       ((NULL RHS)
        (PROGN
         (COND
          ((OR (EQ OP 'SDIV) (EQ OP 'NASSOC))
           (RETURN (DVFSF_SAFIELD 'NEQ LHS SOP))))
         (COND ((EQ OP 'ASSOC) (RETURN (DVFSF_SAFIELD 'EQUAL LHS SOP))))
         (RETURN 'TRUE))))
      (RETURN (DVFSF_SAVAL1 OP LHS RHS)))) 
(PUT 'DVFSF_SAVAL1 'NUMBER-OF-ARGS 3) 
(PUT 'DVFSF_SAVAL1 'DEFINED-ON-LINE '76) 
(PUT 'DVFSF_SAVAL1 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSIAT.RED) 
(PUT 'DVFSF_SAVAL1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SAVAL1 (OP LHS RHS)
    (PROG (GCD NATF1 SFF JUNCT)
      (SETQ JUNCT (COND ((OR (EQ OP 'SDIV) (EQ OP 'NASSOC)) 'AND) (T 'OR)))
      (SETQ LHS (ABSF (DVFSF_VSIMPF LHS)))
      (SETQ RHS (ABSF (DVFSF_VSIMPF RHS)))
      (COND
       ((EQUAL LHS RHS)
        (RETURN (COND ((OR (EQ OP 'SDIV) (EQ OP 'NASSOC)) 'FALSE) (T 'TRUE)))))
      (SETQ GCD (SFTO_GCDF* LHS RHS))
      (SETQ LHS ((LAMBDA (*EXP) (QUOTF1 LHS GCD)) T))
      (SETQ RHS ((LAMBDA (*EXP) (QUOTF1 RHS GCD)) T))
      (SETQ NATF1 (DVFSF_SAVAL2 OP LHS RHS))
      (COND
       ((EQ JUNCT 'AND)
        (PROGN
         (COND ((EQ NATF1 'FALSE) (RETURN 'FALSE)))
         (SETQ SFF (DVFSF_SAFIELD 'NEQ GCD 'AND))
         (RETURN (DVFSF_COMPOSE 'AND NATF1 SFF)))))
      (COND ((EQ NATF1 'TRUE) (RETURN NATF1)))
      (SETQ SFF (DVFSF_SAFIELD 'EQUAL GCD 'OR))
      (RETURN (DVFSF_COMPOSE 'OR NATF1 SFF)))) 
(PUT 'DVFSF_COMPOSE 'NUMBER-OF-ARGS 3) 
(PUT 'DVFSF_COMPOSE 'DEFINED-ON-LINE '102) 
(PUT 'DVFSF_COMPOSE 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSIAT.RED) 
(PUT 'DVFSF_COMPOSE 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_COMPOSE (OP AT F)
    (COND ((AND (EQ OP 'OR) (OR (EQ AT 'TRUE) (EQ F 'TRUE))) 'TRUE)
          ((AND (EQ OP 'AND) (OR (EQ AT 'FALSE) (EQ F 'FALSE))) 'FALSE)
          ((OR (EQ AT 'TRUE) (EQ AT 'FALSE)) F)
          ((OR (EQ F 'TRUE) (EQ F 'FALSE)) AT)
          ((OR (NEQ OP (COND ((ATOM F) F) (T (CAR F)))) (NOT (CL_CXFP F)))
           (LIST OP AT F))
          (T (CONS OP (CONS AT (CDR F)))))) 
(PUT 'DVFSF_SAVAL2 'NUMBER-OF-ARGS 3) 
(PUT 'DVFSF_SAVAL2 'DEFINED-ON-LINE '119) 
(PUT 'DVFSF_SAVAL2 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSIAT.RED) 
(PUT 'DVFSF_SAVAL2 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SAVAL2 (OP LHS RHS)
    (PROG (W)
      (COND
       ((GREATERP DVFSF_P* 0)
        (PROGN
         (SETQ W (DVFSF_SACVAL OP LHS RHS))
         (COND ((OR (EQ W 'TRUE) (EQ W 'FALSE)) (RETURN W)))
         (SETQ OP (DVFSF_OP W))
         (SETQ LHS (ABSF (DVFSF_ARG2L W)))
         (SETQ RHS (ABSF (DVFSF_ARG2R W)))))
       (T
        (PROGN
         (SETQ W (DVFSF_SAAVAL OP LHS RHS))
         (COND ((OR (EQ W 'TRUE) (EQ W 'FALSE)) (RETURN W)))
         (COND
          ((NEQ W 'FAILED)
           (PROGN
            (SETQ OP (DVFSF_OP W))
            (SETQ LHS (ABSF (DVFSF_ARG2L W)))
            (SETQ RHS (ABSF (DVFSF_ARG2R W)))))))))
      (COND
       ((EQUAL LHS RHS)
        (RETURN (COND ((OR (EQ OP 'SDIV) (EQ OP 'NASSOC)) 'FALSE) (T 'TRUE)))))
      (COND
       ((AND (OR (EQ OP 'ASSOC) (EQ OP 'NASSOC)) (ORDP RHS LHS))
        (RETURN (DVFSF_MK2 OP RHS LHS))))
      (RETURN (DVFSF_MK2 OP LHS RHS)))) 
(PUT 'DVFSF_SACVAL 'NUMBER-OF-ARGS 3) 
(PUT 'DVFSF_SACVAL 'DEFINED-ON-LINE '150) 
(PUT 'DVFSF_SACVAL 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSIAT.RED) 
(PUT 'DVFSF_SACVAL 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SACVAL (OP LHS RHS)
    (PROG (LCONT RCONT LV RV)
      (COND
       ((AND (OR (ATOM LHS) (ATOM (CAR LHS))) (OR (ATOM RHS) (ATOM (CAR RHS))))
        (PROGN
         (COND
          ((EQ OP 'ASSOC)
           (RETURN
            (COND ((EQUAL (DVFSF_V LHS) (DVFSF_V RHS)) 'TRUE) (T 'FALSE)))))
         (COND
          ((EQ OP 'NASSOC)
           (RETURN
            (COND ((NEQ (DVFSF_V LHS) (DVFSF_V RHS)) 'TRUE) (T 'FALSE)))))
         (COND
          ((EQ OP 'SDIV)
           (RETURN
            (COND ((LESSP (DVFSF_V LHS) (DVFSF_V RHS)) 'TRUE) (T 'FALSE)))))
         (RETURN
          (COND ((LEQ (DVFSF_V LHS) (DVFSF_V RHS)) 'TRUE) (T 'FALSE))))))
      (SETQ LCONT (SFTO_DCONTENTF LHS))
      (SETQ LHS ((LAMBDA (*EXP) (QUOTF1 LHS LCONT)) T))
      (SETQ RCONT (SFTO_DCONTENTF RHS))
      (SETQ RHS ((LAMBDA (*EXP) (QUOTF1 RHS RCONT)) T))
      (SETQ LV (DVFSF_V LCONT))
      (SETQ RV (DVFSF_V RCONT))
      (COND
       ((GEQ LV RV)
        (SETQ LHS
                ((LAMBDA (G125)
                   (COND (*PHYSOP-LOADED (PHYSOP-MULTF G125 LHS))
                         (T (POLY-MULTF G125 LHS))))
                 (CAR (SIMP (EXPT DVFSF_P* (DIFFERENCE LV RV)))))))
       (T
        (SETQ RHS
                ((LAMBDA (G127)
                   (COND (*PHYSOP-LOADED (PHYSOP-MULTF G127 RHS))
                         (T (POLY-MULTF G127 RHS))))
                 (CAR (SIMP (EXPT DVFSF_P* (DIFFERENCE RV LV))))))))
      (RETURN (DVFSF_MK2 OP LHS RHS)))) 
(PUT 'DVFSF_SAFIELD 'NUMBER-OF-ARGS 3) 
(PUT 'DVFSF_SAFIELD 'DEFINED-ON-LINE '182) 
(PUT 'DVFSF_SAFIELD 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSIAT.RED) 
(PUT 'DVFSF_SAFIELD 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SAFIELD (OP LHS SOP)
    (PROG ()
      (SETQ LHS (DVFSF_VSIMPF LHS))
      (COND
       ((OR (ATOM LHS) (ATOM (CAR LHS)))
        (COND ((EQ OP 'EQUAL) (RETURN (COND ((NULL LHS) 'TRUE) (T 'FALSE))))
              (T (RETURN (COND ((NULL LHS) 'FALSE) (T 'TRUE)))))))
      (SETQ LHS (SFTO_DPRPARTF LHS))
      (COND ((GREATERP DVFSF_P* 0) (RETURN (DVFSF_SAPFACF OP LHS SOP))))
      (SETQ LHS (DVFSF_DPPOWER LHS))
      (COND
       ((OR (ATOM LHS) (ATOM (CAR LHS)))
        (RETURN (COND ((EQ OP 'EQUAL) 'FALSE) (T 'TRUE)))))
      (RETURN (DVFSF_SAPFACF OP LHS SOP)))) 
(PUT 'DVFSF_SAPFACF 'NUMBER-OF-ARGS 3) 
(PUT 'DVFSF_SAPFACF 'DEFINED-ON-LINE '203) 
(PUT 'DVFSF_SAPFACF 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSIAT.RED) 
(PUT 'DVFSF_SAPFACF 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SAPFACF (OP LHS SOP)
    (PROG (JUNCT)
      (SETQ JUNCT (COND ((EQ OP 'EQUAL) 'OR) (T 'AND)))
      (COND
       ((AND *RLSIFAC (OR *RLSIEXPLA (AND *RLSIEXPL (EQUAL SOP JUNCT))))
        (RETURN
         ((LAMBDA (G130)
            (COND ((AND G130 (CDR G130)) (CONS JUNCT G130))
                  ((NULL G130) (COND ((EQ JUNCT 'AND) 'TRUE) (T 'FALSE)))
                  (T (CAR G130))))
          (PROG (X FORALL-RESULT FORALL-ENDPTR)
            (SETQ X (CDR (FCTRF LHS)))
            (COND ((NULL X) (RETURN NIL)))
            (SETQ FORALL-RESULT
                    (SETQ FORALL-ENDPTR
                            (CONS
                             ((LAMBDA (X) (DVFSF_SAPEQ OP (CAR X))) (CAR X))
                             NIL)))
           LOOPLABEL
            (SETQ X (CDR X))
            (COND ((NULL X) (RETURN FORALL-RESULT)))
            (RPLACD FORALL-ENDPTR
                    (CONS ((LAMBDA (X) (DVFSF_SAPEQ OP (CAR X))) (CAR X)) NIL))
            (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
            (GO LOOPLABEL))))))
      (RETURN (DVFSF_SAPEQ OP LHS)))) 
(PUT 'DVFSF_DPPOWER 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_DPPOWER 'DEFINED-ON-LINE '218) 
(PUT 'DVFSF_DPPOWER 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSIAT.RED) 
(PUT 'DVFSF_DPPOWER 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_DPPOWER (F)
    (PROG (QR P)
      (SETQ P (CAR (SIMP 'P)))
      (SETQ QR (QREMF F P))
      (PROG ()
       WHILELABEL
        (COND ((NOT (NULL (CDR QR))) (RETURN NIL)))
        (PROGN (SETQ F (CAR QR)) (SETQ QR (QREMF (CAR QR) P)) NIL)
        (GO WHILELABEL))
      (RETURN F))) 
(PUT 'DVFSF_SAAVAL 'NUMBER-OF-ARGS 3) 
(PUT 'DVFSF_SAAVAL 'DEFINED-ON-LINE '231) 
(PUT 'DVFSF_SAAVAL 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSIAT.RED) 
(PUT 'DVFSF_SAAVAL 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SAAVAL (OP LHS RHS)
    (PROG (W)
      (SETQ W (DVFSF_SAPPOW OP LHS RHS))
      (COND ((NEQ W 'FAILED) (RETURN W)))
      (SETQ W (DVFSF_SAVPC OP LHS RHS))
      (COND ((NEQ W 'FAILED) (RETURN W)))
      (SETQ W (DVFSF_SAPUREINTC OP LHS RHS))
      (COND ((NEQ W 'FAILED) (RETURN W)))
      (SETQ W (DVFSF_SAPFACTOR OP LHS RHS))
      (COND ((NEQ W 'FAILED) (RETURN W)))
      (RETURN 'FAILED))) 
(PUT 'DVFSF_SAPPOW 'NUMBER-OF-ARGS 3) 
(PUT 'DVFSF_SAPPOW 'DEFINED-ON-LINE '252) 
(PUT 'DVFSF_SAPPOW 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSIAT.RED) 
(PUT 'DVFSF_SAPPOW 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SAPPOW (OP LHS RHS)
    (PROG (LP RP)
      (SETQ LP (DVFSF_PPOWERP LHS))
      (SETQ RP (DVFSF_PPOWERP RHS))
      (COND
       ((AND RP (EQUAL LHS (CAR (SIMP 1))))
        (RETURN (COND ((EQUAL OP 'ASSOC) 'FALSE) (T 'TRUE)))))
      (COND
       ((AND LP (EQUAL RHS (CAR (SIMP 1))))
        (RETURN (COND ((EQUAL OP 'NASSOC) 'TRUE) (T 'FALSE)))))
      (RETURN 'FAILED))) 
(PUT 'DVFSF_SAVPC 'NUMBER-OF-ARGS 3) 
(PUT 'DVFSF_SAVPC 'DEFINED-ON-LINE '269) 
(PUT 'DVFSF_SAVPC 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSIAT.RED) 
(PUT 'DVFSF_SAVPC 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SAVPC (OP LHS RHS)
    (PROG (W)
      (COND ((NOT *RLSIFAC) (RETURN 'FAILED)))
      (SETQ W (DVFSF_SAVPC1 OP LHS RHS))
      (COND ((EQ W 'FAILED) (RETURN 'FAILED)))
      (SETQ OP (DVFSF_OP W))
      (COND
       ((EQUAL (DVFSF_ARG2L W) (DVFSF_ARG2R W))
        (RETURN (COND ((EQ OP 'NASSOC) 'FALSE) (T 'TRUE)))))
      (RETURN W))) 
(PUT 'DVFSF_SAVPC1 'NUMBER-OF-ARGS 3) 
(PUT 'DVFSF_SAVPC1 'DEFINED-ON-LINE '292) 
(PUT 'DVFSF_SAVPC1 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSIAT.RED) 
(PUT 'DVFSF_SAVPC1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SAVPC1 (OP LHS RHS)
    (PROG (N)
      (RETURN
       (COND
        ((AND (OR (ATOM RHS) (ATOM (CAR RHS))) (SETQ N (DVFSF_PPOWERP LHS)))
         (PROGN
          (COND
           ((EQ OP 'ASSOC)
            (DVFSF_MK2 'NASSOC (SFTO_ZDEQN RHS N) (CAR (SIMP 1))))
           ((EQ OP 'NASSOC)
            (DVFSF_MK2 'ASSOC (SFTO_ZDEQN RHS N) (CAR (SIMP 1))))
           ((EQ OP 'DIV) (DVFSF_MK2 'NASSOC (SFTO_ZDGEN RHS N) (CAR (SIMP 1))))
           ((EQ OP 'SDIV)
            (DVFSF_MK2 'NASSOC (SFTO_ZDGTN RHS N) (CAR (SIMP 1))))
           (T (REDERR "Bug in dvfsf_savpc")))))
        ((AND (OR (ATOM LHS) (ATOM (CAR LHS))) (SETQ N (DVFSF_PPOWERP RHS)))
         (PROGN
          (COND
           ((EQ OP 'ASSOC)
            (DVFSF_MK2 'NASSOC (SFTO_ZDEQN LHS N) (CAR (SIMP 1))))
           ((EQ OP 'NASSOC)
            (DVFSF_MK2 'ASSOC (SFTO_ZDEQN LHS N) (CAR (SIMP 1))))
           ((EQ OP 'DIV) (DVFSF_MK2 'ASSOC (SFTO_ZDGTN LHS N) (CAR (SIMP 1))))
           ((EQ OP 'SDIV) (DVFSF_MK2 'ASSOC (SFTO_ZDGEN LHS N) (CAR (SIMP 1))))
           (T (REDERR "Bug in dvfsf_savpc")))))
        (T 'FAILED))))) 
(PUT 'DVFSF_PPOWERP 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_PPOWERP 'DEFINED-ON-LINE '327) 
(PUT 'DVFSF_PPOWERP 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSIAT.RED) 
(PUT 'DVFSF_PPOWERP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_PPOWERP (U)
    (PROG (ROU W)
      (SETQ ROU (SFTO_REORDER U 'P))
      (SETQ W
              (AND (NOT (OR (ATOM ROU) (ATOM (CAR ROU))))
                   (EQUAL (CAAAR ROU) 'P)
                   (OR (ATOM (CDAR ROU)) (ATOM (CAR (CDAR ROU))))
                   (NULL (CDR ROU))))
      (COND (W (RETURN (CDAAR U)))))) 
(PUT 'DVFSF_PPOLYP 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_PPOLYP 'DEFINED-ON-LINE '340) 
(PUT 'DVFSF_PPOLYP 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSIAT.RED) 
(PUT 'DVFSF_PPOLYP 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_PPOLYP (F)
    (PROG (W)
      (COND ((OR (ATOM F) (ATOM (CAR F))) (RETURN T)))
      (SETQ W (KERNELS F))
      (RETURN (AND (NULL (CDR W)) (EQ (CAR W) 'P))))) 
(PUT 'DVFSF_PPOLYDEC 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_PPOLYDEC 'DEFINED-ON-LINE '351) 
(PUT 'DVFSF_PPOLYDEC 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSIAT.RED) 
(PUT 'DVFSF_PPOLYDEC 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_PPOLYDEC (F)
    (COND ((NULL F) NIL) ((OR (ATOM F) (ATOM (CAR F))) (LIST (CONS F 0)))
          (T (CONS (CONS (CDAR F) (CDAAR F)) (DVFSF_PPOLYDEC (CDR F)))))) 
(PUT 'DVFSF_VSIMPF 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_VSIMPF 'DEFINED-ON-LINE '362) 
(PUT 'DVFSF_VSIMPF 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSIAT.RED) 
(PUT 'DVFSF_VSIMPF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_VSIMPF (F)
    (PROG (W FDC CEP C N CDC)
      (COND ((OR (ATOM F) (ATOM (CAR F))) (RETURN F)))
      (COND ((NOT (DVFSF_PPOLYP F)) (RETURN F)))
      (SETQ FDC (REVERSIP (DVFSF_PPOLYDEC F)))
      (SETQ W (CAR FDC))
      (SETQ FDC (CDR FDC))
      (COND ((NULL FDC) (RETURN F)))
      (SETQ N (CDR W))
      (SETQ C (CAR W))
      (COND
       ((OR (EQUAL C 1) (EQUAL C (MINUS 1)))
        (RETURN (CAR (SIMP (LIST 'EXPT 'P N))))))
      (SETQ CDC (SORT (ZFACTOR C) (FUNCTION GREATERPCDR)))
      (COND
       ((LESSP (PLUS N (CDR (CAR CDC))) (CDR (CAR FDC)))
        (RETURN (CAR (SIMP (LIST 'TIMES C (LIST 'EXPT 'P N)))))))
      (PROG ()
       WHILELABEL
        (COND ((NOT CDC) (RETURN NIL)))
        (PROGN
         (SETQ CEP (CAR CDC))
         (SETQ W (DVFSF_VSIMPF1 (CAR CEP) (CDR CEP) N FDC))
         (COND ((EQ W 'FAILED) (SETQ CDC NIL)) (T (SETQ CDC (CDR CDC))))
         NIL)
        (GO WHILELABEL))
      (COND ((EQ W 'FAILED) (RETURN F)))
      (RETURN (CAR (SIMP (LIST 'TIMES C (LIST 'EXPT 'P N))))))) 
(PUT 'DVFSF_VSIMPF1 'NUMBER-OF-ARGS 4) 
(PUT 'DVFSF_VSIMPF1 'DEFINED-ON-LINE '397) 
(PUT 'DVFSF_VSIMPF1 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSIAT.RED) 
(PUT 'DVFSF_VSIMPF1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_VSIMPF1 (Q M N FDC)
    (PROG (W K QP)
      (PROG ()
       WHILELABEL
        (COND ((NOT FDC) (RETURN NIL)))
        (PROGN
         (SETQ W (CAR FDC))
         (SETQ K (DIFFERENCE (CDR W) N))
         (COND ((LESSP M K) (PROGN (SETQ W NIL) (SETQ FDC NIL)))
               (T
                (PROGN
                 (SETQ QP (EXPT (ABS Q) (PLUS (DIFFERENCE M K) 1)))
                 (COND ((EQUAL (GCDF* QP (CAR W)) QP) (SETQ FDC (CDR FDC)))
                       (T (PROGN (SETQ W 'FAILED) (SETQ FDC NIL) NIL)))))))
        (GO WHILELABEL))
      (COND ((EQ W 'FAILED) (RETURN 'FAILED))))) 
(PUT 'DVFSF_SAPUREINTC 'NUMBER-OF-ARGS 3) 
(PUT 'DVFSF_SAPUREINTC 'DEFINED-ON-LINE '423) 
(PUT 'DVFSF_SAPUREINTC 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSIAT.RED) 
(PUT 'DVFSF_SAPUREINTC 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SAPUREINTC (OP LHS RHS)
    (COND ((NOT *RLSIFAC) 'FAILED)
          ((NOT
            (AND (OR (ATOM LHS) (ATOM (CAR LHS)))
                 (OR (ATOM RHS) (ATOM (CAR RHS)))))
           'FAILED)
          ((OR (EQ OP 'ASSOC) (EQ OP 'NASSOC))
           (DVFSF_MK2 OP (SFTO_SQFPARTZ (TIMES LHS RHS)) (CAR (SIMP 1))))
          ((EQ OP 'DIV) (DVFSF_MK2 'ASSOC (SFTO_SQFPARTZ LHS) (CAR (SIMP 1))))
          ((EQ OP 'SDIV)
           (DVFSF_MK2 'NASSOC (SFTO_SQFPARTZ RHS) (CAR (SIMP 1))))
          (T (REDERR "bug dvfsf_sapureintc")))) 
(PUT 'DVFSF_SAPEQ 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_SAPEQ 'DEFINED-ON-LINE '442) 
(PUT 'DVFSF_SAPEQ 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSIAT.RED) 
(PUT 'DVFSF_SAPEQ 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SAPEQ (OP LHS)
    (COND
     ((NOT
       (AND (NOT (OR (ATOM LHS) (ATOM (CAR LHS)))) (EQ (CAAAR LHS) 'P)
            (EQUAL (CDAAR LHS) 1)
            (OR (ATOM (CDAR LHS)) (ATOM (CAR (CDAR LHS))))
            (OR (ATOM (CDR LHS)) (ATOM (CAR (CDR LHS))))))
      (DVFSF_MK2 OP LHS NIL))
     ((OR (NEQ (CDAR LHS) 1) (NOT (MINUSF (CDR LHS))) (NOT (PRIMEP (CDR LHS))))
      (COND ((EQ OP 'EQUAL) 'FALSE) (T 'TRUE)))
     (T
      (DVFSF_MK2 (COND ((EQ OP 'EQUAL) 'NASSOC) (T 'ASSOC)) (NEGF (CDR LHS))
                 (CAR (SIMP 1)))))) 
(PUT 'DVFSF_SAPFACTOR 'NUMBER-OF-ARGS 3) 
(PUT 'DVFSF_SAPFACTOR 'DEFINED-ON-LINE '458) 
(PUT 'DVFSF_SAPFACTOR 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFSIAT.RED) 
(PUT 'DVFSF_SAPFACTOR 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_SAPFACTOR (OP LHS RHS)
    (PROG (W)
      (COND
       ((EQ OP 'SDIV)
        (PROGN
         (SETQ W (QREMF RHS (CAR (SIMP 'P))))
         (COND ((NULL (CDR W)) (RETURN (DVFSF_MK2 'DIV LHS (CAR W)))))
         (RETURN 'FAILED))))
      (COND
       ((EQ OP 'DIV)
        (PROGN
         (SETQ W (QREMF LHS (CAR (SIMP 'P))))
         (COND ((NULL (CDR W)) (RETURN (DVFSF_MK2 'SDIV (CAR W) RHS))))
         (RETURN 'FAILED))))
      (RETURN 'FAILED))) 
(ENDMODULE) 