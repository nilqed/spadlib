(cl:declaim (cl:optimize cl:debug cl:safety))
(cl:declaim (sb-ext:muffle-conditions sb-ext:compiler-note cl:style-warning))
(MODULE (LIST 'DVFSFQE)) 
(REVISION 'DVFSFQE "$Id: dvfsfqe.red 6030 2021-09-16 14:01:45Z thomas-sturm $") 
(COPYRIGHT 'DVFSFQE "(c) 1995-2009 A. Dolzmann, T. Sturm") 
(PUT 'DVFSF_VARSEL 'NUMBER-OF-ARGS 3) 
(PUT 'DVFSF_VARSEL 'DEFINED-ON-LINE '34) 
(PUT 'DVFSF_VARSEL 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFQE.RED) 
(PUT 'DVFSF_VARSEL 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_VARSEL (F VL THEO) (LIST (CAR VL))) 
(PUT 'DVFSF_PMULTF 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_PMULTF 'DEFINED-ON-LINE '42) 
(PUT 'DVFSF_PMULTF 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFQE.RED) 
(PUT 'DVFSF_PMULTF 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_PMULTF (U)
    ((LAMBDA (G132)
       (COND (*PHYSOP-LOADED (PHYSOP-MULTF U G132)) (T (POLY-MULTF U G132))))
     (CAR (SIMP 'P)))) 
(PUT 'DVFSF_PMULTSQ 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_PMULTSQ 'DEFINED-ON-LINE '45) 
(PUT 'DVFSF_PMULTSQ 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFQE.RED) 
(PUT 'DVFSF_PMULTSQ 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_PMULTSQ (U) (MULTSQ U (SIMP 'P))) 
(PUT 'DVFSF_IPMULTSQ 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_IPMULTSQ 'DEFINED-ON-LINE '48) 
(PUT 'DVFSF_IPMULTSQ 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFQE.RED) 
(PUT 'DVFSF_IPMULTSQ 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_IPMULTSQ (U) (MULTSQ U (INVSQ (SIMP 'P)))) 
(PUT 'DVFSF_TRANSLAT 'NUMBER-OF-ARGS 5) 
(PUT 'DVFSF_TRANSLAT 'DEFINED-ON-LINE '58) 
(PUT 'DVFSF_TRANSLAT 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFQE.RED) 
(PUT 'DVFSF_TRANSLAT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_TRANSLAT (ATF V THEO POS ANS)
    (PROG (OP LHS RHS)
      (COND ((NOT (MEMQ V (DVFSF_VARLAT ATF))) (RETURN (CONS NIL NIL))))
      (COND ((NOT POS) (SETQ ATF (DVFSF_NEGATEAT ATF))))
      (SETQ OP (DVFSF_OP ATF))
      (SETQ LHS (DVFSF_ARG2L ATF))
      (SETQ RHS (DVFSF_ARG2R ATF))
      (COND
       ((EQ OP 'NEQ) (RETURN (DVFSF_TRANSLAT2 V 'SDIV (LIST (CONS LHS RHS))))))
      (COND
       ((OR (EQUAL OP 'SDIV) (EQUAL OP 'DIV) (EQUAL OP 'EQUAL))
        (RETURN (DVFSF_TRANSLAT2 V OP (LIST (CONS LHS RHS))))))
      (COND
       ((EQ OP 'ASSOC)
        (RETURN
         (DVFSF_TRANSLAT2 V 'DIV (LIST (CONS LHS RHS) (CONS RHS LHS))))))
      (COND
       ((EQ OP 'NASSOC)
        (RETURN
         (DVFSF_TRANSLAT2 V 'SDIV (LIST (CONS LHS RHS) (CONS RHS LHS))))))
      (REDERR "BUG IN dvfsf_translat"))) 
(PUT 'DVFSF_TRANSLAT2 'NUMBER-OF-ARGS 3) 
(PUT 'DVFSF_TRANSLAT2 'DEFINED-ON-LINE '83) 
(PUT 'DVFSF_TRANSLAT2 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFQE.RED) 
(PUT 'DVFSF_TRANSLAT2 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_TRANSLAT2 (V OP L)
    (PROG (M EQSOLL PR CL DL EL FL A AA B BB CO)
      (COND
       ((EQUAL OP 'EQUAL)
        (RETURN
         (CONS
          (LIST (CONS 'EQUAL (LIST (DVFSF_MKCSOL (DVFSF_MKPAIR (CAAR L) V)))))
          NIL))))
      (PROG (X)
        (SETQ X L)
       LAB
        (COND ((NULL X) (RETURN NIL)))
        ((LAMBDA (X)
           (PROGN
            (SETQ PR (DVFSF_MKPAIR (CAR X) V))
            (SETQ A (CAR PR))
            (SETQ B (CDR PR))
            (SETQ PR (DVFSF_MKPAIR (CDR X) V))
            (SETQ AA (CAR PR))
            (SETQ BB (CDR PR))
            (COND
             ((NULL AA)
              (PROGN
               (SETQ CL (LTO_INSERT (DVFSF_MKCPOINT (NEGF B) A) CL))
               (SETQ DL (LTO_INSERT (DVFSF_MKCPOINT BB A) DL))))
             ((NULL A)
              (PROGN
               (SETQ EL (LTO_INSERT (DVFSF_MKCPOINT B AA) EL))
               (SETQ FL (LTO_INSERT (DVFSF_MKCPOINT (NEGF BB) AA) FL))))
             (T
              (PROGN
               (SETQ CL (LTO_INSERT (DVFSF_MKCPOINT (NEGF B) A) CL))
               (SETQ DL (LTO_INSERT (DVFSF_MKCPOINT BB A) DL))
               (SETQ EL (LTO_INSERT (DVFSF_MKCPOINT B AA) EL))
               (SETQ FL (LTO_INSERT (DVFSF_MKCPOINT (NEGF BB) AA) FL))
               (SETQ FL (LTO_INSERT (DVFSF_MKCPOINT (NEGF BB) A) FL))
               (SETQ CO
                       (CONS 'AND
                             (LIST (DVFSF_0MK2 'NEQ A) (DVFSF_0MK2 'NEQ AA))))
               (SETQ A (CONS A 1))
               (SETQ B (CONS B 1))
               (SETQ AA (CONS AA 1))
               (SETQ BB (CONS BB 1))
               (SETQ M
                       (ADDSQ (MULTSQ BB (INVSQ AA))
                              (NEGSQ (MULTSQ B (INVSQ A)))))
               (SETQ EL
                       (LTO_INSERT (LIST CO (MULTSQ (MULTSQ A (INVSQ AA)) M))
                                   EL))
               (SETQ DL
                       (LTO_INSERT (LIST CO (MULTSQ (MULTSQ AA (INVSQ A)) M))
                                   DL)))))))
         (CAR X))
        (SETQ X (CDR X))
        (GO LAB))
      (RETURN
       (CONS (LIST (CONS 'C CL) (CONS 'D DL) (CONS 'E EL) (CONS 'F FL)) NIL)))) 
(PUT 'DVFSF_MKPAIR 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_MKPAIR 'DEFINED-ON-LINE '119) 
(PUT 'DVFSF_MKPAIR 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFQE.RED) 
(PUT 'DVFSF_MKPAIR 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DVFSF_MKPAIR (U V)
    (PROG (D)
      (SETQ U (SFTO_REORDER U V))
      (SETQ D (DEGR U V))
      (COND ((EQUAL D 0) (RETURN (CONS NIL (REORDER U)))))
      (COND ((EQUAL D 1) (RETURN (CONS (REORDER (CDAR U)) (REORDER (CDR U))))))
      (REDERR (LIST "degree violation in" (PREPF (REORDER U)))))) 
(PUT 'DVFSF_MKCSOL 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_MKCSOL 'DEFINED-ON-LINE '130) 
(PUT 'DVFSF_MKCSOL 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFQE.RED) 
(PUT 'DVFSF_MKCSOL 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_MKCSOL (PR)
    (LIST (DVFSF_0MK2 'NEQ (CAR PR))
          (MULTSQ (CONS (NEGF (CDR PR)) 1) (INVSQ (CONS (CAR PR) 1))))) 
(PUT 'DVFSF_MKCPOINT 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_MKCPOINT 'DEFINED-ON-LINE '133) 
(PUT 'DVFSF_MKCPOINT 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFQE.RED) 
(PUT 'DVFSF_MKCPOINT 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DVFSF_MKCPOINT (B A)
    (LIST (DVFSF_0MK2 'NEQ A) (MULTSQ (CONS B 1) (INVSQ (CONS A 1))))) 
(PUT 'DVFSF_ELIMSET 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_ELIMSET 'DEFINED-ON-LINE '143) 
(PUT 'DVFSF_ELIMSET 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFQE.RED) 
(PUT 'DVFSF_ELIMSET 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DVFSF_ELIMSET (V ALP)
    (PROG (W ESETL ATAL CL EL M1 M2 I)
      (SETQ I 0)
      (SETQ ATAL (CAR ALP))
      (SETQ CL (LTO_CATSOC 'C ATAL))
      (SETQ EL (LTO_CATSOC 'E ATAL))
      (COND ((AND *RLVERBOSE (NULL EL)) (IOTO_PRIN2 "#u")))
      (SETQ ESETL (CONS (LIST 'TRUE (SIMP 1)) (LTO_CATSOC 'EQUAL ATAL)))
      (SETQ ESETL (NCONC (LTO_CATSOC 'F ATAL) ESETL))
      (PROG (D)
        (SETQ D (LTO_CATSOC 'D ATAL))
       LAB
        (COND ((NULL D) (RETURN NIL)))
        ((LAMBDA (D)
           (SETQ ESETL (CONS (LIST (CAR D) (DVFSF_IPMULTSQ (CADR D))) ESETL)))
         (CAR D))
        (SETQ D (CDR D))
        (GO LAB))
      (PROG (C)
        (SETQ C CL)
       LAB
        (COND ((NULL C) (RETURN NIL)))
        ((LAMBDA (C)
           (PROGN
            (SETQ ESETL (CONS (LIST (CAR C) (DVFSF_IPMULTSQ (CADR C))) ESETL))
            (COND
             (EL
              (PROGN
               (PROG (E)
                 (SETQ E EL)
                LAB
                 (COND ((NULL E) (RETURN NIL)))
                 ((LAMBDA (E)
                    (SETQ ESETL
                            (CONS
                             (LIST (CONS 'AND (LIST (CAR C) (CAR E)))
                                   (ADDSQ (CADR E) (CADR C)))
                             ESETL)))
                  (CAR E))
                 (SETQ E (CDR E))
                 (GO LAB))
               (PROG (CC)
                 (SETQ CC CL)
                LAB
                 (COND ((NULL CC) (RETURN NIL)))
                 ((LAMBDA (CC)
                    (PROGN
                     (SETQ M2 (CADR CC))
                     (SETQ M1 (ADDSQ (CADR C) (NEGSQ M2)))
                     (SETQ ESETL
                             (CONS
                              (LIST (CONS 'AND (LIST (CAR C) (CAR CC)))
                                    (ADDSQ (DVFSF_PMULTSQ M1) M2))
                              ESETL))
                     (SETQ W
                             (COND
                              ((NEQ DVFSF_P* 0)
                               (MIN (LENGTH CL) (DIFFERENCE (ABS DVFSF_P*) 1)))
                              (T (LENGTH CL))))
                     (PROG (Z)
                       (SETQ Z 1)
                      LAB
                       (COND ((MINUSP (DIFFERENCE W Z)) (RETURN NIL)))
                       (SETQ ESETL
                               (CONS
                                (LIST (CONS 'AND (LIST (CAR C) (CAR CC)))
                                      (ADDSQ (MULTSQ (SIMP Z) M1) M2))
                                ESETL))
                       (SETQ Z (PLUS2 Z 1))
                       (GO LAB))))
                  (CAR CC))
                 (SETQ CC (CDR CC))
                 (GO LAB)))))))
         (CAR C))
        (SETQ C (CDR C))
        (GO LAB))
      (COND (EL (SETQ ESETL (NCONC CL ESETL))))
      (RETURN (LIST (CONS 'DVFSF_QESUBCQ ESETL))))) 
(PUT 'DVFSF_QESUBCQ 'NUMBER-OF-ARGS 6) 
(PUT 'DVFSF_QESUBCQ 'DEFINED-ON-LINE '182) 
(PUT 'DVFSF_QESUBCQ 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFQE.RED) 
(PUT 'DVFSF_QESUBCQ 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_QESUBCQ (BVL THEO F V C U)
    (COND ((EQ (SETQ C (CL_SIMPL C NIL (MINUS 1))) 'FALSE) (CONS NIL 'FALSE))
          (T (CONS NIL (CONS 'AND (LIST C (DVFSF_QESUBQ F V U))))))) 
(PUT 'DVFSF_QESUBQ 'NUMBER-OF-ARGS 3) 
(PUT 'DVFSF_QESUBQ 'DEFINED-ON-LINE '192) 
(PUT 'DVFSF_QESUBQ 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFQE.RED) 
(PUT 'DVFSF_QESUBQ 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_QESUBQ (F V U) (CL_APPLY2ATS1 F 'DVFSF_QESUBQAT (LIST V U))) 
(PUT 'DVFSF_QESUBQAT 'NUMBER-OF-ARGS 3) 
(PUT 'DVFSF_QESUBQAT 'DEFINED-ON-LINE '198) 
(PUT 'DVFSF_QESUBQAT 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFQE.RED) 
(PUT 'DVFSF_QESUBQAT 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_QESUBQAT (ATF V U)
    (PROG (OP AL LHS RHS)
      (SETQ OP (DVFSF_OP ATF))
      (SETQ AL (LIST (CONS V (PREPSQ U))))
      (SETQ LHS (SUBF (DVFSF_ARG2L ATF) AL))
      (COND ((MEMQ OP '(EQUAL NEQ)) (RETURN (DVFSF_0MK2 OP (CAR LHS)))))
      (SETQ RHS (SUBF (DVFSF_ARG2R ATF) AL))
      (RETURN
       (DVFSF_MK2 OP
                  (COND (*PHYSOP-LOADED (PHYSOP-MULTF (CAR LHS) (CDR RHS)))
                        (T (POLY-MULTF (CAR LHS) (CDR RHS))))
                  (COND (*PHYSOP-LOADED (PHYSOP-MULTF (CAR RHS) (CDR LHS)))
                        (T (POLY-MULTF (CAR RHS) (CDR LHS)))))))) 
(PUT 'DVFSF_TRANSFORM 'NUMBER-OF-ARGS 7) 
(PUT 'DVFSF_TRANSFORM 'DEFINED-ON-LINE '213) 
(PUT 'DVFSF_TRANSFORM 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFQE.RED) 
(PUT 'DVFSF_TRANSFORM 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL GENERAL GENERAL GENERAL)
       GENERAL)) 
(DE DVFSF_TRANSFORM (V F VL AN THEO ANS BVL) NIL) 
(PUT 'DVFSF_TRYGAUSS 'NUMBER-OF-ARGS 5) 
(PUT 'DVFSF_TRYGAUSS 'DEFINED-ON-LINE '216) 
(PUT 'DVFSF_TRYGAUSS 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFQE.RED) 
(PUT 'DVFSF_TRYGAUSS 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_TRYGAUSS (F VL THEO ANS BVL)
    (PROG (W V FARGL)
      (COND ((EQUAL (COND ((ATOM F) F) (T (CAR F))) 'AND) (SETQ FARGL (CDR F)))
            ((CL_ATFP F) (SETQ FARGL (LIST F))) (T (RETURN 'FAILED)))
      (PROG ()
       WHILELABEL
        (COND ((NOT VL) (RETURN NIL)))
        (PROGN
         (SETQ V (CAR VL))
         (SETQ VL (CDR VL))
         (SETQ W (DVFSF_FINDEQSOL FARGL V THEO ANS))
         (COND
          ((NEQ W 'FAILED)
           (PROGN (SETQ W (CONS (CONS V W) THEO)) (SETQ VL NIL)))))
        (GO WHILELABEL))
      (RETURN W))) 
(PUT 'DVFSF_FINDEQSOL 'NUMBER-OF-ARGS 4) 
(PUT 'DVFSF_FINDEQSOL 'DEFINED-ON-LINE '236) 
(PUT 'DVFSF_FINDEQSOL 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFQE.RED) 
(PUT 'DVFSF_FINDEQSOL 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_FINDEQSOL (FL V THEO ANS)
    (PROG (W)
      (SETQ W (DVFSF_FINDEQSOL1 (CAR FL) V THEO ANS))
      (COND ((NEQ W 'FAILED) (RETURN W)))
      (COND ((CDR FL) (RETURN (DVFSF_FINDEQSOL (CDR FL) V THEO ANS))))
      (RETURN 'FAILED))) 
(PUT 'DVFSF_FINDEQSOL1 'NUMBER-OF-ARGS 4) 
(PUT 'DVFSF_FINDEQSOL1 'DEFINED-ON-LINE '244) 
(PUT 'DVFSF_FINDEQSOL1 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFQE.RED) 
(PUT 'DVFSF_FINDEQSOL1 'PROCEDURE_TYPE
     '(ARROW (TIMES GENERAL GENERAL GENERAL GENERAL) GENERAL)) 
(DE DVFSF_FINDEQSOL1 (A V THEO ANS)
    (COND
     ((OR (CL_CXFP A) (NEQ (DVFSF_OP A) 'EQUAL)
          (NOT (MEMQ V (DVFSF_VARLAT A))))
      'FAILED)
     (T (DVFSF_GELIMSET A V)))) 
(PUT 'DVFSF_GELIMSET 'NUMBER-OF-ARGS 2) 
(PUT 'DVFSF_GELIMSET 'DEFINED-ON-LINE '250) 
(PUT 'DVFSF_GELIMSET 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFQE.RED) 
(PUT 'DVFSF_GELIMSET 'PROCEDURE_TYPE '(ARROW (TIMES GENERAL GENERAL) GENERAL)) 
(DE DVFSF_GELIMSET (A V)
    (PROG (PR)
      (SETQ PR (DVFSF_MKPAIR (DVFSF_ARG2L A) V))
      (COND
       ((NUMBERP (CAR PR))
        (RETURN (LIST (CONS 'DVFSF_QESUBCQ (LIST (DVFSF_MKCSOL PR)))))))
      (RETURN 'FAILED))) 
(PUT 'DVFSF_QEMKANS 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_QEMKANS 'DEFINED-ON-LINE '258) 
(PUT 'DVFSF_QEMKANS 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFQE.RED) 
(PUT 'DVFSF_QEMKANS 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_QEMKANS (AN)
    (SORT (DVFSF_QEBACKSUB (DVFSF_QEMKANS1 AN)) (FUNCTION ORDPCADR))) 
(PUT 'DVFSF_QEMKANS1 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_QEMKANS1 'DEFINED-ON-LINE '261) 
(PUT 'DVFSF_QEMKANS1 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFQE.RED) 
(PUT 'DVFSF_QEMKANS1 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_QEMKANS1 (AN)
    (PROG (Y FORALL-RESULT FORALL-ENDPTR)
      (SETQ Y AN)
      (COND ((NULL Y) (RETURN NIL)))
      (SETQ FORALL-RESULT
              (SETQ FORALL-ENDPTR
                      (CONS
                       ((LAMBDA (Y)
                          (LIST 'EQUAL (CAR Y) (PREPSQ (CADR (CADDR Y)))))
                        (CAR Y))
                       NIL)))
     LOOPLABEL
      (SETQ Y (CDR Y))
      (COND ((NULL Y) (RETURN FORALL-RESULT)))
      (RPLACD FORALL-ENDPTR
              (CONS
               ((LAMBDA (Y) (LIST 'EQUAL (CAR Y) (PREPSQ (CADR (CADDR Y)))))
                (CAR Y))
               NIL))
      (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
      (GO LOOPLABEL))) 
(PUT 'DVFSF_QEBACKSUB 'NUMBER-OF-ARGS 1) 
(PUT 'DVFSF_QEBACKSUB 'DEFINED-ON-LINE '267) 
(PUT 'DVFSF_QEBACKSUB 'DEFINED-IN-FILE 'REDLOG/DVFSF/DVFSFQE.RED) 
(PUT 'DVFSF_QEBACKSUB 'PROCEDURE_TYPE '(ARROW GENERAL GENERAL)) 
(DE DVFSF_QEBACKSUB (EQL)
    (PROG (SUBL RHS W)
      (RETURN
       (PROG (E FORALL-RESULT FORALL-ENDPTR)
         (SETQ E EQL)
         (COND ((NULL E) (RETURN NIL)))
         (SETQ FORALL-RESULT
                 (SETQ FORALL-ENDPTR
                         (CONS
                          ((LAMBDA (E)
                             (PROGN
                              (SETQ RHS (SIMP (CADDR E)))
                              (SETQ W
                                      (LIST 'EQUAL (CADR E)
                                            (PREPSQ (SUBSQ RHS SUBL))))
                              (SETQ SUBL (CONS (CONS (CADR W) (CADDR W)) SUBL))
                              W))
                           (CAR E))
                          NIL)))
        LOOPLABEL
         (SETQ E (CDR E))
         (COND ((NULL E) (RETURN FORALL-RESULT)))
         (RPLACD FORALL-ENDPTR
                 (CONS
                  ((LAMBDA (E)
                     (PROGN
                      (SETQ RHS (SIMP (CADDR E)))
                      (SETQ W (LIST 'EQUAL (CADR E) (PREPSQ (SUBSQ RHS SUBL))))
                      (SETQ SUBL (CONS (CONS (CADR W) (CADDR W)) SUBL))
                      W))
                   (CAR E))
                  NIL))
         (SETQ FORALL-ENDPTR (CDR FORALL-ENDPTR))
         (GO LOOPLABEL))))) 
(ENDMODULE) 